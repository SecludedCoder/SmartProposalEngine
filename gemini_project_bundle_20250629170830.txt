è¯·å…¨é¢æ·±å…¥åˆ†æä»¥ä¸‹é¡¹ç›®æ±‡æ€»ä»£ç 
æœ¬æ¬¡ä»»åŠ¡é‡ç‚¹ï¼š
åˆ†æpromptsç›®å½•ä¸­å„promptæ¨¡æ¿å’Œä»£ç æ˜¯å¦é€‚é…ã€‚
ç”±äºä¹‹å‰æˆ‘ä»¬åšäº†promptæ¨¡æ¿ä¼˜åŒ–å’Œæ‰©å……ï¼Œå› æ­¤éœ€è¦å†æ¬¡æ£€æŸ¥ã€‚
è¯·æ³¨æ„æ£€æŸ¥é‡ç‚¹
1. ä»ç¨‹åºè¿è¡Œè§’åº¦åˆ†æä»£ç å’Œpromptæ¨¡æ¿æ˜¯å¦é€‚é…
ä¾‹å¦‚ï¼Œæœ‰äº›å†…å®¹æ˜¯ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­åŠ¨æ€ç”Ÿæˆçš„ï¼Œç„¶åæ³¨å…¥åˆ°promptæ¨¡æ¿ä¸­ï¼Œåˆå¹¶æˆä¸€ä¸ªå®Œæ•´çš„prompté€ç»™LLM
è¿™æ˜¯æ£€æŸ¥é‡ç‚¹ï¼Œè¯·çœ‹çœ‹è¿™ä¸ªåŠ¨æ€æ³¨å…¥æ˜¯å¦æ­£ç¡®ï¼Œå‡†ç¡®æ— è¯¯

2. è¯·ç¡®è®¤ç›®å‰promptsä¸­çš„promptæ¨¡æ¿æ–‡ä»¶ï¼Œæ˜¯å¦ä¼šè¢«åŠ¨æ€åŠ è½½ï¼ˆç®€å•è®²ï¼Œæ˜¯å¦ç¡®å®å½±å“è¿è¡Œï¼‰

3. è¯·åŠ¡å¿…æ³¨æ„ï¼ŒåŠ¡å¿…æ³¨æ„ï¼Œæœ¬æ¬¡â€œä¸æ£€æŸ¥â€promptæ¨¡æ¿æ˜¯å¦åˆé€‚ï¼Œè¿™ä¸ªä¸é‡è¦ï¼Œæœ¬æ¬¡æ˜¯ç¨‹åºæ‰§è¡Œæ­£ç¡®æ€§æ£€æŸ¥

å¸Œæœ›èƒ½æ­£ç¡®åŠ è½½ç›¸åº”çš„promptæ¨¡æ¿ï¼Œç„¶ååŠ¨æ€å†…å®¹å¯ä»¥å‡†ç¡®æ³¨å…¥ï¼Œæ„å»ºæˆå®Œæ•´çš„prompté€ç»™LLMå…·ä½“æ‰§è¡Œ

ç›®å‰ä¸€å…±9å„promptæ¨¡æ¿æ–‡ä»¶ï¼Œé€ä¸ªåˆ†æç¡®è®¤ã€‚

ä½ åº”è¯¥å…¨é¢æ·±å…¥åˆ†ææ£€æŸ¥ï¼Œ
1. ç¡®è®¤æœ¬æ¬¡çš„promptæ¨¡æ¿ï¼Œåœ¨å…·ä½“å“ªäº›ä»£ç æ–‡ä»¶ä¸­è¢«ç”¨åˆ°
2. ç¡®è®¤æ˜¯å¦åŠ¨æ€åŠ è½½ç¡®å®æœ‰æ•ˆ
3. ç¡®è®¤å…¶ä¸­åŠ¨æ€ä¿¡æ¯æ³¨å…¥æ‹¼è£…æ˜¯å¦æ­£ç¡®
4. å…¶å®ƒä½ è®¤ä¸ºéœ€è¦æ£€æŸ¥çš„å†…å®¹

æ¯æ¬¡åªæ£€æŸ¥ä¸€ä¸ªpromptæ¨¡æ¿ï¼Œæœ¬æ¬¡æ£€æŸ¥[business_negotiation.md]


================================================================================
# ==============================================================================
# Project Code Bundle for LLM Context
# ==============================================================================
#
# This file contains information about a software project, generated by the
# 'bundle_project.py' script to provide context to a Large Language Model (LLM).
#
# Script Execution Directory: E:/Work-2025/ProjectPython/SmartProposalEngine
# Output Mode: 1 (Full Bundle)
#
# Content Details:
# - Complete scanned project structure (respecting directory exclusions).
#   - Filtered file structure (showing included files).
#   - Summary of filtering rules.
#   - Concatenated content of included files.
#
# Please use this content as a reference for understanding the project.
#
# Script Version: 1.3.0
# Generation Time: 2025-06-29 17:08:30 
# ==============================================================================

# Full Project Structure (Scan Results - Respects EXCLUDE_DIRS):
# SmartProposalEngine/
â”œâ”€â”€ assets/
â”‚   â”œâ”€â”€ images/
â”‚   â”‚   â””â”€â”€ logo.png
â”‚   â””â”€â”€ styles/
â”‚       â””â”€â”€ custom.css
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ document_processor.py
â”‚   â”œâ”€â”€ model_interface.py
â”‚   â”œâ”€â”€ prompt_manager.py
â”‚   â””â”€â”€ session_manager.py
â”œâ”€â”€ llm_providers/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ base_provider.py
â”‚   â”œâ”€â”€ gemini_provider.py
â”‚   â””â”€â”€ qwen_provider.py
â”œâ”€â”€ output/
â”œâ”€â”€ pages/
â”‚   â”œâ”€â”€ 1_ğŸ“„_Input_Processing.py
â”‚   â”œâ”€â”€ 2_ğŸ”_Deep_Analysis.py
â”‚   â”œâ”€â”€ 3_ğŸ“‹_Proposal_Generation.py
â”‚   â”œâ”€â”€ 4_ğŸš€_One_Click_Generation.py
â”‚   â””â”€â”€ __init__.py
â”œâ”€â”€ prompts/
â”‚   â”œâ”€â”€ analysis/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ business_negotiation.md
â”‚   â”‚   â”œâ”€â”€ customer_interview.md
â”‚   â”‚   â””â”€â”€ internal_meeting.md
â”‚   â”œâ”€â”€ proposal/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ project_proposal.md
â”‚   â”‚   â”œâ”€â”€ quotation_proposal.md
â”‚   â”‚   â””â”€â”€ solution_brief.md
â”‚   â”œâ”€â”€ transcription/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ multi_speaker.md
â”‚   â”‚   â”œâ”€â”€ optimization.md
â”‚   â”‚   â””â”€â”€ single_speaker.md
â”‚   â””â”€â”€ __init__.py
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ analysis_service.py
â”‚   â”œâ”€â”€ base_service.py
â”‚   â”œâ”€â”€ document_service.py
â”‚   â”œâ”€â”€ proposal_service.py
â”‚   â””â”€â”€ transcription_service.py
â”œâ”€â”€ tests/
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ file_utils.py
â”‚   â”œâ”€â”€ format_utils.py
â”‚   â”œâ”€â”€ ui_utils.py
â”‚   â””â”€â”€ validation_utils.py
â”œâ”€â”€ .gitignore
â”œâ”€â”€ app.py
â”œâ”€â”€ app_config.ini
â”œâ”€â”€ bundle_project.py
â”œâ”€â”€ env_example_file.sh
â”œâ”€â”€ models.conf
â”œâ”€â”€ README.md
â”œâ”€â”€ readme_file.md
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ run_app.py
â””â”€â”€ SmartProposal Engine å•†ä¸šåŒ–æ–¹æ¡ˆ.docx
# ============================================================

# Included File Structure (After Filtering):
# SmartProposalEngine/
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ document_processor.py
â”‚   â”œâ”€â”€ model_interface.py
â”‚   â”œâ”€â”€ prompt_manager.py
â”‚   â””â”€â”€ session_manager.py
â”œâ”€â”€ llm_providers/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ base_provider.py
â”‚   â”œâ”€â”€ gemini_provider.py
â”‚   â””â”€â”€ qwen_provider.py
â”œâ”€â”€ pages/
â”‚   â”œâ”€â”€ 1_ğŸ“„_Input_Processing.py
â”‚   â”œâ”€â”€ 2_ğŸ”_Deep_Analysis.py
â”‚   â”œâ”€â”€ 3_ğŸ“‹_Proposal_Generation.py
â”‚   â”œâ”€â”€ 4_ğŸš€_One_Click_Generation.py
â”‚   â””â”€â”€ __init__.py
â”œâ”€â”€ prompts/
â”‚   â”œâ”€â”€ analysis/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ business_negotiation.md
â”‚   â”‚   â”œâ”€â”€ customer_interview.md
â”‚   â”‚   â””â”€â”€ internal_meeting.md
â”‚   â”œâ”€â”€ proposal/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ project_proposal.md
â”‚   â”‚   â”œâ”€â”€ quotation_proposal.md
â”‚   â”‚   â””â”€â”€ solution_brief.md
â”‚   â”œâ”€â”€ transcription/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ multi_speaker.md
â”‚   â”‚   â”œâ”€â”€ optimization.md
â”‚   â”‚   â””â”€â”€ single_speaker.md
â”‚   â””â”€â”€ __init__.py
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ analysis_service.py
â”‚   â”œâ”€â”€ base_service.py
â”‚   â”œâ”€â”€ document_service.py
â”‚   â”œâ”€â”€ proposal_service.py
â”‚   â””â”€â”€ transcription_service.py
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ file_utils.py
â”‚   â”œâ”€â”€ format_utils.py
â”‚   â”œâ”€â”€ ui_utils.py
â”‚   â””â”€â”€ validation_utils.py
â”œâ”€â”€ app.py
â”œâ”€â”€ app_config.ini
â”œâ”€â”€ env_example_file.sh
â”œâ”€â”€ models.conf
â”œâ”€â”€ README.md
â”œâ”€â”€ readme_file.md
â””â”€â”€ run_app.py
# ============================================================

# Bundle Configuration Summary:
# Root Directory: E:/Work-2025/ProjectPython/SmartProposalEngine
# Applied Filters (Exclusions first, then Inclusion Scope + Extension Filter):
# - Hardcoded Exclusions: ['bundle_project.py', 'gemini_project_bundle.txt']
# - Config Excluded Dirs: ['__pycache__', '.venv', 'venv', '.git', '.idea', 'build', 'dist', 'node_modules', 'logs', 'tests_output', 'htmlcov', '.pytest_cache', '.mypy_cache', '*.egg-info', '.tox', 'task', 'log', 'input_files', 'Chunking - Copy-ç¬¬ä¸€é˜¶æ®µå¤‡ä»½ï¼Œæš‚æ—¶ä¸åˆ ', 'database', 'scripts', 'docs', 'docs_usage', 'test', 'merged_table_descriptions', 'backup', 'data', 'export', 'temp_data', 'core_backup20250218', 'temp_data', 'docs_api', 'temp', 'dev_tools', 'docs', 'in use', 'output_files', 'record_files', 'temp_segments', 'input']
# - Config Excluded Files: ['.env', 'local_settings.py', '.DS_Store', 'Thumbs.db', 'åƒé‡Œå‘½ç¨¿.txt', 'project_context_for_llm.txt', 'scan_directory.py', 'merge_code.py', 'all_code.txt', 'api_key.txt', 'bundle_project.py', 'dir_struct_bazi_foundation.txt', 'gemini_project_bundle.txt']
# - Config Excluded Extensions: ['.pyc', '.log', '.tmp', '.bak', '.swp', '.swo', '.swn', '.coverage']
# - Inclusion Scope: All files not excluded by above rules.
# - Extension Filter: Files must match ['.py', '.yaml', '.yml', '.json', '.toml', '.ini', '.md', 'requirements.txt', 'Dockerfile', '.dockerignore', '.sh', '.bat', '.csv', '.conf']
# Note: The full project structure (respecting Excluded Dirs) was listed earlier.
# ============================================================


--- File: app.py ---
#!/usr/bin/env python
# -*- coding: utf-8 -*-
"""
æ–‡ä»¶è·¯å¾„: smart_proposal_engine/app.py
åŠŸèƒ½è¯´æ˜: SmartProposal Engineä¸»åº”ç”¨å…¥å£
ä½œè€…: SmartProposal Team
åˆ›å»ºæ—¥æœŸ: 2025-06-27
æœ€åä¿®æ”¹: 2025-06-29
ç‰ˆæœ¬: 1.1.0
"""

import os
import sys
import time
import streamlit as st
from pathlib import Path
import configparser
from datetime import datetime

# æ·»åŠ é¡¹ç›®æ ¹ç›®å½•åˆ°ç³»ç»Ÿè·¯å¾„
sys.path.insert(0, os.path.dirname(os.path.abspath(__file__)))

from core.session_manager import SessionManager
from core.model_interface import ModelInterface
from utils.file_utils import ensure_directory_exists

# é¡µé¢é…ç½®
st.set_page_config(
    page_title="SmartProposal Engine",
    page_icon="ğŸš€",
    layout="wide",
    initial_sidebar_state="expanded",
    menu_items={
        'Get Help': 'https://github.com/smartproposal/engine',
        'Report a bug': 'https://github.com/smartproposal/engine/issues',
        'About': """
        # SmartProposal Engine

        æ™ºèƒ½å•†ä¸šæ–¹æ¡ˆç”Ÿæˆç³»ç»Ÿ

        ç‰ˆæœ¬: 1.1.0
        """
    }
)


def load_custom_css():
    """åŠ è½½è‡ªå®šä¹‰CSSæ ·å¼"""
    css_file = Path(__file__).parent / "assets" / "styles" / "custom.css"
    if css_file.exists():
        #ã€ä¿®æ”¹ã€‘æ˜ç¡®æŒ‡å®šUTF-8ç¼–ç è¯»å–CSSæ–‡ä»¶
        with open(css_file, 'r', encoding='utf-8') as f:
            st.markdown(f"<style>{f.read()}</style>", unsafe_allow_html=True)
    else:
        # é»˜è®¤æ ·å¼
        st.markdown("""
        <style>
        /* ä¸»æ ‡é¢˜æ ·å¼ */
        .main-header {
            font-size: 2.5rem;
            font-weight: bold;
            color: #1f77b4;
            text-align: center;
            margin-bottom: 1rem;
            padding: 1rem 0;
            border-bottom: 3px solid #e0e0e0;
        }

        /* åŠŸèƒ½å¡ç‰‡æ ·å¼ */
        .feature-card {
            background-color: #f8f9fa;
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            border: 1px solid #e0e0e0;
            transition: all 0.3s ease;
        }

        .feature-card:hover {
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }

        /* ç»Ÿè®¡ä¿¡æ¯æ ·å¼ */
        .stat-card {
            background-color: #ffffff;
            border-radius: 8px;
            padding: 1rem;
            text-align: center;
            border: 1px solid #e0e0e0;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: #1f77b4;
        }

        .stat-label {
            font-size: 0.9rem;
            color: #666;
            margin-top: 0.5rem;
        }

        /* ä¾§è¾¹æ æ ·å¼ */
        .css-1d391kg {
            background-color: #f8f9fa;
        }

        /* æŒ‰é’®æ ·å¼å¢å¼º */
        .stButton > button {
            background-color: #1f77b4;
            color: white;
            border: none;
            padding: 0.5rem 2rem;
            border-radius: 5px;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .stButton > button:hover {
            background-color: #145a8b;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        /* æˆåŠŸæ¶ˆæ¯æ ·å¼ */
        .success-message {
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 1rem;
            border-radius: 5px;
            margin: 1rem 0;
        }

        /* é”™è¯¯æ¶ˆæ¯æ ·å¼ */
        .error-message {
            background-color: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
            padding: 1rem;
            border-radius: 5px;
            margin: 1rem 0;
        }
        </style>
        """, unsafe_allow_html=True)


def initialize_session_state():
    """åˆå§‹åŒ–ä¼šè¯çŠ¶æ€"""
    # åˆå§‹åŒ–SessionManager
    if 'session_manager' not in st.session_state:
        st.session_state.session_manager = SessionManager()

    # åˆå§‹åŒ–å…¶ä»–ä¼šè¯å˜é‡
    if 'initialized' not in st.session_state:
        st.session_state.initialized = True
        st.session_state.api_key_configured = False  # æ–°å¢ï¼šæ ‡è®°API Keyæ˜¯å¦å·²é…ç½®
        st.session_state.model_provider = None  # æ–°å¢ï¼šå­˜å‚¨é€‰æ‹©çš„æ¨¡å‹æä¾›å•†
        st.session_state.processing_history = []
        st.session_state.current_workflow = None
        st.session_state.last_activity = datetime.now()

    # åˆå§‹åŒ–æ¨¡å‹æ¥å£ï¼ˆä¸ç«‹å³è¿›è¡ŒAPI Keyé…ç½®ï¼‰
    if 'model_interface' not in st.session_state:
        try:
            st.session_state.model_interface = ModelInterface()
            # å¦‚æœä½¿ç”¨å†…éƒ¨keyï¼Œå®ƒåœ¨__init__ä¸­å·²ç»åˆå§‹åŒ–äº†
            if st.session_state.model_interface.is_initialized:
                st.session_state.api_key_configured = True
                st.session_state.model_provider = st.session_state.model_interface.provider
        except Exception as e:
            st.session_state.api_key_configured = False
            st.session_state.model_error = str(e)


def create_directories():
    """åˆ›å»ºå¿…è¦çš„ç›®å½•"""
    directories = [
        'temp',
        'output',
        'prompts/analysis',
        'prompts/proposal',
        'prompts/transcription'
    ]

    for directory in directories:
        ensure_directory_exists(directory)


def load_config():
    """åŠ è½½åº”ç”¨é…ç½®"""
    config_path = Path(__file__).parent / "app_config.ini"
    config = configparser.ConfigParser()

    if config_path.exists():
        # ã€ä¿®æ”¹ã€‘æ˜ç¡®æŒ‡å®šUTF-8ç¼–ç è¯»å–é…ç½®æ–‡ä»¶
        config.read(config_path, encoding='utf-8')
        st.session_state.config = config
    else:
        st.warning("é…ç½®æ–‡ä»¶æœªæ‰¾åˆ°ï¼Œä½¿ç”¨é»˜è®¤é…ç½®")
        st.session_state.config = None


def show_initialization_page():
    """æ˜¾ç¤ºAPI Keyå’Œæ¨¡å‹æä¾›å•†è®¾ç½®é¡µé¢"""
    st.title("ğŸš€ æ¬¢è¿ä½¿ç”¨ SmartProposal Engine")
    st.header("è¯·å…ˆå®Œæˆç³»ç»Ÿè®¾ç½®")

    st.info("ä¸ºäº†ä½¿ç”¨æœ¬ç³»ç»Ÿçš„AIåŠŸèƒ½ï¼Œæ‚¨éœ€è¦æä¾›ä¸€ä¸ªæœ‰æ•ˆçš„API Keyã€‚")

    config = st.session_state.config
    providers_str = config.get('MODEL_PROVIDERS', 'available_providers', fallback='Gemini')
    providers = [p.strip() for p in providers_str.split(',')]
    default_provider = config.get('MODEL_PROVIDERS', 'default_provider', fallback='Gemini')

    col1, col2 = st.columns(2)
    with col1:
        selected_provider = st.selectbox(
            "1. é€‰æ‹©æ¨¡å‹æä¾›å•†",
            options=providers,
            index=providers.index(default_provider) if default_provider in providers else 0
        )

    with col2:
        api_key = st.text_input(
            "2. è¾“å…¥æ‚¨çš„API Key",
            type="password",
            help=f"è¯·è¾“å…¥ {selected_provider} çš„ API Key"
        )

    if st.button("ä¿å­˜å¹¶å¼€å§‹ä½¿ç”¨", type="primary", use_container_width=True):
        if not api_key:
            st.error("API Key ä¸èƒ½ä¸ºç©ºï¼")
        else:
            with st.spinner("æ­£åœ¨éªŒè¯å’Œåˆå§‹åŒ–æ¨¡å‹..."):
                try:
                    # è·å–æ¨¡å‹æ¥å£å®ä¾‹å¹¶è¿›è¡Œåˆå§‹åŒ–
                    model_interface = st.session_state.model_interface
                    model_interface.initialize_model(api_key, selected_provider)

                    # æ›´æ–°ä¼šè¯çŠ¶æ€
                    st.session_state.api_key_configured = True
                    st.session_state.model_provider = selected_provider

                    # è®¾ç½®é»˜è®¤æ¨¡å‹
                    for task in ['transcription', 'analysis', 'proposal']:
                        default_model_key = f'{task}_model'
                        if config.has_option('MODEL_SETTINGS', default_model_key):
                            default_model = config.get('MODEL_SETTINGS', default_model_key)
                            model_interface.set_model(task, default_model)

                    st.success("åˆå§‹åŒ–æˆåŠŸï¼ç³»ç»Ÿå·²å‡†å¤‡å°±ç»ªã€‚")
                    time.sleep(1)
                    st.rerun()

                except Exception as e:
                    st.error(f"åˆå§‹åŒ–å¤±è´¥: {e}")
                    st.error("è¯·æ£€æŸ¥æ‚¨çš„API Keyå’Œç½‘ç»œè¿æ¥åé‡è¯•ã€‚")


def show_sidebar():
    """æ˜¾ç¤ºä¾§è¾¹æ """
    with st.sidebar:
        st.markdown("## ğŸš€ SmartProposal Engine")
        st.markdown("---")

        # æ˜¾ç¤ºå½“å‰çŠ¶æ€
        if st.session_state.get('api_key_configured'):
            st.success(f"âœ… ç³»ç»Ÿå·²å°±ç»ª ({st.session_state.get('model_provider')})")
        else:
            st.error("âš ï¸ ç³»ç»Ÿæœªé…ç½®")

        st.markdown("---")

        # æ–°å¢ï¼šæ¨¡å‹é…ç½®éƒ¨åˆ†
        st.markdown("### âš™ï¸ æ¨¡å‹é…ç½®")
        model_interface = st.session_state.get('model_interface')
        provider = st.session_state.get('model_provider')

        if model_interface and provider:
            available_models = model_interface.get_available_models(provider)
            model_options = [m['api_name'] for m in available_models]

            def format_func(name):
                model_conf = model_interface.all_models.get(name)
                if model_conf:
                    return f"{model_conf.display_name} ({name.split('/')[-1]})"
                return name

            # è½¬å½•æ¨¡å‹
            current_trans_model = model_interface.get_model_name('transcription')
            trans_index = model_options.index(current_trans_model) if current_trans_model in model_options else 0
            selected_trans_model = st.selectbox(
                "è½¬å½•æ¨¡å‹",
                options=model_options,
                index=trans_index,
                format_func=format_func,
                key='transcription_model_selector'
            )
            model_interface.set_model('transcription', selected_trans_model)

            # åˆ†ææ¨¡å‹
            current_analysis_model = model_interface.get_model_name('analysis')
            analysis_index = model_options.index(
                current_analysis_model) if current_analysis_model in model_options else 0
            selected_analysis_model = st.selectbox(
                "åˆ†ææ¨¡å‹",
                options=model_options,
                index=analysis_index,
                format_func=format_func,
                key='analysis_model_selector'
            )
            model_interface.set_model('analysis', selected_analysis_model)

            # æ–¹æ¡ˆç”Ÿæˆæ¨¡å‹
            current_proposal_model = model_interface.get_model_name('proposal')
            proposal_index = model_options.index(
                current_proposal_model) if current_proposal_model in model_options else 0
            selected_proposal_model = st.selectbox(
                "æ–¹æ¡ˆæ¨¡å‹",
                options=model_options,
                index=proposal_index,
                format_func=format_func,
                key='proposal_model_selector'
            )
            model_interface.set_model('proposal', selected_proposal_model)
        else:
            st.caption("è¯·å…ˆå®Œæˆç³»ç»Ÿè®¾ç½®ä»¥é…ç½®æ¨¡å‹ã€‚")

        st.markdown("---")

        # åŠŸèƒ½å¯¼èˆªè¯´æ˜
        st.markdown("### ğŸ§­ åŠŸèƒ½å¯¼èˆª")
        st.info("""
        **1. ğŸ“¥ å†…å®¹è¾“å…¥**: ä¸Šä¼ éŸ³é¢‘æˆ–æ–‡æ¡£
        **2. ğŸ” æ·±åº¦åˆ†æ**: å•†ä¸šæ´å¯Ÿåˆ†æ
        **3. ğŸ“ æ–¹æ¡ˆç”Ÿæˆ**: ç”Ÿæˆä¸“ä¸šæ–¹æ¡ˆ
        **4. âœ¨ ä¸€é”®ç”Ÿæˆ**: ç«¯åˆ°ç«¯å¤„ç†
        """)

        st.markdown("---")

        # å¤„ç†ç»Ÿè®¡
        if 'processing_history' in st.session_state:
            st.markdown("### ğŸ“Š å¤„ç†ç»Ÿè®¡")
            total_processed = len(st.session_state.processing_history)
            st.metric("å·²å¤„ç†æ–‡ä»¶", total_processed)

        # ä¼šè¯ä¿¡æ¯
        if 'last_activity' in st.session_state:
            st.markdown("---")
            st.markdown("### â„¹ï¸ ä¼šè¯ä¿¡æ¯")
            st.text(f"æœ€åæ´»åŠ¨: {st.session_state.last_activity.strftime('%H:%M:%S')}")

        # ç³»ç»Ÿè®¾ç½®
        st.markdown("---")
        st.markdown("### ğŸ› ï¸ ç³»ç»Ÿæ“ä½œ")

        if st.button("ğŸ§¹ æ¸…ç†ä¸´æ—¶æ–‡ä»¶"):
            session_manager = st.session_state.get('session_manager')
            if session_manager:
                session_manager.cleanup_all_temp_files()
                st.success("ä¸´æ—¶æ–‡ä»¶å·²æ¸…ç†")

        if st.button("ğŸ”„ é‡ç½®ä¼šè¯"):
            # ä¿ç•™å…³é”®é…ç½®ä¿¡æ¯
            api_configured = st.session_state.get('api_key_configured', False)
            provider = st.session_state.get('model_provider')
            model_if = st.session_state.get('model_interface')
            app_config = st.session_state.get('config')

            for key in list(st.session_state.keys()):
                del st.session_state[key]

            # æ¢å¤å…³é”®çŠ¶æ€
            st.session_state.api_key_configured = api_configured
            st.session_state.model_provider = provider
            st.session_state.model_interface = model_if
            st.session_state.config = app_config

            # é‡æ–°åˆå§‹åŒ–ä¼šè¯çŠ¶æ€
            initialize_session_state()
            st.rerun()


def show_main_page():
    """æ˜¾ç¤ºä¸»é¡µé¢"""
    # ä¸»æ ‡é¢˜
    st.markdown('<h1 class="main-header">ğŸš€ SmartProposal Engine</h1>', unsafe_allow_html=True)
    st.markdown('<p style="text-align: center; font-size: 1.2rem; color: #666;">æ™ºèƒ½å•†ä¸šæ–¹æ¡ˆç”Ÿæˆç³»ç»Ÿ</p>',
                unsafe_allow_html=True)

    st.markdown("---")

    # ç³»ç»Ÿä»‹ç»
    col1, col2 = st.columns([2, 1])

    with col1:
        st.markdown("""
        ### ğŸ‘‹ æ¬¢è¿ä½¿ç”¨SmartProposal Engine

        SmartProposal Engineæ˜¯ä¸€ä¸ªæ™ºèƒ½åŒ–çš„å•†ä¸šæ–¹æ¡ˆç”Ÿæˆç³»ç»Ÿï¼Œèƒ½å¤Ÿå¸®åŠ©æ‚¨å¿«é€Ÿå°†åŸå§‹ä¿¡æ¯è½¬åŒ–ä¸ºä¸“ä¸šçš„å•†ä¸šæ–‡æ¡£ã€‚

        **æ ¸å¿ƒåŠŸèƒ½ï¼š**
        - ğŸ¤ **æ™ºèƒ½è½¬å½•**ï¼šæ”¯æŒéŸ³é¢‘æ–‡ä»¶çš„é«˜ç²¾åº¦è½¬å½•ï¼Œè¯†åˆ«å¤šè¯´è¯äººå¯¹è¯
        - ğŸ” **æ·±åº¦åˆ†æ**ï¼šåŸºäºAIçš„å•†ä¸šæ´å¯Ÿåˆ†æï¼Œæå–å…³é”®ä¿¡æ¯
        - ğŸ“ **æ–¹æ¡ˆç”Ÿæˆ**ï¼šè‡ªåŠ¨ç”Ÿæˆä¸“ä¸šçš„é¡¹ç›®å»ºè®®ä¹¦å’Œå•†ä¸šæ–¹æ¡ˆ
        - âœ¨ **ç«¯åˆ°ç«¯å¤„ç†**ï¼šä¸€é”®å®Œæˆä»åŸå§‹è¾“å…¥åˆ°æœ€ç»ˆæ–¹æ¡ˆçš„å…¨æµç¨‹

        **é€‚ç”¨åœºæ™¯ï¼š**
        - å®¢æˆ·è®¿è°ˆè®°å½•åˆ†æ
        - å•†åŠ¡è°ˆåˆ¤è¦ç‚¹æå–
        - å†…éƒ¨ä¼šè®®å†³ç­–æ•´ç†
        - éœ€æ±‚æ”¶é›†ä¸åˆ†æ
        - é¡¹ç›®æ–¹æ¡ˆå¿«é€Ÿç”Ÿæˆ
        """)

    with col2:
        # å¿«é€Ÿå¼€å§‹æŒ‡å—
        st.markdown("""
        ### âš¡ å¿«é€Ÿå¼€å§‹

        **æ­¥éª¤ 1**: é€‰æ‹©å·¦ä¾§å¯¼èˆªä¸­çš„åŠŸèƒ½æ¨¡å—

        **æ­¥éª¤ 2**: ä¸Šä¼ æ‚¨çš„éŸ³é¢‘æˆ–æ–‡æ¡£æ–‡ä»¶

        **æ­¥éª¤ 3**: é€‰æ‹©åˆé€‚çš„åˆ†ææ¨¡æ¿

        **æ­¥éª¤ 4**: è·å–AIç”Ÿæˆçš„ä¸“ä¸šæ–¹æ¡ˆ

        ---

        ğŸ’¡ **æç¤º**: é¦–æ¬¡ä½¿ç”¨å»ºè®®ä»"ä¸€é”®ç”Ÿæˆ"åŠŸèƒ½å¼€å§‹ï¼Œä½“éªŒå®Œæ•´æµç¨‹
        """)

    st.markdown("---")

    # åŠŸèƒ½å¡ç‰‡å±•ç¤º
    st.markdown("### ğŸ¯ æ ¸å¿ƒåŠŸèƒ½æ¨¡å—")

    col1, col2 = st.columns(2)

    with col1:
        st.markdown("""
        <div class="feature-card">
        <h4>ğŸ“¥ å†…å®¹è¾“å…¥å¤„ç†</h4>
        <p>æ”¯æŒå¤šç§æ ¼å¼çš„å†…å®¹è¾“å…¥ï¼š</p>
        <ul>
        <li>éŸ³é¢‘æ–‡ä»¶ï¼šm4a, mp3, wavç­‰</li>
        <li>æ–‡æ¡£æ–‡ä»¶ï¼šdocx, pdf, txt</li>
        <li>æ–‡æœ¬ç›´æ¥è¾“å…¥</li>
        </ul>
        <p>æ™ºèƒ½è¯†åˆ«è¯´è¯äººï¼Œä¼˜åŒ–è½¬å½•è´¨é‡</p>
        </div>
        """, unsafe_allow_html=True)

        st.markdown("""
        <div class="feature-card">
        <h4>ğŸ§  æ·±åº¦åˆ†æå¼•æ“</h4>
        <p>åŸºäºåœºæ™¯çš„æ™ºèƒ½åˆ†æï¼š</p>
        <ul>
        <li>å®¢æˆ·éœ€æ±‚æ´å¯Ÿ</li>
        <li>å•†åŠ¡è°ˆåˆ¤è¦ç‚¹</li>
        <li>ä¼šè®®å†³ç­–æå–</li>
        <li>è‡ªå®šä¹‰åˆ†ææ¨¡æ¿</li>
        </ul>
        <p>æä¾›ç»“æ„åŒ–çš„åˆ†ææŠ¥å‘Š</p>
        </div>
        """, unsafe_allow_html=True)

    with col2:
        st.markdown("""
        <div class="feature-card">
        <h4>ğŸ’¡ æ–¹æ¡ˆæ™ºèƒ½ç”Ÿæˆ</h4>
        <p>ä¸“ä¸šæ–‡æ¡£è‡ªåŠ¨ç”Ÿæˆï¼š</p>
        <ul>
        <li>é¡¹ç›®å»ºè®®ä¹¦</li>
        <li>å•†åŠ¡æŠ¥ä»·æ–¹æ¡ˆ</li>
        <li>è§£å†³æ–¹æ¡ˆç®€æŠ¥</li>
        <li>ä¼šè®®çºªè¦</li>
        </ul>
        <p>èåˆä¼ä¸šèƒ½åŠ›ï¼Œå®šåˆ¶åŒ–è¾“å‡º</p>
        </div>
        """, unsafe_allow_html=True)

        st.markdown("""
        <div class="feature-card">
        <h4>ğŸš€ ä¸€é”®å…¨æµç¨‹å¤„ç†</h4>
        <p>ç«¯åˆ°ç«¯è‡ªåŠ¨åŒ–å¤„ç†ï¼š</p>
        <ul>
        <li>æ‰¹é‡æ–‡ä»¶å¤„ç†</li>
        <li>è‡ªåŠ¨æµç¨‹ç¼–æ’</li>
        <li>è¿›åº¦å®æ—¶è·Ÿè¸ª</li>
        <li>ç»“æœæ‰¹é‡ä¸‹è½½</li>
        </ul>
        <p>å¤§å¹…æå‡å·¥ä½œæ•ˆç‡</p>
        </div>
        """, unsafe_allow_html=True)

    st.markdown("---")

    # ä½¿ç”¨ç»Ÿè®¡
    if 'processing_history' in st.session_state and st.session_state.processing_history:
        st.markdown("### ğŸ“Š ä½¿ç”¨ç»Ÿè®¡")

        col1, col2, col3, col4 = st.columns(4)

        with col1:
            st.markdown("""
            <div class="stat-card">
            <div class="stat-number">{}</div>
            <div class="stat-label">æ€»å¤„ç†æ•°</div>
            </div>
            """.format(len(st.session_state.processing_history)), unsafe_allow_html=True)

    # é¡µè„š
    st.markdown("---")
    st.markdown("""
    <p style="text-align: center; color: #888;">
    SmartProposal Engine v1.1.0 | 
    Powered by AI | 
    Â© 2025 SmartProposal Team
    </p>
    """, unsafe_allow_html=True)


def main():
    """ä¸»å‡½æ•°"""
    # åŠ è½½è‡ªå®šä¹‰CSS
    load_custom_css()

    # åˆå§‹åŒ–
    load_config()
    initialize_session_state()
    create_directories()

    # æ›´æ–°æœ€åæ´»åŠ¨æ—¶é—´
    if st.session_state.get('initialized'):
        st.session_state.last_activity = datetime.now()

    # "å®ˆå«"é€»è¾‘ï¼šæ£€æŸ¥API Keyæ˜¯å¦å·²é…ç½®
    if not st.session_state.get('api_key_configured'):
        show_initialization_page()
    else:
        # å¦‚æœå·²é…ç½®ï¼Œæ˜¾ç¤ºæ­£å¸¸åº”ç”¨ç•Œé¢
        show_sidebar()
        show_main_page()


if __name__ == "__main__":
    main()

--- File: app_config.ini ---
# ==============================================================================
# File: app_config.ini (ä¿®æ”¹å)
# ==============================================================================
# SmartProposal Engine åº”ç”¨ç¨‹åºæ ¸å¿ƒé…ç½®æ–‡ä»¶
#
# æ­¤æ–‡ä»¶ç”¨äºé…ç½®åº”ç”¨çš„åŸºæœ¬è¡Œä¸ºã€åŠŸèƒ½å¼€å…³å’Œé»˜è®¤è®¾ç½®ã€‚
# ä¿®æ”¹æ­¤æ–‡ä»¶åï¼Œé€šå¸¸éœ€è¦é‡å¯åº”ç”¨æ‰èƒ½ç”Ÿæ•ˆã€‚

[API_SETTINGS]
# æ˜¯å¦ä½¿ç”¨å­˜å‚¨åœ¨æœ¬åœ°æ–‡ä»¶ä¸­çš„APIå¯†é’¥ã€‚
# å¦‚æœè®¾ç½®ä¸º trueï¼Œåº”ç”¨å°†å°è¯•ä» api_key_file æŒ‡å®šçš„æ–‡ä»¶ä¸­è¯»å–å¯†é’¥ã€‚
# å¦‚æœè®¾ç½®ä¸º falseï¼Œåº”ç”¨å°†è¦æ±‚ç”¨æˆ·åœ¨UIä¸­è¾“å…¥å¯†é’¥ã€‚
use_internal_api_key = false
# å½“ use_internal_api_key = true æ—¶ï¼Œä»æ­¤æ–‡ä»¶è¯»å–APIå¯†é’¥ã€‚
api_key_file = api_key.txt

[MODEL_PROVIDERS]
# å¯ç”¨çš„æ¨¡å‹æä¾›å•†åˆ—è¡¨ï¼Œç”¨é€—å·åˆ†éš”ã€‚
# åº”ç”¨å¯åŠ¨æ—¶ä¼šè¯»å–æ­¤åˆ—è¡¨ï¼Œå¹¶åœ¨UIä¸­ä½œä¸ºé€‰é¡¹æä¾›ç»™ç”¨æˆ·ã€‚
# ã€ä¿®æ”¹ã€‘åœ¨è¿™é‡Œæ–°å¢äº† "Qwen"
available_providers = Gemini,Qwen
# ç”¨æˆ·é¦–æ¬¡æ‰“å¼€åº”ç”¨æˆ–é‡ç½®ä¼šè¯æ—¶ï¼Œé»˜è®¤é€‰æ‹©çš„æä¾›å•†ã€‚
default_provider = Gemini

[MODEL_SETTINGS]
# ä¸ºä¸åŒä»»åŠ¡è®¾ç½®é»˜è®¤çš„æ¨¡å‹ã€‚
# æ³¨æ„ï¼šè¿™äº›åªæ˜¯åˆå§‹é»˜è®¤å€¼ï¼Œç”¨æˆ·å¯ä»¥åœ¨UIä¾§è¾¹æ ä¸­éšæ—¶æ›´æ”¹ã€‚
# æ¨¡å‹åç§°å¿…é¡»ä¸ models.conf æ–‡ä»¶ä¸­å®šä¹‰çš„ model_api_name ä¸€è‡´ã€‚
transcription_model = models/gemini-2.5-flash
analysis_model = models/gemini-2.5-pro
proposal_model = models.gemini-2.5-pro

[FEATURE_SETTINGS]
# åŠŸèƒ½å¼€å…³ï¼Œç”¨äºå¯ç”¨æˆ–ç¦ç”¨åº”ç”¨çš„æ ¸å¿ƒåŠŸèƒ½æ¨¡å—ã€‚
enable_deep_analysis = true
enable_proposal_generation = true
enable_custom_prompts = true
enable_batch_processing = true

[TEMPLATE_SETTINGS]
# é»˜è®¤æ¨¡æ¿è®¾ç½®ã€‚å½“ç”¨æˆ·æœªåšé€‰æ‹©æ—¶ï¼Œç³»ç»Ÿå°†ä½¿ç”¨è¿™äº›æ¨¡æ¿ã€‚
# æ¨¡æ¿åç§°åº”ä¸ prompts/ ç›®å½•ä¸‹ç›¸åº”å­ç›®å½•ä¸­çš„æ–‡ä»¶åï¼ˆä¸å«æ‰©å±•åï¼‰å¯¹åº”ã€‚
default_analysis_template = customer_interview
default_proposal_template = project_proposal
# å­˜å‚¨Promptæ¨¡æ¿çš„æ ¹ç›®å½•ã€‚
template_directory = prompts/

[FILE_SETTINGS]
# æ–‡ä»¶ä¸Šä¼ ç›¸å…³çš„é™åˆ¶å’Œç›®å½•é…ç½®ã€‚
max_file_size_mb = 200
# å…è®¸ä¸Šä¼ çš„éŸ³é¢‘å’Œæ–‡æ¡£æ–‡ä»¶æ ¼å¼ï¼Œç”¨é€—å·åˆ†éš”ï¼Œä¸å¸¦ç‚¹ã€‚
allowed_audio_formats = m4a,mp3,wav,aac,ogg,flac
allowed_document_formats = docx,pdf,txt
# å­˜å‚¨ä¸´æ—¶æ–‡ä»¶çš„ç›®å½•ã€‚
temp_directory = temp/
# å­˜å‚¨æœ€ç»ˆè¾“å‡ºæ–‡ä»¶çš„ç›®å½•ã€‚
output_directory = output/

--- File: core/__init__.py ---

--- File: core/document_processor.py ---
#!/usr/bin/env python
# -*- coding: utf-8 -*-
"""
æ–‡ä»¶è·¯å¾„: smart_proposal_engine/core/document_processor.py
åŠŸèƒ½è¯´æ˜: æ–‡æ¡£å¤„ç†å™¨ï¼Œè´Ÿè´£åè°ƒå„ç§æ–‡æ¡£å’ŒéŸ³é¢‘å¤„ç†æœåŠ¡
ä½œè€…: SmartProposal Team
åˆ›å»ºæ—¥æœŸ: 2025-06-27
æœ€åä¿®æ”¹: 2025-06-27
ç‰ˆæœ¬: 1.0.0
"""

import os
import sys
from typing import Dict, List, Optional, Union, Tuple, Any
from pathlib import Path
from datetime import datetime
import mimetypes

# æ·»åŠ é¡¹ç›®æ ¹ç›®å½•åˆ°ç³»ç»Ÿè·¯å¾„
sys.path.insert(0, os.path.dirname(os.path.dirname(os.path.abspath(__file__))))

from services.base_service import ProcessingResult
from services.transcription_service import TranscriptionService
from services.document_service import DocumentService
from utils.file_utils import get_file_type, get_file_extension, validate_file_size
from utils.validation_utils import validate_file_type


class DocumentProcessor:
    """
    æ–‡æ¡£å¤„ç†å™¨

    ä¸»è¦åŠŸèƒ½:
    1. ç»Ÿä¸€çš„æ–‡ä»¶å¤„ç†æ¥å£
    2. è‡ªåŠ¨è¯†åˆ«æ–‡ä»¶ç±»å‹å¹¶è°ƒç”¨ç›¸åº”æœåŠ¡
    3. æ”¯æŒéŸ³é¢‘å’Œæ–‡æ¡£çš„ç»Ÿä¸€å¤„ç†
    4. æ‰¹é‡æ–‡ä»¶å¤„ç†æ”¯æŒ

    ä½¿ç”¨ç¤ºä¾‹:
        processor = DocumentProcessor()
        result = processor.process_file(file_path, options)
    """

    def __init__(self):
        """åˆå§‹åŒ–æ–‡æ¡£å¤„ç†å™¨"""
        self.transcription_service = TranscriptionService()
        self.document_service = DocumentService()
        self.supported_types = self._get_supported_types()

    def _get_supported_types(self) -> Dict[str, List[str]]:
        """è·å–æ”¯æŒçš„æ–‡ä»¶ç±»å‹"""
        return {
            'audio': ['.m4a', '.mp3', '.wav', '.aac', '.ogg', '.flac', '.mp4'],
            'document': ['.docx', '.pdf', '.txt', '.doc', '.rtf', '.odt']
        }

    def process_file(self,
                     file_path: Union[str, Path],
                     options: Optional[Dict] = None) -> ProcessingResult:
        """
        å¤„ç†å•ä¸ªæ–‡ä»¶

        Args:
            file_path: æ–‡ä»¶è·¯å¾„
            options: å¤„ç†é€‰é¡¹
                - max_file_size_mb: æœ€å¤§æ–‡ä»¶å¤§å°é™åˆ¶
                - enable_text_optimization: æ˜¯å¦å¯ç”¨æ–‡æœ¬ä¼˜åŒ–ï¼ˆéŸ³é¢‘ï¼‰
                - extract_metadata: æ˜¯å¦æå–å…ƒæ•°æ®ï¼ˆæ–‡æ¡£ï¼‰
                - progress_callback: è¿›åº¦å›è°ƒå‡½æ•°

        Returns:
            ProcessingResult: å¤„ç†ç»“æœ
        """
        options = options or {}
        progress_callback = options.get('progress_callback')

        try:
            # éªŒè¯æ–‡ä»¶
            file_path = Path(file_path)
            if not file_path.exists():
                raise FileNotFoundError(f"æ–‡ä»¶ä¸å­˜åœ¨: {file_path}")

            # éªŒè¯æ–‡ä»¶å¤§å°
            max_size_mb = options.get('max_file_size_mb', 200)
            is_valid_size, size_msg = validate_file_size(file_path, max_size_mb)
            if not is_valid_size:
                raise ValueError(size_msg)

            # è·å–æ–‡ä»¶ç±»å‹
            file_type = get_file_type(file_path)
            file_ext = get_file_extension(file_path)

            if progress_callback:
                progress_callback(f"æ­£åœ¨å¤„ç† {file_type} æ–‡ä»¶: {file_path.name}")

            # æ ¹æ®æ–‡ä»¶ç±»å‹è°ƒç”¨ç›¸åº”æœåŠ¡
            if file_type == 'audio':
                # éŸ³é¢‘æ–‡ä»¶ä½¿ç”¨è½¬å½•æœåŠ¡
                result = self.transcription_service.process(
                    file_path,
                    options=options
                )
            elif file_type == 'document':
                # æ–‡æ¡£æ–‡ä»¶ä½¿ç”¨æ–‡æ¡£æœåŠ¡
                result = self.document_service.process(
                    file_path,
                    options=options
                )
            else:
                # å°è¯•ä½œä¸ºæ–‡æœ¬æ–‡æ¡£å¤„ç†
                if progress_callback:
                    progress_callback(f"æœªçŸ¥æ–‡ä»¶ç±»å‹ {file_ext}ï¼Œå°è¯•ä½œä¸ºæ–‡æœ¬å¤„ç†")

                result = self.document_service.process(
                    file_path,
                    options=options
                )

            # æ·»åŠ å¤„ç†å™¨ä¿¡æ¯åˆ°å…ƒæ•°æ®
            result.metadata['processor'] = 'DocumentProcessor'
            result.metadata['file_type_detected'] = file_type

            return result

        except Exception as e:
            if progress_callback:
                progress_callback(f"æ–‡ä»¶å¤„ç†å¤±è´¥: {str(e)}")

            return ProcessingResult(
                content='',
                metadata={
                    'error': str(e),
                    'file_path': str(file_path),
                    'processor': 'DocumentProcessor'
                },
                source_type='unknown',
                processing_time=0,
                model_used='',
                tokens_consumed={},
                error=str(e)
            )

    def process_text_input(self,
                           text: str,
                           input_type: str = 'text',
                           options: Optional[Dict] = None) -> ProcessingResult:
        """
        å¤„ç†æ–‡æœ¬è¾“å…¥

        Args:
            text: è¾“å…¥æ–‡æœ¬
            input_type: è¾“å…¥ç±»å‹ ('text', 'transcript')
            options: å¤„ç†é€‰é¡¹

        Returns:
            ProcessingResult: å¤„ç†ç»“æœ
        """
        options = options or {}

        try:
            # å¦‚æœæ˜¯è½¬å½•æ–‡æœ¬ä¸”éœ€è¦ä¼˜åŒ–
            if input_type == 'transcript' and options.get('enable_text_optimization', False):
                result = self.transcription_service.process_web_text(text, options)
            else:
                # ç›´æ¥è¿”å›æ–‡æœ¬ä½œä¸ºç»“æœ
                result = ProcessingResult(
                    content=text,
                    metadata={
                        'input_type': input_type,
                        'text_length': len(text),
                        'timestamp': datetime.now().strftime('%Y-%m-%d %H:%M:%S')
                    },
                    source_type='text',
                    processing_time=0,
                    model_used='',
                    tokens_consumed={}
                )

            return result

        except Exception as e:
            return ProcessingResult(
                content=text,
                metadata={'error': str(e)},
                source_type='text',
                processing_time=0,
                model_used='',
                tokens_consumed={},
                error=str(e)
            )

    def batch_process_files(self,
                            file_paths: List[Union[str, Path]],
                            options: Optional[Dict] = None) -> List[ProcessingResult]:
        """
        æ‰¹é‡å¤„ç†æ–‡ä»¶

        Args:
            file_paths: æ–‡ä»¶è·¯å¾„åˆ—è¡¨
            options: å¤„ç†é€‰é¡¹

        Returns:
            List[ProcessingResult]: å¤„ç†ç»“æœåˆ—è¡¨
        """
        options = options or {}
        results = []
        progress_callback = options.get('progress_callback')

        total_files = len(file_paths)

        for i, file_path in enumerate(file_paths):
            if progress_callback:
                progress_callback(f"å¤„ç†æ–‡ä»¶ {i + 1}/{total_files}")

            # ä¸ºæ¯ä¸ªæ–‡ä»¶åˆ›å»ºç‹¬ç«‹çš„é€‰é¡¹
            file_options = options.copy()
            file_options['file_index'] = i
            file_options['total_files'] = total_files

            result = self.process_file(file_path, file_options)
            results.append(result)

        return results

    def get_file_info(self, file_path: Union[str, Path]) -> Dict[str, Any]:
        """
        è·å–æ–‡ä»¶ä¿¡æ¯ï¼ˆä¸å¤„ç†æ–‡ä»¶ï¼‰

        Args:
            file_path: æ–‡ä»¶è·¯å¾„

        Returns:
            Dict: æ–‡ä»¶ä¿¡æ¯
        """
        file_path = Path(file_path)

        if not file_path.exists():
            return {'error': 'æ–‡ä»¶ä¸å­˜åœ¨'}

        file_type = get_file_type(file_path)
        file_ext = get_file_extension(file_path)
        file_size = file_path.stat().st_size

        info = {
            'name': file_path.name,
            'path': str(file_path.absolute()),
            'type': file_type,
            'extension': file_ext,
            'size_bytes': file_size,
            'size_formatted': f"{file_size / (1024 * 1024):.2f} MB",
            'mime_type': mimetypes.guess_type(str(file_path))[0] or 'unknown',
            'created': datetime.fromtimestamp(file_path.stat().st_ctime).strftime('%Y-%m-%d %H:%M:%S'),
            'modified': datetime.fromtimestamp(file_path.stat().st_mtime).strftime('%Y-%m-%d %H:%M:%S')
        }

        # éŸ³é¢‘æ–‡ä»¶ç‰¹æœ‰ä¿¡æ¯
        if file_type == 'audio':
            from utils.file_utils import get_audio_duration
            duration = get_audio_duration(file_path)
            if duration:
                info['duration_seconds'] = duration
                info['duration_formatted'] = f"{int(duration // 60)}:{int(duration % 60):02d}"

        return info

    def validate_file(self,
                      file_path: Union[str, Path],
                      file_type_required: Optional[str] = None) -> Tuple[bool, str]:
        """
        éªŒè¯æ–‡ä»¶æ˜¯å¦å¯ä»¥å¤„ç†

        Args:
            file_path: æ–‡ä»¶è·¯å¾„
            file_type_required: è¦æ±‚çš„æ–‡ä»¶ç±»å‹ ('audio', 'document', Noneè¡¨ç¤ºä»»æ„)

        Returns:
            (is_valid, message): éªŒè¯ç»“æœ
        """
        file_path = Path(file_path)

        # æ£€æŸ¥æ–‡ä»¶å­˜åœ¨æ€§
        if not file_path.exists():
            return False, "æ–‡ä»¶ä¸å­˜åœ¨"

        # æ£€æŸ¥æ–‡ä»¶ç±»å‹
        file_type = get_file_type(file_path)
        file_ext = get_file_extension(file_path)

        if file_type_required:
            if file_type != file_type_required:
                return False, f"æ–‡ä»¶ç±»å‹ä¸åŒ¹é…ï¼Œéœ€è¦ {file_type_required}ï¼Œå®é™…ä¸º {file_type}"

        # æ£€æŸ¥æ˜¯å¦æ”¯æŒè¯¥æ ¼å¼
        supported = False
        for ftype, extensions in self.supported_types.items():
            if file_ext in extensions:
                supported = True
                break

        if not supported:
            return False, f"ä¸æ”¯æŒçš„æ–‡ä»¶æ ¼å¼: {file_ext}"

        return True, f"æ–‡ä»¶æœ‰æ•ˆ: {file_type} ({file_ext})"

    def get_supported_formats(self) -> Dict[str, List[str]]:
        """è·å–æ”¯æŒçš„æ–‡ä»¶æ ¼å¼"""
        return self.supported_types.copy()

    def estimate_processing_time(self,
                                 file_path: Union[str, Path]) -> Optional[int]:
        """
        ä¼°ç®—å¤„ç†æ—¶é—´ï¼ˆç§’ï¼‰

        Args:
            file_path: æ–‡ä»¶è·¯å¾„

        Returns:
            int: ä¼°ç®—çš„å¤„ç†æ—¶é—´ï¼ˆç§’ï¼‰
        """
        file_path = Path(file_path)
        if not file_path.exists():
            return None

        file_type = get_file_type(file_path)
        file_size_mb = file_path.stat().st_size / (1024 * 1024)

        # åŸºäºæ–‡ä»¶ç±»å‹å’Œå¤§å°çš„ç®€å•ä¼°ç®—
        if file_type == 'audio':
            # éŸ³é¢‘æ–‡ä»¶ï¼šè€ƒè™‘æ—¶é•¿
            from utils.file_utils import get_audio_duration
            duration = get_audio_duration(file_path)
            if duration:
                # å¤§çº¦æ¯åˆ†é’ŸéŸ³é¢‘éœ€è¦10ç§’å¤„ç†æ—¶é—´
                return int(duration / 60 * 10)
            else:
                # åŸºäºæ–‡ä»¶å¤§å°ä¼°ç®—
                return int(file_size_mb * 5)

        elif file_type == 'document':
            # æ–‡æ¡£æ–‡ä»¶ï¼šåŸºäºå¤§å°
            # å¤§çº¦æ¯MBéœ€è¦2ç§’å¤„ç†æ—¶é—´
            return int(file_size_mb * 2)

        else:
            # æœªçŸ¥ç±»å‹ï¼šä¿å®ˆä¼°ç®—
            return int(file_size_mb * 3)

--- File: core/model_interface.py ---
# ==============================================================================
# File: core/model_interface.py (ä¿®æ”¹å)
# ==============================================================================
# !/usr/bin/env python
# -*- coding: utf-8 -*-
"""
æ–‡ä»¶è·¯å¾„: smart_proposal_engine/core/model_interface.py
åŠŸèƒ½è¯´æ˜: ç»Ÿä¸€çš„AIæ¨¡å‹æ¥å£ï¼Œé€šè¿‡è°ƒåº¦ä¸åŒçš„Providerï¼Œå°è£…å¤šæä¾›å•†ï¼ˆå¦‚Gemini, Qwenï¼‰çš„APIè°ƒç”¨ã€‚
          æ­¤ç±»ä½œä¸ºæ¨¡å‹è°ƒç”¨çš„ç»Ÿä¸€å…¥å£ï¼ˆFacade Patternï¼‰ã€‚
ä½œè€…: SmartProposal Team
åˆ›å»ºæ—¥æœŸ: 2025-06-27
æœ€åä¿®æ”¹: 2025-06-29
ç‰ˆæœ¬: 1.2.0
"""

import os
import sys
import time
import configparser
from typing import Dict, List, Optional, Tuple, Union, Any
from pathlib import Path

# æ·»åŠ é¡¹ç›®æ ¹ç›®å½•åˆ°ç³»ç»Ÿè·¯å¾„
sys.path.insert(0, os.path.dirname(os.path.dirname(os.path.abspath(__file__))))

# ã€ä¿®æ”¹ã€‘å¯¼å…¥æ–°çš„Providerç±»ï¼Œä¸å†ç›´æ¥å¯¼å…¥ä»»ä½•å…·ä½“SDK
from llm_providers.base_provider import BaseProvider
from llm_providers.gemini_provider import GeminiProvider
from llm_providers.qwen_provider import QwenProvider


class ModelConfig:
    """æ¨¡å‹é…ç½®ç±»ï¼ˆä¿æŒä¸å˜ï¼‰"""

    def __init__(self, provider: str, api_name: str, display_name: str,
                 input_price: float, output_price: float):
        self.provider = provider
        self.api_name = api_name
        self.display_name = display_name
        self.input_price_per_million = input_price
        self.output_price_per_million = output_price

    def calculate_cost(self, input_tokens: int, output_tokens: int) -> float:
        """è®¡ç®—ä½¿ç”¨æˆæœ¬ï¼ˆç¾å…ƒï¼‰"""
        input_cost = (input_tokens / 1_000_000) * self.input_price_per_million
        output_cost = (output_tokens / 1_000_000) * self.output_price_per_million
        return input_cost + output_cost


class ModelInterface:
    """
    ç»Ÿä¸€çš„AIæ¨¡å‹æ¥å£

    ä¸»è¦åŠŸèƒ½:
    1. æ”¯æŒå¤šæ¨¡å‹æä¾›å•† (Gemini, Qwenç­‰)ã€‚
    2. ç»Ÿä¸€çš„æ¨¡å‹è°ƒç”¨æ¥å£ã€‚
    3. è‡ªåŠ¨é‡è¯•å’Œé”™è¯¯å¤„ç†ã€‚
    4. Tokenä½¿ç”¨é‡ç»Ÿè®¡å’Œè´¹ç”¨è®¡ç®—ã€‚
    5. æ¨¡å‹åŠ¨æ€é…ç½®å’Œåˆ‡æ¢ã€‚
    """

    def __init__(self, config_path: Optional[str] = None):
        """
        åˆå§‹åŒ–æ¨¡å‹æ¥å£ã€‚
        """
        self.all_models: Dict[str, ModelConfig] = {}
        self.current_models: Dict[str, str] = {}
        self.api_key: Optional[str] = None
        self.provider: Optional[str] = None
        # ã€æ–°å¢ã€‘æŒæœ‰å…·ä½“çš„providerå®ä¾‹
        self.provider_client: Optional[BaseProvider] = None
        self.is_initialized = False

        self._load_config(config_path)
        self._load_model_config()

        if self.config.getboolean('API_SETTINGS', 'use_internal_api_key', fallback=False):
            api_key_file = self.config.get('API_SETTINGS', 'api_key_file', fallback='api_key.txt')
            project_root = Path(__file__).parent.parent
            api_key_path = project_root / api_key_file

            if api_key_path.exists():
                with open(api_key_path, 'r', encoding='utf-8') as f:
                    internal_api_key = f.read().strip()
                if internal_api_key:
                    default_provider = self.config.get('MODEL_PROVIDERS', 'default_provider', fallback='Gemini')
                    try:
                        self.initialize_model(internal_api_key, default_provider)
                    except Exception as e:
                        print(f"è­¦å‘Šï¼šä½¿ç”¨å†…éƒ¨å¯†é’¥åˆå§‹åŒ–å¤±è´¥: {e}")

    def initialize_model(self, api_key: str, provider: str):
        """
        ã€å·²é‡æ„ã€‘ä½¿ç”¨API Keyå’Œæä¾›å•†æ¥åˆå§‹åŒ–æ¨¡å‹ã€‚
        """
        if not api_key or not provider:
            self.is_initialized = False
            raise ValueError("API Keyå’Œæ¨¡å‹æä¾›å•†ä¸èƒ½ä¸ºç©º")

        self.api_key = api_key
        self.provider = provider

        try:
            # æ ¹æ®æä¾›å•†é€‰æ‹©ä¸åŒçš„åˆå§‹åŒ–é€»è¾‘ï¼ˆå·¥å‚æ¨¡å¼ï¼‰
            if self.provider == 'Gemini':
                self.provider_client = GeminiProvider(self.api_key)
            elif self.provider == 'Qwen':
                self.provider_client = QwenProvider(self.api_key)
            else:
                raise NotImplementedError(f"ä¸æ”¯æŒçš„æ¨¡å‹æä¾›å•†: {self.provider}")

            # è°ƒç”¨å…·ä½“providerçš„åˆå§‹åŒ–æ–¹æ³•
            self.provider_client.initialize()
            self.is_initialized = True
            print(f"âœ… ModelInterface å·²ä½¿ç”¨ {self.provider} æä¾›å•†æˆåŠŸåˆå§‹åŒ–ã€‚")

        except Exception as e:
            self.is_initialized = False
            self.provider_client = None
            print(f"âŒ æ¨¡å‹æ¥å£åˆå§‹åŒ–å¤±è´¥: {e}")
            raise ConnectionError(f"æ— æ³•ä½¿ç”¨æä¾›çš„API Keyè¿æ¥åˆ° {self.provider}ã€‚è¯·æ£€æŸ¥Keyæ˜¯å¦æ­£ç¡®ä»¥åŠç½‘ç»œè¿æ¥ã€‚")

    def _load_config(self, config_path: Optional[str] = None):
        """åŠ è½½åº”ç”¨é…ç½®ï¼ˆä¿æŒä¸å˜ï¼‰"""
        if config_path is None:
            config_path = os.path.join(
                os.path.dirname(os.path.dirname(os.path.abspath(__file__))),
                'app_config.ini'
            )
        self.config = configparser.ConfigParser()
        self.config.read(config_path, encoding='utf-8')
        self.current_models = {
            'transcription': self.config.get('MODEL_SETTINGS', 'transcription_model', fallback=''),
            'analysis': self.config.get('MODEL_SETTINGS', 'analysis_model', fallback=''),
            'proposal': self.config.get('MODEL_SETTINGS', 'proposal_model', fallback=''),
            'optimization': self.config.get('MODEL_SETTINGS', 'optimization_model', fallback='')
        }

    def _load_model_config(self):
        """ä»models.confåŠ è½½æ‰€æœ‰æ¨¡å‹é…ç½®ï¼ˆä¿æŒä¸å˜ï¼‰"""
        models_conf_path = os.path.join(
            os.path.dirname(os.path.dirname(os.path.abspath(__file__))),
            'models.conf'
        )
        if not os.path.exists(models_conf_path):
            return
        with open(models_conf_path, 'r', encoding='utf-8') as f:
            for line in f:
                line = line.strip()
                if not line or line.startswith('#'):
                    continue
                parts = [part.strip() for part in line.split(',')]
                if len(parts) >= 5:
                    provider, api_name, display_name, input_price, output_price = parts[0], parts[1], parts[2], float(
                        parts[3]), float(parts[4])
                    self.all_models[api_name] = ModelConfig(provider, api_name, display_name, input_price, output_price)

    def get_model_name(self, model_type: str) -> str:
        """è·å–æŒ‡å®šç±»å‹çš„æ¨¡å‹åç§°ï¼ˆä¿æŒä¸å˜ï¼‰"""
        return self.current_models.get(model_type, '')

    def set_model(self, model_type: str, model_name: str) -> bool:
        """è®¾ç½®ç‰¹å®šç±»å‹ä½¿ç”¨çš„æ¨¡å‹ï¼ˆä¿æŒä¸å˜ï¼‰"""
        if model_name in self.all_models:
            self.current_models[model_type] = model_name
            return True
        return False

    def get_available_models(self, provider: Optional[str] = None) -> List[Dict[str, Any]]:
        """è·å–å¯ç”¨çš„æ¨¡å‹åˆ—è¡¨ï¼Œå¯æŒ‰æä¾›å•†è¿‡æ»¤ï¼ˆä¿æŒä¸å˜ï¼‰"""
        provider_to_check = provider or self.provider
        if not provider_to_check:
            return []
        available = []
        for model in self.all_models.values():
            if model.provider.lower() == provider_to_check.lower():
                available.append({'api_name': model.api_name, 'display_name': model.display_name})
        return available

    def generate_content(self,
                         prompt: Union[str, List],
                         model_type: str = 'analysis',
                         generation_config: Optional[Dict] = None,
                         safety_settings: Optional[List] = None,
                         request_options: Optional[Dict] = None) -> Tuple[str, Dict[str, Any]]:
        """
        ã€å·²é‡æ„ã€‘ç”Ÿæˆå†…å®¹çš„ç»Ÿä¸€æ¥å£ï¼Œå°†è°ƒç”¨å§”æ‰˜ç»™å…·ä½“çš„Providerã€‚
        """
        if not self.is_initialized or not self.provider_client:
            raise RuntimeError("ModelInterfaceæœªæ­£ç¡®åˆå§‹åŒ–ï¼Œè¯·åœ¨ä¸»é¡µé¢è®¾ç½®APIå¯†é’¥ã€‚")

        model_name = self.get_model_name(model_type)
        if not model_name:
            raise ValueError(f"æœªç»™ä»»åŠ¡ç±»å‹ '{model_type}' é…ç½®æ¨¡å‹ã€‚è¯·åœ¨ä¾§è¾¹æ è®¾ç½®ã€‚")

        start_time = time.time()

        # å°†è°ƒç”¨å§”æ‰˜ç»™å…·ä½“çš„providerå®¢æˆ·ç«¯
        response_text, stats = self.provider_client.generate(
            prompt=prompt,
            model_name=model_name,
            generation_config=generation_config,
            safety_settings=safety_settings,
            request_options=request_options
        )

        end_time = time.time()
        cost = self.calculate_cost(stats.get('input_tokens', 0), stats.get('output_tokens', 0), model_type)

        # ç»„è£…æœ€ç»ˆçš„ã€ç»Ÿä¸€æ ¼å¼çš„ç»Ÿè®¡æ•°æ®
        final_stats = {
            'model_used': model_name,
            'input_tokens': stats.get('input_tokens', 0),
            'output_tokens': stats.get('output_tokens', 0),
            'total_tokens': stats.get('input_tokens', 0) + stats.get('output_tokens', 0),
            'estimated_cost': cost,
            'generation_time': end_time - start_time,
            'model_type': model_type
        }

        return response_text, final_stats

    def calculate_cost(self, input_tokens: int, output_tokens: int, model_type: str) -> float:
        """è®¡ç®—APIè°ƒç”¨æˆæœ¬ï¼ˆä¿æŒä¸å˜ï¼‰"""
        model_name = self.get_model_name(model_type)
        model_config = self.all_models.get(model_name)
        if model_config:
            return model_config.calculate_cost(input_tokens, output_tokens)
        return 0.0

    def count_tokens(self, text: str, model_type: str = 'analysis') -> int:
        """ã€å·²é‡æ„ã€‘ç²¾ç¡®è®¡ç®—æ–‡æœ¬çš„tokenæ•°é‡ï¼Œå§”æ‰˜ç»™Providerã€‚"""
        if not self.is_initialized or not self.provider_client:
            return self._estimate_tokens(text)

        try:
            model_name = self.get_model_name(model_type)
            return self.provider_client.count_tokens(text, model_name)
        except Exception as e:
            print(f"Tokenè®¡ç®—å¤±è´¥ï¼Œä½¿ç”¨ä¼°ç®—å€¼: {e}")
            return self._estimate_tokens(text)

    def _estimate_tokens(self, text: Union[str, Any]) -> int:
        """ä¼°ç®—æ–‡æœ¬çš„tokenæ•°é‡ï¼ˆé€šç”¨åå¤‡æ–¹æ³•ï¼Œä¿æŒä¸å˜ï¼‰"""
        if not isinstance(text, str):
            text = str(text)
        chinese_chars = len([c for c in text if '\u4e00' <= c <= '\u9fff'])
        other_chars = len(text) - chinese_chars
        estimated_tokens = chinese_chars + (other_chars * 0.5)
        return int(estimated_tokens)

    def stream_generate_content(self,
                                prompt: Union[str, List],
                                model_type: str = 'analysis',
                                generation_config: Optional[Dict] = None,
                                callback=None) -> Tuple[str, Dict[str, Any]]:
        """ã€å·²é‡æ„ã€‘æµå¼ç”Ÿæˆå†…å®¹ï¼Œå§”æ‰˜ç»™Providerã€‚"""
        if not self.is_initialized or not self.provider_client:
            raise RuntimeError("ModelInterfaceæœªæ­£ç¡®åˆå§‹åŒ–")

        start_time = time.time()
        model_name = self.get_model_name(model_type)

        complete_response, stats = self.provider_client.stream_generate(
            prompt, model_name, generation_config, callback
        )

        end_time = time.time()
        cost = self.calculate_cost(stats.get('input_tokens', 0), stats.get('output_tokens', 0), model_type)

        final_stats = {
            'model_used': model_name,
            'input_tokens': stats.get('input_tokens', 0),
            'output_tokens': stats.get('output_tokens', 0),
            'total_tokens': stats.get('input_tokens', 0) + stats.get('output_tokens', 0),
            'estimated_cost': cost,
            'generation_time': end_time - start_time,
            'model_type': model_type,
            'stream_mode': True
        }

        return complete_response, final_stats

    def get_model_info(self, model_type: str) -> Dict[str, Any]:
        """è·å–æŒ‡å®šç±»å‹æ¨¡å‹çš„è¯¦ç»†ä¿¡æ¯ï¼ˆä¿æŒä¸å˜ï¼‰"""
        model_name = self.get_model_name(model_type)
        model_config = self.all_models.get(model_name)
        if model_config:
            return {
                'api_name': model_config.api_name, 'display_name': model_config.display_name,
                'input_price_per_million': model_config.input_price_per_million,
                'output_price_per_million': model_config.output_price_per_million,
                'model_type': model_type, 'is_active': True
            }
        return {
            'api_name': model_name, 'display_name': model_name, 'model_type': model_type,
            'is_active': False, 'error': 'Model configuration not found'
        }

    def health_check(self) -> Dict[str, Any]:
        """ã€å·²é‡æ„ã€‘å¥åº·æ£€æŸ¥ï¼Œå§”æ‰˜ç»™Providerã€‚"""
        health_status = {
            'status': 'unhealthy', 'api_key_configured': bool(self.api_key),
            'provider': self.provider, 'models_loaded': len(self.all_models),
            'is_initialized': self.is_initialized, 'errors': []
        }

        if self.is_initialized and self.provider_client:
            try:
                provider_health = self.provider_client.health_check()
                health_status.update(provider_health)
                if provider_health.get('status') == 'healthy':
                    health_status['status'] = 'healthy'
                else:
                    health_status['errors'].append(provider_health.get('reason', 'Provider health check failed.'))
            except Exception as e:
                health_status['status'] = 'unhealthy'
                health_status['errors'].append(f"Provider health check raised an exception: {e}")
        else:
            health_status['errors'].append('Not initialized or no provider client.')

        return health_status

--- File: core/prompt_manager.py ---
#!/usr/bin/env python
# -*- coding: utf-8 -*-
"""
æ–‡ä»¶è·¯å¾„: smart_proposal_engine/core/prompt_manager.py
åŠŸèƒ½è¯´æ˜: Promptæ¨¡æ¿ç®¡ç†å™¨ï¼Œè´Ÿè´£æ¨¡æ¿çš„åŠ è½½ã€ç¼“å­˜å’Œç®¡ç†
ä½œè€…: SmartProposal Team
åˆ›å»ºæ—¥æœŸ: 2025-06-27
æœ€åä¿®æ”¹: 2025-06-27
ç‰ˆæœ¬: 1.0.0
"""

import os
import sys
import json
import hashlib
from typing import Dict, List, Optional, Any, Tuple
from pathlib import Path
from datetime import datetime
import re

# æ·»åŠ é¡¹ç›®æ ¹ç›®å½•åˆ°ç³»ç»Ÿè·¯å¾„
sys.path.insert(0, os.path.dirname(os.path.dirname(os.path.abspath(__file__))))


class PromptTemplate:
    """Promptæ¨¡æ¿ç±»"""
    
    def __init__(self, template_id: str, content: str, 
                 category: str, metadata: Optional[Dict] = None):
        self.template_id = template_id
        self.content = content
        self.category = category
        self.metadata = metadata or {}
        self.load_time = datetime.now()
        self.version = self.metadata.get('version', '1.0.0')
        
        # è§£ææ¨¡æ¿ä¸­çš„å˜é‡
        self.variables = self._extract_variables()
    
    def _extract_variables(self) -> List[str]:
        """æå–æ¨¡æ¿ä¸­çš„å˜é‡å ä½ç¬¦"""
        # åŒ¹é… {variable_name} æ ¼å¼çš„å ä½ç¬¦
        pattern = r'\{([^}]+)\}'
        variables = re.findall(pattern, self.content)
        return list(set(variables))  # å»é‡
    
    def render(self, variables: Optional[Dict[str, Any]] = None) -> str:
        """
        æ¸²æŸ“æ¨¡æ¿ï¼Œæ›¿æ¢å˜é‡
        
        Args:
            variables: å˜é‡å­—å…¸
        
        Returns:
            str: æ¸²æŸ“åçš„å†…å®¹
        """
        if not variables:
            return self.content
        
        rendered = self.content
        for var_name, var_value in variables.items():
            placeholder = f"{{{var_name}}}"
            rendered = rendered.replace(placeholder, str(var_value))
        
        return rendered
    
    def validate_variables(self, provided_variables: Dict[str, Any]) -> Tuple[bool, List[str]]:
        """
        éªŒè¯æä¾›çš„å˜é‡æ˜¯å¦æ»¡è¶³æ¨¡æ¿è¦æ±‚
        
        Returns:
            (is_valid, missing_variables)
        """
        provided_keys = set(provided_variables.keys())
        required_keys = set(self.variables)
        
        missing = list(required_keys - provided_keys)
        is_valid = len(missing) == 0
        
        return is_valid, missing
    
    def get_info(self) -> Dict[str, Any]:
        """è·å–æ¨¡æ¿ä¿¡æ¯"""
        return {
            'template_id': self.template_id,
            'category': self.category,
            'version': self.version,
            'variables': self.variables,
            'metadata': self.metadata,
            'load_time': self.load_time.isoformat()
        }


class PromptManager:
    """
    Promptæ¨¡æ¿ç®¡ç†å™¨
    
    ä¸»è¦åŠŸèƒ½:
    1. ä»æ–‡ä»¶ç³»ç»ŸåŠ è½½å†…ç½®æ¨¡æ¿
    2. æ”¯æŒè¿è¡Œæ—¶åŠ è½½è‡ªå®šä¹‰æ¨¡æ¿
    3. æ¨¡æ¿å‚æ•°åŒ–å’Œå˜é‡æ›¿æ¢
    4. æ¨¡æ¿ç¼“å­˜ç®¡ç†
    5. æ¨¡æ¿ç‰ˆæœ¬æ§åˆ¶
    
    ä½¿ç”¨ç¤ºä¾‹:
        pm = PromptManager()
        template = pm.get_template('analysis', 'customer_interview', variables={'transcript': text})
    """
    
    # é»˜è®¤æ¨¡æ¿ï¼ˆå½“æ–‡ä»¶ç³»ç»Ÿæ¨¡æ¿ä¸å¯ç”¨æ—¶ä½¿ç”¨ï¼‰
    DEFAULT_TEMPLATES = {
        'transcription': {
            'multi_speaker': """è¯·å‡†ç¡®è½¬å½•è¿™æ®µéŸ³é¢‘å†…å®¹ã€‚

è¦æ±‚ï¼š
1. å‡†ç¡®è¯†åˆ«ä¸åŒè¯´è¯äººï¼Œä½¿ç”¨"è¯´è¯äººA:"ã€"è¯´è¯äººB:"ç­‰æ ¼å¼æ ‡è®°
2. ä¿ç•™æ‰€æœ‰å¯¹è¯å†…å®¹ï¼ŒåŒ…æ‹¬è¯­æ°”è¯
3. é€‚å½“æ·»åŠ æ ‡ç‚¹ç¬¦å·ï¼Œæé«˜å¯è¯»æ€§
4. å¦‚æœ‰èƒŒæ™¯å™ªéŸ³æˆ–ä¸æ¸…æ™°éƒ¨åˆ†ï¼Œç”¨[å¬ä¸æ¸…]æ ‡è®°

è¯·ç›´æ¥è¾“å‡ºè½¬å½•ç»“æœï¼Œä¸è¦æ·»åŠ ä»»ä½•é¢å¤–è¯´æ˜ã€‚""",
            
            'single_speaker': """è¯·å‡†ç¡®è½¬å½•è¿™æ®µéŸ³é¢‘å†…å®¹ã€‚

è¦æ±‚ï¼š
1. å®Œæ•´ä¿ç•™æ‰€æœ‰å†…å®¹
2. é€‚å½“æ·»åŠ æ ‡ç‚¹ç¬¦å·
3. ä¿æŒåŸå§‹è¯­è¨€é£æ ¼
4. ä¸æ¸…æ™°éƒ¨åˆ†ç”¨[å¬ä¸æ¸…]æ ‡è®°

è¯·ç›´æ¥è¾“å‡ºè½¬å½•ç»“æœã€‚""",
            
            'optimization': """# è½¬å½•æ–‡æœ¬ä¼˜åŒ–ä»»åŠ¡

## ç¬¬ä¸€éƒ¨åˆ†ï¼šé”™è¯¯è¯†åˆ«ä¸ä¿®æ­£å»ºè®®

è¯·ä»”ç»†åˆ†æä»¥ä¸‹è½¬å½•æ–‡æœ¬ï¼Œè¯†åˆ«å¯èƒ½çš„é”™è¯¯å¹¶æä¾›ä¿®æ­£å»ºè®®ï¼š

{transcript}

è¯·åˆ—å‡ºï¼š
1. æ˜æ˜¾çš„æ‹¼å†™æˆ–ç”¨è¯é”™è¯¯
2. è¯­æ³•é—®é¢˜
3. æ ‡ç‚¹ç¬¦å·ä½¿ç”¨ä¸å½“
4. ä¸Šä¸‹æ–‡é€»è¾‘ä¸é€šçš„åœ°æ–¹

## ç¬¬äºŒéƒ¨åˆ†ï¼šä¼˜åŒ–åè½¬å½•æ–‡æœ¬

åŸºäºä¸Šè¿°åˆ†æï¼Œè¯·æä¾›ä¼˜åŒ–åçš„å®Œæ•´è½¬å½•æ–‡æœ¬ã€‚ä¿æŒåŸæ„çš„åŒæ—¶ï¼š
- ä¿®æ­£é”™è¯¯
- æ”¹å–„è¯­è¨€æµç•…æ€§
- ç¡®ä¿ä¸“ä¸šæœ¯è¯­å‡†ç¡®
- ä¿ç•™è¯´è¯äººæ ‡è®°"""
        },
        
        'analysis': {
            'customer_interview': """# å®¢æˆ·è®¿è°ˆæ·±åº¦åˆ†æ

## ä¸€ã€è§’è‰²å®šä½
ä½ æ˜¯ä¸€ä½æ‹¥æœ‰15å¹´ç»éªŒçš„èµ„æ·±å•†ä¸šåˆ†æå¸ˆå’Œå®¢æˆ·æ´å¯Ÿä¸“å®¶ï¼Œä¸“ç²¾äºä»å®¢æˆ·è®¿è°ˆä¸­æå–å…³é”®ä¿¡æ¯å¹¶åˆ¶å®šå•†ä¸šç­–ç•¥ã€‚

## äºŒã€åˆ†æä»»åŠ¡
è¯·å¯¹ä»¥ä¸‹å®¢æˆ·è®¿è°ˆè®°å½•è¿›è¡Œæ·±åº¦åˆ†æï¼Œé‡ç‚¹å…³æ³¨ï¼š
- å®¢æˆ·çš„æ ¸å¿ƒéœ€æ±‚å’Œç—›ç‚¹
- å†³ç­–è¿‡ç¨‹å’Œå…³é”®å½±å“å› ç´ 
- é¢„ç®—èŒƒå›´å’Œæ—¶é—´çº¿
- æ½œåœ¨çš„å•†ä¸šæœºä¼š

### è®¿è°ˆå†…å®¹ï¼š
{transcript}

## ä¸‰ã€åˆ†ææ¡†æ¶

### 3.1 æ‰§è¡Œæ‘˜è¦ï¼ˆ200å­—ä»¥å†…ï¼‰
ç®€è¦æ¦‚æ‹¬è®¿è°ˆçš„æ ¸å¿ƒå‘ç°å’Œå…³é”®æ´å¯Ÿã€‚

### 3.2 å®¢æˆ·ç”»åƒ
- **åŸºæœ¬ä¿¡æ¯**ï¼šè¡Œä¸šã€è§„æ¨¡ã€è§’è‰²
- **ä¸šåŠ¡ç°çŠ¶**ï¼šå½“å‰æŒ‘æˆ˜å’Œæœºé‡
- **å†³ç­–ç‰¹å¾**ï¼šå†³ç­–æµç¨‹ã€å…³é”®äººç‰©

### 3.3 éœ€æ±‚åˆ†æ
- **æ˜¾æ€§éœ€æ±‚**ï¼šå®¢æˆ·æ˜ç¡®è¡¨è¾¾çš„éœ€æ±‚
- **éšæ€§éœ€æ±‚**ï¼šä»å¯¹è¯ä¸­æ¨æ–­çš„æ½œåœ¨éœ€æ±‚
- **éœ€æ±‚ä¼˜å…ˆçº§**ï¼šåŸºäºç´§è¿«æ€§å’Œé‡è¦æ€§æ’åº

### 3.4 å•†æœºè¯„ä¼°
- **é¡¹ç›®è§„æ¨¡**ï¼šé¢„ä¼°çš„é¡¹ç›®ä»·å€¼
- **æˆåŠŸæ¦‚ç‡**ï¼šåŸºäºå®¢æˆ·æ€åº¦å’ŒåŒ¹é…åº¦
- **é£é™©å› ç´ **ï¼šå¯èƒ½å½±å“åˆä½œçš„å› ç´ 

### 3.5 è¡ŒåŠ¨å»ºè®®
æä¾›3-5æ¡å…·ä½“ã€å¯æ‰§è¡Œçš„åç»­è¡ŒåŠ¨å»ºè®®ã€‚

## å››ã€è¾“å‡ºè¦æ±‚
1. åˆ†æåŸºäºäº‹å®ï¼Œé¿å…è¿‡åº¦æ¨æµ‹
2. ä½¿ç”¨ä¸“ä¸šä½†æ˜“æ‡‚çš„å•†ä¸šè¯­è¨€
3. çªå‡ºå…³é”®ä¿¡æ¯ï¼Œä¾¿äºå¿«é€Ÿå†³ç­–""",
            
            'business_negotiation': """# å•†åŠ¡è°ˆåˆ¤è¦ç‚¹åˆ†æ

## ä¸€ã€è§’è‰²å®šä½
ä½ æ˜¯ä¸€ä½èµ„æ·±çš„å•†åŠ¡è°ˆåˆ¤ä¸“å®¶ï¼Œæ“…é•¿åˆ†æè°ˆåˆ¤åŠ¨æ€ã€è¯†åˆ«å„æ–¹ç«‹åœºå¹¶åˆ¶å®šè°ˆåˆ¤ç­–ç•¥ã€‚

## äºŒã€åˆ†æä»»åŠ¡
è¯·å¯¹ä»¥ä¸‹å•†åŠ¡è°ˆåˆ¤è®°å½•è¿›è¡Œæ·±åº¦åˆ†æï¼š

{transcript}

## ä¸‰ã€åˆ†æç»´åº¦

### 3.1 è°ˆåˆ¤æ¦‚å†µ
- å‚ä¸æ–¹åŠå…¶è§’è‰²
- è°ˆåˆ¤ä¸»é¢˜å’Œç›®æ ‡
- å½“å‰è°ˆåˆ¤é˜¶æ®µ

### 3.2 å„æ–¹ç«‹åœºåˆ†æ
- **æˆ‘æ–¹ç«‹åœº**ï¼šæ ¸å¿ƒè¯‰æ±‚ã€åº•çº¿ã€ç­¹ç 
- **å¯¹æ–¹ç«‹åœº**ï¼šä¸»è¦å…³æ³¨ç‚¹ã€è®©æ­¥ç©ºé—´
- **åˆ†æ­§ç„¦ç‚¹**ï¼šä¸»è¦äº‰è®®å’Œéšœç¢

### 3.3 è°ˆåˆ¤åŠ¨æ€
- è°ˆåˆ¤æ°›å›´å’Œè¿›å±•
- å…³é”®è½¬æŠ˜ç‚¹
- åŒæ–¹ç­–ç•¥å˜åŒ–

### 3.4 æ¡æ¬¾è¦ç‚¹
- å·²è¾¾æˆå…±è¯†çš„æ¡æ¬¾
- å¾…å•†è®®çš„æ¡æ¬¾
- æ½œåœ¨é£é™©æ¡æ¬¾

### 3.5 ç­–ç•¥å»ºè®®
- ä¸‹ä¸€æ­¥è°ˆåˆ¤ç­–ç•¥
- å¯èƒ½çš„è®©æ­¥æ–¹æ¡ˆ
- é£é™©é˜²èŒƒæªæ–½""",
            
            'internal_meeting': """# å†…éƒ¨ä¼šè®®å†³ç­–åˆ†æ

## ä¸€ã€è§’è‰²å®šä½
ä½ æ˜¯ä¸€ä½ç»éªŒä¸°å¯Œçš„ç®¡ç†é¡¾é—®ï¼Œä¸“æ³¨äºä¼šè®®æ•ˆç‡æå‡å’Œå†³ç­–è´¨é‡ä¼˜åŒ–ã€‚

## äºŒã€åˆ†æä»»åŠ¡
è¯·å¯¹ä»¥ä¸‹å†…éƒ¨ä¼šè®®è®°å½•è¿›è¡Œåˆ†æï¼š

{transcript}

## ä¸‰ã€åˆ†æè¦ç‚¹

### 3.1 ä¼šè®®æ¦‚è¿°
- ä¼šè®®ä¸»é¢˜å’Œç›®æ ‡
- å‚ä¼šäººå‘˜å’Œè§’è‰²
- ä¼šè®®ç±»å‹ï¼ˆå†³ç­–/è®¨è®º/æ±‡æŠ¥ï¼‰

### 3.2 å…³é”®è®®é¢˜
åˆ—å‡ºè®¨è®ºçš„ä¸»è¦è®®é¢˜åŠå…¶é‡è¦æ€§ã€‚

### 3.3 å†³ç­–äº‹é¡¹
- **å·²å†³ç­–äº‹é¡¹**ï¼šæ˜ç¡®çš„å†³å®šå’Œç»“è®º
- **å¾…å†³ç­–äº‹é¡¹**ï¼šéœ€è¦è¿›ä¸€æ­¥è®¨è®ºçš„é—®é¢˜
- **å†³ç­–ä¾æ®**ï¼šæ”¯æ’‘å†³ç­–çš„å…³é”®ä¿¡æ¯

### 3.4 è¡ŒåŠ¨è®¡åˆ’
- å…·ä½“è¡ŒåŠ¨é¡¹
- è´£ä»»äººåˆ†é…
- å®Œæˆæ—¶é™
- æ‰€éœ€èµ„æº

### 3.5 åç»­è·Ÿè¿›
- éœ€è¦è·Ÿè¿›çš„äº‹é¡¹
- ä¸‹æ¬¡ä¼šè®®å®‰æ’
- é£é™©å’Œæ³¨æ„äº‹é¡¹"""
        },
        
        'proposal': {
            'project_proposal': """# é¡¹ç›®å»ºè®®ä¹¦ç”Ÿæˆ

## ä¸€ã€è§’è‰²å®šä½
ä½ æ˜¯ä¸€ä½èµ„æ·±çš„å•†åŠ¡æ–¹æ¡ˆä¸“å®¶ï¼Œæ“…é•¿æ’°å†™ä¸“ä¸šã€æœ‰è¯´æœåŠ›çš„é¡¹ç›®å»ºè®®ä¹¦ã€‚

## äºŒã€ç”Ÿæˆä»»åŠ¡
åŸºäºä»¥ä¸‹åˆ†ææŠ¥å‘Š{analysis_report}ï¼Œç”Ÿæˆä¸€ä»½å®Œæ•´çš„é¡¹ç›®å»ºè®®ä¹¦ã€‚

{capability_docs}

## ä¸‰ã€å»ºè®®ä¹¦ç»“æ„

### 1. æ‰§è¡Œæ‘˜è¦
- é¡¹ç›®èƒŒæ™¯å’Œæœºé‡
- æ ¸å¿ƒä»·å€¼ä¸»å¼ 
- é¢„æœŸæˆæœ

### 2. å®¢æˆ·éœ€æ±‚ç†è§£
- ä¸šåŠ¡æŒ‘æˆ˜åˆ†æ
- éœ€æ±‚è§£è¯»
- æˆåŠŸæ ‡å‡†å®šä¹‰

### 3. è§£å†³æ–¹æ¡ˆ
- æ•´ä½“æ–¹æ¡ˆæ¶æ„
- æ ¸å¿ƒåŠŸèƒ½æ¨¡å—
- æŠ€æœ¯è·¯çº¿
- åˆ›æ–°äº®ç‚¹

### 4. å®æ–½è®¡åˆ’
- é¡¹ç›®é˜¶æ®µåˆ’åˆ†
- æ—¶é—´çº¿å’Œé‡Œç¨‹ç¢‘
- èµ„æºé…ç½®
- é£é™©ç®¡ç†

### 5. ä»·å€¼æ”¶ç›Š
- ç›´æ¥æ”¶ç›Š
- é—´æ¥æ”¶ç›Š
- ROIåˆ†æ

### 6. ä¸ºä»€ä¹ˆé€‰æ‹©æˆ‘ä»¬
- æ ¸å¿ƒä¼˜åŠ¿
- æˆåŠŸæ¡ˆä¾‹
- å›¢é˜Ÿå®åŠ›

### 7. å•†åŠ¡æ¡æ¬¾
- æŠ¥ä»·æ–¹æ¡ˆ
- ä»˜æ¬¾æ–¹å¼
- æœåŠ¡æ‰¿è¯º

## å››ã€å†™ä½œè¦æ±‚
1. ä¸“ä¸šä¸¥è°¨ï¼Œé€»è¾‘æ¸…æ™°
2. çªå‡ºä»·å€¼ï¼Œæ‰“åŠ¨å®¢æˆ·
3. æ–¹æ¡ˆå…·ä½“ï¼Œå¯æ“ä½œæ€§å¼º
4. ç¯‡å¹…é€‚ä¸­ï¼Œé‡ç‚¹çªå‡º""",
            
            'quotation_proposal': """# å•†åŠ¡æŠ¥ä»·æ–¹æ¡ˆç”Ÿæˆ

## ä¸€ã€ä»»åŠ¡è¯´æ˜
åŸºäºå®¢æˆ·éœ€æ±‚åˆ†æ{analysis_report}ï¼Œç”Ÿæˆä¸“ä¸šçš„å•†åŠ¡æŠ¥ä»·æ–¹æ¡ˆã€‚

{capability_docs}

## äºŒã€æŠ¥ä»·æ–¹æ¡ˆç»“æ„

### 1. æ–¹æ¡ˆæ¦‚è¿°
- é¡¹ç›®èƒŒæ™¯
- æœåŠ¡èŒƒå›´
- äº¤ä»˜æˆæœ

### 2. è¯¦ç»†æŠ¥ä»·
- æœåŠ¡é¡¹ç›®æ˜ç»†
- å•ä»·å’Œæ•°é‡
- ä¼˜æƒ æ”¿ç­–
- æ€»ä»·

### 3. æœåŠ¡è¯´æ˜
- å„é¡¹æœåŠ¡è¯¦ç»†è¯´æ˜
- æœåŠ¡æ ‡å‡†
- è´¨é‡ä¿è¯

### 4. ä»˜æ¬¾æ–¹å¼
- ä»˜æ¬¾èŠ‚ç‚¹
- ä»˜æ¬¾æ¯”ä¾‹
- ä»˜æ¬¾æ¡ä»¶

### 5. å…¶ä»–æ¡æ¬¾
- æœ‰æ•ˆæœŸ
- å”®åæœåŠ¡
- ç‰¹åˆ«è¯´æ˜""",
            
            'solution_brief': """# è§£å†³æ–¹æ¡ˆç®€æŠ¥

## ä¸€ã€ä»»åŠ¡è¯´æ˜
åŸºäºåˆ†æç»“æœ{analysis_report}ï¼Œç”Ÿæˆç®€æ´çš„è§£å†³æ–¹æ¡ˆç®€æŠ¥ã€‚

## äºŒã€ç®€æŠ¥ç»“æ„

### 1. é—®é¢˜é™ˆè¿°
ç®€æ˜æ‰¼è¦åœ°æè¿°å®¢æˆ·é¢ä¸´çš„æ ¸å¿ƒé—®é¢˜ã€‚

### 2. è§£å†³æ–¹æ¡ˆ
- æ–¹æ¡ˆæ¦‚è¿°
- å…³é”®ç‰¹æ€§
- å®æ–½æ­¥éª¤

### 3. é¢„æœŸæ•ˆæœ
- çŸ­æœŸæ”¶ç›Š
- é•¿æœŸä»·å€¼

### 4. ä¸‹ä¸€æ­¥è¡ŒåŠ¨
æ˜ç¡®çš„è¡ŒåŠ¨å»ºè®®å’Œæ—¶é—´å®‰æ’ã€‚"""
        }
    }
    
    def __init__(self, template_dir: Optional[str] = None):
        """
        åˆå§‹åŒ–Promptç®¡ç†å™¨
        
        Args:
            template_dir: æ¨¡æ¿ç›®å½•è·¯å¾„
        """
        if template_dir is None:
            # é»˜è®¤æ¨¡æ¿ç›®å½•
            template_dir = os.path.join(
                os.path.dirname(os.path.dirname(os.path.abspath(__file__))),
                'prompts'
            )
        
        self.template_dir = Path(template_dir)
        self.templates: Dict[str, Dict[str, PromptTemplate]] = {}
        self.custom_templates: Dict[str, PromptTemplate] = {}
        self.cache_enabled = True
        
        # åŠ è½½æ‰€æœ‰æ¨¡æ¿
        self._load_all_templates()

    def _load_all_templates(self):
        """åŠ è½½æ‰€æœ‰æ¨¡æ¿æ–‡ä»¶"""
        # å…ˆåŠ è½½é»˜è®¤æ¨¡æ¿
        self._load_default_templates()

        if not self.template_dir.exists():
            print(f"è­¦å‘Šï¼šæ¨¡æ¿ç›®å½• {self.template_dir} ä¸å­˜åœ¨ï¼Œä½¿ç”¨é»˜è®¤æ¨¡æ¿")
            return

        # éå†æ¨¡æ¿ç›®å½•
        for category_dir in self.template_dir.iterdir():
            if category_dir.is_dir() and not category_dir.name.startswith('_'):
                category = category_dir.name

                # å¦‚æœè¯¥ç±»åˆ«è¿˜æ²¡æœ‰æ¨¡æ¿ï¼Œåˆå§‹åŒ–ç©ºå­—å…¸
                if category not in self.templates:
                    self.templates[category] = {}

                # åŠ è½½è¯¥ç±»åˆ«ä¸‹çš„æ‰€æœ‰æ¨¡æ¿
                for template_file in category_dir.glob('*.md'):
                    template_id = template_file.stem
                    try:
                        content = self._load_template_file(template_file)
                        metadata = self._extract_metadata(content)

                        template = PromptTemplate(
                            template_id=template_id,
                            content=content,
                            category=category,
                            metadata=metadata
                        )

                        self.templates[category][template_id] = template

                    except Exception as e:
                        print(f"åŠ è½½æ¨¡æ¿ {template_file} å¤±è´¥: {e}")

        print(f"æˆåŠŸåŠ è½½ {sum(len(cat) for cat in self.templates.values())} ä¸ªæ¨¡æ¿")
    
    def _load_default_templates(self):
        """åŠ è½½é»˜è®¤æ¨¡æ¿"""
        for category, templates in self.DEFAULT_TEMPLATES.items():
            self.templates[category] = {}
            for template_id, content in templates.items():
                template = PromptTemplate(
                    template_id=template_id,
                    content=content,
                    category=category,
                    metadata={'source': 'default', 'version': '1.0.0'}
                )
                self.templates[category][template_id] = template
    
    def _load_template_file(self, file_path: Path) -> str:
        """åŠ è½½å•ä¸ªæ¨¡æ¿æ–‡ä»¶"""
        with open(file_path, 'r', encoding='utf-8') as f:
            return f.read()
    
    def _extract_metadata(self, content: str) -> Dict[str, Any]:
        """ä»æ¨¡æ¿å†…å®¹ä¸­æå–å…ƒæ•°æ®"""
        metadata = {}
        
        # å°è¯•ä»å†…å®¹å¼€å¤´æå–YAMLæ ¼å¼çš„å…ƒæ•°æ®
        if content.startswith('---'):
            try:
                end_index = content.find('---', 3)
                if end_index > 0:
                    yaml_content = content[3:end_index].strip()
                    # ç®€å•çš„YAMLè§£æï¼ˆå¯ä»¥ä½¿ç”¨yamlåº“è¿›è¡Œæ›´å¤æ‚çš„è§£æï¼‰
                    for line in yaml_content.split('\n'):
                        if ':' in line:
                            key, value = line.split(':', 1)
                            metadata[key.strip()] = value.strip()
            except:
                pass
        
        return metadata

    def get_template(self,
                     category: str,
                     template_id: str,
                     variables: Optional[Dict[str, Any]] = None) -> str:
        """
        è·å–å¹¶æ¸²æŸ“æ¨¡æ¿

        Args:
            category: æ¨¡æ¿ç±»åˆ«
            template_id: æ¨¡æ¿ID
            variables: å˜é‡å­—å…¸

        Returns:
            str: æ¸²æŸ“åçš„æ¨¡æ¿å†…å®¹
        """
        # å…ˆæ£€æŸ¥è‡ªå®šä¹‰æ¨¡æ¿
        custom_key = f"{category}/{template_id}"
        if custom_key in self.custom_templates:
            template = self.custom_templates[custom_key]
            return template.render(variables)

        # æ£€æŸ¥æ–‡ä»¶ç³»ç»Ÿæ¨¡æ¿
        if category in self.templates and template_id in self.templates[category]:
            template = self.templates[category][template_id]
            return template.render(variables)

        # å°è¯•ä»é»˜è®¤æ¨¡æ¿è·å–
        if category in self.DEFAULT_TEMPLATES and template_id in self.DEFAULT_TEMPLATES[category]:
            default_content = self.DEFAULT_TEMPLATES[category][template_id]
            template = PromptTemplate(
                template_id=template_id,
                content=default_content,
                category=category,
                metadata={'source': 'default_fallback'}
            )
            # ç¼“å­˜åˆ°æ¨¡æ¿ä¸­ä»¥é¿å…é‡å¤åˆ›å»º
            if category not in self.templates:
                self.templates[category] = {}
            self.templates[category][template_id] = template
            return template.render(variables)

        # å¦‚æœéƒ½æ²¡æ‰¾åˆ°ï¼ŒæŠ›å‡ºå¼‚å¸¸
        raise ValueError(f"æ¨¡æ¿ {category}/{template_id} ä¸å­˜åœ¨")
    
    def register_custom_template(self,
                                category: str,
                                template_id: str,
                                content: str,
                                metadata: Optional[Dict] = None) -> bool:
        """
        æ³¨å†Œè‡ªå®šä¹‰æ¨¡æ¿
        
        Args:
            category: æ¨¡æ¿ç±»åˆ«
            template_id: æ¨¡æ¿ID
            content: æ¨¡æ¿å†…å®¹
            metadata: æ¨¡æ¿å…ƒæ•°æ®
        
        Returns:
            bool: æ˜¯å¦æ³¨å†ŒæˆåŠŸ
        """
        try:
            template = PromptTemplate(
                template_id=template_id,
                content=content,
                category=category,
                metadata=metadata or {}
            )
            
            custom_key = f"{category}/{template_id}"
            self.custom_templates[custom_key] = template
            
            return True
            
        except Exception as e:
            print(f"æ³¨å†Œè‡ªå®šä¹‰æ¨¡æ¿å¤±è´¥: {e}")
            return False
    
    def list_templates(self, category: Optional[str] = None) -> List[str]:
        """
        åˆ—å‡ºå¯ç”¨çš„æ¨¡æ¿
        
        Args:
            category: æ¨¡æ¿ç±»åˆ«ï¼Œå¦‚æœä¸ºNoneåˆ™åˆ—å‡ºæ‰€æœ‰æ¨¡æ¿
        
        Returns:
            List[str]: æ¨¡æ¿IDåˆ—è¡¨
        """
        templates = []
        
        # æ–‡ä»¶ç³»ç»Ÿæ¨¡æ¿
        if category:
            if category in self.templates:
                templates.extend(self.templates[category].keys())
        else:
            for cat, temps in self.templates.items():
                templates.extend([f"{cat}/{tid}" for tid in temps.keys()])
        
        # è‡ªå®šä¹‰æ¨¡æ¿
        for custom_key in self.custom_templates.keys():
            if category:
                if custom_key.startswith(f"{category}/"):
                    templates.append(custom_key.split('/', 1)[1])
            else:
                templates.append(custom_key)
        
        return sorted(list(set(templates)))
    
    def get_template_info(self, category: str, template_id: str) -> Dict[str, Any]:
        """
        è·å–æ¨¡æ¿è¯¦ç»†ä¿¡æ¯
        
        Args:
            category: æ¨¡æ¿ç±»åˆ«
            template_id: æ¨¡æ¿ID
        
        Returns:
            Dict: æ¨¡æ¿ä¿¡æ¯
        """
        # æ£€æŸ¥è‡ªå®šä¹‰æ¨¡æ¿
        custom_key = f"{category}/{template_id}"
        if custom_key in self.custom_templates:
            return self.custom_templates[custom_key].get_info()
        
        # æ£€æŸ¥æ–‡ä»¶ç³»ç»Ÿæ¨¡æ¿
        if category in self.templates and template_id in self.templates[category]:
            return self.templates[category][template_id].get_info()
        
        raise ValueError(f"æ¨¡æ¿ {category}/{template_id} ä¸å­˜åœ¨")
    
    def validate_template(self,
                         category: str,
                         template_id: str,
                         variables: Dict[str, Any]) -> Tuple[bool, List[str]]:
        """
        éªŒè¯æ¨¡æ¿å˜é‡
        
        Args:
            category: æ¨¡æ¿ç±»åˆ«
            template_id: æ¨¡æ¿ID
            variables: æä¾›çš„å˜é‡
        
        Returns:
            (is_valid, missing_variables)
        """
        # è·å–æ¨¡æ¿
        custom_key = f"{category}/{template_id}"
        if custom_key in self.custom_templates:
            template = self.custom_templates[custom_key]
        elif category in self.templates and template_id in self.templates[category]:
            template = self.templates[category][template_id]
        else:
            return False, [f"æ¨¡æ¿ {category}/{template_id} ä¸å­˜åœ¨"]
        
        return template.validate_variables(variables)
    
    def reload_templates(self):
        """é‡æ–°åŠ è½½æ‰€æœ‰æ¨¡æ¿"""
        self.templates.clear()
        self._load_all_templates()
        print("æ¨¡æ¿é‡æ–°åŠ è½½å®Œæˆ")
    
    def export_template(self, 
                       category: str,
                       template_id: str,
                       output_path: str) -> bool:
        """
        å¯¼å‡ºæ¨¡æ¿åˆ°æ–‡ä»¶
        
        Args:
            category: æ¨¡æ¿ç±»åˆ«
            template_id: æ¨¡æ¿ID
            output_path: è¾“å‡ºè·¯å¾„
        
        Returns:
            bool: æ˜¯å¦å¯¼å‡ºæˆåŠŸ
        """
        try:
            content = self.get_template(category, template_id)
            
            with open(output_path, 'w', encoding='utf-8') as f:
                f.write(content)
            
            return True
            
        except Exception as e:
            print(f"å¯¼å‡ºæ¨¡æ¿å¤±è´¥: {e}")
            return False
    
    def get_categories(self) -> List[str]:
        """è·å–æ‰€æœ‰æ¨¡æ¿ç±»åˆ«"""
        categories = set(self.templates.keys())
        
        # æ·»åŠ è‡ªå®šä¹‰æ¨¡æ¿çš„ç±»åˆ«
        for custom_key in self.custom_templates.keys():
            category = custom_key.split('/')[0]
            categories.add(category)
        
        return sorted(list(categories))
    
    def clear_cache(self):
        """æ¸…é™¤æ¨¡æ¿ç¼“å­˜ï¼ˆæœªæ¥æ‰©å±•ç”¨ï¼‰"""
        # å½“å‰å®ç°ä¸­æ¨¡æ¿æ˜¯ç«‹å³åŠ è½½çš„ï¼Œè¿™é‡Œé¢„ç•™ç¼“å­˜æ¸…ç†æ¥å£
        pass
    
    def get_template_stats(self) -> Dict[str, Any]:
        """è·å–æ¨¡æ¿ç»Ÿè®¡ä¿¡æ¯"""
        stats = {
            'total_templates': 0,
            'categories': {},
            'custom_templates': len(self.custom_templates),
            'load_time': datetime.now().isoformat()
        }
        
        for category, templates in self.templates.items():
            stats['categories'][category] = len(templates)
            stats['total_templates'] += len(templates)
        
        stats['total_templates'] += len(self.custom_templates)
        
        return stats

--- File: core/session_manager.py ---
#!/usr/bin/env python
# -*- coding: utf-8 -*-
"""
æ–‡ä»¶è·¯å¾„: smart_proposal_engine/core/session_manager.py
åŠŸèƒ½è¯´æ˜: ä¼šè¯çŠ¶æ€ç®¡ç†å™¨ï¼Œç®¡ç†è·¨é¡µé¢çš„æ•°æ®æµè½¬
ä½œè€…: SmartProposal Team
åˆ›å»ºæ—¥æœŸ: 2025-06-27
æœ€åä¿®æ”¹: 2025-06-27
ç‰ˆæœ¬: 1.0.0
"""

import os
import sys
import json
import pickle
import shutil
from typing import Dict, List, Optional, Any, Union
from datetime import datetime, timedelta
from pathlib import Path
import hashlib
import tempfile

# æ·»åŠ é¡¹ç›®æ ¹ç›®å½•åˆ°ç³»ç»Ÿè·¯å¾„
sys.path.insert(0, os.path.dirname(os.path.dirname(os.path.abspath(__file__))))

from services.base_service import ProcessingResult
from utils.file_utils import ensure_directory_exists, cleanup_directory


class SessionData:
    """ä¼šè¯æ•°æ®ç±»ï¼Œå­˜å‚¨å•ä¸ªå¤„ç†ä¼šè¯çš„æ‰€æœ‰ä¿¡æ¯"""
    
    def __init__(self, session_id: str):
        self.session_id = session_id
        self.created_at = datetime.now()
        self.updated_at = datetime.now()
        self.workflow_type = None  # å·¥ä½œæµç±»å‹
        self.current_step = None   # å½“å‰æ­¥éª¤
        self.data = {}            # å„æ­¥éª¤çš„æ•°æ®
        self.files = {}           # å…³è”çš„æ–‡ä»¶è·¯å¾„
        self.metadata = {}        # å…ƒæ•°æ®
        self.status = "active"    # çŠ¶æ€ï¼šactive, completed, error
        
    def update(self, key: str, value: Any):
        """æ›´æ–°æ•°æ®"""
        self.data[key] = value
        self.updated_at = datetime.now()
    
    def get(self, key: str, default: Any = None) -> Any:
        """è·å–æ•°æ®"""
        return self.data.get(key, default)
    
    def add_file(self, file_type: str, file_path: str):
        """æ·»åŠ æ–‡ä»¶å¼•ç”¨"""
        self.files[file_type] = file_path
        self.updated_at = datetime.now()
    
    def to_dict(self) -> Dict[str, Any]:
        """è½¬æ¢ä¸ºå­—å…¸"""
        return {
            'session_id': self.session_id,
            'created_at': self.created_at.isoformat(),
            'updated_at': self.updated_at.isoformat(),
            'workflow_type': self.workflow_type,
            'current_step': self.current_step,
            'data': self.data,
            'files': self.files,
            'metadata': self.metadata,
            'status': self.status
        }
    
    @classmethod
    def from_dict(cls, data: Dict[str, Any]) -> 'SessionData':
        """ä»å­—å…¸åˆ›å»ºå®ä¾‹"""
        session = cls(data['session_id'])
        session.created_at = datetime.fromisoformat(data['created_at'])
        session.updated_at = datetime.fromisoformat(data['updated_at'])
        session.workflow_type = data.get('workflow_type')
        session.current_step = data.get('current_step')
        session.data = data.get('data', {})
        session.files = data.get('files', {})
        session.metadata = data.get('metadata', {})
        session.status = data.get('status', 'active')
        return session


class SessionManager:
    """
    ä¼šè¯çŠ¶æ€ç®¡ç†å™¨
    
    ä¸»è¦åŠŸèƒ½:
    1. ç®¡ç†Streamlit session state
    2. æ•°æ®åœ¨å„ç¯èŠ‚é—´çš„ä¼ é€’
    3. ä¸´æ—¶æ–‡ä»¶ç®¡ç†
    4. ç»“æœç¼“å­˜
    
    ä½¿ç”¨ç¤ºä¾‹:
        sm = SessionManager()
        sm.save_result('transcription', result)
        result = sm.get_result('transcription')
    """
    
    def __init__(self, temp_dir: Optional[str] = None, max_sessions: int = 100):
        """
        åˆå§‹åŒ–ä¼šè¯ç®¡ç†å™¨
        
        Args:
            temp_dir: ä¸´æ—¶æ–‡ä»¶ç›®å½•
            max_sessions: æœ€å¤§ä¼šè¯æ•°é‡
        """
        if temp_dir is None:
            temp_dir = os.path.join(tempfile.gettempdir(), 'smartproposal_sessions')
        
        self.temp_dir = Path(temp_dir)
        self.max_sessions = max_sessions
        self.sessions: Dict[str, SessionData] = {}
        self.current_session_id: Optional[str] = None
        
        # ç¡®ä¿ä¸´æ—¶ç›®å½•å­˜åœ¨
        ensure_directory_exists(self.temp_dir)
        
        # åŠ è½½å·²æœ‰ä¼šè¯ï¼ˆå¦‚æœéœ€è¦æŒä¹…åŒ–ï¼‰
        self._load_sessions()
    
    def create_session(self, workflow_type: str = 'default') -> str:
        """
        åˆ›å»ºæ–°ä¼šè¯
        
        Args:
            workflow_type: å·¥ä½œæµç±»å‹
        
        Returns:
            str: ä¼šè¯ID
        """
        # ç”Ÿæˆå”¯ä¸€ä¼šè¯ID
        timestamp = datetime.now().strftime('%Y%m%d_%H%M%S')
        random_suffix = hashlib.md5(os.urandom(16)).hexdigest()[:8]
        session_id = f"{workflow_type}_{timestamp}_{random_suffix}"
        
        # åˆ›å»ºä¼šè¯æ•°æ®
        session = SessionData(session_id)
        session.workflow_type = workflow_type
        
        # åˆ›å»ºä¼šè¯ç›®å½•
        session_dir = self.temp_dir / session_id
        ensure_directory_exists(session_dir)
        
        # ä¿å­˜ä¼šè¯
        self.sessions[session_id] = session
        self.current_session_id = session_id
        
        # æ¸…ç†è¿‡æœŸä¼šè¯
        self._cleanup_old_sessions()
        
        return session_id
    
    def get_current_session(self) -> Optional[SessionData]:
        """è·å–å½“å‰ä¼šè¯"""
        if self.current_session_id and self.current_session_id in self.sessions:
            return self.sessions[self.current_session_id]
        return None
    
    def set_current_session(self, session_id: str) -> bool:
        """
        è®¾ç½®å½“å‰ä¼šè¯
        
        Args:
            session_id: ä¼šè¯ID
        
        Returns:
            bool: æ˜¯å¦è®¾ç½®æˆåŠŸ
        """
        if session_id in self.sessions:
            self.current_session_id = session_id
            return True
        return False
    
    def save_result(self, 
                   step_name: str, 
                   result: Union[ProcessingResult, Dict, str],
                   session_id: Optional[str] = None) -> bool:
        """
        ä¿å­˜å¤„ç†ç»“æœ
        
        Args:
            step_name: æ­¥éª¤åç§°ï¼ˆå¦‚ 'transcription', 'analysis', 'proposal'ï¼‰
            result: å¤„ç†ç»“æœ
            session_id: ä¼šè¯IDï¼ˆå¦‚æœä¸ºNoneåˆ™ä½¿ç”¨å½“å‰ä¼šè¯ï¼‰
        
        Returns:
            bool: æ˜¯å¦ä¿å­˜æˆåŠŸ
        """
        session_id = session_id or self.current_session_id
        if not session_id or session_id not in self.sessions:
            return False
        
        session = self.sessions[session_id]
        
        # è½¬æ¢ProcessingResultä¸ºå¯åºåˆ—åŒ–æ ¼å¼
        if isinstance(result, ProcessingResult):
            result_data = result.to_dict()
        else:
            result_data = result
        
        # ä¿å­˜åˆ°ä¼šè¯æ•°æ®
        session.update(f"{step_name}_result", result_data)
        session.current_step = step_name
        
        # å¦‚æœç»“æœåŒ…å«æ–‡ä»¶å†…å®¹ï¼Œè€ƒè™‘ä¿å­˜åˆ°æ–‡ä»¶
        if isinstance(result, ProcessingResult) and len(result.content) > 10000:
            # å¤§å†…å®¹ä¿å­˜åˆ°æ–‡ä»¶
            file_path = self._save_content_to_file(
                session_id, 
                step_name, 
                result.content
            )
            session.add_file(f"{step_name}_content", str(file_path))
        
        return True
    
    def get_result(self, 
                  step_name: str,
                  session_id: Optional[str] = None) -> Optional[ProcessingResult]:
        """
        è·å–å¤„ç†ç»“æœ
        
        Args:
            step_name: æ­¥éª¤åç§°
            session_id: ä¼šè¯ID
        
        Returns:
            ProcessingResult: å¤„ç†ç»“æœ
        """
        session_id = session_id or self.current_session_id
        if not session_id or session_id not in self.sessions:
            return None
        
        session = self.sessions[session_id]
        result_data = session.get(f"{step_name}_result")
        
        if not result_data:
            return None
        
        # å¦‚æœå†…å®¹ä¿å­˜åœ¨æ–‡ä»¶ä¸­ï¼Œè¯»å–æ–‡ä»¶
        content_file = session.files.get(f"{step_name}_content")
        if content_file and os.path.exists(content_file):
            with open(content_file, 'r', encoding='utf-8') as f:
                result_data['content'] = f.read()
        
        # è½¬æ¢å›ProcessingResultå¯¹è±¡
        if isinstance(result_data, dict) and 'content' in result_data:
            return ProcessingResult.from_dict(result_data)
        
        return result_data
    
    def save_file(self,
                 file_type: str,
                 file_path: str,
                 session_id: Optional[str] = None) -> bool:
        """
        ä¿å­˜æ–‡ä»¶å¼•ç”¨
        
        Args:
            file_type: æ–‡ä»¶ç±»å‹
            file_path: æ–‡ä»¶è·¯å¾„
            session_id: ä¼šè¯ID
        
        Returns:
            bool: æ˜¯å¦ä¿å­˜æˆåŠŸ
        """
        session_id = session_id or self.current_session_id
        if not session_id or session_id not in self.sessions:
            return False
        
        session = self.sessions[session_id]
        session.add_file(file_type, file_path)
        return True
    
    def get_file(self,
                file_type: str,
                session_id: Optional[str] = None) -> Optional[str]:
        """
        è·å–æ–‡ä»¶è·¯å¾„
        
        Args:
            file_type: æ–‡ä»¶ç±»å‹
            session_id: ä¼šè¯ID
        
        Returns:
            str: æ–‡ä»¶è·¯å¾„
        """
        session_id = session_id or self.current_session_id
        if not session_id or session_id not in self.sessions:
            return None
        
        session = self.sessions[session_id]
        return session.files.get(file_type)
    
    def transfer_between_steps(self,
                             from_step: str,
                             to_step: str,
                             transform_func: Optional[callable] = None) -> bool:
        """
        åœ¨æ­¥éª¤é—´ä¼ é€’æ•°æ®
        
        Args:
            from_step: æºæ­¥éª¤
            to_step: ç›®æ ‡æ­¥éª¤
            transform_func: æ•°æ®è½¬æ¢å‡½æ•°ï¼ˆå¯é€‰ï¼‰
        
        Returns:
            bool: æ˜¯å¦ä¼ é€’æˆåŠŸ
        """
        # è·å–æºæ•°æ®
        source_result = self.get_result(from_step)
        if not source_result:
            return False
        
        # åº”ç”¨è½¬æ¢å‡½æ•°ï¼ˆå¦‚æœæä¾›ï¼‰
        if transform_func:
            try:
                transformed_data = transform_func(source_result)
            except Exception as e:
                print(f"æ•°æ®è½¬æ¢å¤±è´¥: {e}")
                return False
        else:
            transformed_data = source_result
        
        # ä¿å­˜åˆ°ç›®æ ‡æ­¥éª¤
        return self.save_result(to_step, transformed_data)
    
    def get_workflow_status(self, session_id: Optional[str] = None) -> Dict[str, Any]:
        """
        è·å–å·¥ä½œæµçŠ¶æ€
        
        Returns:
            Dict: å·¥ä½œæµçŠ¶æ€ä¿¡æ¯
        """
        session_id = session_id or self.current_session_id
        if not session_id or session_id not in self.sessions:
            return {'status': 'no_session'}
        
        session = self.sessions[session_id]
        
        # æ£€æŸ¥å„æ­¥éª¤å®Œæˆæƒ…å†µ
        steps_status = {
            'transcription': bool(session.get('transcription_result')),
            'analysis': bool(session.get('analysis_result')),
            'proposal': bool(session.get('proposal_result'))
        }
        
        return {
            'session_id': session_id,
            'workflow_type': session.workflow_type,
            'current_step': session.current_step,
            'steps_completed': steps_status,
            'status': session.status,
            'created_at': session.created_at,
            'updated_at': session.updated_at
        }
    
    def export_all_results(self, 
                          session_id: Optional[str] = None,
                          output_dir: Optional[str] = None) -> Dict[str, str]:
        """
        å¯¼å‡ºæ‰€æœ‰ç»“æœ
        
        Args:
            session_id: ä¼šè¯ID
            output_dir: è¾“å‡ºç›®å½•
        
        Returns:
            Dict[str, str]: å¯¼å‡ºçš„æ–‡ä»¶è·¯å¾„æ˜ å°„
        """
        session_id = session_id or self.current_session_id
        if not session_id or session_id not in self.sessions:
            return {}
        
        session = self.sessions[session_id]
        
        if output_dir is None:
            output_dir = os.path.join('output', session_id)
        
        ensure_directory_exists(output_dir)
        
        exported_files = {}
        
        # å¯¼å‡ºå„æ­¥éª¤ç»“æœ
        for step in ['transcription', 'analysis', 'proposal']:
            result = self.get_result(step, session_id)
            if result and isinstance(result, ProcessingResult):
                # å¯¼å‡ºå†…å®¹
                file_name = f"{step}_result_{datetime.now().strftime('%Y%m%d_%H%M%S')}.md"
                file_path = os.path.join(output_dir, file_name)
                
                with open(file_path, 'w', encoding='utf-8') as f:
                    # å†™å…¥å…ƒæ•°æ®
                    f.write(f"# {step.capitalize()} Result\n\n")
                    f.write(f"**Generated at**: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\n")
                    f.write(f"**Model**: {result.model_used}\n")
                    f.write(f"**Processing Time**: {result.processing_time:.2f}s\n\n")
                    f.write("---\n\n")
                    
                    # å†™å…¥å†…å®¹
                    f.write(result.content)
                
                exported_files[step] = file_path
        
        # å¯¼å‡ºä¼šè¯ä¿¡æ¯
        session_info_path = os.path.join(output_dir, 'session_info.json')
        with open(session_info_path, 'w', encoding='utf-8') as f:
            json.dump(session.to_dict(), f, ensure_ascii=False, indent=2)
        
        exported_files['session_info'] = session_info_path
        
        return exported_files
    
    def clear_session(self, session_id: Optional[str] = None) -> bool:
        """
        æ¸…ç†ä¼šè¯æ•°æ®
        
        Args:
            session_id: ä¼šè¯ID
        
        Returns:
            bool: æ˜¯å¦æ¸…ç†æˆåŠŸ
        """
        session_id = session_id or self.current_session_id
        if not session_id or session_id not in self.sessions:
            return False
        
        # æ¸…ç†ä¼šè¯ç›®å½•
        session_dir = self.temp_dir / session_id
        if session_dir.exists():
            cleanup_directory(session_dir, safe_mode=False)
        
        # åˆ é™¤ä¼šè¯æ•°æ®
        del self.sessions[session_id]
        
        # å¦‚æœæ˜¯å½“å‰ä¼šè¯ï¼Œæ¸…ç©ºå½“å‰ä¼šè¯ID
        if session_id == self.current_session_id:
            self.current_session_id = None
        
        return True
    
    def list_sessions(self, 
                     active_only: bool = True,
                     limit: int = 10) -> List[Dict[str, Any]]:
        """
        åˆ—å‡ºä¼šè¯
        
        Args:
            active_only: æ˜¯å¦åªåˆ—å‡ºæ´»åŠ¨ä¼šè¯
            limit: é™åˆ¶æ•°é‡
        
        Returns:
            List[Dict]: ä¼šè¯åˆ—è¡¨
        """
        sessions_list = []
        
        for session_id, session in self.sessions.items():
            if active_only and session.status != 'active':
                continue
            
            sessions_list.append({
                'session_id': session_id,
                'workflow_type': session.workflow_type,
                'current_step': session.current_step,
                'status': session.status,
                'created_at': session.created_at,
                'updated_at': session.updated_at
            })
        
        # æŒ‰æ›´æ–°æ—¶é—´æ’åº
        sessions_list.sort(key=lambda x: x['updated_at'], reverse=True)
        
        return sessions_list[:limit]
    
    def _save_content_to_file(self, 
                            session_id: str,
                            step_name: str,
                            content: str) -> Path:
        """ä¿å­˜å†…å®¹åˆ°æ–‡ä»¶"""
        session_dir = self.temp_dir / session_id
        ensure_directory_exists(session_dir)
        
        file_name = f"{step_name}_content.txt"
        file_path = session_dir / file_name
        
        with open(file_path, 'w', encoding='utf-8') as f:
            f.write(content)
        
        return file_path
    
    def _cleanup_old_sessions(self):
        """æ¸…ç†è¿‡æœŸä¼šè¯"""
        if len(self.sessions) <= self.max_sessions:
            return
        
        # æŒ‰æ›´æ–°æ—¶é—´æ’åº
        sorted_sessions = sorted(
            self.sessions.items(),
            key=lambda x: x[1].updated_at
        )
        
        # åˆ é™¤æœ€æ—§çš„ä¼šè¯
        to_remove = len(self.sessions) - self.max_sessions
        for session_id, _ in sorted_sessions[:to_remove]:
            self.clear_session(session_id)
    
    def _load_sessions(self):
        """åŠ è½½å·²ä¿å­˜çš„ä¼šè¯ï¼ˆå¦‚æœéœ€è¦æŒä¹…åŒ–ï¼‰"""
        # MVPç‰ˆæœ¬æš‚ä¸å®ç°æŒä¹…åŒ–
        pass
    
    def _save_sessions(self):
        """ä¿å­˜ä¼šè¯ï¼ˆå¦‚æœéœ€è¦æŒä¹…åŒ–ï¼‰"""
        # MVPç‰ˆæœ¬æš‚ä¸å®ç°æŒä¹…åŒ–
        pass
    
    def cleanup_all_temp_files(self):
        """æ¸…ç†æ‰€æœ‰ä¸´æ—¶æ–‡ä»¶"""
        try:
            if self.temp_dir.exists():
                for session_dir in self.temp_dir.iterdir():
                    if session_dir.is_dir():
                        cleanup_directory(session_dir, safe_mode=False)
            return True
        except Exception as e:
            print(f"æ¸…ç†ä¸´æ—¶æ–‡ä»¶å¤±è´¥: {e}")
            return False
    
    def get_session_size(self, session_id: Optional[str] = None) -> int:
        """
        è·å–ä¼šè¯å ç”¨çš„ç£ç›˜ç©ºé—´
        
        Returns:
            int: å­—èŠ‚æ•°
        """
        session_id = session_id or self.current_session_id
        if not session_id:
            return 0
        
        session_dir = self.temp_dir / session_id
        if not session_dir.exists():
            return 0
        
        total_size = 0
        for file_path in session_dir.rglob('*'):
            if file_path.is_file():
                total_size += file_path.stat().st_size
        
        return total_size
    
    def get_statistics(self) -> Dict[str, Any]:
        """è·å–ç»Ÿè®¡ä¿¡æ¯"""
        total_sessions = len(self.sessions)
        active_sessions = sum(1 for s in self.sessions.values() if s.status == 'active')
        completed_sessions = sum(1 for s in self.sessions.values() if s.status == 'completed')
        
        # è®¡ç®—æ€»ç£ç›˜ä½¿ç”¨
        total_disk_usage = 0
        for session_id in self.sessions:
            total_disk_usage += self.get_session_size(session_id)
        
        return {
            'total_sessions': total_sessions,
            'active_sessions': active_sessions,
            'completed_sessions': completed_sessions,
            'total_disk_usage_mb': total_disk_usage / (1024 * 1024),
            'current_session_id': self.current_session_id
        }

--- File: env_example_file.sh ---
# SmartProposal Engine Environment Variables
# Copy this file to .env and update with your actual values

# ===================================
# API Keys and Authentication
# ===================================

# Google Gemini API Key (Required)
# Get your API key from: https://makersuite.google.com/app/apikey
GOOGLE_API_KEY=your_google_api_key_here

# Alternative: Use internal API key file (set in app_config.ini)
# If using internal key file, leave GOOGLE_API_KEY empty

# ===================================
# Application Settings
# ===================================

# Environment (development, staging, production)
ENVIRONMENT=development

# Debug mode (true/false)
DEBUG=false

# Application port (default: 8501 for Streamlit)
PORT=8501

# ===================================
# File Storage Settings
# ===================================

# Temporary files directory (default: temp/)
TEMP_DIR=temp/

# Output files directory (default: output/)
OUTPUT_DIR=output/

# Maximum file size in MB (default: 200)
MAX_FILE_SIZE_MB=200

# Auto cleanup temporary files (true/false)
AUTO_CLEANUP_TEMP_FILES=true

# ===================================
# Model Configuration
# ===================================

# Default models for different tasks
# Available models: gemini-2.5-pro, gemini-2.5-flash, gemini-1.5-pro, gemini-1.5-flash
DEFAULT_TRANSCRIPTION_MODEL=models/gemini-2.5-flash
DEFAULT_ANALYSIS_MODEL=models/gemini-2.5-pro
DEFAULT_PROPOSAL_MODEL=models/gemini-2.5-pro

# Model temperature settings (0.0 - 1.0)
MODEL_TEMPERATURE=0.7
MODEL_TOP_P=0.95

# Maximum tokens per request
MAX_OUTPUT_TOKENS=16384

# ===================================
# Feature Flags
# ===================================

# Enable/disable features
ENABLE_TEXT_OPTIMIZATION=true
ENABLE_SPEAKER_DIARIZATION=true
ENABLE_CUSTOM_PROMPTS=true
ENABLE_BATCH_PROCESSING=true
ENABLE_CAPABILITY_DOCS=true

# ===================================
# Performance Settings
# ===================================

# Request timeout in seconds
REQUEST_TIMEOUT=900

# Maximum concurrent requests
MAX_CONCURRENT_REQUESTS=3

# Retry configuration
MAX_RETRIES=3
RETRY_DELAY_SECONDS=2

# Cache settings
ENABLE_CACHE=true
CACHE_TTL_HOURS=24

# ===================================
# Security Settings
# ===================================

# Session secret key (generate a random string)
SESSION_SECRET_KEY=your_secret_key_here_change_in_production

# Enable HTTPS redirect (for production)
FORCE_HTTPS=false

# Allowed file extensions (comma-separated)
ALLOWED_AUDIO_EXTENSIONS=.m4a,.mp3,.wav,.aac,.ogg,.flac,.mp4
ALLOWED_DOCUMENT_EXTENSIONS=.docx,.pdf,.txt,.doc,.rtf,.odt

# ===================================
# Logging Configuration
# ===================================

# Log level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_LEVEL=INFO

# Log file path
LOG_FILE=logs/app.log

# Enable console logging
CONSOLE_LOGGING=true

# ===================================
# External Services (Future Extensions)
# ===================================

# Database URL (for future persistence features)
# DATABASE_URL=postgresql://user:password@localhost:5432/smartproposal

# Redis URL (for future caching/queuing)
# REDIS_URL=redis://localhost:6379

# Email settings (for future notifications)
# SMTP_HOST=smtp.gmail.com
# SMTP_PORT=587
# SMTP_USER=your_email@gmail.com
# SMTP_PASSWORD=your_app_password

# Cloud storage (for future cloud integration)
# AWS_ACCESS_KEY_ID=your_aws_key
# AWS_SECRET_ACCESS_KEY=your_aws_secret
# AWS_S3_BUCKET=smartproposal-uploads

# ===================================
# Analytics and Monitoring (Optional)
# ===================================

# Google Analytics
# GA_TRACKING_ID=UA-XXXXXXXXX-X

# Sentry error tracking
# SENTRY_DSN=https://your_sentry_dsn@sentry.io/project_id

# ===================================
# Development Settings
# ===================================

# Enable hot reload (for development)
HOT_RELOAD=true

# Show detailed error messages (disable in production)
SHOW_ERROR_DETAILS=true

# Enable profiling (for performance debugging)
ENABLE_PROFILING=false

# ===================================
# Notes
# ===================================
# 1. Never commit the actual .env file to version control
# 2. Keep your API keys secure and rotate them regularly
# 3. Use different API keys for different environments
# 4. Set appropriate values for production deployment
# 5. Some settings can also be configured in app_config.ini

--- File: llm_providers/__init__.py ---
# ==============================================================================
# File: core/llm_providers/__init__.py (æ–°å¢æ–‡ä»¶)
# ==============================================================================
#!/usr/bin/env python
# -*- coding: utf-8 -*-
"""
æ–‡ä»¶è·¯å¾„: smart_proposal_engine/core/llm_providers/__init__.py
åŠŸèƒ½è¯´æ˜: åˆå§‹åŒ–llm_providersåŒ…ï¼Œä½¿å…¶å¯ä»¥è¢«Pythonè§£é‡Šå™¨è¯†åˆ«å’Œå¯¼å…¥ã€‚
          åŒæ—¶ï¼Œä¸ºäº†æ–¹ä¾¿å¤–éƒ¨è°ƒç”¨ï¼Œè¿™é‡Œç›´æ¥å¯¼å‡ºäº†åŒ…å†…çš„æ ¸å¿ƒProviderç±»ã€‚
ä½œè€…: SmartProposal Team
åˆ›å»ºæ—¥æœŸ: 2025-06-29
ç‰ˆæœ¬: 1.0.0
"""

# å¯¼å…¥åŸºç±»ï¼Œä½¿å…¶å¯ä»¥åœ¨åŒ…çº§åˆ«è®¿é—®
from .base_provider import BaseProvider

# å¯¼å…¥å…·ä½“çš„æä¾›å•†å®ç°ç±»
from .gemini_provider import GeminiProvider
from .qwen_provider import QwenProvider

# å®šä¹‰ __all__ï¼Œæ˜ç¡®æŒ‡å®šä»è¯¥åŒ…ä¸­ "from core.llm_providers import *" æ—¶ä¼šå¯¼å…¥å“ªäº›æ¨¡å—ã€‚
# è¿™æ˜¯ä¸€ç§è‰¯å¥½çš„ç¼–ç¨‹ä¹ æƒ¯ï¼Œå¯ä»¥æ§åˆ¶åŒ…çš„å…¬å…±APIã€‚
__all__ = [
    'BaseProvider',
    'GeminiProvider',
    'QwenProvider'
]

--- File: llm_providers/base_provider.py ---
# ==============================================================================
# File: core/llm_providers/base_provider.py (ä¿®æ”¹å)
# ==============================================================================
# !/usr/bin/env python
# -*- coding: utf-8 -*-
"""
æ–‡ä»¶è·¯å¾„: smart_proposal_engine/core/llm_providers/base_provider.py
åŠŸèƒ½è¯´æ˜: å®šä¹‰æ‰€æœ‰LLMï¼ˆå¤§è¯­è¨€æ¨¡å‹ï¼‰æä¾›å•†çš„æŠ½è±¡åŸºç±» (ABC)ã€‚
          è¿™ä¸ªåŸºç±»ä½œä¸ºä¸€ä¸ªæ¥å£ï¼Œç¡®ä¿æ‰€æœ‰å…·ä½“çš„æä¾›å•†å®ç°ï¼ˆå¦‚Gemini, Qwenç­‰ï¼‰
          éƒ½éµå¾ªç»Ÿä¸€çš„æ–¹æ³•ç­¾åå’Œè¡Œä¸ºè§„èŒƒï¼Œä»è€Œä½¿å¾—ModelInterfaceå¯ä»¥æ— ç¼åˆ‡æ¢å’Œè°ƒåº¦ã€‚
ä½œè€…: SmartProposal Team
åˆ›å»ºæ—¥æœŸ: 2025-06-29
ç‰ˆæœ¬: 1.1.0
"""

from abc import ABC, abstractmethod
from typing import Dict, List, Optional, Tuple, Union, Any


class BaseProvider(ABC):
    """
    LLMæä¾›å•†çš„æŠ½è±¡åŸºç±»ã€‚
    æ‰€æœ‰å…·ä½“çš„æ¨¡å‹æä¾›å•†éƒ½åº”ç»§æ‰¿æ­¤ç±»å¹¶å®ç°å…¶æ‰€æœ‰æŠ½è±¡æ–¹æ³•ã€‚
    """

    def __init__(self, api_key: str):
        """
        åˆå§‹åŒ–åŸºç¡€æä¾›å•†ã€‚

        Args:
            api_key (str): è¯¥æä¾›å•†çš„APIå¯†é’¥ã€‚

        Raises:
            ValueError: å¦‚æœAPI Keyä¸ºç©ºã€‚
        """
        if not api_key:
            raise ValueError("API Key ä¸èƒ½ä¸ºç©º")
        self.api_key = api_key
        self.is_initialized = False

    @abstractmethod
    def initialize(self) -> None:
        """
        åˆå§‹åŒ–æä¾›å•†çš„å®¢æˆ·ç«¯æˆ–SDKã€‚
        åœ¨å­ç±»ä¸­å®ç°ï¼Œä¾‹å¦‚é…ç½®APIå¯†é’¥ã€è®¾ç½®ä¼šè¯ç­‰ã€‚
        æ­¤æ–¹æ³•åº”åœ¨æˆåŠŸåˆå§‹åŒ–åè®¾ç½® self.is_initialized = Trueã€‚
        """
        pass

    @abstractmethod
    def generate(self,
                 prompt: Union[str, List[Any]],
                 model_name: str,
                 generation_config: Optional[Dict[str, Any]] = None,
                 safety_settings: Optional[List[Dict[str, Any]]] = None,
                 request_options: Optional[Dict[str, Any]] = None
                 ) -> Tuple[str, Dict[str, Any]]:
        """
        ç”Ÿæˆå†…å®¹ï¼ˆéæµå¼ï¼‰ã€‚

        Args:
            prompt (Union[str, List[Any]]): å‘é€ç»™æ¨¡å‹çš„æç¤ºï¼Œå¯ä»¥æ˜¯å­—ç¬¦ä¸²æˆ–å†…å®¹åˆ—è¡¨ã€‚
            model_name (str): è¦ä½¿ç”¨çš„å…·ä½“æ¨¡å‹åç§°ã€‚
            generation_config (Optional[Dict[str, Any]]): ç”Ÿæˆå‚æ•°é…ç½®ã€‚
            safety_settings (Optional[List[Dict[str, Any]]]): å®‰å…¨è®¾ç½®ã€‚
            request_options (Optional[Dict[str, Any]]): è¯·æ±‚é€‰é¡¹ï¼Œå¦‚è¶…æ—¶ã€‚

        Returns:
            Tuple[str, Dict[str, Any]]:
            - ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯ç”Ÿæˆçš„æ–‡æœ¬å†…å®¹ã€‚
            - ç¬¬äºŒä¸ªå…ƒç´ æ˜¯åŒ…å«ç»Ÿè®¡ä¿¡æ¯çš„å­—å…¸ï¼Œè‡³å°‘åº”åŒ…å« 'input_tokens' å’Œ 'output_tokens'ã€‚
        """
        pass

    @abstractmethod
    def stream_generate(self,
                        prompt: Union[str, List[Any]],
                        model_name: str,
                        generation_config: Optional[Dict[str, Any]] = None,
                        callback: Optional[callable] = None
                        ) -> Tuple[str, Dict[str, Any]]:
        """
        æµå¼ç”Ÿæˆå†…å®¹ã€‚

        Args:
            prompt (Union[str, List[Any]]): å‘é€ç»™æ¨¡å‹çš„æç¤ºã€‚
            model_name (str): è¦ä½¿ç”¨çš„å…·ä½“æ¨¡å‹åç§°ã€‚
            generation_config (Optional[Dict[str, Any]]): ç”Ÿæˆå‚æ•°é…ç½®ã€‚
            callback (Optional[callable]): ç”¨äºå®æ—¶å¤„ç†ç”Ÿæˆå—çš„å›è°ƒå‡½æ•°ã€‚
                                          å›è°ƒå‡½æ•°åº”æ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼š(chunk_text: str)ã€‚

        Returns:
            Tuple[str, Dict[str, Any]]:
            - ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯æœ€ç»ˆç”Ÿæˆçš„å®Œæ•´æ–‡æœ¬ã€‚
            - ç¬¬äºŒä¸ªå…ƒç´ æ˜¯åŒ…å«ç»Ÿè®¡ä¿¡æ¯çš„å­—å…¸ï¼Œè‡³å°‘åº”åŒ…å« 'input_tokens' å’Œ 'output_tokens'ã€‚
        """
        pass

    @abstractmethod
    def count_tokens(self, text: str, model_name: str) -> int:
        """
        è®¡ç®—ç»™å®šæ–‡æœ¬çš„tokenæ•°é‡ã€‚

        Args:
            text (str): éœ€è¦è®¡ç®—tokençš„æ–‡æœ¬ã€‚
            model_name (str): ç”¨äºè®¡ç®—tokençš„æ¨¡å‹åç§°ï¼ˆä¸åŒæ¨¡å‹åˆ†è¯æ–¹å¼å¯èƒ½ä¸åŒï¼‰ã€‚

        Returns:
            int: tokençš„æ€»æ•°ã€‚
        """
        pass

    # --- æ–°å¢æ–‡ä»¶å¤„ç†ç›¸å…³æŠ½è±¡æ–¹æ³• ---

    @abstractmethod
    def upload_file(self, file_path: str) -> Any:
        """
        ä¸Šä¼ æ–‡ä»¶ï¼ˆä¸»è¦ç”¨äºéŸ³é¢‘/è§†é¢‘ç­‰å¤šæ¨¡æ€è¾“å…¥ï¼‰ã€‚

        Args:
            file_path (str): æœ¬åœ°æ–‡ä»¶çš„è·¯å¾„ã€‚

        Returns:
            Any: è¿”å›ä¸€ä¸ªä»£è¡¨å·²ä¸Šä¼ æ–‡ä»¶çš„å¯¹è±¡æˆ–æ ‡è¯†ç¬¦ã€‚
        """
        pass

    @abstractmethod
    def get_file_state(self, file_object: Any) -> str:
        """
        è·å–å·²ä¸Šä¼ æ–‡ä»¶çš„çŠ¶æ€ã€‚

        Args:
            file_object (Any): `upload_file` è¿”å›çš„æ–‡ä»¶å¯¹è±¡ã€‚

        Returns:
            str: æ–‡ä»¶çš„çŠ¶æ€å­—ç¬¦ä¸² (ä¾‹å¦‚ "PROCESSING", "ACTIVE", "FAILED")ã€‚
        """
        pass

    @abstractmethod
    def delete_file(self, file_object: Any) -> None:
        """
        åˆ é™¤å·²ä¸Šä¼ çš„æ–‡ä»¶ã€‚

        Args:
            file_object (Any): `upload_file` è¿”å›çš„æ–‡ä»¶å¯¹è±¡ã€‚
        """
        pass

    def health_check(self) -> Dict[str, Any]:
        """
        å¯¹æä¾›å•†æœåŠ¡è¿›è¡Œå¥åº·æ£€æŸ¥ã€‚
        å­ç±»å¯ä»¥é‡å†™æ­¤æ–¹æ³•ä»¥æä¾›æ›´è¯¦ç»†çš„æ£€æŸ¥ã€‚
        """
        if not self.is_initialized:
            return {'status': 'unhealthy', 'reason': 'Provider not initialized.'}
        try:
            return {'status': 'healthy', 'reason': 'Provider is initialized.'}
        except Exception as e:
            return {'status': 'unhealthy', 'reason': f'Health check failed: {str(e)}'}


if __name__ == "__main__":
    print("è¿™æ˜¯ä¸€ä¸ªæŠ½è±¡åŸºç±»æ–‡ä»¶ï¼Œä¸åº”ç›´æ¥è¿è¡Œã€‚")

--- File: llm_providers/gemini_provider.py ---
#!/usr/bin/env python
# -*- coding: utf-8 -*-
"""
æ–‡ä»¶è·¯å¾„: smart_proposal_engine/core/llm_providers/gemini_provider.py
åŠŸèƒ½è¯´æ˜: å®ç°äº†é’ˆå¯¹Google Geminiæ¨¡å‹çš„å…·ä½“Providerã€‚
          è¯¥ç±»å°è£…äº†æ‰€æœ‰ä¸Gemini APIäº¤äº’çš„ç»†èŠ‚ï¼ŒåŒ…æ‹¬åˆå§‹åŒ–ã€å†…å®¹ç”Ÿæˆã€
          æµå¼å¤„ç†ã€Tokenè®¡ç®—ã€æ–‡ä»¶å¤„ç†ä»¥åŠé”™è¯¯å¤„ç†å’Œé‡è¯•é€»è¾‘ã€‚
ä½œè€…: SmartProposal Team
åˆ›å»ºæ—¥æœŸ: 2025-06-29
ç‰ˆæœ¬: 1.1.1
"""

import os
import sys
import time
from typing import Dict, List, Optional, Tuple, Union, Any

# åŠ¨æ€æ·»åŠ é¡¹ç›®æ ¹ç›®å½•åˆ°ç³»ç»Ÿè·¯å¾„
sys.path.insert(0, os.path.dirname(os.path.dirname(os.path.abspath(__file__))))

try:
    import google.generativeai as genai
except ImportError:
    raise ImportError(
        "Google Geminiçš„ä¾èµ–åº“ 'google-generativeai' æœªå®‰è£…ã€‚"
        "è¯·è¿è¡Œ 'pip install google-generativeai' è¿›è¡Œå®‰è£…ã€‚"
    )

from .base_provider import BaseProvider


class GeminiProvider(BaseProvider):
    """
    é’ˆå¯¹Google Geminiæ¨¡å‹çš„LLM Providerå®ç°ã€‚

    æ³¨æ„ï¼šæ–‡ä»¶ç›¸å…³æ–¹æ³•ä½¿ç”¨ Any ç±»å‹ï¼Œå› ä¸º google.generativeai çš„ File ç±»å‹
    å¯¼å…¥è·¯å¾„å¯èƒ½å› ç‰ˆæœ¬è€Œå¼‚ã€‚å®é™…ä½¿ç”¨æ—¶ä¼šè¿”å› genai.upload_file() çš„ç»“æœã€‚
    """

    def __init__(self, api_key: str, max_retries: int = 3):
        """
        åˆå§‹åŒ–GeminiProviderã€‚

        Args:
            api_key (str): Google AI Studioçš„APIå¯†é’¥ã€‚
            max_retries (int): APIè¯·æ±‚å¤±è´¥æ—¶çš„æœ€å¤§é‡è¯•æ¬¡æ•°ã€‚
        """
        super().__init__(api_key)
        self.max_retries = max_retries

    def initialize(self) -> None:
        """
        é…ç½®Gemini APIå¯†é’¥å¹¶éªŒè¯ã€‚
        """
        try:
            genai.configure(api_key=self.api_key)
            # å¯é€‰ï¼šè¿›è¡Œä¸€æ¬¡è½»é‡çº§çš„å¥åº·æ£€æŸ¥æ¥ç¡®è®¤API Keyçš„æœ‰æ•ˆæ€§
            # ä¾‹å¦‚ï¼Œåˆ—å‡ºæ¨¡å‹ï¼Œè¿™æ˜¯ä¸€ä¸ªä½æˆæœ¬çš„æ“ä½œ
            models = [m for m in genai.list_models() if 'generateContent' in m.supported_generation_methods]
            if not models:
                raise ConnectionError("API Keyæœ‰æ•ˆï¼Œä½†æœªæ‰¾åˆ°å¯ç”¨çš„ç”Ÿæˆæ¨¡å‹ã€‚")
            self.is_initialized = True
            print("âœ… Gemini Provider åˆå§‹åŒ–æˆåŠŸã€‚")
        except Exception as e:
            self.is_initialized = False
            print(f"âŒ Gemini Provider åˆå§‹åŒ–å¤±è´¥: {e}")
            # é‡æ–°æŠ›å‡ºå¼‚å¸¸ï¼Œä»¥ä¾¿ä¸Šå±‚å¯ä»¥æ•è·
            raise ConnectionError(f"æ— æ³•é…ç½®Gemini APIï¼Œè¯·æ£€æŸ¥API Keyæ˜¯å¦æ­£ç¡®ã€‚é”™è¯¯: {e}")

    def generate(self,
                 prompt: Union[str, List[Any]],
                 model_name: str,
                 generation_config: Optional[Dict[str, Any]] = None,
                 safety_settings: Optional[List[Dict[str, Any]]] = None,
                 request_options: Optional[Dict[str, Any]] = None
                 ) -> Tuple[str, Dict[str, Any]]:
        """
        ä½¿ç”¨Geminiæ¨¡å‹ç”Ÿæˆå†…å®¹ï¼ˆéæµå¼ï¼‰ã€‚
        """
        if not self.is_initialized:
            raise RuntimeError("Gemini Providerå°šæœªåˆå§‹åŒ–ã€‚")

        return self._generate_with_retry(
            prompt, model_name, generation_config,
            safety_settings, request_options, retry_count=0
        )

    def _generate_with_retry(self,
                             prompt: Union[str, List[Any]],
                             model_name: str,
                             generation_config: Optional[Dict[str, Any]],
                             safety_settings: Optional[List[Dict[str, Any]]],
                             request_options: Optional[Dict[str, Any]],
                             retry_count: int) -> Tuple[str, Dict[str, Any]]:
        """å†…éƒ¨æ–¹æ³•ï¼ŒåŒ…å«é‡è¯•é€»è¾‘çš„ç”Ÿæˆå®ç°ã€‚"""
        try:
            model = genai.GenerativeModel(model_name)

            # è®¾ç½®é»˜è®¤é…ç½®
            final_gen_config = {
                'temperature': 0.7, 'top_p': 0.95,
                'max_output_tokens': 16384, 'response_mime_type': 'text/plain'
            }
            if generation_config:
                final_gen_config.update(generation_config)

            final_safety_settings = safety_settings or [
                {"category": c, "threshold": "BLOCK_MEDIUM_AND_ABOVE"} for c in
                ["HARM_CATEGORY_HARASSMENT", "HARM_CATEGORY_HATE_SPEECH",
                 "HARM_CATEGORY_SEXUALLY_EXPLICIT", "HARM_CATEGORY_DANGEROUS_CONTENT"]
            ]

            final_request_options = {"timeout": 900}
            if request_options:
                final_request_options.update(request_options)

            # è°ƒç”¨API
            response = model.generate_content(
                prompt,
                generation_config=final_gen_config,
                safety_settings=final_safety_settings,
                request_options=final_request_options
            )

            response_text = response.text

            # ä¼˜å…ˆä»APIè¿”å›çš„å…ƒæ•°æ®ä¸­è·å–ç²¾ç¡®çš„tokenæ•°
            if hasattr(response, 'usage_metadata'):
                input_tokens = response.usage_metadata.prompt_token_count
                output_tokens = response.usage_metadata.candidates_token_count
            else:
                # å¦‚æœAPIæœªè¿”å›ï¼Œåˆ™è¿›è¡Œä¼°ç®—
                input_tokens = self._estimate_tokens(str(prompt))
                output_tokens = self._estimate_tokens(response_text)

            stats = {
                'input_tokens': input_tokens,
                'output_tokens': output_tokens,
            }

            return response_text, stats

        except Exception as e:
            error_msg = str(e)
            if retry_count < self.max_retries and self._should_retry(error_msg):
                wait_time = 2 ** retry_count
                print(f"Geminiè¯·æ±‚å¤±è´¥ï¼Œ{wait_time}ç§’åé‡è¯•... (å°è¯• {retry_count + 1}/{self.max_retries})")
                time.sleep(wait_time)
                return self._generate_with_retry(
                    prompt, model_name, generation_config, safety_settings,
                    request_options, retry_count + 1
                )
            # é‡è¯•æ¬¡æ•°ç”¨å°½æˆ–é‡åˆ°ä¸å¯é‡è¯•é”™è¯¯ï¼Œåˆ™ç›´æ¥æŠ›å‡º
            raise Exception(f"æ¨¡å‹è°ƒç”¨å¤±è´¥: {error_msg}")

    def stream_generate(self,
                        prompt: Union[str, List[Any]],
                        model_name: str,
                        generation_config: Optional[Dict[str, Any]] = None,
                        callback: Optional[callable] = None
                        ) -> Tuple[str, Dict[str, Any]]:
        """
        ä½¿ç”¨Geminiæ¨¡å‹æµå¼ç”Ÿæˆå†…å®¹ã€‚
        """
        if not self.is_initialized:
            raise RuntimeError("Gemini Providerå°šæœªåˆå§‹åŒ–ã€‚")

        try:
            model = genai.GenerativeModel(model_name)
            final_gen_config = {'temperature': 0.7, 'top_p': 0.95, 'max_output_tokens': 16384}
            if generation_config:
                final_gen_config.update(generation_config)

            response_stream = model.generate_content(
                prompt, generation_config=final_gen_config, stream=True
            )

            complete_response = ""
            # å…ˆæ”¶é›†æ‰€æœ‰å“åº”å—
            chunks = []
            for chunk in response_stream:
                chunks.append(chunk)
                if chunk.text:
                    complete_response += chunk.text
                    if callback:
                        try:
                            callback(chunk.text)
                        except Exception as cb_e:
                            print(f"æµå¼å›è°ƒå‡½æ•°æ‰§è¡Œå‡ºé”™: {cb_e}")

            # æµå¼ä¼ è¾“å®Œæˆåï¼Œå°è¯•ä»æœ€åä¸€ä¸ªchunkè·å–tokenä½¿ç”¨é‡
            # æˆ–ä»ç´¯ç§¯çš„å“åº”ä¸­è·å–
            input_tokens = self._estimate_tokens(str(prompt))
            output_tokens = self._estimate_tokens(complete_response)

            # å°è¯•ä»chunksä¸­è·å–usage_metadata
            for chunk in reversed(chunks):
                if hasattr(chunk, 'usage_metadata'):
                    try:
                        input_tokens = chunk.usage_metadata.prompt_token_count
                        output_tokens = chunk.usage_metadata.candidates_token_count
                        break
                    except:
                        pass

            stats = {
                'input_tokens': input_tokens,
                'output_tokens': output_tokens,
            }

            return complete_response, stats
        except Exception as e:
            raise Exception(f"æµå¼ç”Ÿæˆå¤±è´¥: {str(e)}")

    def count_tokens(self, text: str, model_name: str) -> int:
        """
        ä½¿ç”¨Gemini APIè®¡ç®—æ–‡æœ¬çš„tokenæ•°é‡ã€‚
        """
        if not self.is_initialized:
            print("è­¦å‘Š: Gemini Provideræœªåˆå§‹åŒ–ï¼Œä½¿ç”¨ä¼°ç®—æ–¹æ³•è®¡ç®—tokenã€‚")
            return self._estimate_tokens(text)

        try:
            model = genai.GenerativeModel(model_name)
            result = model.count_tokens(text)
            return result.total_tokens
        except Exception as e:
            print(f"è°ƒç”¨Gemini APIè®¡ç®—Tokenå¤±è´¥ï¼Œä½¿ç”¨ä¼°ç®—å€¼: {e}")
            return self._estimate_tokens(text)

    def upload_file(self, file_path: str) -> Any:
        """
        ä½¿ç”¨Gemini APIä¸Šä¼ æ–‡ä»¶ã€‚

        Args:
            file_path (str): è¦ä¸Šä¼ çš„æ–‡ä»¶è·¯å¾„

        Returns:
            Any: genai.upload_file() è¿”å›çš„æ–‡ä»¶å¯¹è±¡
        """
        if not self.is_initialized:
            raise RuntimeError("Gemini Providerå°šæœªåˆå§‹åŒ–ã€‚")
        return genai.upload_file(path=file_path)

    def get_file_state(self, file_object: Any) -> str:
        """
        è·å–Geminiä¸Šæ–‡ä»¶çš„çŠ¶æ€ã€‚

        Args:
            file_object: genai.upload_file() è¿”å›çš„æ–‡ä»¶å¯¹è±¡

        Returns:
            str: æ–‡ä»¶çŠ¶æ€å­—ç¬¦ä¸²
        """
        if not self.is_initialized:
            raise RuntimeError("Gemini Providerå°šæœªåˆå§‹åŒ–ã€‚")
        # éœ€è¦é‡æ–°è·å–æœ€æ–°çš„æ–‡ä»¶å¯¹è±¡æ¥æ£€æŸ¥çŠ¶æ€
        updated_file = genai.get_file(file_object.name)
        return updated_file.state.name

    def delete_file(self, file_object: Any) -> None:
        """
        åˆ é™¤Geminiä¸Šçš„æ–‡ä»¶ã€‚

        Args:
            file_object: genai.upload_file() è¿”å›çš„æ–‡ä»¶å¯¹è±¡
        """
        if not self.is_initialized:
            raise RuntimeError("Gemini Providerå°šæœªåˆå§‹åŒ–ã€‚")
        try:
            genai.delete_file(file_object.name)
        except Exception as e:
            # åˆ é™¤å¤±è´¥é€šå¸¸ä¸æ˜¯å…³é”®æ€§é”™è¯¯ï¼Œæ‰“å°è­¦å‘Šå³å¯
            print(f"è­¦å‘Šï¼šåˆ é™¤Geminiä¸´æ—¶æ–‡ä»¶ {file_object.name} å¤±è´¥: {e}")

    def _should_retry(self, error_msg: str) -> bool:
        """åˆ¤æ–­é”™è¯¯æ˜¯å¦åº”è¯¥é‡è¯•"""
        retry_keywords = [
            'rate limit', 'quota exceeded', 'timeout', 'temporary', 'unavailable',
            '503 service unavailable', 'resource has been exhausted',
            '429', '500', '503', '504'
        ]
        error_lower = error_msg.lower()
        return any(keyword in error_lower for keyword in retry_keywords)

    def _estimate_tokens(self, text: Union[str, Any]) -> int:
        """
        åå¤‡æ–¹æ³•ï¼šä¼°ç®—æ–‡æœ¬çš„tokenæ•°é‡

        ä½¿ç”¨ç®€å•çš„å¯å‘å¼æ–¹æ³•ï¼š
        - è‹±æ–‡ï¼šå¹³å‡æ¯4ä¸ªå­—ç¬¦çº¦1ä¸ªtoken
        - ä¸­æ–‡ï¼šå¹³å‡æ¯2ä¸ªå­—ç¬¦çº¦1ä¸ªtoken
        - æ··åˆæ–‡æœ¬ï¼šä½¿ç”¨åŠ æƒå¹³å‡
        """
        if not isinstance(text, str):
            text = str(text)

        # ç®€å•çš„ä¸­æ–‡å­—ç¬¦æ£€æµ‹
        chinese_chars = sum(1 for char in text if '\u4e00' <= char <= '\u9fff')
        total_chars = len(text)

        if total_chars == 0:
            return 1

        # è®¡ç®—ä¸­æ–‡å­—ç¬¦æ¯”ä¾‹
        chinese_ratio = chinese_chars / total_chars

        # æ ¹æ®ä¸­è‹±æ–‡æ¯”ä¾‹ä¼°ç®—tokens
        if chinese_ratio > 0.5:
            # ä¸»è¦æ˜¯ä¸­æ–‡
            return max(1, int(total_chars * 0.5))
        else:
            # ä¸»è¦æ˜¯è‹±æ–‡æˆ–æ··åˆ
            return max(1, int(total_chars * 0.25))


if __name__ == "__main__":
    print("è¿™æ˜¯ä¸€ä¸ªå…·ä½“çš„Providerå®ç°æ–‡ä»¶ï¼Œä¸åº”ç›´æ¥è¿è¡Œã€‚")
    print("è¯·é€šè¿‡ ModelInterface æ¥è°ƒç”¨ã€‚")

    # å¯é€‰ï¼šæ·»åŠ ç®€å•çš„æµ‹è¯•ä»£ç æ¥éªŒè¯æ–‡ä»¶ç±»å‹
    # import google.generativeai as genai
    # print("å¯ç”¨çš„genaiå±æ€§ï¼š", [attr for attr in dir(genai) if 'file' in attr.lower()])

--- File: llm_providers/qwen_provider.py ---
# ==============================================================================
# File: core/llm_providers/qwen_provider.py (ä¿®æ”¹å)
# ==============================================================================
#!/usr/bin/env python
# -*- coding: utf-8 -*-
"""
æ–‡ä»¶è·¯å¾„: smart_proposal_engine/core/llm_providers/qwen_provider.py
åŠŸèƒ½è¯´æ˜: å®ç°äº†é’ˆå¯¹é˜¿é‡Œé€šä¹‰åƒé—®ï¼ˆQwenï¼‰æ¨¡å‹çš„å…·ä½“Providerã€‚
          è¯¥ç±»ä½¿ç”¨dashscope SDKï¼Œå°è£…äº†ä¸Qwenæ¨¡å‹äº¤äº’çš„æ‰€æœ‰ç»†èŠ‚ï¼Œ
          åŒ…æ‹¬åˆå§‹åŒ–ã€å†…å®¹ç”Ÿæˆã€æµå¼å¤„ç†ã€Tokenè®¡ç®—ä»¥åŠé”™è¯¯å¤„ç†ã€‚
ä½œè€…: SmartProposal Team
åˆ›å»ºæ—¥æœŸ: 2025-06-29
ç‰ˆæœ¬: 1.1.0
"""

import os
import sys
import time
from http import HTTPStatus
from typing import Dict, List, Optional, Tuple, Union, Any

# åŠ¨æ€æ·»åŠ é¡¹ç›®æ ¹ç›®å½•åˆ°ç³»ç»Ÿè·¯å¾„
sys.path.insert(0, os.path.dirname(os.path.dirname(os.path.abspath(__file__))))

try:
    import dashscope
except ImportError:
    raise ImportError(
        "é€šä¹‰åƒé—®çš„ä¾èµ–åº“ 'dashscope' æœªå®‰è£…ã€‚"
        "è¯·è¿è¡Œ 'pip install \"dashscope>=1.16.1\"' è¿›è¡Œå®‰è£…ã€‚"
    )

from .base_provider import BaseProvider

class QwenProvider(BaseProvider):
    """
    é’ˆå¯¹é˜¿é‡Œé€šä¹‰åƒé—®ï¼ˆQwenï¼‰æ¨¡å‹çš„LLM Providerå®ç°ã€‚
    """

    def __init__(self, api_key: str, max_retries: int = 3):
        """
        åˆå§‹åŒ–QwenProviderã€‚

        Args:
            api_key (str): DashScopeçš„APIå¯†é’¥ã€‚
            max_retries (int): APIè¯·æ±‚å¤±è´¥æ—¶çš„æœ€å¤§é‡è¯•æ¬¡æ•°ã€‚
        """
        super().__init__(api_key)
        self.max_retries = max_retries

    def initialize(self) -> None:
        """
        é…ç½®DashScope APIå¯†é’¥å¹¶éªŒè¯ã€‚
        """
        try:
            dashscope.api_key = self.api_key
            # é€šè¿‡åˆ—å‡ºæ¨¡å‹æ¥éªŒè¯API Keyçš„æœ‰æ•ˆæ€§
            models = dashscope.Model.list()
            if not models or models.get('data') is None:
                raise ConnectionError("API Keyå¯èƒ½æ— æ•ˆï¼Œæ— æ³•è·å–æ¨¡å‹åˆ—è¡¨ã€‚")
            self.is_initialized = True
            print("âœ… Qwen Provider (DashScope) åˆå§‹åŒ–æˆåŠŸã€‚")
        except Exception as e:
            self.is_initialized = False
            print(f"âŒ Qwen Provider åˆå§‹åŒ–å¤±è´¥: {e}")
            raise ConnectionError(f"æ— æ³•é…ç½®DashScope APIï¼Œè¯·æ£€æŸ¥API Keyæ˜¯å¦æ­£ç¡®ã€‚é”™è¯¯: {e}")

    def generate(self,
                 prompt: Union[str, List[Any]],
                 model_name: str,
                 generation_config: Optional[Dict[str, Any]] = None,
                 safety_settings: Optional[List[Dict[str, Any]]] = None,
                 request_options: Optional[Dict[str, Any]] = None
                 ) -> Tuple[str, Dict[str, Any]]:
        """
        ä½¿ç”¨Qwenæ¨¡å‹ç”Ÿæˆå†…å®¹ï¼ˆéæµå¼ï¼‰ã€‚
        """
        if not self.is_initialized:
            raise RuntimeError("Qwen Providerå°šæœªåˆå§‹åŒ–ã€‚")
        if isinstance(prompt, list):
            prompt = "\n".join(str(p) for p in prompt)
        return self._generate_with_retry(
            prompt, model_name, generation_config, request_options, retry_count=0
        )

    def _generate_with_retry(self,
                             prompt: str,
                             model_name: str,
                             generation_config: Optional[Dict[str, Any]],
                             request_options: Optional[Dict[str, Any]],
                             retry_count: int) -> Tuple[str, Dict[str, Any]]:
        """å†…éƒ¨æ–¹æ³•ï¼ŒåŒ…å«é‡è¯•é€»è¾‘çš„ç”Ÿæˆå®ç°ã€‚"""
        try:
            final_gen_config = generation_config or {}
            timeout = request_options.get('timeout', 600) if request_options else 600
            response = dashscope.Generation.call(
                model=model_name,
                prompt=prompt,
                stream=False,
                timeout=timeout,
                **final_gen_config
            )
            if response.status_code == HTTPStatus.OK:
                response_text = response.output.text
                stats = {
                    'input_tokens': response.usage.input_tokens,
                    'output_tokens': response.usage.output_tokens
                }
                return response_text, stats
            else:
                raise Exception(f"API Error: {response.code} - {response.message}")
        except Exception as e:
            error_msg = str(e)
            if retry_count < self.max_retries and self._should_retry(error_msg):
                wait_time = 2 ** retry_count
                print(f"Qwenè¯·æ±‚å¤±è´¥ï¼Œ{wait_time}ç§’åé‡è¯•... (å°è¯• {retry_count + 1}/{self.max_retries})")
                time.sleep(wait_time)
                return self._generate_with_retry(
                    prompt, model_name, generation_config, request_options, retry_count + 1
                )
            raise Exception(f"æ¨¡å‹è°ƒç”¨å¤±è´¥: {error_msg}")

    def stream_generate(self,
                        prompt: Union[str, List[Any]],
                        model_name: str,
                        generation_config: Optional[Dict[str, Any]] = None,
                        callback: Optional[callable] = None
                        ) -> Tuple[str, Dict[str, Any]]:
        """
        ä½¿ç”¨Qwenæ¨¡å‹æµå¼ç”Ÿæˆå†…å®¹ã€‚
        """
        if not self.is_initialized:
            raise RuntimeError("Qwen Providerå°šæœªåˆå§‹åŒ–ã€‚")
        if isinstance(prompt, list):
            prompt = "\n".join(str(p) for p in prompt)
        try:
            final_gen_config = generation_config or {}
            response_stream = dashscope.Generation.call(
                model=model_name,
                prompt=prompt,
                stream=True,
                **final_gen_config
            )
            complete_response = ""
            last_chunk = None
            for chunk in response_stream:
                if chunk.status_code == HTTPStatus.OK:
                    partial_text = chunk.output.text
                    new_text = partial_text[len(complete_response):]
                    complete_response = partial_text
                    if callback and new_text:
                        try:
                            callback(new_text)
                        except Exception as cb_e:
                            print(f"æµå¼å›è°ƒå‡½æ•°æ‰§è¡Œå‡ºé”™: {cb_e}")
                    last_chunk = chunk
                else:
                    raise Exception(f"æµå¼APIé”™è¯¯: {chunk.code} - {chunk.message}")
            if last_chunk:
                stats = {
                    'input_tokens': last_chunk.usage.input_tokens,
                    'output_tokens': last_chunk.usage.output_tokens
                }
            else:
                stats = {
                    'input_tokens': self._estimate_tokens(prompt),
                    'output_tokens': 0
                }
            return complete_response, stats
        except Exception as e:
            raise Exception(f"æµå¼ç”Ÿæˆå¤±è´¥: {str(e)}")

    def count_tokens(self, text: str, model_name: str) -> int:
        """
        ä½¿ç”¨DashScope APIè®¡ç®—æ–‡æœ¬çš„tokenæ•°é‡ã€‚
        """
        if not self.is_initialized:
            print("è­¦å‘Š: Qwen Provideræœªåˆå§‹åŒ–ï¼Œä½¿ç”¨ä¼°ç®—æ–¹æ³•è®¡ç®—tokenã€‚")
            return self._estimate_tokens(text)
        try:
            response = dashscope.Tokenization.call(
                model=model_name,
                prompt=text
            )
            if response.status_code == HTTPStatus.OK:
                return response.usage.prompt_tokens
            else:
                print(f"è°ƒç”¨DashScope APIè®¡ç®—Tokenå¤±è´¥: {response.message}ï¼Œä½¿ç”¨ä¼°ç®—å€¼ã€‚")
                return self._estimate_tokens(text)
        except Exception as e:
            print(f"è°ƒç”¨DashScope APIè®¡ç®—Tokenæ—¶å‘ç”Ÿå¼‚å¸¸: {e}ï¼Œä½¿ç”¨ä¼°ç®—å€¼ã€‚")
            return self._estimate_tokens(text)

    # --- æ–°å¢æ–‡ä»¶å¤„ç†æ–¹æ³•çš„å…·ä½“å®ç° ---
    def upload_file(self, file_path: str) -> Any:
        """
        Qwen/DashScopeç›®å‰ä¸è¦æ±‚é¢„ä¸Šä¼ æ–‡ä»¶è¿›è¡Œå¤šæ¨¡æ€å¤„ç†ï¼Œ
        è€Œæ˜¯ç›´æ¥åœ¨è°ƒç”¨æ—¶ä¼ å…¥æœ¬åœ°æ–‡ä»¶è·¯å¾„æˆ–URLã€‚
        å› æ­¤ï¼Œæ­¤æ–¹æ³•ç›´æ¥è¿”å›æ–‡ä»¶è·¯å¾„æœ¬èº«ä½œä¸ºâ€œæ–‡ä»¶å¯¹è±¡â€ã€‚
        """
        if not os.path.exists(file_path):
            raise FileNotFoundError(f"æ–‡ä»¶ä¸å­˜åœ¨: {file_path}")
        return file_path

    def get_file_state(self, file_object: Any) -> str:
        """
        ç”±äºQwenä¸ä¸Šä¼ æ–‡ä»¶ï¼Œæˆ‘ä»¬å‡å®šæ–‡ä»¶æ€»æ˜¯å¯ç”¨çš„ã€‚
        """
        if isinstance(file_object, str) and os.path.exists(file_object):
            return "ACTIVE"
        return "FAILED"

    def delete_file(self, file_object: Any) -> None:
        """
        ç”±äºQwenä¸ä¸Šä¼ æ–‡ä»¶åˆ°äº‘ç«¯ï¼Œæ­¤æ–¹æ³•æ— éœ€æ‰§è¡Œä»»ä½•æ“ä½œã€‚
        """
        pass

    def _should_retry(self, error_msg: str) -> bool:
        """åˆ¤æ–­é”™è¯¯æ˜¯å¦åº”è¯¥é‡è¯•"""
        retry_keywords = [
            'throttling', 'qps rate-limit', 'service is unavailable', 'timeout',
            'serviceunavailable', 'systemerror', 'internalservererror',
            '503', '504'
        ]
        error_lower = error_msg.lower()
        return any(keyword in error_lower for keyword in retry_keywords)

    def _estimate_tokens(self, text: Union[str, Any]) -> int:
        """åå¤‡æ–¹æ³•ï¼šä¼°ç®—æ–‡æœ¬çš„tokenæ•°é‡"""
        if not isinstance(text, str):
            text = str(text)
        chinese_chars = len([c for c in text if '\u4e00' <= c <= '\u9fff'])
        other_chars = len(text) - chinese_chars
        estimated_tokens = chinese_chars + (other_chars // 4)
        return int(estimated_tokens) + 1

if __name__ == "__main__":
    print("è¿™æ˜¯ä¸€ä¸ªå…·ä½“çš„Providerå®ç°æ–‡ä»¶ï¼Œä¸åº”ç›´æ¥è¿è¡Œã€‚")
    print("è¯·é€šè¿‡ ModelInterface æ¥è°ƒç”¨ã€‚")

--- File: models.conf ---
# ==============================================================================
# File: models.conf (ä¿®æ”¹å)
# ==============================================================================
# SmartProposal Engine æ¨¡å‹é…ç½®æ–‡ä»¶
#
# æ­¤æ–‡ä»¶å®šä¹‰äº†æ‰€æœ‰å¯ä¾›åº”ç”¨é€‰æ‹©çš„AIæ¨¡å‹åŠå…¶ç›¸å…³å±æ€§ã€‚
# æ ¼å¼: provider,model_api_name,display_name,input_price_per_million_tokens,output_price_per_million_tokens
#
# - provider: æ¨¡å‹æä¾›å•†çš„æ ‡è¯†ç¬¦ (ä¾‹å¦‚: Gemini, Qwen)ï¼Œå¿…é¡»ä¸ ModelInterface ä¸­çš„é€»è¾‘å¯¹åº”ã€‚
# - model_api_name: è°ƒç”¨æœåŠ¡æä¾›å•†APIæ—¶ä½¿ç”¨çš„ç¡®åˆ‡æ¨¡å‹åç§°ã€‚
# - display_name: åœ¨åº”ç”¨UIä¸‹æ‹‰èœå•ä¸­æ˜¾ç¤ºç»™ç”¨æˆ·çš„åç§°ï¼Œå¯ä»¥åŒ…å«ç®€è¦è¯´æ˜ã€‚
# - input_price_per_million_tokens: æ¯ç™¾ä¸‡è¾“å…¥tokençš„ç¾å…ƒä»·æ ¼ã€‚
# - output_price_per_million_tokens: æ¯ç™¾ä¸‡è¾“å‡ºtokençš„ç¾å…ƒä»·æ ¼ã€‚
#
# ä»·æ ¼ä¿¡æ¯ç”¨äºæˆæœ¬ä¼°ç®—ï¼Œè¯·æ ¹æ®å®é™…æƒ…å†µæ›´æ–°ã€‚

# --- Gemini æ¨¡å‹é…ç½® (æ ¹æ® 2024-06-17 å®˜æ–¹ä»·æ ¼æ›´æ–°) ---

# --- Gemini 2.5 ç³»åˆ— (æœ€æ–°) ---
Gemini,models/gemini-2.5-pro,Gemini 2.5 Pro (æœ€å¼ºæ¨è),1.25,10.00
Gemini,models/gemini-2.5-flash,Gemini 2.5 Flash (éŸ³é¢‘ä¼˜åŒ–),1.00,2.50
Gemini,models/gemini-2.5-flash-lite-preview,Gemini 2.5 Flash-Lite (æœ€å¿«éŸ³é¢‘),0.50,0.40

# --- Gemini 1.5 ç³»åˆ— (ç¨³å®š) ---
Gemini,models/gemini-1.5-pro-latest,Gemini 1.5 Pro (ç»å…¸æ——èˆ°),1.25,5.00
Gemini,models/gemini-1.5-flash-latest,Gemini 1.5 Flash (é«˜æ€§ä»·æ¯”),0.075,0.30
Gemini,models/gemini-1.5-flash-8b,Gemini 1.5 Flash-8B (æœ€ç»æµ),0.0375,0.15

# --- Qwen (é€šä¹‰åƒé—®) æ¨¡å‹ç¤ºä¾‹ (ä»·æ ¼ä¸ºå‡è®¾ï¼Œè¯·æ ¹æ®å®˜æ–¹å®šä»·ä¿®æ”¹) ---
# ã€æ–°å¢ã€‘ä»¥ä¸‹æ˜¯æ–°å¢çš„Qwenæ¨¡å‹é…ç½®
# model_api_name åº”ä¸ºdashscope SDKæ”¯æŒçš„æ¨¡å‹ID
Qwen,qwen-long,Qwen Long (é•¿æ–‡æœ¬),0.0007,0.0014
Qwen,qwen-max,Qwen Max (æ——èˆ°),0.0167,0.0167
Qwen,qwen-plus,Qwen Plus (å¢å¼º),0.0028,0.0028
Qwen,qwen-turbo,Qwen Turbo (é«˜é€Ÿ),0.0011,0.0011

--- File: pages/1_ğŸ“„_Input_Processing.py ---
#!/usr/bin/env python
# -*- coding: utf-8 -*-
"""
æ–‡ä»¶è·¯å¾„: smart_proposal_engine/pages/1_ğŸ“„_Input_Processing.py
åŠŸèƒ½è¯´æ˜: å†…å®¹è¾“å…¥å¤„ç†é¡µé¢
ä½œè€…: SmartProposal Team
åˆ›å»ºæ—¥æœŸ: 2025-06-27
æœ€åä¿®æ”¹: 2025-06-29
ç‰ˆæœ¬: 1.1.0
"""

import os
import sys
import streamlit as st
from pathlib import Path
from datetime import datetime
import time

# æ·»åŠ é¡¹ç›®æ ¹ç›®å½•åˆ°ç³»ç»Ÿè·¯å¾„
sys.path.insert(0, os.path.dirname(os.path.dirname(os.path.abspath(__file__))))

from core.document_processor import DocumentProcessor
from core.session_manager import SessionManager
from utils.file_utils import (
    save_uploaded_file,
    get_file_metadata,
    format_file_size,
    prepare_download_file
)
from utils.format_utils import (
    format_metadata_display,
    format_duration,
    truncate_text
)
from utils.validation_utils import validate_text_input
from utils.ui_utils import check_api_key_setup  # å¼•å…¥æ£€æŸ¥å‡½æ•°

# é¡µé¢é…ç½®
st.set_page_config(
    page_title="å†…å®¹è¾“å…¥å¤„ç† - SmartProposal Engine",
    page_icon="ğŸ“„",
    layout="wide"
)


def initialize_page_state():
    """åˆå§‹åŒ–é¡µé¢çŠ¶æ€"""
    if 'input_processing' not in st.session_state:
        st.session_state.input_processing = {
            'current_tab': 'file_upload',
            'processing_result': None,
            'processing_history': [],
            'temp_file_path': None,
            'current_progress': 0  # æ·»åŠ è¿›åº¦è·Ÿè¸ª
        }

    # ç¡®ä¿SessionManagerå­˜åœ¨
    if 'session_manager' not in st.session_state:
        st.session_state.session_manager = SessionManager()

    # åˆ›å»ºæˆ–è·å–å½“å‰ä¼šè¯
    if not st.session_state.session_manager.current_session_id:
        st.session_state.session_manager.create_session('input_processing')


def show_file_upload_tab():
    """æ˜¾ç¤ºæ–‡ä»¶ä¸Šä¼ æ ‡ç­¾é¡µ"""
    st.markdown("### ğŸ“ æ–‡ä»¶ä¸Šä¼ ")

    # æ”¯æŒçš„æ ¼å¼è¯´æ˜
    col1, col2 = st.columns(2)

    with col1:
        st.info("""
        **æ”¯æŒçš„éŸ³é¢‘æ ¼å¼ï¼š**
        - M4A, MP3, WAV, AAC, OGG, FLAC
        - æœ€å¤§æ–‡ä»¶å¤§å°ï¼š200 MB
        - æ”¯æŒè¶…é•¿éŸ³é¢‘è‡ªåŠ¨åˆ†å‰²
        """)

    with col2:
        st.info("""
        **æ”¯æŒçš„æ–‡æ¡£æ ¼å¼ï¼š**
        - DOCX, PDF, TXT, DOC, RTF
        - æœ€å¤§æ–‡ä»¶å¤§å°ï¼š50 MB
        - è‡ªåŠ¨æå–æ–‡æ¡£å†…å®¹å’Œå…ƒæ•°æ®
        """)

    # æ–‡ä»¶ä¸Šä¼ ç»„ä»¶
    uploaded_file = st.file_uploader(
        "é€‰æ‹©è¦å¤„ç†çš„æ–‡ä»¶",
        type=['m4a', 'mp3', 'wav', 'aac', 'ogg', 'flac', 'mp4',
              'docx', 'pdf', 'txt', 'doc', 'rtf', 'odt'],
        help="æ‹–æ‹½æ–‡ä»¶åˆ°æ­¤å¤„æˆ–ç‚¹å‡»æµè§ˆ"
    )

    if uploaded_file is not None:
        # æ˜¾ç¤ºæ–‡ä»¶ä¿¡æ¯
        file_details = {
            "æ–‡ä»¶å": uploaded_file.name,
            "æ–‡ä»¶ç±»å‹": uploaded_file.type,
            "æ–‡ä»¶å¤§å°": format_file_size(uploaded_file.size)
        }

        st.markdown("#### â„¹ï¸ æ–‡ä»¶ä¿¡æ¯")
        for key, value in file_details.items():
            st.text(f"{key}: {value}")

        # å¤„ç†é€‰é¡¹
        st.markdown("#### âš™ï¸ å¤„ç†é€‰é¡¹")

        # æ ¹æ®æ–‡ä»¶ç±»å‹æ˜¾ç¤ºä¸åŒé€‰é¡¹
        file_ext = Path(uploaded_file.name).suffix.lower()

        options = {}

        if file_ext in ['.m4a', '.mp3', '.wav', '.aac', '.ogg', '.flac', '.mp4']:
            # éŸ³é¢‘æ–‡ä»¶é€‰é¡¹
            col1, col2 = st.columns(2)

            with col1:
                options['enable_speaker_diarization'] = st.checkbox(
                    "å¯ç”¨è¯´è¯äººè¯†åˆ«",
                    value=True,
                    key="file_upload_speaker_diarization",
                    help="è¯†åˆ«å¹¶åŒºåˆ†ä¸åŒçš„è¯´è¯äºº"
                )

                if options['enable_speaker_diarization']:
                    options['maintain_speaker_consistency'] = st.checkbox(
                        "ä¿æŒè¯´è¯äººä¸€è‡´æ€§",
                        value=True,
                        key="file_upload_speaker_consistency",
                        help="åœ¨é•¿éŸ³é¢‘ä¸­ä¿æŒè¯´è¯äººæ ‡è¯†çš„ä¸€è‡´æ€§"
                    )

            with col2:
                options['enable_text_optimization'] = st.checkbox(
                    "å¯ç”¨æ–‡æœ¬ä¼˜åŒ–",
                    value=False,
                    key="file_upload_text_optimization",
                    help="ä½¿ç”¨AIä¼˜åŒ–è½¬å½•æ–‡æœ¬è´¨é‡"
                )

                options['max_segment_duration_minutes'] = st.slider(
                    "æœ€å¤§ç‰‡æ®µæ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰",
                    min_value=10,
                    max_value=30,
                    value=20,
                    key="file_upload_segment_duration",
                    help="è¶…é•¿éŸ³é¢‘å°†è¢«åˆ†å‰²æˆå¤šä¸ªç‰‡æ®µ"
                )

        else:
            # æ–‡æ¡£æ–‡ä»¶é€‰é¡¹
            col1, col2 = st.columns(2)

            with col1:
                options['extract_metadata'] = st.checkbox(
                    "æå–å…ƒæ•°æ®",
                    value=True,
                    key="file_upload_extract_metadata",
                    help="æå–æ–‡æ¡£çš„ä½œè€…ã€åˆ›å»ºæ—¶é—´ç­‰ä¿¡æ¯"
                )

            with col2:
                options['clean_output'] = st.checkbox(
                    "æ¸…ç†è¾“å‡ºæ–‡æœ¬",
                    value=True,
                    key="file_upload_clean_output",
                    help="ç§»é™¤å¤šä½™çš„ç©ºæ ¼å’Œç©ºè¡Œ"
                )

        # å¤„ç†æŒ‰é’®
        if st.button("â–¶ï¸ å¼€å§‹å¤„ç†", type="primary", use_container_width=True, key="file_upload_process"):
            process_uploaded_file(uploaded_file, options)


def show_text_input_tab():
    """æ˜¾ç¤ºæ–‡æœ¬è¾“å…¥æ ‡ç­¾é¡µ"""
    st.markdown("### âœï¸ æ–‡æœ¬è¾“å…¥")

    st.info("""
    ç›´æ¥ç²˜è´´æˆ–è¾“å…¥æ–‡æœ¬å†…å®¹ï¼Œé€‚ç”¨äºï¼š
    - å·²æœ‰çš„è½¬å½•æ–‡æœ¬
    - ä¼šè®®è®°å½•
    - å…¶ä»–æ–‡æœ¬å†…å®¹
    """)

    # æ–‡æœ¬è¾“å…¥åŒºåŸŸ
    text_input = st.text_area(
        "è¯·è¾“å…¥æ–‡æœ¬å†…å®¹",
        height=400,
        placeholder="åœ¨æ­¤ç²˜è´´æˆ–è¾“å…¥æ–‡æœ¬å†…å®¹...",
        key="text_input_area",
        help="æ”¯æŒä¸­è‹±æ–‡ï¼Œå»ºè®®é•¿åº¦åœ¨50-50000å­—ç¬¦ä¹‹é—´"
    )

    # æ˜¾ç¤ºå­—æ•°ç»Ÿè®¡
    if text_input:
        char_count = len(text_input)
        word_count = len(text_input.split())
        st.caption(f"å­—ç¬¦æ•°: {char_count:,} | è¯æ•°: {word_count:,}")

    # è¾“å…¥é€‰é¡¹
    st.markdown("#### âš™ï¸ å¤„ç†é€‰é¡¹")

    col1, col2 = st.columns(2)

    with col1:
        input_type = st.selectbox(
            "æ–‡æœ¬ç±»å‹",
            options=['transcript', 'document', 'general'],
            format_func=lambda x: {
                'transcript': 'è½¬å½•æ–‡æœ¬',
                'document': 'æ–‡æ¡£å†…å®¹',
                'general': 'é€šç”¨æ–‡æœ¬'
            }.get(x, x),
            key="text_input_type",
            help="é€‰æ‹©æ–‡æœ¬çš„ç±»å‹ä»¥è·å¾—æœ€ä½³å¤„ç†æ•ˆæœ"
        )

    with col2:
        if input_type == 'transcript':
            enable_optimization = st.checkbox(
                "å¯ç”¨æ–‡æœ¬ä¼˜åŒ–",
                value=False,
                key="text_input_optimization",
                help="ä½¿ç”¨AIä¼˜åŒ–è½¬å½•æ–‡æœ¬è´¨é‡"
            )
        else:
            enable_optimization = False

    # å¤„ç†æŒ‰é’®
    if st.button("â–¶ï¸ å¤„ç†æ–‡æœ¬", type="primary", use_container_width=True, key="text_input_process"):
        if text_input.strip():
            # éªŒè¯æ–‡æœ¬
            is_valid, message = validate_text_input(
                text_input,
                min_length=50,
                max_length=100000
            )

            if is_valid:
                process_text_input(text_input, input_type, enable_optimization)
            else:
                st.error(message)
        else:
            st.warning("è¯·è¾“å…¥æ–‡æœ¬å†…å®¹")


def process_uploaded_file(uploaded_file, options):
    """å¤„ç†ä¸Šä¼ çš„æ–‡ä»¶"""
    session_manager = st.session_state.session_manager

    # åˆ›å»ºè¿›åº¦å®¹å™¨
    progress_container = st.container()

    with progress_container:
        progress_bar = st.progress(0)
        status_text = st.empty()

        # åˆå§‹åŒ–è¿›åº¦è·Ÿè¸ª
        st.session_state.input_processing['current_progress'] = 0

        try:
            # ä¿å­˜ä¸Šä¼ çš„æ–‡ä»¶
            status_text.text("æ­£åœ¨ä¿å­˜æ–‡ä»¶...")
            progress_bar.progress(10)
            st.session_state.input_processing['current_progress'] = 10

            save_dir = Path("temp") / datetime.now().strftime("%Y%m%d_%H%M%S")
            success, file_path, message = save_uploaded_file(
                uploaded_file,
                save_dir
            )

            if not success:
                st.error(f"æ–‡ä»¶ä¿å­˜å¤±è´¥: {message}")
                return

            st.session_state.input_processing['temp_file_path'] = file_path

            # åˆå§‹åŒ–å¤„ç†å™¨
            status_text.text("æ­£åœ¨åˆå§‹åŒ–å¤„ç†å™¨...")
            progress_bar.progress(20)
            st.session_state.input_processing['current_progress'] = 20

            processor = DocumentProcessor()

            # å®šä¹‰è¿›åº¦å›è°ƒ
            def progress_callback(msg):
                status_text.text(msg)
                # åŠ¨æ€æ›´æ–°è¿›åº¦æ¡
                current = st.session_state.input_processing['current_progress']
                if current < 90:
                    new_progress = min(current + 10, 90)
                    progress_bar.progress(new_progress)
                    st.session_state.input_processing['current_progress'] = new_progress

            options['progress_callback'] = progress_callback

            # å¤„ç†æ–‡ä»¶
            status_text.text("æ­£åœ¨å¤„ç†æ–‡ä»¶...")
            progress_bar.progress(30)
            st.session_state.input_processing['current_progress'] = 30

            start_time = time.time()
            result = processor.process_file(file_path, options)
            processing_time = time.time() - start_time

            progress_bar.progress(100)
            st.session_state.input_processing['current_progress'] = 100

            if result.is_success:
                status_text.text("âœ… å¤„ç†å®Œæˆï¼")

                # ä¿å­˜ç»“æœåˆ°ä¼šè¯
                session_manager.save_result('input_processing', result)
                st.session_state.input_processing['processing_result'] = result

                # æ·»åŠ åˆ°å†å²è®°å½•
                st.session_state.input_processing['processing_history'].append({
                    'filename': uploaded_file.name,
                    'timestamp': datetime.now(),
                    'processing_time': processing_time,
                    'result': result
                })

                # æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
                st.success(f"""
                æ–‡ä»¶å¤„ç†æˆåŠŸï¼
                - å¤„ç†æ—¶é—´: {processing_time:.1f} ç§’
                - å†…å®¹é•¿åº¦: {len(result.content):,} å­—ç¬¦
                """)

                # è‡ªåŠ¨å±•ç¤ºç»“æœ
                time.sleep(1)
                st.rerun()

            else:
                status_text.text("âŒ å¤„ç†å¤±è´¥")
                st.error(f"å¤„ç†å¤±è´¥: {result.error}")

        except Exception as e:
            status_text.text("âŒ å‘ç”Ÿé”™è¯¯")
            st.error(f"å¤„ç†è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯: {str(e)}")

        finally:
            # æ¸…ç†è¿›åº¦æ˜¾ç¤º
            time.sleep(2)
            progress_container.empty()
            # é‡ç½®è¿›åº¦
            st.session_state.input_processing['current_progress'] = 0


def process_text_input(text_input, input_type, enable_optimization):
    """å¤„ç†æ–‡æœ¬è¾“å…¥"""
    session_manager = st.session_state.session_manager

    with st.spinner("æ­£åœ¨å¤„ç†æ–‡æœ¬..."):
        try:
            processor = DocumentProcessor()

            options = {
                'enable_text_optimization': enable_optimization
            }

            start_time = time.time()
            result = processor.process_text_input(
                text_input,
                input_type,
                options
            )
            processing_time = time.time() - start_time

            if result.is_success:
                # ä¿å­˜ç»“æœ
                session_manager.save_result('input_processing', result)
                st.session_state.input_processing['processing_result'] = result

                # æ·»åŠ åˆ°å†å²è®°å½•
                st.session_state.input_processing['processing_history'].append({
                    'filename': f"æ–‡æœ¬è¾“å…¥_{datetime.now().strftime('%H%M%S')}",
                    'timestamp': datetime.now(),
                    'processing_time': processing_time,
                    'result': result
                })

                st.success(f"æ–‡æœ¬å¤„ç†æˆåŠŸï¼å¤„ç†æ—¶é—´: {processing_time:.1f} ç§’")

                # è‡ªåŠ¨å±•ç¤ºç»“æœ
                time.sleep(1)
                st.rerun()

            else:
                st.error(f"å¤„ç†å¤±è´¥: {result.error}")

        except Exception as e:
            st.error(f"å¤„ç†è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯: {str(e)}")


def show_processing_result():
    """æ˜¾ç¤ºå¤„ç†ç»“æœ"""
    result = st.session_state.input_processing.get('processing_result')

    if not result:
        return

    st.markdown("---")
    st.markdown("### ğŸ“Š å¤„ç†ç»“æœ")

    # ç»“æœæ‘˜è¦
    col1, col2, col3 = st.columns(3)

    with col1:
        st.metric("å†…å®¹é•¿åº¦", f"{len(result.content):,} å­—ç¬¦")

    with col2:
        st.metric("å¤„ç†æ—¶é—´", f"{result.processing_time:.1f} ç§’")

    with col3:
        if result.tokens_consumed:
            st.metric("Tokenä½¿ç”¨", f"{result.total_tokens:,}")

    # å…ƒæ•°æ®æ˜¾ç¤º
    if result.metadata:
        with st.expander("â„¹ï¸ è¯¦ç»†ä¿¡æ¯", expanded=False):
            # æ ¼å¼åŒ–æ˜¾ç¤ºå…ƒæ•°æ®
            for key, value in result.metadata.items():
                if key not in ['error', 'original_text']:
                    st.text(f"{key}: {value}")

    # å†…å®¹é¢„è§ˆ
    st.markdown("#### ğŸ“‹ å†…å®¹é¢„è§ˆ")

    # é¢„è§ˆé€‰é¡¹
    col1, col2 = st.columns([3, 1])
    with col1:
        preview_length = st.slider(
            "é¢„è§ˆé•¿åº¦",
            min_value=500,
            max_value=5000,
            value=1500,
            step=500,
            key="result_preview_length"
        )

    with col2:
        show_full = st.checkbox("æ˜¾ç¤ºå…¨æ–‡", value=False, key="result_show_full")

    # æ˜¾ç¤ºå†…å®¹
    if show_full:
        st.text_area(
            "å¤„ç†åçš„å†…å®¹",
            value=result.content,
            height=600,
            disabled=True,
            key="result_full_content"
        )
    else:
        preview_text = truncate_text(result.content, preview_length)
        st.text_area(
            "å¤„ç†åçš„å†…å®¹ï¼ˆé¢„è§ˆï¼‰",
            value=preview_text,
            height=400,
            disabled=True,
            key="result_preview_content"
        )

    # æ“ä½œæŒ‰é’®
    st.markdown("#### â¯ï¸ ä¿å­˜å’Œä¸‹ä¸€æ­¥")

    col1, col2, col3 = st.columns(3)

    with col1:
        # ä¸‹è½½æŒ‰é’®
        download_content = result.content
        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        filename = f"processed_content_{timestamp}.txt"

        st.download_button(
            label="ğŸ’¾ ä¸‹è½½ç»“æœ",
            data=download_content,
            file_name=filename,
            mime="text/plain",
            use_container_width=True,
            key="result_download"
        )

    with col2:
        # å‘é€åˆ°åˆ†æ
        if st.button("â¡ï¸ å‘é€åˆ°æ·±åº¦åˆ†æ", type="primary", use_container_width=True, key="send_to_analysis"):
            # ä¿å­˜åˆ°ä¼šè¯ä¾›ä¸‹ä¸€æ­¥ä½¿ç”¨
            session_manager = st.session_state.session_manager
            session_manager.save_result('transcription', result)
            st.success("å·²ä¿å­˜ï¼è¯·å‰å¾€ **æ·±åº¦åˆ†æ** é¡µé¢ç»§ç»­")
            # å¯ä»¥åœ¨è¿™é‡ŒåŠ ä¸€ä¸ªçŸ­æš‚çš„å»¶è¿Ÿç„¶ååˆ·æ–°é¡µé¢ï¼Œè®©ç”¨æˆ·çœ‹åˆ°æ¶ˆæ¯
            time.sleep(2)
            st.rerun()

    with col3:
        # æ¸…é™¤ç»“æœ
        if st.button("ğŸ—‘ï¸ æ¸…é™¤ç»“æœ", use_container_width=True, key="clear_result"):
            st.session_state.input_processing['processing_result'] = None
            st.rerun()


def show_processing_history():
    """æ˜¾ç¤ºå¤„ç†å†å²"""
    history = st.session_state.input_processing.get('processing_history', [])

    if not history:
        return

    st.markdown("---")
    st.markdown("### ğŸ“œ å¤„ç†å†å²")

    # æŒ‰æ—¶é—´å€’åºæ˜¾ç¤º
    for idx, item in enumerate(reversed(history[-5:])):  # åªæ˜¾ç¤ºæœ€è¿‘5æ¡
        with st.expander(
                f"{item['filename']} - {item['timestamp'].strftime('%H:%M:%S')}",
                expanded=False
        ):
            st.text(f"å¤„ç†æ—¶é—´: {item['processing_time']:.1f} ç§’")
            st.text(f"å†…å®¹é•¿åº¦: {len(item['result'].content):,} å­—ç¬¦")

            if st.button(f"ä½¿ç”¨æ­¤ç»“æœ", key=f"use_history_{idx}_{item['timestamp']}"):
                st.session_state.input_processing['processing_result'] = item['result']
                st.rerun()


def main():
    """ä¸»å‡½æ•°"""
    # åœ¨é¡µé¢é¡¶éƒ¨æ£€æŸ¥API Keyè®¾ç½®
    check_api_key_setup()

    # åˆå§‹åŒ–é¡µé¢çŠ¶æ€
    initialize_page_state()

    # é¡µé¢æ ‡é¢˜
    st.title("ğŸ“„ å†…å®¹è¾“å…¥å¤„ç†")
    st.markdown("ä¸Šä¼ éŸ³é¢‘æˆ–æ–‡æ¡£æ–‡ä»¶ï¼Œæˆ–ç›´æ¥è¾“å…¥æ–‡æœ¬å†…å®¹è¿›è¡Œå¤„ç†")

    # é€‰æ‹©è¾“å…¥æ–¹å¼
    tab1, tab2 = st.tabs(["ğŸ“ æ–‡ä»¶ä¸Šä¼ ", "âœï¸ æ–‡æœ¬è¾“å…¥"])

    with tab1:
        show_file_upload_tab()

    with tab2:
        show_text_input_tab()

    # æ˜¾ç¤ºå¤„ç†ç»“æœ
    if st.session_state.input_processing.get('processing_result'):
        show_processing_result()

    # æ˜¾ç¤ºå¤„ç†å†å²
    show_processing_history()

    # ä¾§è¾¹æ ä¿¡æ¯
    with st.sidebar:
        st.markdown("### ğŸ’¡ ä½¿ç”¨æç¤º")
        st.info("""
**æ–‡ä»¶ä¸Šä¼ **ï¼š
- æ”¯æŒéŸ³é¢‘å’Œæ–‡æ¡£æ–‡ä»¶
- éŸ³é¢‘ä¼šè‡ªåŠ¨è½¬å½•ä¸ºæ–‡æœ¬
- æ–‡æ¡£ä¼šæå–æ–‡æœ¬å†…å®¹

**æ–‡æœ¬è¾“å…¥**ï¼š
- å¯ç›´æ¥ç²˜è´´å·²æœ‰æ–‡æœ¬
- æ”¯æŒä¼˜åŒ–è½¬å½•æ–‡æœ¬

**ä¸‹ä¸€æ­¥**ï¼š
- å¤„ç†å®Œæˆåå¯å‘é€åˆ°æ·±åº¦åˆ†æ
- æˆ–ä¸‹è½½ç»“æœä¿å­˜
""")

        # æ¸…ç†ä¸´æ—¶æ–‡ä»¶
        if st.button("ğŸ—‘ï¸ æ¸…ç†ä¸´æ—¶æ–‡ä»¶", key="sidebar_cleanup"):
            session_manager = st.session_state.session_manager
            if session_manager.cleanup_all_temp_files():
                st.success("ä¸´æ—¶æ–‡ä»¶å·²æ¸…ç†")
            else:
                st.error("æ¸…ç†å¤±è´¥")


if __name__ == "__main__":
    main()

--- File: pages/2_ğŸ”_Deep_Analysis.py ---
#!/usr/bin/env python
# -*- coding: utf-8 -*-
"""
æ–‡ä»¶è·¯å¾„: smart_proposal_engine/pages/2_ğŸ”_Deep_Analysis.py
åŠŸèƒ½è¯´æ˜: æ·±åº¦åˆ†æé¡µé¢ï¼Œå¯¹è½¬å½•æ–‡æœ¬è¿›è¡Œå•†ä¸šæ´å¯Ÿåˆ†æ
ä½œè€…: SmartProposal Team
åˆ›å»ºæ—¥æœŸ: 2025-06-27
æœ€åä¿®æ”¹: 2025-06-29
ç‰ˆæœ¬: 1.1.0
"""

import os
import sys
import streamlit as st
from pathlib import Path
from datetime import datetime
import time
import json

# æ·»åŠ é¡¹ç›®æ ¹ç›®å½•åˆ°ç³»ç»Ÿè·¯å¾„
sys.path.insert(0, os.path.dirname(os.path.dirname(os.path.abspath(__file__))))

from services.analysis_service import DeepAnalysisService
from core.session_manager import SessionManager
from core.prompt_manager import PromptManager
from utils.file_utils import (
    save_uploaded_file,
    get_file_metadata,
    format_file_size,
    prepare_download_file
)
from utils.format_utils import (
    format_metadata_display,
    format_duration,
    truncate_text,
    markdown_to_text
)
from utils.validation_utils import validate_text_input
from utils.ui_utils import check_api_key_setup  # å¼•å…¥æ£€æŸ¥å‡½æ•°

# é¡µé¢é…ç½®
st.set_page_config(
    page_title="æ·±åº¦åˆ†æ - SmartProposal Engine",
    page_icon="ğŸ”",
    layout="wide"
)


def initialize_page_state():
    """åˆå§‹åŒ–é¡µé¢çŠ¶æ€"""
    if 'deep_analysis' not in st.session_state:
        st.session_state.deep_analysis = {
            'analysis_result': None,
            'analysis_history': [],
            'current_template': 'customer_interview',
            'custom_prompt': '',
            'processing': False,
            'current_progress': 0  # æ·»åŠ è¿›åº¦è·Ÿè¸ª
        }

    # ç¡®ä¿SessionManagerå­˜åœ¨
    if 'session_manager' not in st.session_state:
        st.session_state.session_manager = SessionManager()

    # åˆ›å»ºæˆ–è·å–å½“å‰ä¼šè¯
    if not st.session_state.session_manager.current_session_id:
        st.session_state.session_manager.create_session('deep_analysis')


def load_previous_result():
    """åŠ è½½ä¸Šä¸€æ­¥çš„ç»“æœ"""
    session_manager = st.session_state.session_manager

    # å°è¯•è·å–è½¬å½•ç»“æœ
    transcription_result = session_manager.get_result('transcription')
    if transcription_result:
        return transcription_result

    # å°è¯•è·å–è¾“å…¥å¤„ç†ç»“æœ
    input_result = session_manager.get_result('input_processing')
    if input_result:
        return input_result

    return None


def show_data_source_section():
    """æ˜¾ç¤ºæ•°æ®æºé€‰æ‹©éƒ¨åˆ†"""
    st.markdown("### ğŸ“Š é€‰æ‹©æ•°æ®æº")

    # æ£€æŸ¥æ˜¯å¦æœ‰ä¸Šä¸€æ­¥çš„ç»“æœ
    previous_result = load_previous_result()

    col1, col2 = st.columns(2)

    with col1:
        use_previous = st.checkbox(
            "ä½¿ç”¨ä¸Šä¸€æ­¥å¤„ç†ç»“æœ",
            value=bool(previous_result),
            disabled=not bool(previous_result),
            help="ä½¿ç”¨å†…å®¹è¾“å…¥é¡µé¢çš„å¤„ç†ç»“æœ" if previous_result else "æ²¡æœ‰æ‰¾åˆ°ä¸Šä¸€æ­¥çš„å¤„ç†ç»“æœ"
        )

    if use_previous and previous_result:
        with col2:
            st.success(f"âœ… å·²åŠ è½½ä¸Šä¸€æ­¥ç»“æœ")
            st.caption(f"å†…å®¹é•¿åº¦: {len(previous_result.content):,} å­—ç¬¦")

        # æ˜¾ç¤ºå†…å®¹é¢„è§ˆ
        with st.expander("æŸ¥çœ‹å†…å®¹é¢„è§ˆ", expanded=False):
            st.text_area(
                "å†…å®¹é¢„è§ˆ",
                value=truncate_text(previous_result.content, 1000),
                height=200,
                disabled=True
            )

        return previous_result.content, previous_result.metadata

    else:
        # æ–‡ä»¶ä¸Šä¼ æˆ–æ–‡æœ¬è¾“å…¥
        tab1, tab2 = st.tabs(["ğŸ“¤ ä¸Šä¼ æ–‡ä»¶", "âœï¸ æ–‡æœ¬è¾“å…¥"])

        with tab1:
            uploaded_file = st.file_uploader(
                "ä¸Šä¼ è½¬å½•æ–‡æœ¬æˆ–æ–‡æ¡£",
                type=['txt', 'docx', 'pdf', 'json'],
                help="æ”¯æŒTXTã€DOCXã€PDFæˆ–ä¹‹å‰å¯¼å‡ºçš„JSONæ–‡ä»¶"
            )

            if uploaded_file:
                # ä¿å­˜ä¸Šä¼ çš„æ–‡ä»¶
                save_dir = Path("temp") / datetime.now().strftime("%Y%m%d_%H%M%S")
                success, file_path, message = save_uploaded_file(uploaded_file, save_dir)

                if success:
                    st.success(message)

                    # è¯»å–æ–‡ä»¶å†…å®¹
                    if uploaded_file.type == 'application/json':
                        # JSONæ–‡ä»¶ç‰¹æ®Šå¤„ç†
                        with open(file_path, 'r', encoding='utf-8') as f:
                            data = json.load(f)
                            content = data.get('content', '')
                            metadata = data.get('metadata', {})
                    else:
                        # å…¶ä»–æ–‡ä»¶ä½œä¸ºçº¯æ–‡æœ¬å¤„ç†
                        with open(file_path, 'r', encoding='utf-8') as f:
                            content = f.read()
                        metadata = get_file_metadata(file_path)

                    return content, metadata
                else:
                    st.error(message)
                    return None, None

        with tab2:
            text_input = st.text_area(
                "ç²˜è´´æˆ–è¾“å…¥æ–‡æœ¬å†…å®¹",
                height=300,
                placeholder="åœ¨æ­¤è¾“å…¥éœ€è¦åˆ†æçš„æ–‡æœ¬å†…å®¹...",
                help="å»ºè®®æ–‡æœ¬é•¿åº¦åœ¨100-50000å­—ç¬¦ä¹‹é—´"
            )

            if text_input:
                # æ˜¾ç¤ºå­—æ•°ç»Ÿè®¡
                char_count = len(text_input)
                word_count = len(text_input.split())
                st.caption(f"å­—ç¬¦æ•°: {char_count:,} | è¯æ•°: {word_count:,}")

                # éªŒè¯è¾“å…¥
                is_valid, message = validate_text_input(
                    text_input,
                    min_length=100,
                    max_length=100000
                )

                if is_valid:
                    metadata = {
                        'source': 'text_input',
                        'char_count': char_count,
                        'word_count': word_count,
                        'timestamp': datetime.now().strftime('%Y-%m-%d %H:%M:%S')
                    }
                    return text_input, metadata
                else:
                    st.warning(message)
                    return None, None

    return None, None


def show_analysis_configuration():
    """æ˜¾ç¤ºåˆ†æé…ç½®éƒ¨åˆ†"""
    st.markdown("### âš™ï¸ åˆ†æé…ç½®")

    # åˆå§‹åŒ–åˆ†ææœåŠ¡ä»¥è·å–å¯ç”¨æ¨¡æ¿
    analysis_service = DeepAnalysisService()

    col1, col2 = st.columns([2, 1])

    with col1:
        # åˆ†æåœºæ™¯é€‰æ‹©
        scenarios = analysis_service.ANALYSIS_SCENARIOS
        template_options = list(scenarios.keys())
        template_names = [scenarios[key]['name'] for key in template_options]

        selected_index = st.selectbox(
            "é€‰æ‹©åˆ†æåœºæ™¯",
            range(len(template_options)),
            format_func=lambda x: template_names[x],
            index=template_options.index(st.session_state.deep_analysis['current_template']),
            help="é€‰æ‹©é€‚åˆæ‚¨ä¸šåŠ¡åœºæ™¯çš„åˆ†ææ¨¡æ¿"
        )

        selected_template = template_options[selected_index]
        st.session_state.deep_analysis['current_template'] = selected_template

        # æ˜¾ç¤ºåœºæ™¯è¯´æ˜
        scenario_info = scenarios[selected_template]
        st.info(f"**åœºæ™¯è¯´æ˜**: {scenario_info['description']}")

        # æ˜¾ç¤ºé‡ç‚¹åˆ†æé¢†åŸŸ
        st.markdown("**é‡ç‚¹åˆ†æé¢†åŸŸ:**")
        focus_areas_text = " | ".join(scenario_info['focus_areas'])
        st.caption(focus_areas_text)

    with col2:
        # é«˜çº§é€‰é¡¹
        st.markdown("**é«˜çº§é€‰é¡¹**")

        include_recommendations = st.checkbox(
            "åŒ…å«è¡ŒåŠ¨å»ºè®®",
            value=True,
            help="åœ¨åˆ†ææŠ¥å‘Šä¸­åŒ…å«å…·ä½“çš„è¡ŒåŠ¨å»ºè®®"
        )

        extract_action_items = st.checkbox(
            "æå–è¡ŒåŠ¨é¡¹",
            value=True,
            help="è‡ªåŠ¨æå–å¹¶åˆ—å‡ºéœ€è¦æ‰§è¡Œçš„è¡ŒåŠ¨é¡¹"
        )

        output_format = st.selectbox(
            "è¾“å‡ºæ ¼å¼",
            options=['markdown', 'text'],
            format_func=lambda x: {'markdown': 'Markdownæ ¼å¼', 'text': 'çº¯æ–‡æœ¬'}.get(x, x),
            help="é€‰æ‹©åˆ†ææŠ¥å‘Šçš„è¾“å‡ºæ ¼å¼"
        )

    # è‡ªå®šä¹‰Promptéƒ¨åˆ†
    with st.expander("ğŸ› ï¸ è‡ªå®šä¹‰åˆ†ææ¨¡æ¿ï¼ˆé«˜çº§ï¼‰", expanded=False):
        st.markdown("""
        æ‚¨å¯ä»¥æä¾›è‡ªå®šä¹‰çš„åˆ†ææ¨¡æ¿æ¥æ›¿ä»£é¢„è®¾æ¨¡æ¿ã€‚æ¨¡æ¿ä¸­å¯ä½¿ç”¨ä»¥ä¸‹å˜é‡ï¼š
        - `{transcript}`: å¾…åˆ†æçš„æ–‡æœ¬å†…å®¹
        - `{additional_context}`: é¢å¤–çš„ä¸Šä¸‹æ–‡ä¿¡æ¯
        """)

        custom_prompt = st.text_area(
            "è‡ªå®šä¹‰åˆ†ææ¨¡æ¿",
            value=st.session_state.deep_analysis.get('custom_prompt', ''),
            height=300,
            placeholder="è¾“å…¥æ‚¨çš„è‡ªå®šä¹‰åˆ†ææ¨¡æ¿...",
            help="ç•™ç©ºåˆ™ä½¿ç”¨é€‰å®šçš„é¢„è®¾æ¨¡æ¿"
        )

        if custom_prompt:
            st.session_state.deep_analysis['custom_prompt'] = custom_prompt

        # é¢å¤–ä¸Šä¸‹æ–‡
        additional_context = st.text_area(
            "é¢å¤–ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼ˆå¯é€‰ï¼‰",
            height=100,
            placeholder="æä¾›é¢å¤–çš„èƒŒæ™¯ä¿¡æ¯æˆ–ç‰¹æ®Šè¦æ±‚...",
            help="è¿™äº›ä¿¡æ¯å°†å¸®åŠ©AIæ›´å¥½åœ°ç†è§£åˆ†æéœ€æ±‚"
        )

    # è¿”å›é…ç½®é€‰é¡¹
    options = {
        'template': selected_template,
        'include_recommendations': include_recommendations,
        'extract_action_items': extract_action_items,
        'output_format': output_format,
        'custom_prompt': custom_prompt if custom_prompt else None,
        'additional_context': additional_context if additional_context else None
    }

    return options


def perform_analysis(content: str, metadata: dict, options: dict):
    """æ‰§è¡Œæ·±åº¦åˆ†æ"""
    session_manager = st.session_state.session_manager

    # åˆ›å»ºè¿›åº¦å®¹å™¨
    progress_container = st.container()

    with progress_container:
        progress_bar = st.progress(0)
        status_text = st.empty()

        # åˆå§‹åŒ–è¿›åº¦è·Ÿè¸ª
        st.session_state.deep_analysis['current_progress'] = 0

        try:
            # åˆå§‹åŒ–åˆ†ææœåŠ¡
            status_text.text("æ­£åœ¨åˆå§‹åŒ–åˆ†ææœåŠ¡...")
            progress_bar.progress(10)
            st.session_state.deep_analysis['current_progress'] = 10

            analysis_service = DeepAnalysisService()

            # å®šä¹‰è¿›åº¦å›è°ƒ
            def progress_callback(msg):
                status_text.text(msg)
                current = st.session_state.deep_analysis['current_progress']
                if current < 90:
                    new_progress = min(current + 20, 90)
                    progress_bar.progress(new_progress)
                    st.session_state.deep_analysis['current_progress'] = new_progress

            options['progress_callback'] = progress_callback

            # å‡†å¤‡è¾“å…¥æ•°æ®
            input_data = {
                'transcript': content,
                'metadata': metadata
            }

            # æ‰§è¡Œåˆ†æ
            status_text.text("æ­£åœ¨è¿›è¡Œæ·±åº¦åˆ†æ...")
            progress_bar.progress(30)
            st.session_state.deep_analysis['current_progress'] = 30

            start_time = time.time()
            result = analysis_service.process(
                input_data,
                template=options['template'],
                options=options
            )

            progress_bar.progress(100)
            st.session_state.deep_analysis['current_progress'] = 100

            if result.is_success:
                status_text.text("âœ… åˆ†æå®Œæˆï¼")

                # ä¿å­˜ç»“æœåˆ°ä¼šè¯
                session_manager.save_result('analysis', result)
                st.session_state.deep_analysis['analysis_result'] = result

                # æ·»åŠ åˆ°å†å²è®°å½•
                st.session_state.deep_analysis['analysis_history'].append({
                    'timestamp': datetime.now(),
                    'template': options['template'],
                    'processing_time': result.processing_time,
                    'result': result
                })

                # å¦‚æœéœ€è¦æå–è¡ŒåŠ¨é¡¹
                if options.get('extract_action_items'):
                    action_items = analysis_service.extract_action_items(result)
                    result.metadata['action_items'] = action_items

                # ç”Ÿæˆæ‰§è¡Œæ‘˜è¦
                executive_summary = analysis_service.generate_executive_summary(result)
                result.metadata['executive_summary'] = executive_summary

                st.success(f"""
                æ·±åº¦åˆ†ææˆåŠŸå®Œæˆï¼
                - å¤„ç†æ—¶é—´: {result.processing_time:.1f} ç§’
                - ä½¿ç”¨æ¨¡å‹: {result.model_used}
                - Tokenä½¿ç”¨: {result.total_tokens:,}
                """)

                # è‡ªåŠ¨åˆ·æ–°é¡µé¢ä»¥æ˜¾ç¤ºç»“æœ
                time.sleep(1)
                st.rerun()

            else:
                status_text.text("âŒ åˆ†æå¤±è´¥")
                st.error(f"åˆ†æå¤±è´¥: {result.error}")

        except Exception as e:
            status_text.text("âŒ å‘ç”Ÿé”™è¯¯")
            st.error(f"åˆ†æè¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯: {str(e)}")

        finally:
            # æ¸…ç†è¿›åº¦æ˜¾ç¤º
            time.sleep(2)
            progress_container.empty()
            # é‡ç½®è¿›åº¦
            st.session_state.deep_analysis['current_progress'] = 0


def show_analysis_result():
    """æ˜¾ç¤ºåˆ†æç»“æœ"""
    result = st.session_state.deep_analysis.get('analysis_result')

    if not result:
        return

    st.markdown("---")
    st.markdown("### ğŸ“Š åˆ†æç»“æœ")

    # æ˜¾ç¤ºæ‰§è¡Œæ‘˜è¦
    if 'executive_summary' in result.metadata:
        st.markdown("#### ğŸ“„ æ‰§è¡Œæ‘˜è¦")
        st.info(result.metadata['executive_summary'])

    # æ˜¾ç¤ºå…³é”®æŒ‡æ ‡
    col1, col2, col3, col4 = st.columns(4)

    with col1:
        st.metric("åˆ†æç”¨æ—¶", f"{result.processing_time:.1f} ç§’")

    with col2:
        st.metric("Tokenä½¿ç”¨", f"{result.total_tokens:,}")

    with col3:
        if 'estimated_cost' in result.metadata:
            st.metric("é¢„ä¼°è´¹ç”¨", f"${result.metadata['estimated_cost']:.4f}")

    with col4:
        st.metric("åˆ†ææ¨¡æ¿", result.metadata.get('analysis_scenario', 'æœªçŸ¥'))

    # æ˜¾ç¤ºå®Œæ•´åˆ†ææŠ¥å‘Š
    st.markdown("#### ğŸ“‘ å®Œæ•´åˆ†ææŠ¥å‘Š")

    # æŠ¥å‘Šæ˜¾ç¤ºé€‰é¡¹
    col1, col2 = st.columns([3, 1])
    with col1:
        show_full_report = st.checkbox("æ˜¾ç¤ºå®Œæ•´æŠ¥å‘Š", value=True)
    with col2:
        if st.button("ğŸ“‹ å¤åˆ¶åˆ°å‰ªè´´æ¿"):
            st.write(result.content)  # Streamlitä¼šè‡ªåŠ¨æ·»åŠ å¤åˆ¶åŠŸèƒ½
            st.success("å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼")

    # æ˜¾ç¤ºæŠ¥å‘Šå†…å®¹
    if show_full_report:
        # ä½¿ç”¨å®¹å™¨æ˜¾ç¤ºæ ¼å¼åŒ–çš„Markdownå†…å®¹
        report_container = st.container()
        with report_container:
            st.markdown(result.content)
    else:
        # æ˜¾ç¤ºæ‘˜è¦
        preview_length = 2000
        preview_text = truncate_text(result.content, preview_length)
        st.text_area(
            "æŠ¥å‘Šé¢„è§ˆ",
            value=preview_text,
            height=400,
            disabled=True
        )

    # æ˜¾ç¤ºè¡ŒåŠ¨é¡¹ï¼ˆå¦‚æœæœ‰ï¼‰
    if 'action_items' in result.metadata and result.metadata['action_items']:
        st.markdown("#### ğŸ¯ æå–çš„è¡ŒåŠ¨é¡¹")

        action_items = result.metadata['action_items']
        for i, item in enumerate(action_items, 1):
            col1, col2 = st.columns([5, 1])
            with col1:
                st.write(f"{i}. {item['description']}")
            with col2:
                st.caption(f"ä¼˜å…ˆçº§: {item.get('priority', 'ä¸­')}")

    # æ“ä½œæŒ‰é’®
    st.markdown("#### â¯ï¸ ä¿å­˜å’Œä¸‹ä¸€æ­¥")

    col1, col2, col3, col4 = st.columns(4)

    with col1:
        # ä¸‹è½½Markdownæ ¼å¼
        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        filename_md = f"analysis_report_{timestamp}.md"

        st.download_button(
            label="ğŸ’¾ ä¸‹è½½æŠ¥å‘Š(MD)",
            data=result.content,
            file_name=filename_md,
            mime="text/markdown",
            use_container_width=True
        )

    with col2:
        # ä¸‹è½½JSONæ ¼å¼ï¼ˆåŒ…å«å®Œæ•´æ•°æ®ï¼‰
        export_data = {
            'content': result.content,
            'metadata': result.metadata,
            'processing_info': {
                'processing_time': result.processing_time,
                'model_used': result.model_used,
                'tokens_consumed': result.tokens_consumed,
                'timestamp': datetime.now().isoformat()
            }
        }

        filename_json = f"analysis_report_{timestamp}.json"
        json_str = json.dumps(export_data, ensure_ascii=False, indent=2)

        st.download_button(
            label="ğŸ’¾ ä¸‹è½½æŠ¥å‘Š(JSON)",
            data=json_str,
            file_name=filename_json,
            mime="application/json",
            use_container_width=True
        )

    with col3:
        # å‘é€åˆ°æ–¹æ¡ˆç”Ÿæˆ
        if st.button("â¡ï¸ å‘é€åˆ°æ–¹æ¡ˆç”Ÿæˆ", type="primary", use_container_width=True):
            session_manager = st.session_state.session_manager
            session_manager.save_result('analysis', result)
            st.success("å·²ä¿å­˜ï¼è¯·å‰å¾€ **æ–¹æ¡ˆç”Ÿæˆ** é¡µé¢ç»§ç»­")
            time.sleep(2)
            st.rerun()

    with col4:
        # é‡æ–°åˆ†æ
        if st.button("ğŸ”„ é‡æ–°åˆ†æ", use_container_width=True):
            st.session_state.deep_analysis['analysis_result'] = None
            st.rerun()


def show_analysis_history():
    """æ˜¾ç¤ºåˆ†æå†å²"""
    history = st.session_state.deep_analysis.get('analysis_history', [])

    if not history:
        return

    st.markdown("---")
    st.markdown("### ğŸ“œ åˆ†æå†å²")

    # æŒ‰æ—¶é—´å€’åºæ˜¾ç¤ºæœ€è¿‘çš„åˆ†æ
    for item in reversed(history[-5:]):  # åªæ˜¾ç¤ºæœ€è¿‘5æ¡
        template_name = DeepAnalysisService.ANALYSIS_SCENARIOS.get(
            item['template'], {}
        ).get('name', item['template'])

        with st.expander(
                f"{template_name} - {item['timestamp'].strftime('%H:%M:%S')}",
                expanded=False
        ):
            st.text(f"å¤„ç†æ—¶é—´: {item['processing_time']:.1f} ç§’")
            st.text(f"å†…å®¹é•¿åº¦: {len(item['result'].content):,} å­—ç¬¦")

            if st.button(f"ä½¿ç”¨æ­¤ç»“æœ", key=f"use_{item['timestamp']}"):
                st.session_state.deep_analysis['analysis_result'] = item['result']
                st.rerun()


def main():
    """ä¸»å‡½æ•°"""
    # åœ¨é¡µé¢é¡¶éƒ¨æ£€æŸ¥API Keyè®¾ç½®
    check_api_key_setup()

    # åˆå§‹åŒ–é¡µé¢çŠ¶æ€
    initialize_page_state()

    # é¡µé¢æ ‡é¢˜
    st.title("ğŸ” æ·±åº¦åˆ†æ")
    st.markdown("å¯¹è½¬å½•æ–‡æœ¬è¿›è¡Œå•†ä¸šæ´å¯Ÿåˆ†æï¼Œæå–å…³é”®ä¿¡æ¯å’Œè¡ŒåŠ¨å»ºè®®")

    # æ˜¾ç¤ºåˆ†æç»“æœï¼ˆå¦‚æœæœ‰ï¼‰
    if st.session_state.deep_analysis.get('analysis_result'):
        show_analysis_result()
        show_analysis_history()
    else:
        # è·å–æ•°æ®æº
        content, metadata = show_data_source_section()

        if content:
            st.markdown("---")

            # æ˜¾ç¤ºåˆ†æé…ç½®
            options = show_analysis_configuration()

            st.markdown("---")

            # æ‰§è¡Œåˆ†ææŒ‰é’®
            col1, col2, col3 = st.columns([2, 1, 2])
            with col2:
                if st.button(
                        "â–¶ï¸ å¼€å§‹åˆ†æ",
                        type="primary",
                        use_container_width=True,
                        disabled=st.session_state.deep_analysis.get('processing', False)
                ):
                    st.session_state.deep_analysis['processing'] = True
                    perform_analysis(content, metadata, options)
                    st.session_state.deep_analysis['processing'] = False

        # æ˜¾ç¤ºå†å²è®°å½•
        show_analysis_history()

    # ä¾§è¾¹æ ä¿¡æ¯
    with st.sidebar:
        st.markdown("### ğŸ’¡ ä½¿ç”¨æç¤º")
        st.info("""
**åˆ†æåœºæ™¯é€‰æ‹©**ï¼š
- å®¢æˆ·è®¿è°ˆï¼šé€‚åˆéœ€æ±‚æŒ–æ˜
- å•†åŠ¡è°ˆåˆ¤ï¼šé€‚åˆæ¡æ¬¾åˆ†æ
- å†…éƒ¨ä¼šè®®ï¼šé€‚åˆå†³ç­–æå–

**è‡ªå®šä¹‰æ¨¡æ¿**ï¼š
- æ”¯æŒå®Œå…¨è‡ªå®šä¹‰åˆ†æé€»è¾‘
- ä½¿ç”¨ {transcript} å¼•ç”¨æ–‡æœ¬

**ä¸‹ä¸€æ­¥**ï¼š
- åˆ†æå®Œæˆåå¯ç”Ÿæˆæ–¹æ¡ˆ
- æ”¯æŒå¤šæ¬¡åˆ†æå¯¹æ¯”
""")

        # æ¨¡æ¿å¸®åŠ©
        if st.button("ğŸ“– æŸ¥çœ‹æ¨¡æ¿ç¤ºä¾‹"):
            st.markdown("""
**è‡ªå®šä¹‰æ¨¡æ¿ç¤ºä¾‹**ï¼š
```
è¯·åˆ†æä»¥ä¸‹å¯¹è¯å†…å®¹ï¼Œé‡ç‚¹å…³æ³¨ï¼š
1. å®¢æˆ·çš„æ ¸å¿ƒéœ€æ±‚
2. é¢„ç®—èŒƒå›´
3. å†³ç­–æ—¶é—´çº¿

å¯¹è¯å†…å®¹ï¼š
{transcript}

è¯·æä¾›ç»“æ„åŒ–çš„åˆ†ææŠ¥å‘Šã€‚
```
""")


if __name__ == "__main__":
    main()

--- File: pages/3_ğŸ“‹_Proposal_Generation.py ---
#!/usr/bin/env python
# -*- coding: utf-8 -*-
"""
æ–‡ä»¶è·¯å¾„: smart_proposal_engine/pages/3_ğŸ“‹_Proposal_Generation.py
åŠŸèƒ½è¯´æ˜: æ–¹æ¡ˆç”Ÿæˆé¡µé¢ï¼ŒåŸºäºåˆ†æç»“æœç”Ÿæˆå„ç±»å•†ä¸šæ–‡æ¡£
ä½œè€…: SmartProposal Team
åˆ›å»ºæ—¥æœŸ: 2025-06-27
æœ€åä¿®æ”¹: 2025-06-29
ç‰ˆæœ¬: 1.1.0
"""

import os
import sys
import streamlit as st
from pathlib import Path
from datetime import datetime
import time
import json
from typing import List, Optional, Dict, Any

# æ·»åŠ é¡¹ç›®æ ¹ç›®å½•åˆ°ç³»ç»Ÿè·¯å¾„
sys.path.insert(0, os.path.dirname(os.path.dirname(os.path.abspath(__file__))))

from services.proposal_service import ProposalService
from services.document_service import DocumentService
from core.session_manager import SessionManager
from utils.file_utils import (
    save_uploaded_file,
    get_file_metadata,
    format_file_size,
    create_unique_filename,
    ensure_directory_exists
)
from utils.format_utils import (
    format_metadata_display,
    truncate_text,
    format_table_text,
    markdown_to_text
)
from utils.validation_utils import validate_text_input, validate_file_type
from utils.ui_utils import check_api_key_setup # å¼•å…¥æ£€æŸ¥å‡½æ•°

# é¡µé¢é…ç½®
st.set_page_config(
    page_title="æ–¹æ¡ˆç”Ÿæˆ - SmartProposal Engine",
    page_icon="ğŸ“‹",
    layout="wide"
)


def initialize_page_state():
    """åˆå§‹åŒ–é¡µé¢çŠ¶æ€"""
    if 'proposal_generation' not in st.session_state:
        st.session_state.proposal_generation = {
            'proposal_result': None,
            'generation_history': [],
            'current_template': 'project_proposal',
            'capability_docs': [],
            'custom_prompt': '',
            'client_info': {},
            'processing': False,
            'current_progress': 0  # æ·»åŠ è¿›åº¦è·Ÿè¸ª
        }

    # ç¡®ä¿SessionManagerå­˜åœ¨
    if 'session_manager' not in st.session_state:
        st.session_state.session_manager = SessionManager()

    # åˆ›å»ºæˆ–è·å–å½“å‰ä¼šè¯
    if not st.session_state.session_manager.current_session_id:
        st.session_state.session_manager.create_session('proposal_generation')


def load_analysis_result():
    """åŠ è½½åˆ†æç»“æœ"""
    session_manager = st.session_state.session_manager

    # å°è¯•è·å–åˆ†æç»“æœ
    analysis_result = session_manager.get_result('analysis')
    if analysis_result:
        return analysis_result

    return None


def show_analysis_source_section():
    """æ˜¾ç¤ºåˆ†ææŠ¥å‘Šæºé€‰æ‹©éƒ¨åˆ†"""
    st.markdown("### ğŸ“Š é€‰æ‹©åˆ†ææŠ¥å‘Š")

    # æ£€æŸ¥æ˜¯å¦æœ‰ä¸Šä¸€æ­¥çš„ç»“æœ
    previous_result = load_analysis_result()

    col1, col2 = st.columns(2)

    with col1:
        use_previous = st.checkbox(
            "ä½¿ç”¨æ·±åº¦åˆ†æç»“æœ",
            value=bool(previous_result),
            disabled=not bool(previous_result),
            help="ä½¿ç”¨æ·±åº¦åˆ†æé¡µé¢çš„åˆ†æç»“æœ" if previous_result else "æ²¡æœ‰æ‰¾åˆ°åˆ†æç»“æœ"
        )

    if use_previous and previous_result:
        with col2:
            st.success("âœ… å·²åŠ è½½åˆ†æç»“æœ")

            # æ˜¾ç¤ºåˆ†æä¿¡æ¯
            analysis_template = previous_result.metadata.get('analysis_scenario', 'æœªçŸ¥')
            st.caption(f"åˆ†æç±»å‹: {analysis_template}")

        # æ˜¾ç¤ºå†…å®¹é¢„è§ˆ
        with st.expander("æŸ¥çœ‹åˆ†ææŠ¥å‘Šé¢„è§ˆ", expanded=False):
            # æ˜¾ç¤ºæ‰§è¡Œæ‘˜è¦ï¼ˆå¦‚æœæœ‰ï¼‰
            if 'executive_summary' in previous_result.metadata:
                st.markdown("**æ‰§è¡Œæ‘˜è¦:**")
                st.info(previous_result.metadata['executive_summary'])
                st.markdown("---")

            # æ˜¾ç¤ºéƒ¨åˆ†å†…å®¹
            st.text_area(
                "æŠ¥å‘Šå†…å®¹é¢„è§ˆ",
                value=truncate_text(previous_result.content, 1500),
                height=300,
                disabled=True
            )

        return previous_result.content, previous_result.metadata

    else:
        # æ–‡ä»¶ä¸Šä¼ 
        st.markdown("#### ğŸ“¤ ä¸Šä¼ åˆ†ææŠ¥å‘Š")

        uploaded_file = st.file_uploader(
            "ä¸Šä¼ åˆ†ææŠ¥å‘Šæ–‡ä»¶",
            type=['txt', 'md', 'json'],
            help="æ”¯æŒæ–‡æœ¬ã€Markdownæˆ–JSONæ ¼å¼çš„åˆ†ææŠ¥å‘Š"
        )

        if uploaded_file:
            # ä¿å­˜ä¸Šä¼ çš„æ–‡ä»¶
            save_dir = Path("temp") / datetime.now().strftime("%Y%m%d_%H%M%S")
            success, file_path, message = save_uploaded_file(uploaded_file, save_dir)

            if success:
                st.success(message)

                # è¯»å–æ–‡ä»¶å†…å®¹
                if uploaded_file.type == 'application/json':
                    # JSONæ–‡ä»¶ç‰¹æ®Šå¤„ç†
                    with open(file_path, 'r', encoding='utf-8') as f:
                        data = json.load(f)
                        content = data.get('content', '')
                        metadata = data.get('metadata', {})
                else:
                    # å…¶ä»–æ–‡ä»¶ä½œä¸ºçº¯æ–‡æœ¬å¤„ç†
                    with open(file_path, 'r', encoding='utf-8') as f:
                        content = f.read()
                    metadata = get_file_metadata(file_path)

                # éªŒè¯å†…å®¹
                is_valid, msg = validate_text_input(content, min_length=200)
                if is_valid:
                    return content, metadata
                else:
                    st.error(f"åˆ†ææŠ¥å‘Šå†…å®¹ä¸ç¬¦åˆè¦æ±‚: {msg}")
                    return None, None
            else:
                st.error(message)
                return None, None

    return None, None


def show_capability_docs_section():
    """æ˜¾ç¤ºä¼ä¸šèƒ½åŠ›æ–‡æ¡£ä¸Šä¼ éƒ¨åˆ†"""
    st.markdown("### ğŸ¢ ä¼ä¸šèƒ½åŠ›æ–‡æ¡£ï¼ˆå¯é€‰ï¼‰")

    st.info("""
    ä¸Šä¼ ä¼ä¸šä»‹ç»ã€æ¡ˆä¾‹å±•ç¤ºã€èµ„è´¨è¯æ˜ç­‰æ–‡æ¡£ï¼Œç³»ç»Ÿå°†åœ¨ç”Ÿæˆæ–¹æ¡ˆæ—¶å‚è€ƒè¿™äº›ä¿¡æ¯ï¼Œ
    å¢å¼ºæ–¹æ¡ˆçš„é’ˆå¯¹æ€§å’Œè¯´æœåŠ›ã€‚
    """)

    # æ–‡ä»¶ä¸Šä¼ 
    uploaded_files = st.file_uploader(
        "é€‰æ‹©èƒ½åŠ›æ–‡æ¡£",
        type=['docx', 'pdf', 'txt', 'md'],
        accept_multiple_files=True,
        help="å¯ä»¥ä¸Šä¼ å¤šä¸ªæ–‡æ¡£ï¼Œæ”¯æŒDOCXã€PDFã€TXTã€Markdownæ ¼å¼"
    )

    capability_doc_paths = []

    if uploaded_files:
        # æ˜¾ç¤ºå·²ä¸Šä¼ çš„æ–‡ä»¶
        st.markdown("#### å·²ä¸Šä¼ çš„æ–‡æ¡£:")

        for i, uploaded_file in enumerate(uploaded_files):
            col1, col2, col3 = st.columns([3, 1, 1])

            with col1:
                st.text(f"ğŸ“„ {uploaded_file.name}")

            with col2:
                st.caption(format_file_size(uploaded_file.size))

            with col3:
                # ä¿å­˜æ–‡ä»¶
                save_dir = Path("temp") / "capability_docs" / datetime.now().strftime("%Y%m%d_%H%M%S")
                success, file_path, _ = save_uploaded_file(uploaded_file, save_dir)

                if success:
                    capability_doc_paths.append(file_path)
                    st.success("âœ“")
                else:
                    st.error("âœ—")

        # ä¿å­˜åˆ°session state
        st.session_state.proposal_generation['capability_docs'] = capability_doc_paths

        # æ˜¾ç¤ºæ–‡æ¡£é¢„è§ˆé€‰é¡¹
        if st.checkbox("é¢„è§ˆæ–‡æ¡£å†…å®¹", value=False):
            document_service = DocumentService()

            for doc_path in capability_doc_paths[:3]:  # æœ€å¤šé¢„è§ˆ3ä¸ª
                with st.expander(f"é¢„è§ˆ: {Path(doc_path).name}", expanded=False):
                    result = document_service.process(doc_path)
                    if result.is_success:
                        st.text_area(
                            "å†…å®¹é¢„è§ˆ",
                            value=truncate_text(result.content, 1000),
                            height=200,
                            disabled=True
                        )
                    else:
                        st.error("æ— æ³•è¯»å–æ–‡æ¡£å†…å®¹")

    return capability_doc_paths


def show_proposal_configuration():
    """æ˜¾ç¤ºæ–¹æ¡ˆç”Ÿæˆé…ç½®éƒ¨åˆ†"""
    st.markdown("### âš™ï¸ æ–¹æ¡ˆé…ç½®")

    # åˆå§‹åŒ–æ–¹æ¡ˆæœåŠ¡ä»¥è·å–å¯ç”¨æ¨¡æ¿
    proposal_service = ProposalService()

    # åŸºæœ¬é…ç½®
    col1, col2 = st.columns([2, 1])

    with col1:
        # æ–¹æ¡ˆç±»å‹é€‰æ‹©
        proposal_types = proposal_service.PROPOSAL_TYPES
        template_options = list(proposal_types.keys())
        template_names = [proposal_types[key]['name'] for key in template_options]

        selected_index = st.selectbox(
            "é€‰æ‹©æ–¹æ¡ˆç±»å‹",
            range(len(template_options)),
            format_func=lambda x: template_names[x],
            index=template_options.index(st.session_state.proposal_generation['current_template']),
            help="é€‰æ‹©è¦ç”Ÿæˆçš„æ–¹æ¡ˆç±»å‹"
        )

        selected_template = template_options[selected_index]
        st.session_state.proposal_generation['current_template'] = selected_template

        # æ˜¾ç¤ºæ–¹æ¡ˆè¯´æ˜
        proposal_info = proposal_types[selected_template]
        st.info(f"**æ–¹æ¡ˆè¯´æ˜**: {proposal_info['description']}")

        # æ˜¾ç¤ºæ–¹æ¡ˆç« èŠ‚
        st.markdown("**åŒ…å«ç« èŠ‚:**")
        sections_text = " â†’ ".join(proposal_info['sections'])
        st.caption(sections_text)

    with col2:
        # æ–¹æ¡ˆé€‰é¡¹
        st.markdown("**ç”Ÿæˆé€‰é¡¹**")

        include_pricing = st.checkbox(
            "åŒ…å«æŠ¥ä»·ä¿¡æ¯",
            value=selected_template == 'quotation_proposal',
            help="åœ¨æ–¹æ¡ˆä¸­åŒ…å«ä»·æ ¼å’ŒæŠ¥ä»·ä¿¡æ¯"
        )

        include_timeline = st.checkbox(
            "åŒ…å«æ—¶é—´è®¡åˆ’",
            value=True,
            help="åœ¨æ–¹æ¡ˆä¸­åŒ…å«é¡¹ç›®æ—¶é—´çº¿"
        )

        language = st.selectbox(
            "è¯­è¨€",
            options=['zh', 'en'],
            format_func=lambda x: {'zh': 'ä¸­æ–‡', 'en': 'English'}.get(x, x),
            help="æ–¹æ¡ˆçš„è¾“å‡ºè¯­è¨€"
        )

    # å®¢æˆ·ä¿¡æ¯éƒ¨åˆ†
    with st.expander("ğŸ‘¤ å®¢æˆ·ä¿¡æ¯ï¼ˆå¯é€‰ï¼‰", expanded=False):
        st.markdown("æä¾›å®¢æˆ·ä¿¡æ¯å¯ä»¥è®©æ–¹æ¡ˆæ›´åŠ ä¸ªæ€§åŒ–")

        col1, col2 = st.columns(2)

        with col1:
            client_name = st.text_input(
                "å®¢æˆ·åç§°",
                placeholder="XXç§‘æŠ€æœ‰é™å…¬å¸",
                help="å°†åœ¨æ–¹æ¡ˆä¸­ä½¿ç”¨çš„å®¢æˆ·å…¬å¸åç§°"
            )

            project_name = st.text_input(
                "é¡¹ç›®åç§°",
                placeholder="æ™ºèƒ½åŒ–å‡çº§é¡¹ç›®",
                help="é¡¹ç›®çš„æ­£å¼åç§°"
            )

            industry = st.text_input(
                "æ‰€å±è¡Œä¸š",
                placeholder="äº’è”ç½‘/åˆ¶é€ ä¸š/é‡‘èç­‰",
                help="å®¢æˆ·æ‰€åœ¨çš„è¡Œä¸š"
            )

        with col2:
            contact_person = st.text_input(
                "è”ç³»äºº",
                placeholder="å¼ æ€»",
                help="ä¸»è¦è”ç³»äººå§“åæˆ–èŒä½"
            )

            budget_range = st.text_input(
                "é¢„ç®—èŒƒå›´",
                placeholder="50-100ä¸‡",
                help="é¡¹ç›®çš„é¢„ç®—èŒƒå›´ï¼ˆå¦‚æœçŸ¥é“ï¼‰"
            )

            timeline = st.text_input(
                "æ—¶é—´è¦æ±‚",
                placeholder="3ä¸ªæœˆå†…å®Œæˆ",
                help="é¡¹ç›®çš„æ—¶é—´è¦æ±‚"
            )

        # ä¿å­˜å®¢æˆ·ä¿¡æ¯
        client_info = {
            'client_name': client_name,
            'project_name': project_name,
            'industry': industry,
            'contact_person': contact_person,
            'budget_range': budget_range,
            'timeline': timeline
        }

        # è¿‡æ»¤æ‰ç©ºå€¼
        client_info = {k: v for k, v in client_info.items() if v}
        st.session_state.proposal_generation['client_info'] = client_info

    # è‡ªå®šä¹‰æ¨¡æ¿éƒ¨åˆ†
    with st.expander("ğŸ› ï¸ è‡ªå®šä¹‰æ–¹æ¡ˆæ¨¡æ¿ï¼ˆé«˜çº§ï¼‰", expanded=False):
        st.markdown("""
        æ‚¨å¯ä»¥æä¾›è‡ªå®šä¹‰çš„æ–¹æ¡ˆç”Ÿæˆæ¨¡æ¿ã€‚æ¨¡æ¿ä¸­å¯ä½¿ç”¨ä»¥ä¸‹å˜é‡ï¼š
        - `{analysis_report}`: åˆ†ææŠ¥å‘Šå†…å®¹
        - `{capability_docs}`: ä¼ä¸šèƒ½åŠ›æ–‡æ¡£å†…å®¹
        - `{client_info}`: å®¢æˆ·ä¿¡æ¯
        """)

        custom_prompt = st.text_area(
            "è‡ªå®šä¹‰æ–¹æ¡ˆæ¨¡æ¿",
            value=st.session_state.proposal_generation.get('custom_prompt', ''),
            height=400,
            placeholder="è¾“å…¥æ‚¨çš„è‡ªå®šä¹‰æ–¹æ¡ˆç”Ÿæˆæ¨¡æ¿...",
            help="ç•™ç©ºåˆ™ä½¿ç”¨é€‰å®šçš„é¢„è®¾æ¨¡æ¿"
        )

        if custom_prompt:
            st.session_state.proposal_generation['custom_prompt'] = custom_prompt

        # æ¨¡æ¿ç¤ºä¾‹
        if st.button("æŸ¥çœ‹æ¨¡æ¿ç¤ºä¾‹"):
            st.code("""
# é¡¹ç›®å»ºè®®ä¹¦

## ä¸€ã€é¡¹ç›®èƒŒæ™¯
åŸºäºåˆ†ææŠ¥å‘Šï¼š{analysis_report}

## äºŒã€è§£å†³æ–¹æ¡ˆ
[è¯¦ç»†æ–¹æ¡ˆè®¾è®¡]

## ä¸‰ã€æˆ‘ä»¬çš„ä¼˜åŠ¿
{capability_docs}

## å››ã€é¡¹ç›®è®¡åˆ’
[å®æ–½è®¡åˆ’å’Œæ—¶é—´è¡¨]

## äº”ã€æŠ•èµ„ä¸æ”¶ç›Š
[å•†åŠ¡æ¡æ¬¾å’ŒROIåˆ†æ]
""", language='markdown')

    # è¿”å›é…ç½®é€‰é¡¹
    options = {
        'template': selected_template,
        'include_pricing': include_pricing,
        'include_timeline': include_timeline,
        'language': language,
        'client_info': client_info,
        'custom_prompt': custom_prompt if custom_prompt else None
    }

    return options


def perform_proposal_generation(analysis_report: str,
                                analysis_metadata: dict,
                                capability_docs: List[str],
                                options: dict):
    """æ‰§è¡Œæ–¹æ¡ˆç”Ÿæˆ"""
    session_manager = st.session_state.session_manager

    # åˆ›å»ºè¿›åº¦å®¹å™¨
    progress_container = st.container()

    with progress_container:
        progress_bar = st.progress(0)
        status_text = st.empty()

        # åˆå§‹åŒ–è¿›åº¦è·Ÿè¸ª
        st.session_state.proposal_generation['current_progress'] = 0

        try:
            # åˆå§‹åŒ–æ–¹æ¡ˆæœåŠ¡
            status_text.text("æ­£åœ¨åˆå§‹åŒ–æ–¹æ¡ˆç”ŸæˆæœåŠ¡...")
            progress_bar.progress(10)
            st.session_state.proposal_generation['current_progress'] = 10

            proposal_service = ProposalService()

            # å®šä¹‰è¿›åº¦å›è°ƒ
            def progress_callback(msg):
                status_text.text(msg)
                # ä» session state è·å–å½“å‰è¿›åº¦
                current = st.session_state.proposal_generation['current_progress']
                if current < 90:
                    new_progress = min(current + 15, 90)
                    progress_bar.progress(new_progress)
                    st.session_state.proposal_generation['current_progress'] = new_progress

            options['progress_callback'] = progress_callback

            # æ·»åŠ èƒ½åŠ›æ–‡æ¡£åˆ°é€‰é¡¹
            if capability_docs:
                options['capability_docs'] = capability_docs

            # å‡†å¤‡è¾“å…¥æ•°æ®
            input_data = {
                'analysis_report': analysis_report,
                'metadata': analysis_metadata
            }

            # æ‰§è¡Œæ–¹æ¡ˆç”Ÿæˆ
            status_text.text("æ­£åœ¨ç”Ÿæˆæ–¹æ¡ˆ...")
            progress_bar.progress(30)
            st.session_state.proposal_generation['current_progress'] = 30

            start_time = time.time()
            result = proposal_service.process(
                input_data,
                template=options['template'],
                options=options
            )

            progress_bar.progress(100)
            st.session_state.proposal_generation['current_progress'] = 100

            if result.is_success:
                status_text.text("âœ… æ–¹æ¡ˆç”Ÿæˆå®Œæˆï¼")

                # åº”ç”¨å®¢æˆ·ä¿¡æ¯å®šåˆ¶åŒ–
                if options.get('client_info'):
                    result.content = proposal_service.customize_proposal(
                        result.content,
                        options['client_info']
                    )

                # ä¿å­˜ç»“æœåˆ°ä¼šè¯
                session_manager.save_result('proposal', result)
                st.session_state.proposal_generation['proposal_result'] = result

                # æ·»åŠ åˆ°å†å²è®°å½•
                st.session_state.proposal_generation['generation_history'].append({
                    'timestamp': datetime.now(),
                    'template': options['template'],
                    'processing_time': result.processing_time,
                    'has_capability_docs': bool(capability_docs),
                    'result': result
                })

                # è·å–æ–¹æ¡ˆå¤§çº²
                outline = proposal_service.get_proposal_outline(options['template'])
                result.metadata['outline'] = outline

                st.success(f"""
                æ–¹æ¡ˆç”ŸæˆæˆåŠŸï¼
                - ç”Ÿæˆæ—¶é—´: {result.processing_time:.1f} ç§’
                - ä½¿ç”¨æ¨¡å‹: {result.model_used}
                - Tokenä½¿ç”¨: {result.total_tokens:,}
                - é¢„ä¼°è´¹ç”¨: ${result.metadata.get('estimated_cost', 0):.4f}
                """)

                # è‡ªåŠ¨åˆ·æ–°é¡µé¢ä»¥æ˜¾ç¤ºç»“æœ
                time.sleep(1)
                st.rerun()

            else:
                status_text.text("âŒ æ–¹æ¡ˆç”Ÿæˆå¤±è´¥")
                st.error(f"ç”Ÿæˆå¤±è´¥: {result.error}")

        except Exception as e:
            status_text.text("âŒ å‘ç”Ÿé”™è¯¯")
            st.error(f"ç”Ÿæˆè¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯: {str(e)}")

        finally:
            # æ¸…ç†è¿›åº¦æ˜¾ç¤º
            time.sleep(2)
            progress_container.empty()
            # é‡ç½®è¿›åº¦
            st.session_state.proposal_generation['current_progress'] = 0


def show_proposal_result():
    """æ˜¾ç¤ºæ–¹æ¡ˆç”Ÿæˆç»“æœ"""
    result = st.session_state.proposal_generation.get('proposal_result')

    if not result:
        return

    st.markdown("---")
    st.markdown("### ğŸ“„ ç”Ÿæˆçš„æ–¹æ¡ˆ")

    # æ˜¾ç¤ºæ–¹æ¡ˆä¿¡æ¯
    col1, col2, col3, col4 = st.columns(4)

    with col1:
        st.metric("æ–¹æ¡ˆç±»å‹", result.metadata.get('proposal_name', 'æœªçŸ¥'))

    with col2:
        st.metric("ç”Ÿæˆç”¨æ—¶", f"{result.processing_time:.1f} ç§’")

    with col3:
        st.metric("å­—æ•°", f"{result.metadata.get('word_count', 0):,}")

    with col4:
        reading_time = result.metadata.get('estimated_reading_time_minutes', 0)
        st.metric("é¢„è®¡é˜…è¯»", f"{reading_time} åˆ†é’Ÿ")

    # æ–¹æ¡ˆå¤§çº²ï¼ˆå¦‚æœæœ‰ï¼‰
    if 'outline' in result.metadata and result.metadata['outline']:
        with st.expander("ğŸ“‘ æ–¹æ¡ˆå¤§çº²", expanded=True):
            outline = result.metadata['outline']
            for item in outline:
                level = item.get('level', 1)
                indent = "  " * (level - 1)
                st.write(f"{indent}{item['number']}. {item['title']}")
                if 'description' in item:
                    st.caption(f"{indent}   {item['description']}")

    # æ–¹æ¡ˆå†…å®¹æ˜¾ç¤º
    st.markdown("#### ğŸ“ æ–¹æ¡ˆå†…å®¹")

    # æ˜¾ç¤ºé€‰é¡¹
    col1, col2, col3 = st.columns([2, 1, 1])
    with col1:
        display_mode = st.radio(
            "æ˜¾ç¤ºæ¨¡å¼",
            options=['formatted', 'plain'],
            format_func=lambda x: {'formatted': 'æ ¼å¼åŒ–æ˜¾ç¤º', 'plain': 'çº¯æ–‡æœ¬'}.get(x, x),
            horizontal=True
        )

    with col2:
        if st.button("ğŸ“‹ å¤åˆ¶å…¨æ–‡"):
            st.write(result.content)  # Streamlitä¼šè‡ªåŠ¨æ·»åŠ å¤åˆ¶åŠŸèƒ½
            st.success("å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼")

    with col3:
        # æ‰“å°é¢„è§ˆ
        if st.button("ğŸ–¨ï¸ æ‰“å°é¢„è§ˆ"):
            # åœ¨æ–°æ ‡ç­¾é¡µä¸­æ‰“å¼€æ‰“å°å‹å¥½çš„ç‰ˆæœ¬
            st.markdown(f'<a href="data:text/html,{result.content}" target="_blank">åœ¨æ–°çª—å£æ‰“å¼€</a>',
                        unsafe_allow_html=True)

    # æ˜¾ç¤ºæ–¹æ¡ˆå†…å®¹
    if display_mode == 'formatted':
        # ä½¿ç”¨å®¹å™¨æ˜¾ç¤ºæ ¼å¼åŒ–çš„Markdownå†…å®¹
        content_container = st.container()
        with content_container:
            # æ·»åŠ ä¸€äº›æ ·å¼ä»¥æ”¹å–„æ˜¾ç¤ºæ•ˆæœ
            st.markdown("""
            <style>
            .proposal-content {
                line-height: 1.6;
                font-size: 16px;
            }
            .proposal-content h1 { color: #1f77b4; margin-top: 2em; }
            .proposal-content h2 { color: #2c5aa0; margin-top: 1.5em; }
            .proposal-content h3 { color: #3d6db5; margin-top: 1.2em; }
            .proposal-content ul, .proposal-content ol { margin-left: 2em; }
            .proposal-content blockquote { 
                border-left: 4px solid #ddd; 
                padding-left: 1em; 
                color: #666; 
            }
            </style>
            """, unsafe_allow_html=True)

            st.markdown(f'<div class="proposal-content">{result.content}</div>',
                        unsafe_allow_html=True)
    else:
        # çº¯æ–‡æœ¬æ˜¾ç¤º
        st.text_area(
            "æ–¹æ¡ˆå†…å®¹",
            value=result.content,
            height=600,
            disabled=True
        )

    # æ“ä½œæŒ‰é’®
    st.markdown("#### ğŸ’¾ å¯¼å‡ºå’Œä¿å­˜")

    col1, col2, col3, col4 = st.columns(4)

    # å‡†å¤‡æ–‡ä»¶å
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
    proposal_type = result.metadata.get('proposal_type', 'proposal')
    client_name = st.session_state.proposal_generation.get('client_info', {}).get('client_name', '')

    if client_name:
        base_filename = f"{client_name}_{proposal_type}_{timestamp}"
    else:
        base_filename = f"{proposal_type}_{timestamp}"

    with col1:
        # ä¸‹è½½Markdownæ ¼å¼
        filename_md = f"{base_filename}.md"

        st.download_button(
            label="ğŸ“¥ ä¸‹è½½(Markdown)",
            data=result.content,
            file_name=filename_md,
            mime="text/markdown",
            use_container_width=True
        )

    with col2:
        # ä¸‹è½½çº¯æ–‡æœ¬æ ¼å¼
        plain_text = markdown_to_text(result.content)
        filename_txt = f"{base_filename}.txt"

        st.download_button(
            label="ğŸ“¥ ä¸‹è½½(TXT)",
            data=plain_text,
            file_name=filename_txt,
            mime="text/plain",
            use_container_width=True
        )

    with col3:
        # ä¸‹è½½å®Œæ•´æ•°æ®ï¼ˆJSONï¼‰
        export_data = {
            'proposal': result.content,
            'metadata': result.metadata,
            'client_info': st.session_state.proposal_generation.get('client_info', {}),
            'generation_info': {
                'processing_time': result.processing_time,
                'model_used': result.model_used,
                'tokens_consumed': result.tokens_consumed,
                'timestamp': datetime.now().isoformat()
            }
        }

        filename_json = f"{base_filename}_complete.json"
        json_str = json.dumps(export_data, ensure_ascii=False, indent=2)

        st.download_button(
            label="ğŸ“¥ ä¸‹è½½(å®Œæ•´æ•°æ®)",
            data=json_str,
            file_name=filename_json,
            mime="application/json",
            use_container_width=True
        )

    with col4:
        # é‡æ–°ç”Ÿæˆ
        if st.button("ğŸ”„ é‡æ–°ç”Ÿæˆ", use_container_width=True):
            st.session_state.proposal_generation['proposal_result'] = None
            st.rerun()


def show_generation_history():
    """æ˜¾ç¤ºç”Ÿæˆå†å²"""
    history = st.session_state.proposal_generation.get('generation_history', [])

    if not history:
        return

    st.markdown("---")
    st.markdown("### ğŸ“š ç”Ÿæˆå†å²")

    # æŒ‰æ—¶é—´å€’åºæ˜¾ç¤ºæœ€è¿‘çš„ç”Ÿæˆè®°å½•
    for item in reversed(history[-5:]):  # åªæ˜¾ç¤ºæœ€è¿‘5æ¡
        template_name = ProposalService.PROPOSAL_TYPES.get(
            item['template'], {}
        ).get('name', item['template'])

        extra_info = []
        if item.get('has_capability_docs'):
            extra_info.append("å«èƒ½åŠ›æ–‡æ¡£")

        title = f"{template_name} - {item['timestamp'].strftime('%H:%M:%S')}"
        if extra_info:
            title += f" ({', '.join(extra_info)})"

        with st.expander(title, expanded=False):
            st.text(f"ç”Ÿæˆæ—¶é—´: {item['processing_time']:.1f} ç§’")
            st.text(f"æ–¹æ¡ˆé•¿åº¦: {len(item['result'].content):,} å­—ç¬¦")

            col1, col2 = st.columns(2)
            with col1:
                if st.button(f"ä½¿ç”¨æ­¤æ–¹æ¡ˆ", key=f"use_{item['timestamp']}"):
                    st.session_state.proposal_generation['proposal_result'] = item['result']
                    st.rerun()

            with col2:
                if st.button(f"æŸ¥çœ‹è¯¦æƒ…", key=f"view_{item['timestamp']}"):
                    with st.container():
                        st.markdown("**æ–¹æ¡ˆé¢„è§ˆ:**")
                        st.text_area(
                            "å†…å®¹",
                            value=truncate_text(item['result'].content, 1000),
                            height=300,
                            disabled=True,
                            key=f"preview_{item['timestamp']}"
                        )


def main():
    """ä¸»å‡½æ•°"""
    # åœ¨é¡µé¢é¡¶éƒ¨æ£€æŸ¥API Keyè®¾ç½®
    check_api_key_setup()

    # åˆå§‹åŒ–é¡µé¢çŠ¶æ€
    initialize_page_state()

    # é¡µé¢æ ‡é¢˜
    st.title("ğŸ“‹ æ–¹æ¡ˆç”Ÿæˆ")
    st.markdown("åŸºäºåˆ†æç»“æœç”Ÿæˆä¸“ä¸šçš„å•†ä¸šæ–¹æ¡ˆå’Œé¡¹ç›®å»ºè®®ä¹¦")

    # æ˜¾ç¤ºç”Ÿæˆç»“æœï¼ˆå¦‚æœæœ‰ï¼‰
    if st.session_state.proposal_generation.get('proposal_result'):
        show_proposal_result()
        show_generation_history()
    else:
        # è·å–åˆ†ææŠ¥å‘Š
        analysis_report, analysis_metadata = show_analysis_source_section()

        if analysis_report:
            st.markdown("---")

            # ä¼ä¸šèƒ½åŠ›æ–‡æ¡£
            capability_docs = show_capability_docs_section()

            st.markdown("---")

            # æ–¹æ¡ˆé…ç½®
            options = show_proposal_configuration()

            st.markdown("---")

            # ç”Ÿæˆæ–¹æ¡ˆæŒ‰é’®
            col1, col2, col3 = st.columns([2, 1, 2])
            with col2:
                button_text = "ğŸš€ ç”Ÿæˆæ–¹æ¡ˆ"
                if capability_docs:
                    button_text += f" ({len(capability_docs)}ä»½å‚è€ƒ)"

                if st.button(
                        button_text,
                        type="primary",
                        use_container_width=True,
                        disabled=st.session_state.proposal_generation.get('processing', False)
                ):
                    st.session_state.proposal_generation['processing'] = True
                    perform_proposal_generation(
                        analysis_report,
                        analysis_metadata,
                        capability_docs,
                        options
                    )
                    st.session_state.proposal_generation['processing'] = False

        # æ˜¾ç¤ºå†å²è®°å½•
        show_generation_history()

    # ä¾§è¾¹æ ä¿¡æ¯
    with st.sidebar:
        st.markdown("### ğŸ’¡ ä½¿ç”¨æç¤º")
        st.info("""
**æ–¹æ¡ˆç±»å‹é€‰æ‹©**ï¼š
- é¡¹ç›®å»ºè®®ä¹¦ï¼šå®Œæ•´çš„é¡¹ç›®æ–¹æ¡ˆ
- å•†åŠ¡æŠ¥ä»·ï¼šé‡ç‚¹åœ¨ä»·æ ¼å’ŒæœåŠ¡
- è§£å†³æ–¹æ¡ˆç®€æŠ¥ï¼šç²¾ç®€ç‰ˆæ–¹æ¡ˆ

**ä¼ä¸šèƒ½åŠ›æ–‡æ¡£**ï¼š
- ä¸Šä¼ å…¬å¸ä»‹ç»ã€æ¡ˆä¾‹ç­‰
- ç³»ç»Ÿä¼šè‡ªåŠ¨å¼•ç”¨ç›¸å…³å†…å®¹
- å¢å¼ºæ–¹æ¡ˆçš„è¯´æœåŠ›

**å®¢æˆ·ä¿¡æ¯**ï¼š
- å¡«å†™å®¢æˆ·ä¿¡æ¯ä¸ªæ€§åŒ–æ–¹æ¡ˆ
- è‡ªåŠ¨æ›¿æ¢å®¢æˆ·åç§°ç­‰ä¿¡æ¯

**å¯¼å‡ºæ ¼å¼**ï¼š
- Markdownï¼šä¿ç•™æ ¼å¼
- TXTï¼šçº¯æ–‡æœ¬ï¼Œä¾¿äºç¼–è¾‘
- JSONï¼šåŒ…å«å®Œæ•´æ•°æ®
""")

        # æ–¹æ¡ˆæ¨¡æ¿è¯´æ˜
        if st.button("ğŸ“– æŸ¥çœ‹æ–¹æ¡ˆç»“æ„"):
            proposal_type = st.session_state.proposal_generation.get('current_template', 'project_proposal')
            proposal_info = ProposalService.PROPOSAL_TYPES.get(proposal_type, {})

            st.markdown(f"### {proposal_info.get('name', 'æ–¹æ¡ˆ')}ç»“æ„")

            sections = proposal_info.get('sections', [])
            for i, section in enumerate(sections, 1):
                st.write(f"{i}. {section}")


if __name__ == "__main__":
    main()

--- File: pages/4_ğŸš€_One_Click_Generation.py ---
#!/usr/bin/env python
# -*- coding: utf-8 -*-
"""
æ–‡ä»¶è·¯å¾„: smart_proposal_engine/pages/4_ğŸš€_One_Click_Generation.py
åŠŸèƒ½è¯´æ˜: ä¸€é”®ç”Ÿæˆé¡µé¢ï¼Œå®ç°ä»è¾“å…¥åˆ°æ–¹æ¡ˆçš„ç«¯åˆ°ç«¯å¤„ç†
ä½œè€…: SmartProposal Team
åˆ›å»ºæ—¥æœŸ: 2025-06-27
æœ€åä¿®æ”¹: 2025-06-29
ç‰ˆæœ¬: 1.1.0
"""

import os
import sys
import streamlit as st
from pathlib import Path
from datetime import datetime
import time
import json
import zipfile
from typing import List, Dict, Optional, Any, Tuple
import shutil

# æ·»åŠ é¡¹ç›®æ ¹ç›®å½•åˆ°ç³»ç»Ÿè·¯å¾„
sys.path.insert(0, os.path.dirname(os.path.dirname(os.path.abspath(__file__))))

from core.document_processor import DocumentProcessor
from core.session_manager import SessionManager
from services.analysis_service import DeepAnalysisService
from services.proposal_service import ProposalService
from services.document_service import DocumentService
from utils.file_utils import (
    save_uploaded_file,
    get_file_metadata,
    format_file_size,
    create_unique_filename,
    ensure_directory_exists,
    validate_file_size,
    validate_file_format,
    create_temp_directory,
    cleanup_directory
)
from utils.format_utils import (
    format_duration,
    format_timestamp,
    format_percentage,
    format_table_text
)
from utils.validation_utils import validate_batch_files
from utils.ui_utils import check_api_key_setup # å¼•å…¥æ£€æŸ¥å‡½æ•°

# é¡µé¢é…ç½®
st.set_page_config(
    page_title="ä¸€é”®ç”Ÿæˆ - SmartProposal Engine",
    page_icon="ğŸš€",
    layout="wide"
)


def initialize_page_state():
    """åˆå§‹åŒ–é¡µé¢çŠ¶æ€"""
    if 'one_click_generation' not in st.session_state:
        st.session_state.one_click_generation = {
            'input_files': [],
            'capability_docs': [],
            'processing_status': 'idle',  # idle, processing, completed, error
            'current_step': None,
            'processing_results': {},
            'workflow_config': {
                'analysis_template': 'customer_interview',
                'proposal_template': 'project_proposal',
                'enable_text_optimization': False,
                'include_capability_docs': True
            },
            'batch_id': None,
            'start_time': None,
            'end_time': None,
            'current_progress': 0,  # æ·»åŠ å…¨å±€è¿›åº¦è·Ÿè¸ª
            'file_progress': {}  # æ·»åŠ æ¯ä¸ªæ–‡ä»¶çš„è¿›åº¦è·Ÿè¸ª
        }

    # ç¡®ä¿SessionManagerå­˜åœ¨
    if 'session_manager' not in st.session_state:
        st.session_state.session_manager = SessionManager()

    # åˆ›å»ºæ‰¹æ¬¡ä¼šè¯
    if not st.session_state.one_click_generation.get('batch_id'):
        batch_id = datetime.now().strftime('%Y%m%d_%H%M%S')
        st.session_state.one_click_generation['batch_id'] = batch_id
        st.session_state.session_manager.create_session(f'batch_{batch_id}')


def show_upload_section():
    """æ˜¾ç¤ºæ–‡ä»¶ä¸Šä¼ éƒ¨åˆ†"""
    st.markdown("### ğŸ“ ä¸Šä¼ æ–‡ä»¶")

    # åˆ›å»ºä¸¤ä¸ªæ ‡ç­¾é¡µ
    tab1, tab2 = st.tabs(["ğŸ“¥ å¾…å¤„ç†æ–‡ä»¶", "ğŸ¢ ä¼ä¸šèƒ½åŠ›æ–‡æ¡£"])

    with tab1:
        st.info("""
        ä¸Šä¼ éœ€è¦å¤„ç†çš„åŸå§‹æ–‡ä»¶ï¼Œæ”¯æŒï¼š
        - **éŸ³é¢‘æ–‡ä»¶**ï¼šå®¢æˆ·è®¿è°ˆå½•éŸ³ã€ä¼šè®®å½•éŸ³ç­‰ï¼ˆm4a, mp3, wavç­‰ï¼‰
        - **æ–‡æ¡£æ–‡ä»¶**ï¼šéœ€æ±‚æ–‡æ¡£ã€ä¼šè®®è®°å½•ç­‰ï¼ˆdocx, pdf, txtç­‰ï¼‰
        """)

        uploaded_input_files = st.file_uploader(
            "é€‰æ‹©è¦å¤„ç†çš„æ–‡ä»¶",
            type=['m4a', 'mp3', 'wav', 'aac', 'ogg', 'flac', 'mp4',
                  'docx', 'pdf', 'txt', 'doc', 'rtf'],
            accept_multiple_files=True,
            key="input_files_uploader",
            help="å¯ä»¥åŒæ—¶ä¸Šä¼ å¤šä¸ªæ–‡ä»¶è¿›è¡Œæ‰¹é‡å¤„ç†"
        )

        if uploaded_input_files:
            # éªŒè¯æ–‡ä»¶
            file_paths = []
            total_size = 0

            st.markdown("#### å·²ä¸Šä¼ çš„å¾…å¤„ç†æ–‡ä»¶:")

            # åˆ›å»ºè¡¨æ ¼æ˜¾ç¤ºæ–‡ä»¶ä¿¡æ¯
            file_info_data = []

            for file in uploaded_input_files:
                # éªŒè¯å•ä¸ªæ–‡ä»¶å¤§å°
                is_valid_size, size_msg = validate_file_size(file.size / (1024 * 1024), 200)

                if is_valid_size:
                    file_info_data.append({
                        "æ–‡ä»¶å": file.name,
                        "ç±»å‹": file.type,
                        "å¤§å°": format_file_size(file.size),
                        "çŠ¶æ€": "âœ… æœ‰æ•ˆ"
                    })
                    total_size += file.size
                else:
                    file_info_data.append({
                        "æ–‡ä»¶å": file.name,
                        "ç±»å‹": file.type,
                        "å¤§å°": format_file_size(file.size),
                        "çŠ¶æ€": f"âŒ {size_msg}"
                    })

            # æ˜¾ç¤ºæ–‡ä»¶åˆ—è¡¨
            for info in file_info_data:
                col1, col2, col3, col4 = st.columns([3, 2, 1, 1])
                with col1:
                    st.text(info["æ–‡ä»¶å"])
                with col2:
                    st.caption(info["ç±»å‹"])
                with col3:
                    st.caption(info["å¤§å°"])
                with col4:
                    st.caption(info["çŠ¶æ€"])

            # æ˜¾ç¤ºæ±‡æ€»ä¿¡æ¯
            st.caption(f"æ€»è®¡: {len(uploaded_input_files)} ä¸ªæ–‡ä»¶, {format_file_size(total_size)}")

            # ä¿å­˜æœ‰æ•ˆæ–‡ä»¶
            valid_files = [f for f, info in zip(uploaded_input_files, file_info_data)
                           if "âœ…" in info["çŠ¶æ€"]]
            st.session_state.one_click_generation['input_files'] = valid_files

    with tab2:
        st.info("""
        ä¸Šä¼ ä¼ä¸šä»‹ç»ã€æˆåŠŸæ¡ˆä¾‹ã€èµ„è´¨è¯æ˜ç­‰æ–‡æ¡£ï¼Œç³»ç»Ÿå°†åœ¨ç”Ÿæˆæ–¹æ¡ˆæ—¶æ™ºèƒ½å¼•ç”¨ï¼Œ
        å¢å¼ºæ–¹æ¡ˆçš„ä¸“ä¸šæ€§å’Œè¯´æœåŠ›ã€‚ï¼ˆå¯é€‰ï¼‰
        """)

        uploaded_capability_docs = st.file_uploader(
            "é€‰æ‹©ä¼ä¸šèƒ½åŠ›æ–‡æ¡£",
            type=['docx', 'pdf', 'txt', 'md'],
            accept_multiple_files=True,
            key="capability_docs_uploader",
            help="è¿™äº›æ–‡æ¡£å°†ä½œä¸ºç”Ÿæˆæ–¹æ¡ˆçš„å‚è€ƒèµ„æ–™"
        )

        if uploaded_capability_docs:
            st.markdown("#### å·²ä¸Šä¼ çš„èƒ½åŠ›æ–‡æ¡£:")

            doc_info_data = []
            for doc in uploaded_capability_docs:
                doc_info_data.append({
                    "æ–‡ä»¶å": doc.name,
                    "å¤§å°": format_file_size(doc.size)
                })

            # æ˜¾ç¤ºæ–‡æ¡£åˆ—è¡¨
            for info in doc_info_data:
                col1, col2 = st.columns([4, 1])
                with col1:
                    st.text(f"ğŸ“„ {info['æ–‡ä»¶å']}")
                with col2:
                    st.caption(info['å¤§å°'])

            st.session_state.one_click_generation['capability_docs'] = uploaded_capability_docs

    # è¿”å›æ–‡ä»¶ç»Ÿè®¡
    input_files = st.session_state.one_click_generation.get('input_files', [])
    capability_docs = st.session_state.one_click_generation.get('capability_docs', [])

    return input_files, capability_docs


def show_workflow_configuration():
    """æ˜¾ç¤ºå·¥ä½œæµé…ç½®éƒ¨åˆ†"""
    st.markdown("### âš™ï¸ å¤„ç†é…ç½®")

    config = st.session_state.one_click_generation['workflow_config']

    col1, col2 = st.columns(2)

    with col1:
        # åˆ†æé…ç½®
        st.markdown("#### ğŸ” åˆ†æè®¾ç½®")

        # åˆ†ææ¨¡æ¿é€‰æ‹©
        analysis_service = DeepAnalysisService()
        scenarios = analysis_service.ANALYSIS_SCENARIOS
        template_options = list(scenarios.keys())
        template_names = [scenarios[key]['name'] for key in template_options]

        selected_analysis_index = st.selectbox(
            "åˆ†æåœºæ™¯",
            range(len(template_options)),
            format_func=lambda x: template_names[x],
            index=template_options.index(config['analysis_template']),
            key="analysis_template_select",
            help="é€‰æ‹©é€‚åˆçš„åˆ†æåœºæ™¯"
        )

        config['analysis_template'] = template_options[selected_analysis_index]

        # æ–‡æœ¬ä¼˜åŒ–é€‰é¡¹ï¼ˆä»…å¯¹éŸ³é¢‘æ–‡ä»¶æœ‰æ•ˆï¼‰
        config['enable_text_optimization'] = st.checkbox(
            "å¯ç”¨è½¬å½•æ–‡æœ¬ä¼˜åŒ–",
            value=config['enable_text_optimization'],
            help="ä½¿ç”¨AIä¼˜åŒ–éŸ³é¢‘è½¬å½•çš„æ–‡æœ¬è´¨é‡ï¼ˆä¼šå¢åŠ å¤„ç†æ—¶é—´ï¼‰"
        )

        # è¯´è¯äººè¯†åˆ«é€‰é¡¹
        config['enable_speaker_diarization'] = st.checkbox(
            "å¯ç”¨è¯´è¯äººè¯†åˆ«",
            value=True,
            help="è¯†åˆ«å¹¶åŒºåˆ†ä¸åŒçš„è¯´è¯äººï¼ˆé€‚ç”¨äºå¤šäººå¯¹è¯ï¼‰"
        )

    with col2:
        # æ–¹æ¡ˆç”Ÿæˆé…ç½®
        st.markdown("#### ğŸ“ æ–¹æ¡ˆè®¾ç½®")

        # æ–¹æ¡ˆæ¨¡æ¿é€‰æ‹©
        proposal_service = ProposalService()
        proposal_types = proposal_service.PROPOSAL_TYPES
        proposal_options = list(proposal_types.keys())
        proposal_names = [proposal_types[key]['name'] for key in proposal_options]

        selected_proposal_index = st.selectbox(
            "æ–¹æ¡ˆç±»å‹",
            range(len(proposal_options)),
            format_func=lambda x: proposal_names[x],
            index=proposal_options.index(config['proposal_template']),
            key="proposal_template_select",
            help="é€‰æ‹©è¦ç”Ÿæˆçš„æ–¹æ¡ˆç±»å‹"
        )

        config['proposal_template'] = proposal_options[selected_proposal_index]

        # æ˜¯å¦ä½¿ç”¨èƒ½åŠ›æ–‡æ¡£
        has_capability_docs = len(st.session_state.one_click_generation.get('capability_docs', [])) > 0
        config['include_capability_docs'] = st.checkbox(
            f"å¼•ç”¨ä¼ä¸šèƒ½åŠ›æ–‡æ¡£ ({len(st.session_state.one_click_generation.get('capability_docs', []))}ä»½)",
            value=config['include_capability_docs'] and has_capability_docs,
            disabled=not has_capability_docs,
            help="åœ¨æ–¹æ¡ˆä¸­å¼•ç”¨ä¸Šä¼ çš„ä¼ä¸šèƒ½åŠ›æ–‡æ¡£"
        )

        # è¾“å‡ºè¯­è¨€
        config['output_language'] = st.selectbox(
            "è¾“å‡ºè¯­è¨€",
            options=['zh', 'en'],
            format_func=lambda x: {'zh': 'ä¸­æ–‡', 'en': 'English'}.get(x, x),
            help="æ–¹æ¡ˆçš„è¾“å‡ºè¯­è¨€"
        )

    # é«˜çº§è®¾ç½®
    with st.expander("ğŸ”§ é«˜çº§è®¾ç½®", expanded=False):
        col1, col2, col3 = st.columns(3)

        with col1:
            config['max_workers'] = st.number_input(
                "å¹¶å‘å¤„ç†æ•°",
                min_value=1,
                max_value=5,
                value=1,
                help="åŒæ—¶å¤„ç†çš„æ–‡ä»¶æ•°é‡ï¼ˆå»ºè®®ä¿æŒä¸º1ä»¥é¿å…APIé™åˆ¶ï¼‰"
            )

        with col2:
            config['save_intermediate_results'] = st.checkbox(
                "ä¿å­˜ä¸­é—´ç»“æœ",
                value=True,
                help="ä¿å­˜æ¯ä¸ªå¤„ç†æ­¥éª¤çš„ç»“æœ"
            )

        with col3:
            config['auto_cleanup'] = st.checkbox(
                "è‡ªåŠ¨æ¸…ç†ä¸´æ—¶æ–‡ä»¶",
                value=True,
                help="å¤„ç†å®Œæˆåè‡ªåŠ¨æ¸…ç†ä¸´æ—¶æ–‡ä»¶"
            )

    # å®¢æˆ·ä¿¡æ¯ï¼ˆå¯é€‰ï¼‰
    st.markdown("#### ğŸ‘¤ å®¢æˆ·ä¿¡æ¯ï¼ˆå¯é€‰ï¼‰")
    col1, col2, col3 = st.columns(3)

    with col1:
        config['client_name'] = st.text_input(
            "å®¢æˆ·åç§°",
            placeholder="XXç§‘æŠ€æœ‰é™å…¬å¸",
            help="å°†åœ¨æ–¹æ¡ˆä¸­ä½¿ç”¨çš„å®¢æˆ·åç§°"
        )

    with col2:
        config['project_name'] = st.text_input(
            "é¡¹ç›®åç§°",
            placeholder="æ™ºèƒ½åŒ–å‡çº§é¡¹ç›®",
            help="é¡¹ç›®çš„æ­£å¼åç§°"
        )

    with col3:
        config['contact_person'] = st.text_input(
            "è”ç³»äºº",
            placeholder="å¼ æ€»",
            help="ä¸»è¦è”ç³»äºº"
        )

    # æ›´æ–°é…ç½®
    st.session_state.one_click_generation['workflow_config'] = config

    return config


def process_single_file(file, file_index: int, total_files: int,
                        config: dict, progress_callback) -> Dict[str, Any]:
    """å¤„ç†å•ä¸ªæ–‡ä»¶çš„å®Œæ•´æµç¨‹"""
    results = {
        'file_name': file.name,
        'file_index': file_index,
        'steps': {},
        'success': False,
        'error': None
    }

    temp_dir = None

    # åˆå§‹åŒ–è¯¥æ–‡ä»¶çš„è¿›åº¦è·Ÿè¸ª
    file_key = f"file_{file_index}"
    st.session_state.one_click_generation['file_progress'][file_key] = 0

    try:
        # æ­¥éª¤1: ä¿å­˜æ–‡ä»¶
        progress_callback(f"[{file_index + 1}/{total_files}] æ­£åœ¨ä¿å­˜æ–‡ä»¶: {file.name}")

        batch_id = st.session_state.one_click_generation['batch_id']
        temp_dir = Path("temp") / batch_id / f"file_{file_index}"
        ensure_directory_exists(temp_dir)

        success, file_path, message = save_uploaded_file(file, temp_dir)
        if not success:
            raise Exception(f"æ–‡ä»¶ä¿å­˜å¤±è´¥: {message}")

        # æ­¥éª¤2: æ–‡æ¡£å¤„ç†ï¼ˆè½¬å½•æˆ–æå–æ–‡æœ¬ï¼‰
        progress_callback(f"[{file_index + 1}/{total_files}] æ­£åœ¨å¤„ç†æ–‡ä»¶å†…å®¹...")

        processor = DocumentProcessor()

        # åˆ›å»ºæ–‡ä»¶ç‰¹å®šçš„è¿›åº¦å›è°ƒ
        def file_progress_callback(msg):
            progress_callback(f"[{file_index + 1}/{total_files}] {msg}")
            # æ›´æ–°æ–‡ä»¶è¿›åº¦
            current = st.session_state.one_click_generation['file_progress'][file_key]
            if current < 90:
                new_progress = min(current + 10, 90)
                st.session_state.one_click_generation['file_progress'][file_key] = new_progress

        process_options = {
            'enable_speaker_diarization': config.get('enable_speaker_diarization', True),
            'enable_text_optimization': config.get('enable_text_optimization', False),
            'max_segment_duration_minutes': 20,
            'extract_metadata': True,
            'progress_callback': file_progress_callback
        }

        process_result = processor.process_file(file_path, process_options)

        if not process_result.is_success:
            raise Exception(f"æ–‡ä»¶å¤„ç†å¤±è´¥: {process_result.error}")

        results['steps']['processing'] = {
            'success': True,
            'content_length': len(process_result.content),
            'processing_time': process_result.processing_time,
            'file_type': process_result.source_type
        }

        # æ­¥éª¤3: æ·±åº¦åˆ†æ
        progress_callback(f"[{file_index + 1}/{total_files}] æ­£åœ¨è¿›è¡Œæ·±åº¦åˆ†æ...")

        analysis_service = DeepAnalysisService()
        analysis_options = {
            'template': config['analysis_template'],
            'include_recommendations': True,
            'output_format': 'markdown',
            'progress_callback': file_progress_callback
        }

        analysis_result = analysis_service.process(
            process_result.content,
            template=config['analysis_template'],
            options=analysis_options
        )

        if not analysis_result.is_success:
            raise Exception(f"åˆ†æå¤±è´¥: {analysis_result.error}")

        results['steps']['analysis'] = {
            'success': True,
            'template_used': config['analysis_template'],
            'processing_time': analysis_result.processing_time,
            'tokens_used': analysis_result.total_tokens
        }

        # æ­¥éª¤4: æ–¹æ¡ˆç”Ÿæˆ
        progress_callback(f"[{file_index + 1}/{total_files}] æ­£åœ¨ç”Ÿæˆæ–¹æ¡ˆ...")

        proposal_service = ProposalService()
        proposal_options = {
            'template': config['proposal_template'],
            'language': config.get('output_language', 'zh'),
            'progress_callback': file_progress_callback
        }

        # æ·»åŠ å®¢æˆ·ä¿¡æ¯
        client_info = {}
        if config.get('client_name'):
            client_info['client_name'] = config['client_name']
        if config.get('project_name'):
            client_info['project_name'] = config['project_name']
        if config.get('contact_person'):
            client_info['contact_person'] = config['contact_person']

        if client_info:
            proposal_options['client_info'] = client_info

        # æ·»åŠ èƒ½åŠ›æ–‡æ¡£
        if config.get('include_capability_docs') and st.session_state.one_click_generation.get('capability_docs'):
            # å¤„ç†èƒ½åŠ›æ–‡æ¡£
            capability_paths = []
            for doc in st.session_state.one_click_generation['capability_docs']:
                doc_path = temp_dir / f"capability_{doc.name}"
                with open(doc_path, 'wb') as f:
                    f.write(doc.getbuffer())
                capability_paths.append(str(doc_path))

            proposal_options['capability_docs'] = capability_paths

        proposal_result = proposal_service.process(
            analysis_result.content,
            template=config['proposal_template'],
            options=proposal_options
        )

        if not proposal_result.is_success:
            raise Exception(f"æ–¹æ¡ˆç”Ÿæˆå¤±è´¥: {proposal_result.error}")

        results['steps']['proposal'] = {
            'success': True,
            'template_used': config['proposal_template'],
            'processing_time': proposal_result.processing_time,
            'tokens_used': proposal_result.total_tokens,
            'word_count': proposal_result.metadata.get('word_count', 0)
        }

        # ä¿å­˜æ‰€æœ‰ç»“æœ
        results['success'] = True
        results['final_results'] = {
            'original_content': process_result.content,
            'analysis_report': analysis_result.content,
            'proposal': proposal_result.content,
            'metadata': {
                'file_metadata': process_result.metadata,
                'analysis_metadata': analysis_result.metadata,
                'proposal_metadata': proposal_result.metadata
            }
        }

        # è®¡ç®—æ€»å¤„ç†æ—¶é—´å’Œæˆæœ¬
        total_time = (process_result.processing_time +
                      analysis_result.processing_time +
                      proposal_result.processing_time)

        total_tokens = (process_result.total_tokens +
                        analysis_result.total_tokens +
                        proposal_result.total_tokens)

        total_cost = (process_result.metadata.get('estimated_cost', 0) +
                      analysis_result.metadata.get('estimated_cost', 0) +
                      proposal_result.metadata.get('estimated_cost', 0))

        results['summary'] = {
            'total_processing_time': total_time,
            'total_tokens': total_tokens,
            'total_cost': total_cost
        }

        # æ ‡è®°æ–‡ä»¶å¤„ç†å®Œæˆ
        st.session_state.one_click_generation['file_progress'][file_key] = 100

    except Exception as e:
        results['success'] = False
        results['error'] = str(e)
        progress_callback(f"[{file_index + 1}/{total_files}] âŒ å¤„ç†å¤±è´¥: {str(e)}")

    finally:
        # æ¸…ç†ä¸´æ—¶æ–‡ä»¶ï¼ˆå¦‚æœé…ç½®äº†è‡ªåŠ¨æ¸…ç†ï¼‰
        if config.get('auto_cleanup', True) and temp_dir and temp_dir.exists():
            try:
                shutil.rmtree(temp_dir)
            except:
                pass

    return results


def process_all_files(input_files: List, config: dict):
    """å¤„ç†æ‰€æœ‰æ–‡ä»¶çš„ä¸»å‡½æ•°"""
    st.session_state.one_click_generation['processing_status'] = 'processing'
    st.session_state.one_click_generation['start_time'] = datetime.now()
    st.session_state.one_click_generation['current_progress'] = 0
    st.session_state.one_click_generation['file_progress'] = {}

    # åˆ›å»ºè¿›åº¦æ˜¾ç¤ºåŒºåŸŸ
    progress_container = st.container()

    with progress_container:
        # æ€»ä½“è¿›åº¦æ¡
        overall_progress = st.progress(0)
        status_text = st.empty()

        # è¯¦ç»†è¿›åº¦ä¿¡æ¯
        detail_container = st.container()

        # å¤„ç†æ¯ä¸ªæ–‡ä»¶
        all_results = []
        total_files = len(input_files)

        for i, file in enumerate(input_files):
            # æ›´æ–°æ€»ä½“è¿›åº¦
            overall_progress_value = i / total_files
            overall_progress.progress(overall_progress_value)
            st.session_state.one_click_generation['current_progress'] = int(overall_progress_value * 100)

            # å®šä¹‰è¿›åº¦å›è°ƒ
            def progress_callback(msg):
                status_text.text(msg)

            # æ˜¾ç¤ºå½“å‰æ–‡ä»¶ä¿¡æ¯
            with detail_container:
                st.markdown(f"### æ­£åœ¨å¤„ç†: {file.name}")
                file_progress = st.progress(0)

                # åˆ›å»ºæ­¥éª¤æŒ‡ç¤ºå™¨
                steps_cols = st.columns(4)
                step_indicators = []

                with steps_cols[0]:
                    step_indicators.append(st.empty())
                    step_indicators[0].info("ğŸ“¥ æ–‡ä»¶å¤„ç†")

                with steps_cols[1]:
                    step_indicators.append(st.empty())
                    step_indicators[1].info("ğŸ” æ·±åº¦åˆ†æ")

                with steps_cols[2]:
                    step_indicators.append(st.empty())
                    step_indicators[2].info("ğŸ“ æ–¹æ¡ˆç”Ÿæˆ")

                with steps_cols[3]:
                    step_indicators.append(st.empty())
                    step_indicators[3].info("ğŸ’¾ ä¿å­˜ç»“æœ")

                # åˆ›å»ºæ–‡ä»¶è¿›åº¦æ›´æ–°å™¨
                def update_file_progress():
                    file_key = f"file_{i}"
                    if file_key in st.session_state.one_click_generation['file_progress']:
                        progress_val = st.session_state.one_click_generation['file_progress'][file_key]
                        file_progress.progress(progress_val / 100.0)

            # å¤„ç†æ–‡ä»¶
            result = process_single_file(file, i, total_files, config, progress_callback)

            # æ›´æ–°æ­¥éª¤æŒ‡ç¤ºå™¨
            if result['success']:
                for indicator in step_indicators:
                    indicator.success("âœ… å®Œæˆ")
            else:
                # æ ¹æ®å¤±è´¥çš„æ­¥éª¤æ›´æ–°æŒ‡ç¤ºå™¨
                if 'processing' in result['steps'] and result['steps']['processing']['success']:
                    step_indicators[0].success("âœ… å®Œæˆ")
                else:
                    step_indicators[0].error("âŒ å¤±è´¥")

                if 'analysis' in result['steps'] and result['steps']['analysis']['success']:
                    step_indicators[1].success("âœ… å®Œæˆ")
                elif 'analysis' in result['steps']:
                    step_indicators[1].error("âŒ å¤±è´¥")

                if 'proposal' in result['steps'] and result['steps']['proposal']['success']:
                    step_indicators[2].success("âœ… å®Œæˆ")
                elif 'proposal' in result['steps']:
                    step_indicators[2].error("âŒ å¤±è´¥")

            all_results.append(result)

            # æ¸…ç†è¯¦ç»†è¿›åº¦æ˜¾ç¤º
            detail_container.empty()

            # æ·»åŠ å»¶è¿Ÿé¿å…APIé™åˆ¶
            if i < total_files - 1:
                time.sleep(2)

        # æ›´æ–°æœ€ç»ˆçŠ¶æ€
        overall_progress.progress(1.0)
        st.session_state.one_click_generation['current_progress'] = 100
        status_text.text("âœ… æ‰€æœ‰æ–‡ä»¶å¤„ç†å®Œæˆï¼")

    # ä¿å­˜ç»“æœ
    st.session_state.one_click_generation['processing_results'] = all_results
    st.session_state.one_click_generation['processing_status'] = 'completed'
    st.session_state.one_click_generation['end_time'] = datetime.now()

    # æ˜¾ç¤ºå¤„ç†æ‘˜è¦
    show_processing_summary(all_results)


def show_processing_summary(results: List[Dict]):
    """æ˜¾ç¤ºå¤„ç†æ‘˜è¦"""
    st.markdown("---")
    st.markdown("### ğŸ“Š å¤„ç†æ‘˜è¦")

    # è®¡ç®—ç»Ÿè®¡æ•°æ®
    total_files = len(results)
    successful_files = sum(1 for r in results if r['success'])
    failed_files = total_files - successful_files

    # è®¡ç®—æ€»æ—¶é—´
    start_time = st.session_state.one_click_generation.get('start_time')
    end_time = st.session_state.one_click_generation.get('end_time')

    if start_time and end_time:
        total_duration = (end_time - start_time).total_seconds()
    else:
        total_duration = 0

    # æ˜¾ç¤ºå…³é”®æŒ‡æ ‡
    col1, col2, col3, col4 = st.columns(4)

    with col1:
        st.metric(
            "å¤„ç†æ–‡ä»¶æ•°",
            f"{successful_files}/{total_files}",
            delta=f"{format_percentage(successful_files / total_files if total_files > 0 else 0)} æˆåŠŸç‡"
        )

    with col2:
        st.metric(
            "æ€»å¤„ç†æ—¶é—´",
            format_duration(total_duration),
            delta=f"å¹³å‡ {format_duration(total_duration / total_files if total_files > 0 else 0)}/æ–‡ä»¶"
        )

    with col3:
        total_tokens = sum(r.get('summary', {}).get('total_tokens', 0) for r in results if r['success'])
        st.metric(
            "Tokenä½¿ç”¨",
            f"{total_tokens:,}",
            delta="æ€»è®¡"
        )

    with col4:
        total_cost = sum(r.get('summary', {}).get('total_cost', 0) for r in results if r['success'])
        st.metric(
            "é¢„ä¼°è´¹ç”¨",
            f"${total_cost:.2f}",
            delta="USD"
        )

    # æ˜¾ç¤ºè¯¦ç»†ç»“æœ
    if failed_files > 0:
        st.warning(f"æœ‰ {failed_files} ä¸ªæ–‡ä»¶å¤„ç†å¤±è´¥")

        # æ˜¾ç¤ºå¤±è´¥æ–‡ä»¶åˆ—è¡¨
        with st.expander("æŸ¥çœ‹å¤±è´¥æ–‡ä»¶è¯¦æƒ…", expanded=True):
            for result in results:
                if not result['success']:
                    st.error(f"**{result['file_name']}**: {result.get('error', 'æœªçŸ¥é”™è¯¯')}")

    # æ˜¾ç¤ºæˆåŠŸæ–‡ä»¶çš„ç»“æœ
    if successful_files > 0:
        st.success(f"æˆåŠŸå¤„ç† {successful_files} ä¸ªæ–‡ä»¶")

        # å‡†å¤‡ä¸‹è½½
        show_download_section(results)


def show_download_section(results: List[Dict]):
    """æ˜¾ç¤ºä¸‹è½½éƒ¨åˆ†"""
    st.markdown("### ğŸ’¾ ä¸‹è½½ç»“æœ")

    # åˆ›å»ºè¾“å‡ºç›®å½•
    batch_id = st.session_state.one_click_generation['batch_id']
    output_dir = Path("output") / batch_id
    ensure_directory_exists(output_dir)

    # å‡†å¤‡ä¸‹è½½é€‰é¡¹
    col1, col2, col3 = st.columns(3)

    with col1:
        download_format = st.selectbox(
            "é€‰æ‹©ä¸‹è½½æ ¼å¼",
            options=['all', 'proposals_only', 'complete_package'],
            format_func=lambda x: {
                'all': 'æ‰€æœ‰æ–‡ä»¶ï¼ˆåˆ†åˆ«ä¸‹è½½ï¼‰',
                'proposals_only': 'ä»…æ–¹æ¡ˆæ–‡æ¡£',
                'complete_package': 'å®Œæ•´æ•°æ®åŒ…ï¼ˆZIPï¼‰'
            }.get(x, x)
        )

    with col2:
        include_intermediate = st.checkbox(
            "åŒ…å«ä¸­é—´ç»“æœ",
            value=False,
            help="åŒ…å«è½¬å½•æ–‡æœ¬å’Œåˆ†ææŠ¥å‘Š"
        )

    with col3:
        organize_by_client = st.checkbox(
            "æŒ‰å®¢æˆ·ç»„ç»‡",
            value=bool(st.session_state.one_click_generation['workflow_config'].get('client_name')),
            help="ä½¿ç”¨å®¢æˆ·åç§°ç»„ç»‡æ–‡ä»¶"
        )

    # ç”Ÿæˆä¸‹è½½æ–‡ä»¶
    if st.button("ğŸ“¦ ç”Ÿæˆä¸‹è½½æ–‡ä»¶", type="primary", use_container_width=True):
        with st.spinner("æ­£åœ¨å‡†å¤‡ä¸‹è½½æ–‡ä»¶..."):
            download_files = prepare_download_files(
                results,
                output_dir,
                download_format,
                include_intermediate,
                organize_by_client
            )

            if download_files:
                st.success(f"å·²ç”Ÿæˆ {len(download_files)} ä¸ªæ–‡ä»¶")

                # æ˜¾ç¤ºä¸‹è½½æŒ‰é’®
                for file_info in download_files:
                    col1, col2 = st.columns([4, 1])

                    with col1:
                        with open(file_info['path'], 'rb') as f:
                            st.download_button(
                                label=f"ğŸ“¥ {file_info['display_name']}",
                                data=f.read(),
                                file_name=file_info['filename'],
                                mime=file_info['mime_type'],
                                use_container_width=True
                            )

                    with col2:
                        st.caption(file_info['size'])


def prepare_download_files(results: List[Dict],
                           output_dir: Path,
                           format_type: str,
                           include_intermediate: bool,
                           organize_by_client: bool) -> List[Dict]:
    """å‡†å¤‡ä¸‹è½½æ–‡ä»¶"""
    download_files = []

    # è·å–å®¢æˆ·åç§°
    client_name = st.session_state.one_click_generation['workflow_config'].get('client_name', '')
    if organize_by_client and client_name:
        base_dir = output_dir / client_name.replace(' ', '_')
    else:
        base_dir = output_dir

    ensure_directory_exists(base_dir)

    if format_type == 'complete_package':
        # åˆ›å»ºZIPåŒ…
        zip_filename = f"SmartProposal_Package_{st.session_state.one_click_generation['batch_id']}.zip"
        zip_path = output_dir / zip_filename

        with zipfile.ZipFile(zip_path, 'w', zipfile.ZIP_DEFLATED) as zipf:
            for result in results:
                if result['success'] and 'final_results' in result:
                    file_base = Path(result['file_name']).stem

                    # æ·»åŠ æ–¹æ¡ˆ
                    proposal_content = result['final_results']['proposal']
                    proposal_name = f"{file_base}_proposal.md"
                    zipf.writestr(f"proposals/{proposal_name}", proposal_content)

                    if include_intermediate:
                        # æ·»åŠ è½¬å½•æ–‡æœ¬
                        transcript_content = result['final_results']['original_content']
                        transcript_name = f"{file_base}_transcript.txt"
                        zipf.writestr(f"transcripts/{transcript_name}", transcript_content)

                        # æ·»åŠ åˆ†ææŠ¥å‘Š
                        analysis_content = result['final_results']['analysis_report']
                        analysis_name = f"{file_base}_analysis.md"
                        zipf.writestr(f"analysis/{analysis_name}", analysis_content)

                    # æ·»åŠ å…ƒæ•°æ®
                    metadata = {
                        'file_name': result['file_name'],
                        'processing_summary': result.get('summary', {}),
                        'metadata': result['final_results']['metadata']
                    }
                    metadata_name = f"{file_base}_metadata.json"
                    zipf.writestr(f"metadata/{metadata_name}",
                                  json.dumps(metadata, ensure_ascii=False, indent=2))

            # æ·»åŠ æ±‡æ€»æŠ¥å‘Š
            summary_report = generate_summary_report(results)
            zipf.writestr("SUMMARY_REPORT.md", summary_report)

        download_files.append({
            'path': str(zip_path),
            'filename': zip_filename,
            'display_name': f"å®Œæ•´æ•°æ®åŒ… ({len([r for r in results if r['success']])} ä¸ªæ–‡ä»¶)",
            'size': format_file_size(zip_path.stat().st_size),
            'mime_type': 'application/zip'
        })

    else:
        # åˆ†åˆ«ä¿å­˜æ–‡ä»¶
        for result in results:
            if result['success'] and 'final_results' in result:
                file_base = Path(result['file_name']).stem

                if format_type == 'all' or format_type == 'proposals_only':
                    # ä¿å­˜æ–¹æ¡ˆ
                    proposal_content = result['final_results']['proposal']
                    proposal_filename = f"{file_base}_proposal.md"
                    proposal_path = base_dir / proposal_filename

                    with open(proposal_path, 'w', encoding='utf-8') as f:
                        f.write(proposal_content)

                    download_files.append({
                        'path': str(proposal_path),
                        'filename': proposal_filename,
                        'display_name': f"æ–¹æ¡ˆ - {file_base}",
                        'size': format_file_size(proposal_path.stat().st_size),
                        'mime_type': 'text/markdown'
                    })

                if format_type == 'all' and include_intermediate:
                    # ä¿å­˜è½¬å½•æ–‡æœ¬
                    transcript_content = result['final_results']['original_content']
                    transcript_filename = f"{file_base}_transcript.txt"
                    transcript_path = base_dir / transcript_filename

                    with open(transcript_path, 'w', encoding='utf-8') as f:
                        f.write(transcript_content)

                    download_files.append({
                        'path': str(transcript_path),
                        'filename': transcript_filename,
                        'display_name': f"è½¬å½• - {file_base}",
                        'size': format_file_size(transcript_path.stat().st_size),
                        'mime_type': 'text/plain'
                    })

                    # ä¿å­˜åˆ†ææŠ¥å‘Š
                    analysis_content = result['final_results']['analysis_report']
                    analysis_filename = f"{file_base}_analysis.md"
                    analysis_path = base_dir / analysis_filename

                    with open(analysis_path, 'w', encoding='utf-8') as f:
                        f.write(analysis_content)

                    download_files.append({
                        'path': str(analysis_path),
                        'filename': analysis_filename,
                        'display_name': f"åˆ†æ - {file_base}",
                        'size': format_file_size(analysis_path.stat().st_size),
                        'mime_type': 'text/markdown'
                    })

    return download_files


def generate_summary_report(results: List[Dict]) -> str:
    """ç”Ÿæˆæ±‡æ€»æŠ¥å‘Š"""
    report = f"""# SmartProposal Engine æ‰¹å¤„ç†æŠ¥å‘Š

**æ‰¹æ¬¡ID**: {st.session_state.one_click_generation['batch_id']}  
**å¤„ç†æ—¶é—´**: {st.session_state.one_click_generation['start_time'].strftime('%Y-%m-%d %H:%M:%S')} - {st.session_state.one_click_generation['end_time'].strftime('%Y-%m-%d %H:%M:%S')}  
**å¤„ç†é…ç½®**:
- åˆ†ææ¨¡æ¿: {st.session_state.one_click_generation['workflow_config']['analysis_template']}
- æ–¹æ¡ˆæ¨¡æ¿: {st.session_state.one_click_generation['workflow_config']['proposal_template']}
- å®¢æˆ·åç§°: {st.session_state.one_click_generation['workflow_config'].get('client_name', 'æœªæŒ‡å®š')}

## å¤„ç†ç»“æœæ‘˜è¦

| æ–‡ä»¶å | çŠ¶æ€ | å¤„ç†æ—¶é—´ | Tokenä½¿ç”¨ | è´¹ç”¨ |
|--------|------|----------|-----------|------|
"""

    for result in results:
        status = "âœ… æˆåŠŸ" if result['success'] else "âŒ å¤±è´¥"

        if result['success']:
            summary = result.get('summary', {})
            time_str = f"{summary.get('total_processing_time', 0):.1f}ç§’"
            tokens_str = f"{summary.get('total_tokens', 0):,}"
            cost_str = f"${summary.get('total_cost', 0):.4f}"
        else:
            time_str = "-"
            tokens_str = "-"
            cost_str = "-"

        report += f"| {result['file_name']} | {status} | {time_str} | {tokens_str} | {cost_str} |\n"

    # æ·»åŠ ç»Ÿè®¡ä¿¡æ¯
    total_success = sum(1 for r in results if r['success'])
    total_time = sum(r.get('summary', {}).get('total_processing_time', 0) for r in results if r['success'])
    total_tokens = sum(r.get('summary', {}).get('total_tokens', 0) for r in results if r['success'])
    total_cost = sum(r.get('summary', {}).get('total_cost', 0) for r in results if r['success'])

    report += f"""
## ç»Ÿè®¡æ±‡æ€»

- **æˆåŠŸå¤„ç†**: {total_success}/{len(results)} ä¸ªæ–‡ä»¶
- **æ€»å¤„ç†æ—¶é—´**: {format_duration(total_time)}
- **æ€»Tokenä½¿ç”¨**: {total_tokens:,}
- **æ€»è´¹ç”¨**: ${total_cost:.2f}

---
*Generated by SmartProposal Engine*
"""

    return report


def main():
    """ä¸»å‡½æ•°"""
    # åˆå§‹åŒ–é¡µé¢çŠ¶æ€
    initialize_page_state()

    # é¡µé¢æ ‡é¢˜
    st.title("ğŸš€ ä¸€é”®ç”Ÿæˆ")
    st.markdown("ä»åŸå§‹æ–‡ä»¶åˆ°ä¸“ä¸šæ–¹æ¡ˆçš„ç«¯åˆ°ç«¯è‡ªåŠ¨åŒ–å¤„ç†")

    # æ ¹æ®å¤„ç†çŠ¶æ€æ˜¾ç¤ºä¸åŒå†…å®¹
    status = st.session_state.one_click_generation['processing_status']

    if status == 'completed':
        # æ˜¾ç¤ºå¤„ç†ç»“æœ
        results = st.session_state.one_click_generation.get('processing_results', [])
        show_processing_summary(results)

        # é‡æ–°å¼€å§‹æŒ‰é’®
        if st.button("ğŸ”„ å¼€å§‹æ–°çš„æ‰¹å¤„ç†", use_container_width=True):
            # é‡ç½®çŠ¶æ€
            st.session_state.one_click_generation = {
                'input_files': [],
                'capability_docs': [],
                'processing_status': 'idle',
                'current_step': None,
                'processing_results': {},
                'workflow_config': st.session_state.one_click_generation['workflow_config'],
                'batch_id': datetime.now().strftime('%Y%m%d_%H%M%S'),
                'start_time': None,
                'end_time': None,
                'current_progress': 0,
                'file_progress': {}
            }
            st.rerun()

    elif status == 'processing':
        # æ­£åœ¨å¤„ç†ä¸­
        st.info("æ­£åœ¨å¤„ç†ä¸­ï¼Œè¯·ç¨å€™...")
        st.spinner("å¤„ç†å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿæ—¶é—´ï¼Œè¯·å‹¿å…³é—­é¡µé¢")

    else:  # idle
        # æ–‡ä»¶ä¸Šä¼ éƒ¨åˆ†
        input_files, capability_docs = show_upload_section()

        if input_files:
            st.markdown("---")

            # å·¥ä½œæµé…ç½®
            config = show_workflow_configuration()

            st.markdown("---")

            # å¤„ç†é¢„è§ˆ
            st.markdown("### ğŸ“‹ å¤„ç†é¢„è§ˆ")

            # æ˜¾ç¤ºå°†è¦å¤„ç†çš„ä¿¡æ¯
            col1, col2 = st.columns(2)

            with col1:
                st.info(f"""
                **å¾…å¤„ç†æ–‡ä»¶**: {len(input_files)} ä¸ª  
                **èƒ½åŠ›æ–‡æ¡£**: {len(capability_docs)} ä¸ª  
                **åˆ†æåœºæ™¯**: {DeepAnalysisService.ANALYSIS_SCENARIOS.get(config['analysis_template'], {}).get('name', config['analysis_template'])}  
                **æ–¹æ¡ˆç±»å‹**: {ProposalService.PROPOSAL_TYPES.get(config['proposal_template'], {}).get('name', config['proposal_template'])}
                """)

            with col2:
                # é¢„ä¼°å¤„ç†æ—¶é—´
                estimated_time_per_file = 60  # æ¯ä¸ªæ–‡ä»¶çº¦60ç§’
                estimated_total_time = len(input_files) * estimated_time_per_file

                st.info(f"""
                **é¢„è®¡å¤„ç†æ—¶é—´**: {format_duration(estimated_total_time)}  
                **æ–‡æœ¬ä¼˜åŒ–**: {'å¯ç”¨' if config.get('enable_text_optimization') else 'ç¦ç”¨'}  
                **è¾“å‡ºè¯­è¨€**: {'ä¸­æ–‡' if config.get('output_language', 'zh') == 'zh' else 'English'}  
                **å®¢æˆ·**: {config.get('client_name', 'æœªæŒ‡å®š')}
                """)

            # å¼€å§‹å¤„ç†æŒ‰é’®
            col1, col2, col3 = st.columns([2, 1, 2])
            with col2:
                if st.button(
                        "ğŸš€ å¼€å§‹æ‰¹é‡å¤„ç†",
                        type="primary",
                        use_container_width=True,
                        help="å¼€å§‹å¤„ç†æ‰€æœ‰ä¸Šä¼ çš„æ–‡ä»¶"
                ):
                    # å¼€å§‹å¤„ç†
                    process_all_files(input_files, config)
                    st.rerun()

    # ä¾§è¾¹æ ä¿¡æ¯
    with st.sidebar:
        st.markdown("### ğŸ’¡ ä½¿ç”¨æç¤º")
        st.info("""
**æ‰¹é‡å¤„ç†æµç¨‹**ï¼š
1. ä¸Šä¼ åŸå§‹æ–‡ä»¶ï¼ˆéŸ³é¢‘/æ–‡æ¡£ï¼‰
2. ä¸Šä¼ ä¼ä¸šèƒ½åŠ›æ–‡æ¡£ï¼ˆå¯é€‰ï¼‰
3. é…ç½®å¤„ç†å‚æ•°
4. ç‚¹å‡»å¼€å§‹æ‰¹é‡å¤„ç†
5. ç­‰å¾…å¤„ç†å®Œæˆ
6. ä¸‹è½½ç”Ÿæˆçš„æ–¹æ¡ˆ

**å¤„ç†æ­¥éª¤**ï¼š
- æ–‡ä»¶å¤„ç†ï¼šè½¬å½•éŸ³é¢‘æˆ–æå–æ–‡æœ¬
- æ·±åº¦åˆ†æï¼šæå–å•†ä¸šæ´å¯Ÿ
- æ–¹æ¡ˆç”Ÿæˆï¼šç”Ÿæˆä¸“ä¸šæ–‡æ¡£

**æ³¨æ„äº‹é¡¹**ï¼š
- æ¯ä¸ªæ–‡ä»¶ç‹¬ç«‹å¤„ç†
- æ”¯æŒå¤šç§æ–‡ä»¶æ ¼å¼
- è‡ªåŠ¨ä¿å­˜ä¸­é—´ç»“æœ
- å¯æ‰“åŒ…ä¸‹è½½æ‰€æœ‰ç»“æœ
""")

        # æ˜¾ç¤ºå½“å‰æ‰¹æ¬¡ä¿¡æ¯
        if st.session_state.one_click_generation.get('batch_id'):
            st.markdown("---")
            st.markdown("### ğŸ“Š å½“å‰æ‰¹æ¬¡")
            st.text(f"ID: {st.session_state.one_click_generation['batch_id']}")

            if status == 'completed':
                results = st.session_state.one_click_generation.get('processing_results', [])
                success_count = sum(1 for r in results if r['success'])
                st.metric("æˆåŠŸç‡", f"{success_count}/{len(results)}")


if __name__ == "__main__":
    main()

--- File: pages/__init__.py ---

--- File: prompts/__init__.py ---

--- File: prompts/analysis/__init__.py ---

--- File: prompts/analysis/business_negotiation.md ---
# å•†åŠ¡è°ˆåˆ¤æ·±åº¦åˆ†æä¸æˆ˜ç•¥æ¨æ¼”æ¨¡æ¿ v3.0ï¼ˆä¼˜åŒ–å¢å¼ºç‰ˆï¼‰

## 1. è§’è‰²å®šä½ä¸ä¸“ä¸šèƒ½åŠ›

### 1.1 è§’è‰²å®šä¹‰
ä½ æ˜¯ä¸€ä½èµ„æ·±çš„å•†åŠ¡è°ˆåˆ¤æˆ˜ç•¥é¡¾é—®ï¼Œæ‹¥æœ‰15å¹´ä»¥ä¸ŠB2Bå¤æ‚äº¤æ˜“è°ˆåˆ¤ç»éªŒã€‚ä½ ç²¾é€šè°ˆåˆ¤ç†è®ºã€è¡Œä¸ºå¿ƒç†å­¦ã€è·¨æ–‡åŒ–æ²Ÿé€šï¼Œå¹¶å…·å¤‡å°†éç»“æ„åŒ–å¯¹è¯è½¬åŒ–ä¸ºç»“æ„åŒ–æˆ˜ç•¥æ´å¯Ÿçš„å“è¶Šèƒ½åŠ›ã€‚

### 1.2 ä¸“ä¸šçŸ¥è¯†å‚¨å¤‡
- **è°ˆåˆ¤ç†è®ºåŸºç¡€**ï¼šç²¾é€šå“ˆä½›è°ˆåˆ¤é¡¹ç›®(Harvard Negotiation Project)ã€Getting to YesåŸåˆ™ã€Chris Vossçš„æˆ˜æœ¯åŒç†å¿ƒç­‰ä¸»æµè°ˆåˆ¤ç†è®º
- **å¿ƒç†å­¦åº”ç”¨**ï¼šæŒæ¡è®¤çŸ¥åå·®ã€é”šå®šæ•ˆåº”ã€æ¡†æ¶æ•ˆåº”ç­‰å¿ƒç†å­¦åŸç†åœ¨è°ˆåˆ¤ä¸­çš„åº”ç”¨
- **å•†ä¸šæ´å¯Ÿ**ï¼šæ·±è°™ä¸åŒè¡Œä¸šçš„å•†ä¸šæ¨¡å¼ã€ä»·å€¼é“¾åˆ†æã€ç«äº‰æ€åŠ¿
- **è·¨æ–‡åŒ–èƒ½åŠ›**ï¼šäº†è§£ä¸»è¦å•†ä¸šæ–‡åŒ–ï¼ˆé«˜è¯­å¢ƒvsä½è¯­å¢ƒã€ä¸ªäººä¸»ä¹‰vsé›†ä½“ä¸»ä¹‰ç­‰ï¼‰çš„è°ˆåˆ¤é£æ ¼å·®å¼‚
- **åˆ†æå·¥å…·æŒæ¡**ï¼šç†Ÿç»ƒè¿ç”¨SWOTã€Porter's Five Forcesã€Game Theoryç­‰åˆ†ææ¡†æ¶

### 1.3 å·¥ä½œå‡†åˆ™
- **å®¢è§‚ä¸­ç«‹**ï¼šåŸºäºäº‹å®è¿›è¡Œåˆ†æï¼Œé¿å…ä¸»è§‚è‡†æ–­
- **ä»·å€¼å¯¼å‘**ï¼šæ‰€æœ‰åˆ†æå’Œå»ºè®®éƒ½ä»¥ä¸ºå®¢æˆ·åˆ›é€ æœ€å¤§ä»·å€¼ä¸ºç›®æ ‡
- **é£é™©æ„è¯†**ï¼šå……åˆ†è¯„ä¼°æ½œåœ¨é£é™©å¹¶æä¾›é¢„é˜²æªæ–½
- **è¡ŒåŠ¨å¯¼å‘**ï¼šæä¾›å…·ä½“å¯æ‰§è¡Œçš„å»ºè®®è€Œéç©ºæ³›ç†è®º
- **æŒç»­ä¼˜åŒ–**ï¼šæ ¹æ®è°ˆåˆ¤è¿›å±•åŠ¨æ€è°ƒæ•´ç­–ç•¥

### 1.4 æ ¸å¿ƒä»»åŠ¡
å°†æä¾›çš„è°ˆåˆ¤è®°å½•è½¬åŒ–ä¸ºåŒ…å«ä»¥ä¸‹è¦ç´ çš„æˆ˜ç•¥åˆ†ææŠ¥å‘Šï¼š
- å¤šç»´åº¦çš„å±€åŠ¿è¯„ä¼°
- æ·±å…¥çš„å‚ä¸æ–¹å¿ƒç†åˆ†æ
- åŸºäºç†è®ºçš„ç­–ç•¥å»ºè®®
- å¯é‡åŒ–çš„é£é™©è¯„ä¼°
- å…·ä½“çš„è¡ŒåŠ¨è·¯çº¿å›¾
- ä¸ºä¸‹æ¸¸AIè¾…åŠ©æ–¹æ¡ˆç”Ÿæˆæä¾›ç»“æ„åŒ–è¾“å…¥

### 1.5 è¾“å…¥å†…å®¹
```text
{transcript}
```

---

## 2. è°ˆåˆ¤åˆ†æç†è®ºæ¡†æ¶

### 2.1 åˆ†æç»´åº¦è¯´æ˜
æœ¬æ¨¡æ¿é‡‡ç”¨"5P+2C"åˆ†ææ¡†æ¶ï¼š

#### 5Pç»´åº¦
1. **Peopleï¼ˆäººï¼‰**ï¼šå‚ä¸æ–¹åˆ†æã€å†³ç­–é“¾ã€ä¸ªäººåŠ¨æœº
2. **Problemï¼ˆé—®é¢˜ï¼‰**ï¼šæ ¸å¿ƒè®®é¢˜ã€åˆ©ç›Šå†²çªç‚¹ã€å…±åŒç›®æ ‡
3. **Processï¼ˆæµç¨‹ï¼‰**ï¼šè°ˆåˆ¤é˜¶æ®µã€æ—¶é—´çº¿ã€å…³é”®èŠ‚ç‚¹
4. **Powerï¼ˆæƒåŠ›ï¼‰**ï¼šè°ˆåˆ¤ç­¹ç ã€BATNAã€å½±å“åŠ›åˆ†æ
5. **Proposalï¼ˆæ–¹æ¡ˆï¼‰**ï¼šå½“å‰ææ¡ˆã€å¤‡é€‰æ–¹æ¡ˆã€åˆ›æ–°è§£å†³æ–¹æ¡ˆ

#### 2Cç»´åº¦
1. **Contextï¼ˆèƒŒæ™¯ï¼‰**ï¼šå¸‚åœºç¯å¢ƒã€è¡Œä¸šè¶‹åŠ¿ã€å†å²å…³ç³»
2. **Cultureï¼ˆæ–‡åŒ–ï¼‰**ï¼šç»„ç»‡æ–‡åŒ–ã€æ²Ÿé€šé£æ ¼ã€å†³ç­–æ¨¡å¼

### 2.2 åˆ†æåŸåˆ™å‡çº§
1. **è¯æ®é“¾åŸåˆ™**ï¼šæ¯ä¸ªåˆ†æç»“è®ºéƒ½éœ€è¦æ˜ç¡®çš„è¯æ®æ”¯æ’‘
   - ç›´æ¥è¯æ®ï¼šå¯¹è¯ä¸­çš„æ˜ç¡®è¡¨è¿° â†’ æ ‡æ³¨[ç›´æ¥è¯æ®]
   - é—´æ¥è¯æ®ï¼šåŸºäºè¡Œä¸ºæ¨¡å¼çš„æ¨æ–­ â†’ æ ‡æ³¨[é—´æ¥æ¨æ–­]
   - å‡è®¾æ¨æµ‹ï¼šåŸºäºç»éªŒçš„åˆ¤æ–­ â†’ æ ‡æ³¨[ç»éªŒå‡è®¾]

2. **é‡åŒ–ä¼˜å…ˆåŸåˆ™**ï¼š
   - ä¸€çº§é‡åŒ–ï¼šå…·ä½“æ•°å­—ï¼ˆé‡‘é¢ã€ç™¾åˆ†æ¯”ã€æ—¶é—´ï¼‰
   - äºŒçº§é‡åŒ–ï¼šåŒºé—´ä¼°è®¡ï¼ˆå¯èƒ½èŒƒå›´ï¼‰
   - ä¸‰çº§é‡åŒ–ï¼šå®šæ€§è½¬å®šé‡ï¼ˆé«˜ä¸­ä½â†’70%/50%/30%ï¼‰

3. **åŠ¨æ€åˆ†æåŸåˆ™**ï¼š
   - è¯†åˆ«è°ˆåˆ¤æ‰€å¤„é˜¶æ®µ
   - é¢„æµ‹ä¸‹ä¸€é˜¶æ®µèµ°å‘
   - åˆ¶å®šé˜¶æ®µæ€§ç­–ç•¥

4. **å…¨å±€è§†è§’åŸåˆ™**ï¼š
   - å•æ¬¡è°ˆåˆ¤vsé•¿æœŸå…³ç³»
   - å½“å‰äº¤æ˜“vsæˆ˜ç•¥å¸ƒå±€
   - ç›´æ¥åˆ©ç›Švsé—´æ¥ä»·å€¼

### 2.3 ä¿¡æ¯å¤„ç†è§„èŒƒ

#### ä¿¡æ¯å®Œæ•´åº¦åˆ†çº§
- **Açº§ï¼ˆ80-100%ï¼‰**ï¼šæ ¸å¿ƒä¿¡æ¯é½å…¨ï¼Œå¯è¿›è¡Œå…¨é¢åˆ†æ
- **Bçº§ï¼ˆ60-79%ï¼‰**ï¼šä¸»è¦ä¿¡æ¯å…·å¤‡ï¼Œéƒ¨åˆ†æ¨æ–­æ ‡æ³¨
- **Cçº§ï¼ˆ40-59%ï¼‰**ï¼šå…³é”®ä¿¡æ¯ç¼ºå¤±ï¼Œéœ€è°¨æ…åˆ†æ
- **Dçº§ï¼ˆ<40%ï¼‰**ï¼šä¿¡æ¯ä¸¥é‡ä¸è¶³ï¼Œä»…æä¾›æ¡†æ¶å»ºè®®

#### ä¿¡æ¯æ ‡æ³¨ä½“ç³»
```
[ç›´æ¥è¯æ®] - å¯¹è¯ä¸­æ˜ç¡®æåˆ°
[é—´æ¥æ¨æ–­] - åŸºäºè¡Œä¸º/è¯­è¨€æ¨¡å¼æ¨æ–­
[ç»éªŒå‡è®¾] - åŸºäºè¡Œä¸šç»éªŒçš„å‡è®¾
[å¾…ç¡®è®¤] - å…³é”®ä¿¡æ¯ä½†æœªæ˜ç¡®
[ä¿¡æ¯ç¼ºå¤±] - åˆ†ææ‰€éœ€ä½†å®Œå…¨æ²¡æœ‰çš„ä¿¡æ¯
[çŸ›ç›¾ä¿¡æ¯] - å­˜åœ¨å†²çªéœ€è¦æ¾„æ¸…
```

### 2.4 è¾“å‡ºæ§åˆ¶è§„èŒƒï¼ˆå¢å¼ºç‰ˆï¼‰
- **æ‰§è¡Œæ‘˜è¦**ï¼š300-400å­—ï¼ˆåŸ200-300å­—ï¼Œå¢åŠ æ´å¯Ÿæ·±åº¦ï¼‰
- **æ ¸å¿ƒåˆ†æ**ï¼šæ¯ä¸ªç»´åº¦300-500å­—
- **è¡¨æ ¼è§„èŒƒ**ï¼š
  - æ ¸å¿ƒè¡¨æ ¼ï¼šæœ€å¤š15è¡Œï¼ˆåŸ10è¡Œï¼‰
  - è¾…åŠ©è¡¨æ ¼ï¼šæœ€å¤š10è¡Œ
  - æ‰€æœ‰è¡¨æ ¼å¿…é¡»æœ‰"æ•°æ®æ¥æº"åˆ—
- **ç­–ç•¥å»ºè®®**ï¼šåˆ†çŸ­ä¸­é•¿æœŸï¼Œå„3-5é¡¹
- **æ€»ä½“é•¿åº¦**ï¼š3000-5000å­—ï¼ˆåŸ2000-3500å­—ï¼‰
- **é™„ä»¶ææ–™**ï¼šå¯é€‰æä¾›è°ˆåˆ¤å‡†å¤‡ææ–™æ¨¡æ¿

---

## 3. è¾“å‡ºç»“æ„è§„èŒƒï¼ˆå¢å¼ºç‰ˆï¼‰

### 3.1 æ‰§è¡Œæ‘˜è¦ [å¿…å¡«]
```markdown
### è°ˆåˆ¤æ¦‚å†µ
- **è°ˆåˆ¤ä»£å·**ï¼š[ä¾¿äºè¿½è¸ªçš„å”¯ä¸€æ ‡è¯†]
- **è°ˆåˆ¤ä¸»é¢˜**ï¼š[ä¸€å¥è¯è¯´æ˜æ ¸å¿ƒè®®é¢˜]
- **è°ˆåˆ¤é˜¶æ®µ**ï¼š[åˆæ­¥æ¥è§¦/éœ€æ±‚æ¢ç´¢/æ–¹æ¡ˆåå•†/ä»·æ ¼åšå¼ˆ/æœ€ç»ˆæ•²å®š]
- **å…³é”®å‘ç°**ï¼š
  1. [æœ€é‡è¦çš„å‘ç°ï¼Œå½±å“è°ˆåˆ¤æ–¹å‘]
  2. [æ¬¡é‡è¦å‘ç°ï¼Œå½±å“è°ˆåˆ¤ç­–ç•¥]
  3. [å…¶ä»–é‡è¦å‘ç°ï¼Œå½±å“æ‰§è¡Œç»†èŠ‚]
- **ç­–ç•¥å»ºè®®**ï¼š[2-3å¥è¯çš„æ ¸å¿ƒç­–ç•¥æ–¹å‘]
- **ç´§æ€¥è¡ŒåŠ¨**ï¼š[48å°æ—¶å†…å¿…é¡»å®Œæˆçš„1-2é¡¹å…³é”®è¡ŒåŠ¨]

### è°ˆåˆ¤æ€åŠ¿ä»ªè¡¨ç›˜
| ç»´åº¦ | å½“å‰çŠ¶æ€ | è¶‹åŠ¿ | å…³é”®æŒ‡æ ‡ | æ•°æ®æ¥æº |
|------|----------|------|----------|----------|
| èµ¢å•æ¦‚ç‡ | XX% | â†‘/â†’/â†“ | [å½±å“æ¦‚ç‡çš„å…³é”®å› ç´ ] | [ç›´æ¥è¯æ®/é—´æ¥æ¨æ–­] |
| è°ˆåˆ¤è¿›å±• | X/5é˜¶æ®µ | å¿«/æ­£å¸¸/æ…¢ | [æ¨è¿›çš„å…³é”®é‡Œç¨‹ç¢‘] | [åˆ¤æ–­ä¾æ®] |
| ä»·æ ¼å·®è· | XX% | ç¼©å°ä¸­/æ‰©å¤§ä¸­ | [å…·ä½“å·®é¢æˆ–æ¯”ä¾‹] | [æ•°æ®å‡ºå¤„] |
| æ—¶é—´å‹åŠ› | é«˜/ä¸­/ä½ | å¢åŠ /ç¨³å®š/å‡å°‘ | [å…³é”®æ—¶é—´èŠ‚ç‚¹] | [ä¿¡æ¯æ¥æº] |
| ç«äº‰å¼ºåº¦ | 1-10åˆ† | å˜åŒ–è¶‹åŠ¿ | [ä¸»è¦ç«äº‰å¯¹æ‰‹] | [è¯æ®ç±»å‹] |
| å…³ç³»è´¨é‡ | 1-10åˆ† | æ”¹å–„/ç¨³å®š/æ¶åŒ– | [å…³ç³»å…³é”®äº‹ä»¶] | [è§‚å¯Ÿä¾æ®] |
```

### 3.2 å‚ä¸æ–¹æ·±åº¦åˆ†æ [å¿…å¡«]

#### 3.2.1 å†³ç­–é“¾æ¡å›¾è°±
```markdown
### ç»„ç»‡å†³ç­–ç»“æ„
æˆ‘æ–¹ï¼š
CEO â†’ [VP Sales] â†’ [é”€å”®æ€»ç›‘] â†’ [å®¢æˆ·ç»ç†]
     â†˜ [CFO] â†’ [è´¢åŠ¡åˆ†æ]ï¼ˆé¢„ç®—å®¡æ‰¹ï¼‰
     â†˜ [CTO] â†’ [æŠ€æœ¯æ€»ç›‘]ï¼ˆæŠ€æœ¯å¯è¡Œæ€§ï¼‰

å¯¹æ–¹ï¼š
[æœ€ç»ˆå†³ç­–è€…] â†’ [å…³é”®å½±å“è€…] â†’ [æ‰§è¡Œå±‚]
              â†˜ [å…¶ä»–ç›¸å…³æ–¹]

### å…³é”®äººç‰©ç”»åƒ
| å§“å/è§’è‰² | æ‰€å±æ–¹ | å†³ç­–è§’è‰² | ä¸ªäººé£æ ¼ | æ ¸å¿ƒåŠ¨æœº | è°ˆåˆ¤ç«‹åœº | å½±å“ç­–ç•¥å»ºè®® |
|-----------|--------|----------|----------|----------|----------|--------------|
| [å§“å/å¤´è¡”] | æˆ‘æ–¹/å¯¹æ–¹ | å†³ç­–è€…/å½±å“è€…/æ‰§è¡Œè€…/æŠŠå…³è€… | ç†æ€§å‹/å…³ç³»å‹/å¼ºåŠ¿å‹/è°¨æ…å‹ | [ä¸ªäººKPI/èŒä¸šå‘å±•/é£é™©è§„é¿ç­‰] | æ”¯æŒ/ä¸­ç«‹/åå¯¹ | [å¦‚ä½•å½±å“æ­¤äºº] |

### åˆ©ç›Šç›¸å…³æ–¹åˆ†æçŸ©é˜µ
| ç›¸å…³æ–¹ | åˆ©ç›Šè¯‰æ±‚ | å½±å“åŠ›(1-10) | æ”¯æŒåº¦(-5åˆ°+5) | å‚ä¸ç­–ç•¥ |
|--------|----------|--------------|----------------|----------|
| [éƒ¨é—¨/ä¸ªäºº] | [å…·ä½“åˆ©ç›Šç‚¹] | Xåˆ† | +Xæˆ–-X | é‡ç‚¹äº‰å–/ä¿æŒæ²Ÿé€š/é™ä½é˜»åŠ›/æš‚ä¸è€ƒè™‘ |
```

#### 3.2.2 å¿ƒç†åŠ¨æ€åˆ†æ
```markdown
### è°ˆåˆ¤å¿ƒç†çŠ¶æ€è¯„ä¼°
- **å¯¹æ–¹ä¸»å¯¼æƒ…ç»ª**ï¼š[ä¿¡å¿ƒå……è¶³/ç„¦è™‘è§‚æœ›/é˜²å¾¡è°¨æ…/ç§¯æè¿›å–]
- **å‹åŠ›æ¥æºåˆ†æ**ï¼š
  - å†…éƒ¨å‹åŠ›ï¼š[ä¸šç»©/é¢„ç®—/æ—¶é—´/ä¸Šçº§ç­‰]
  - å¤–éƒ¨å‹åŠ›ï¼š[ç«äº‰/å¸‚åœº/æŠ€æœ¯æ›´æ–°ç­‰]
- **å†³ç­–å¿ƒç†é”šç‚¹**ï¼š[å¯¹æ–¹å†³ç­–çš„å…³é”®å¿ƒç†ä¾æ®]
- **å¯åˆ©ç”¨çš„è®¤çŸ¥åå·®**ï¼š
  - é”šå®šæ•ˆåº”æœºä¼šï¼š[å¦‚ä½•è®¾ç½®æœ‰åˆ©é”šç‚¹]
  - æŸå¤±åŒæ¶åˆ©ç”¨ï¼š[å¦‚ä½•æ¡†æ¶åŒ–åˆ©ç›ŠæŸå¤±]
  - ç¤¾ä¼šè®¤åŒè¿ç”¨ï¼š[å¦‚ä½•å±•ç¤ºå…¶ä»–å®¢æˆ·æ¡ˆä¾‹]
```

### 3.3 è°ˆåˆ¤è¦ç´ æ·±åº¦åˆ†æ [å¿…å¡«]

#### 3.3.1 åˆ©ç›Šåˆ†æå‡çº§ç‰ˆ
```markdown
### ç«‹åœºvsåˆ©ç›Šåˆ†æ
| è®®é¢˜ | æˆ‘æ–¹ç«‹åœº | æˆ‘æ–¹æ·±å±‚åˆ©ç›Š | å¯¹æ–¹ç«‹åœº | å¯¹æ–¹æ·±å±‚åˆ©ç›Š | å…±åˆ›ä»·å€¼æœºä¼š |
|------|----------|--------------|----------|--------------|--------------|
| ä»·æ ¼ | [è¡¨é¢è¦æ±‚] | [çœŸå®è€ƒè™‘] | [è¡¨é¢è¦æ±‚] | [çœŸå®è€ƒè™‘] | [åŒèµ¢å¯èƒ½] |
| äº¤æœŸ | [è¡¨é¢è¦æ±‚] | [çœŸå®è€ƒè™‘] | [è¡¨é¢è¦æ±‚] | [çœŸå®è€ƒè™‘] | [ååŒæ–¹æ¡ˆ] |
| æ¡æ¬¾ | [è¡¨é¢è¦æ±‚] | [çœŸå®è€ƒè™‘] | [è¡¨é¢è¦æ±‚] | [çœŸå®è€ƒè™‘] | [åˆ›æ–°æ€è·¯] |

### ä»·å€¼åˆ›é€  vs ä»·å€¼åˆ†é…
- **å¯æ‰©å¤§çš„é¥¼**ï¼š[å“ªäº›æ–¹é¢å¯ä»¥åˆ›é€ æ›´å¤šå…±åŒä»·å€¼]
- **é›¶å’Œåšå¼ˆç‚¹**ï¼š[å“ªäº›æ–¹é¢çº¯ç²¹æ˜¯åˆ©ç›Šåˆ†é…]
- **è½¬æ¢ç­–ç•¥**ï¼š[å¦‚ä½•å°†åˆ†é…é—®é¢˜è½¬åŒ–ä¸ºåˆ›é€ é—®é¢˜]
```

#### 3.3.2 BATNAæ·±åº¦åˆ†æ
```markdown
### BATNAè¯„ä¼°çŸ©é˜µ
| è¯„ä¼°ç»´åº¦ | æˆ‘æ–¹BATNA | å¯¹æ–¹BATNA | ç›¸å¯¹ä¼˜åŠ¿åˆ†æ |
|----------|-----------|-----------|--------------|
| æ–¹æ¡ˆå†…å®¹ | [å…·ä½“æè¿°] | [æ¨æ–­æè¿°] | æˆ‘æ–¹+2/ç›¸å½“/å¯¹æ–¹+2 |
| å®æ–½æˆæœ¬ | [é‡‘é¢/èµ„æº] | [æ¨æ–­] | æˆæœ¬ä¼˜åŠ¿åˆ†æ |
| æ—¶é—´æˆæœ¬ | [æ‰€éœ€æ—¶é—´] | [æ¨æ–­] | æ—¶é—´ä¼˜åŠ¿åˆ†æ |
| æœºä¼šæˆæœ¬ | [æ”¾å¼ƒä»€ä¹ˆ] | [æ¨æ–­] | æœºä¼šæˆæœ¬å¯¹æ¯” |
| è½¬æ¢æˆæœ¬ | [æ›´æ¢æˆæœ¬] | [æ¨æ–­] | ç²˜æ€§åˆ†æ |
| ç»¼åˆè¯„åˆ† | X/10åˆ† | X/10åˆ† | [æ€»ä½“BATNAå¼ºå¼±] |

### BATNAæ”¹å–„ç­–ç•¥
1. **å¼ºåŒ–æˆ‘æ–¹BATNA**ï¼š[å…·ä½“æªæ–½æå‡å¤‡é€‰æ–¹æ¡ˆå¸å¼•åŠ›]
2. **å¼±åŒ–å¯¹æ–¹BATNA**ï¼š[åˆæ³•åˆç†é™ä½å¯¹æ–¹å¤‡é€‰æ–¹æ¡ˆå¯è¡Œæ€§]
3. **BATNAä¿¡æ¯æˆ˜**ï¼š[å¦‚ä½•ç­–ç•¥æ€§é€éœ²/éšè—BATNAä¿¡æ¯]
```

#### 3.3.3 ZOPAç²¾ç¡®è®¡ç®—
```markdown
### å¤šç»´åº¦ZOPAåˆ†æ
| ç»´åº¦ | æˆ‘æ–¹åº•çº¿ | æˆ‘æ–¹ç›®æ ‡ | å¯¹æ–¹åº•çº¿(æ¨æµ‹) | å¯¹æ–¹ç›®æ ‡(æ¨æµ‹) | ZOPAåŒºé—´ | æ¦‚ç‡åˆ†å¸ƒ |
|------|----------|----------|----------------|----------------|-----------|-----------|
| æ€»ä»· | Â¥Xä¸‡ | Â¥Yä¸‡ | Â¥Aä¸‡ | Â¥Bä¸‡ | Â¥[X-B]ä¸‡ | æ­£æ€/åæ€ |
| ä»˜æ¬¾æ¡ä»¶ | X% | Y% | A% | B% | [é‡å åŒºé—´] | åˆ†å¸ƒç±»å‹ |
| æœåŠ¡èŒƒå›´ | [æœ€å°] | [ç†æƒ³] | [æœ€å¤§å¯æ¥å—] | [æœŸæœ›] | [äº¤é›†] | å¯èƒ½æ€§% |

### ZOPAåŠ¨æ€å˜åŒ–é¢„æµ‹
- **æ‰©å¤§ZOPAç­–ç•¥**ï¼š[å¦‚ä½•é€šè¿‡ä»·å€¼åˆ›é€ æ‰©å¤§åè®®ç©ºé—´]
- **ZOPAç§»åŠ¨å› ç´ **ï¼š[ä»€ä¹ˆå› ç´ ä¼šæ”¹å˜åŒæ–¹åº•çº¿]
- **æ—¶é—´å¯¹ZOPAçš„å½±å“**ï¼š[éšæ—¶é—´æ¨ç§»ZOPAå¦‚ä½•å˜åŒ–]
```

### 3.4 è°ˆåˆ¤ç­–ç•¥åˆ¶å®š [å¿…å¡«]

#### 3.4.1 æ€»ä½“æˆ˜ç•¥é€‰æ‹©
```markdown
### æˆ˜ç•¥ç±»å‹å†³ç­–æ ‘
åŸºäºä»¥ä¸‹åˆ†æï¼Œæ¨èé‡‡ç”¨ï¼š[ç«äº‰å‹/åˆä½œå‹/æŠ˜ä¸­å‹/å¤åˆå‹]

å†³ç­–ä¾æ®ï¼š
1. **å…³ç³»é‡è¦æ€§**ï¼š[ä¸€æ¬¡æ€§äº¤æ˜“ or é•¿æœŸåˆä½œ] â†’ å½±å“åˆä½œå€¾å‘
2. **ç›¸å¯¹å®åŠ›**ï¼š[æˆ‘å¼ºå¯¹å¼±/åŠ¿å‡åŠ›æ•Œ/æˆ‘å¼±å¯¹å¼º] â†’ å½±å“ç«äº‰å¯èƒ½
3. **æ—¶é—´å‹åŠ›**ï¼š[æˆ‘æ–¹ç´§æ€¥/å¯¹æ–¹ç´§æ€¥/éƒ½ä¸ç´§æ€¥] â†’ å½±å“ç­–ç•¥é€‰æ‹©
4. **BATNAè´¨é‡**ï¼š[æˆ‘æ–¹ä¼˜/å¯¹æ–¹ä¼˜/éƒ½ä¸€èˆ¬] â†’ å½±å“è°ˆåˆ¤ç­¹ç 
5. **ä»·å€¼åˆ›é€ ç©ºé—´**ï¼š[å¤§/ä¸­/å°] â†’ å½±å“åˆä½œå¿…è¦æ€§

### é˜¶æ®µæ€§ç­–ç•¥è§„åˆ’
| è°ˆåˆ¤é˜¶æ®µ | ä¸»è¦ç›®æ ‡ | å…³é”®ç­–ç•¥ | å…·ä½“æˆ˜æœ¯ | æˆåŠŸæ ‡å¿— |
|----------|----------|----------|----------|----------|
| å¼€å±€é˜¶æ®µ | [å»ºç«‹åŸºè°ƒ] | [ç­–ç•¥é€‰æ‹©] | [3-5ä¸ªå…·ä½“æˆ˜æœ¯] | [å¯è¡¡é‡æŒ‡æ ‡] |
| æ¢ç´¢é˜¶æ®µ | [ä¿¡æ¯æ”¶é›†] | [ç­–ç•¥é€‰æ‹©] | [3-5ä¸ªå…·ä½“æˆ˜æœ¯] | [å¯è¡¡é‡æŒ‡æ ‡] |
| è®®ä»·é˜¶æ®µ | [ä»·å€¼äº‰å–] | [ç­–ç•¥é€‰æ‹©] | [3-5ä¸ªå…·ä½“æˆ˜æœ¯] | [å¯è¡¡é‡æŒ‡æ ‡] |
| æ”¶å®˜é˜¶æ®µ | [è¾¾æˆåè®®] | [ç­–ç•¥é€‰æ‹©] | [3-5ä¸ªå…·ä½“æˆ˜æœ¯] | [å¯è¡¡é‡æŒ‡æ ‡] |
```

#### 3.4.2 æˆ˜æœ¯å·¥å…·ç®±
```markdown
### å³æ—¶å¯ç”¨æˆ˜æœ¯ï¼ˆ24-72å°æ—¶ï¼‰
1. **é”šå®šè®¾ç½®**
   - å…·ä½“åšæ³•ï¼š[å¦‚ä½•è®¾ç½®æœ‰åˆ©çš„è°ˆåˆ¤èµ·ç‚¹]
   - é¢„æœŸæ•ˆæœï¼š[å¯¹æ–¹å¯èƒ½çš„å¿ƒç†é”šå®š]
   - é£é™©æç¤ºï¼š[å¯èƒ½çš„è´Ÿé¢ååº”]

2. **æ¡†æ¶é‡æ„**
   - å½“å‰æ¡†æ¶ï¼š[å¯¹æ–¹å¦‚ä½•å®šä¹‰é—®é¢˜]
   - é‡æ„æ–¹å‘ï¼š[å¦‚ä½•é‡æ–°å®šä¹‰æœ‰åˆ©äºæˆ‘æ–¹]
   - è¯æœ¯å»ºè®®ï¼š["æˆ‘ä»¬å¯ä»¥è¿™æ ·çœ‹è¿™ä¸ªé—®é¢˜..."]

3. **è®®ç¨‹æ§åˆ¶**
   - å»ºè®®è®®ç¨‹ï¼š[è®¨è®ºé¡ºåºå®‰æ’]
   - æ§åˆ¶è¦ç‚¹ï¼š[åœ¨å“ªäº›ç¯èŠ‚æŒæ¡ä¸»åŠ¨]
   - æ—¶é—´åˆ†é…ï¼š[å„è®®é¢˜æ—¶é—´æ¯”ä¾‹]

### ä¸­æœŸæˆ˜æœ¯éƒ¨ç½²ï¼ˆ1-2å‘¨ï¼‰
1. **è”ç›Ÿæ„å»º**
   - æ½œåœ¨ç›Ÿå‹ï¼š[å¯¹æ–¹ç»„ç»‡å†…çš„æ”¯æŒè€…]
   - äº‰å–ç­–ç•¥ï¼š[å¦‚ä½•è·å¾—æ”¯æŒ]
   - ååŒæœºåˆ¶ï¼š[å¦‚ä½•å‘æŒ¥è”ç›Ÿä½œç”¨]

2. **é€‰æ‹©æƒåˆ›é€ **
   - æ–¹æ¡ˆè®¾è®¡ï¼š[æä¾›3ä¸ªå¯é€‰æ–¹æ¡ˆ]
   - å¿ƒç†å½±å“ï¼š[é€‰æ‹©æƒå¯¹å†³ç­–çš„å½±å“]
   - å¼•å¯¼æŠ€å·§ï¼š[å¦‚ä½•å¼•å¯¼é€‰æ‹©]

### é«˜çº§æˆ˜æœ¯å‚¨å¤‡ï¼ˆå¿…è¦æ—¶ä½¿ç”¨ï¼‰
1. **æˆ˜ç•¥æ¨¡ç³Š**
   - é€‚ç”¨åœºæ™¯ï¼š[ä¿¡æ¯ä¸å¯¹ç§°æ—¶]
   - å®æ–½æ–¹æ³•ï¼š[ä¿æŒæŸäº›æ¡æ¬¾çš„çµæ´»æ€§]
   - é€€å‡ºæœºåˆ¶ï¼š[ä½•æ—¶éœ€è¦æ˜ç¡®]

2. **è®®é¢˜æ‰“åŒ…/æ‹†åˆ†**
   - æ‰“åŒ…é€»è¾‘ï¼š[å“ªäº›è®®é¢˜é€‚åˆæ†ç»‘]
   - æ‹†åˆ†æ—¶æœºï¼š[ä½•æ—¶éœ€è¦åˆ†åˆ«è®¨è®º]
   - äº¤æ˜“è®¾è®¡ï¼š[å¦‚ä½•è®¾è®¡package deal]
```

#### 3.4.3 æ²Ÿé€šè„šæœ¬å»ºè®®
```markdown
### å…³é”®æ—¶åˆ»è¯æœ¯æ¨¡æ¿

#### å¼€åœºå®šè°ƒ
"æ„Ÿè°¢å„ä½çš„æ—¶é—´ã€‚æˆ‘ç›¸ä¿¡é€šè¿‡ä»Šå¤©çš„è®¨è®ºï¼Œæˆ‘ä»¬èƒ½æ‰¾åˆ°ä¸€ä¸ªè®©åŒæ–¹éƒ½æ»¡æ„çš„æ–¹æ¡ˆã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯å»ºç«‹é•¿æœŸçš„åˆä½œä¼™ä¼´å…³ç³»ï¼Œè€Œä¸ä»…ä»…æ˜¯å®Œæˆè¿™ä¸€å•äº¤æ˜“ã€‚"

#### æ¢ç´¢éœ€æ±‚
"èƒ½å¦è¯·æ‚¨è¯¦ç»†è¯´æ˜ä¸€ä¸‹ï¼Œåœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œä»€ä¹ˆå¯¹æ‚¨æ¥è¯´æ˜¯æœ€é‡è¦çš„ï¼Ÿé™¤äº†ä»·æ ¼ä¹‹å¤–ï¼Œè¿˜æœ‰å“ªäº›å› ç´ ä¼šå½±å“æ‚¨çš„å†³ç­–ï¼Ÿ"

#### ä»·å€¼å¼ºè°ƒ
"æˆ‘ç†è§£ä»·æ ¼æ˜¯ä¸€ä¸ªé‡è¦è€ƒè™‘å› ç´ ã€‚è®©æˆ‘ä»¬ä¸€èµ·çœ‹çœ‹è¿™ä¸ªæŠ•èµ„èƒ½ä¸ºè´µå…¬å¸å¸¦æ¥çš„ä»·å€¼ï¼š[å…·ä½“ä»·å€¼ç‚¹]ã€‚æ ¹æ®æˆ‘ä»¬çš„ç»éªŒï¼Œè¿™é€šå¸¸èƒ½å¸¦æ¥[X%]çš„æ•ˆç‡æå‡ã€‚"

#### å¼‚è®®å¤„ç†
- ä»·æ ¼å¼‚è®®ï¼š"æˆ‘ç†è§£æ‚¨å¯¹ä»·æ ¼çš„æ‹…å¿§ã€‚è®©æˆ‘ä»¬ä¸€èµ·åˆ†æä¸€ä¸‹æ€»ä½“æ‹¥æœ‰æˆæœ¬(TCO)..."
- æ—¶é—´å¼‚è®®ï¼š"æ—¶é—´ç¡®å®å¾ˆå…³é”®ã€‚æˆ‘ä»¬å¯ä»¥æ¢è®¨é˜¶æ®µæ€§äº¤ä»˜çš„å¯èƒ½æ€§..."
- åŠŸèƒ½å¼‚è®®ï¼š"è¿™æ˜¯ä¸ªå¾ˆå¥½çš„é—®é¢˜ã€‚è®©æˆ‘è§£é‡Šä¸€ä¸‹æˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆå¦‚ä½•æ»¡è¶³è¿™ä¸ªéœ€æ±‚..."

#### è¦æ±‚æ‰¿è¯º
"åŸºäºæˆ‘ä»¬ä»Šå¤©çš„è®¨è®ºï¼Œæ‚¨è§‰å¾—æˆ‘ä»¬ç¦»è¾¾æˆåˆä½œè¿˜æœ‰å“ªäº›é—®é¢˜éœ€è¦è§£å†³ï¼Ÿå¦‚æœè¿™äº›é—®é¢˜éƒ½å¾—åˆ°æ»¡æ„çš„ç­”æ¡ˆï¼Œæˆ‘ä»¬æ˜¯å¦å¯ä»¥åœ¨[æ—¶é—´]å‰æ¨è¿›åˆ°ä¸‹ä¸€æ­¥ï¼Ÿ"
```

### 3.5 è®©æ­¥ç­–ç•¥ä¸äº¤æ¢æ¸…å• [å¿…å¡«]
```markdown
### è®©æ­¥ä»·å€¼è¯„ä¼°çŸ©é˜µ
| è®©æ­¥é¡¹ç›® | å¯¹æˆ‘æ–¹æˆæœ¬ | å¯¹å¯¹æ–¹ä»·å€¼ | äº¤æ¢æ¯”ç‡ | è®©æ­¥é¡ºåº | è§¦å‘æ¡ä»¶ |
|----------|------------|------------|-----------|-----------|----------|
| [ä»˜æ¬¾å‘¨æœŸå»¶é•¿] | ä½(2/10) | é«˜(8/10) | 1:4 | ç¬¬ä¸€æ‰¹ | å¯¹æ–¹priceå‹åŠ›å¤§æ—¶ |
| [å…è´¹åŸ¹è®­] | ä¸­(5/10) | ä¸­(6/10) | 1:1.2 | ç¬¬äºŒæ‰¹ | éœ€è¦å¢åŠ perceived valueæ—¶ |
| [ä»·æ ¼æŠ˜æ‰£5%] | é«˜(8/10) | é«˜(9/10) | 1:1.1 | æœ€å | å…¶ä»–éƒ½ç”¨å°½æ—¶ |

### äº¤æ¢ç­–ç•¥è®¾è®¡
1. **ç­‰ä»·äº¤æ¢åŸåˆ™**
   - æ¯ä¸ªè®©æ­¥å¿…é¡»è·å¾—å¯¹ç­‰æˆ–æ›´é«˜ä»·å€¼å›æŠ¥
   - è®°å½•æ‰€æœ‰è®©æ­¥ä»¥å¤‡åç»­reference

2. **è®©æ­¥èŠ‚å¥æ§åˆ¶**
   - åˆæœŸï¼šå°è®©æ­¥è¯•æ¢å¯¹æ–¹è¯šæ„
   - ä¸­æœŸï¼šä¸­ç­‰è®©æ­¥æ¨åŠ¨è¿›å±•
   - åæœŸï¼šå…³é”®è®©æ­¥è¾¾æˆåè®®

3. **åˆ›é€ æ€§äº¤æ¢é€‰é¡¹**
   - æ—¶é—´æ¢é‡‘é’±ï¼š[å…·ä½“æ–¹æ¡ˆ]
   - èŒƒå›´æ¢ä»·æ ¼ï¼š[å…·ä½“æ–¹æ¡ˆ]
   - é£é™©æ¢æ”¶ç›Šï¼š[å…·ä½“æ–¹æ¡ˆ]
```

### 3.6 é£é™©è¯„ä¼°ä¸é¢„æ¡ˆ [å¿…å¡«]
```markdown
### é£é™©è¯„ä¼°çŸ©é˜µï¼ˆå¢å¼ºç‰ˆï¼‰
| é£é™©ç±»åˆ« | å…·ä½“é£é™© | æ¦‚ç‡ | å½±å“ | é£é™©å€¼ | æ—©æœŸä¿¡å· | é¢„é˜²æªæ–½ | åº”æ€¥é¢„æ¡ˆ |
|----------|----------|------|------|---------|----------|----------|----------|
| è°ˆåˆ¤é£é™© | å¯¹æ–¹ä¸­é€”æ¢äºº | 30% | é«˜ | 9 | å¯¹æ–¹æš—ç¤ºäººäº‹å˜åŠ¨ | å»ºç«‹å¤šå±‚å…³ç³» | å¿«é€Ÿé‡å»ºä¿¡ä»» |
| å•†ä¸šé£é™© | é¢„ç®—è¢«å‰Šå‡ | 20% | é«˜ | 6 | å¯¹æ–¹è´¢åŠ¡è°¨æ…åº¦ä¸Šå‡ | åˆ†é˜¶æ®µåˆåŒ | è°ƒæ•´æ–¹æ¡ˆè§„æ¨¡ |
| ç«äº‰é£é™© | ç«äº‰å¯¹æ‰‹æ¶æ„ç«ä»· | 40% | ä¸­ | 6 | å¯¹æ–¹é¢‘ç¹æåŠç«å“ | å¼ºåŒ–å·®å¼‚åŒ– | ä»·å€¼å†æ•™è‚² |
| æ‰§è¡Œé£é™© | æŠ€æœ¯å®æ–½å»¶æœŸ | 25% | ä¸­ | 5 | æŠ€æœ¯å›¢é˜Ÿèµ„æºç´§å¼  | é¢„ç•™ç¼“å†²æ—¶é—´ | å¤–éƒ¨èµ„æºè¡¥å…… |
| å…³ç³»é£é™© | ä¿¡ä»»å±æœº | 15% | é«˜ | 4.5 | æ²Ÿé€šé¢‘ç‡ä¸‹é™ | å®šæœŸå…³ç³»ç»´æŠ¤ | é«˜å±‚ä»‹å…¥ä¿®å¤ |

### é£é™©åº”å¯¹ç­–ç•¥
- **é£é™©å€¼>6**ï¼šéœ€è¦åˆ¶å®šè¯¦ç»†é¢„æ¡ˆå¹¶æ¯æ—¥ç›‘æ§
- **é£é™©å€¼3-6**ï¼šæ¯å‘¨è¯„ä¼°ï¼Œä¿æŒè­¦æƒ•
- **é£é™©å€¼<3**ï¼šçº³å…¥å¸¸è§„æ£€æŸ¥æ¸…å•
```

### 3.7 è¡ŒåŠ¨è®¡åˆ’ï¼ˆæˆ˜æœ¯çº§ï¼‰ [å¿…å¡«]
```markdown
### åˆ†é˜¶æ®µè¡ŒåŠ¨è·¯çº¿å›¾

#### Phase 1: ç«‹å³è¡ŒåŠ¨ï¼ˆ0-48å°æ—¶ï¼‰
| ä¼˜å…ˆçº§ | è¡ŒåŠ¨é¡¹ | å…·ä½“å†…å®¹ | è´£ä»»äºº | å®Œæˆæ ‡å‡† | æ‰€éœ€èµ„æº |
|--------|--------|----------|--------|----------|----------|
| P0 | ä¿¡æ¯ç¡®è®¤ | å‘å¯¹æ–¹ç¡®è®¤[å…³é”®ä¿¡æ¯] | é”€å”®æ€»ç›‘ | è·å¾—ä¹¦é¢ç¡®è®¤ | é‚®ä»¶æ¨¡æ¿ |
| P0 | å†…éƒ¨å¯¹é½ | å¬å¼€ç­–ç•¥ä¼šè®®ï¼Œç»Ÿä¸€è°ˆåˆ¤ç«‹åœº | é¡¹ç›®ç»ç† | å½¢æˆä¸€é¡µçº¸ç­–ç•¥ | ä¼šè®®å®¤2å°æ—¶ |
| P1 | ç«æƒ…åˆ†æ | è°ƒç ”ç«äº‰å¯¹æ‰‹æœ€æ–°åŠ¨æ€ | å¸‚åœºåˆ†æå¸ˆ | å®Œæˆç«å“åˆ†ææŠ¥å‘Š | è¡Œä¸šæ•°æ®åº“ |

#### Phase 2: çŸ­æœŸæ¨è¿›ï¼ˆ3-7å¤©ï¼‰
| ä¼˜å…ˆçº§ | è¡ŒåŠ¨é¡¹ | å…·ä½“å†…å®¹ | è´£ä»»äºº | å®Œæˆæ ‡å‡† | ä¾èµ–æ¡ä»¶ |
|--------|--------|----------|--------|----------|----------|
| P0 | æ–¹æ¡ˆä¼˜åŒ– | æ ¹æ®åé¦ˆè°ƒæ•´ææ¡ˆ | è§£å†³æ–¹æ¡ˆå›¢é˜Ÿ | æ–°ç‰ˆæœ¬æ–¹æ¡ˆ | Phase 1å®Œæˆ |
| P1 | å…³ç³»æ·±åŒ– | å®‰æ’éæ­£å¼äº¤æµ | å®¢æˆ·ç»ç† | å»ºç«‹ä¸ªäººä¿¡ä»» | å¯¹æ–¹æ—¶é—´ |
| P2 | ææ–™å‡†å¤‡ | åˆ¶ä½œæ¼”ç¤ºææ–™ | å¸‚åœºéƒ¨ | PPT+Demo | æ–¹æ¡ˆç¡®å®š |

#### Phase 3: å†³ç­–æ¨åŠ¨ï¼ˆ1-2å‘¨ï¼‰
[ç»§ç»­ç±»ä¼¼æ ¼å¼]

### å…³é”®è·¯å¾„è¯†åˆ«
```mermaid
graph LR
    A[ä¿¡æ¯ç¡®è®¤] --> B[å†…éƒ¨å¯¹é½]
    B --> C[æ–¹æ¡ˆä¼˜åŒ–]
    C --> D[æ­£å¼ææ¡ˆ]
    D --> E[è°ˆåˆ¤åå•†]
    E --> F[åˆåŒç­¾ç½²]
    
    B --> G[ç«æƒ…åˆ†æ]
    G --> C
    
    C --> H[å…³ç³»ç»´æŠ¤]
    H --> E
```
```

### 3.8 ä¿¡æ¯éœ€æ±‚æ¸…å• [å¿…å¡«]
```markdown
### ä¿¡æ¯ç¼ºå£åˆ†æ

#### ç´§æ€¥ä¿¡æ¯éœ€æ±‚ï¼ˆå½±å“å½“å‰å†³ç­–ï¼‰
| ä¿¡æ¯ç±»åˆ« | å…·ä½“é—®é¢˜ | é‡è¦æ€§ | è·å–æ–¹æ³• | é¢„æœŸç­”æ¡ˆèŒƒå›´ | å¤‡é€‰æ–¹æ¡ˆ |
|----------|----------|---------|----------|--------------|----------|
| é¢„ç®—ä¿¡æ¯ | å¯¹æ–¹çœŸå®é¢„ç®—ä¸Šé™ | å…³é”® | ä¾§é¢äº†è§£/ç›´æ¥è¯¢é—® | XX-XXä¸‡ | è¡Œä¸šå‡å€¼æ¨æ–­ |
| å†³ç­–æµç¨‹ | æœ€ç»ˆå®¡æ‰¹äººæ˜¯è° | å…³é”® | ç»„ç»‡æ¶æ„å›¾åˆ†æ | C-level/VPçº§ | è¯¢é—®å†³ç­–æµç¨‹ |
| æ—¶é—´é™åˆ¶ | å¯¹æ–¹å†…éƒ¨deadline | é‡è¦ | æ—æ•²ä¾§å‡» | XæœˆXæ—¥å‰ | é¡¹ç›®å‘¨æœŸæ¨æ–­ |

#### ä¼˜åŒ–ä¿¡æ¯éœ€æ±‚ï¼ˆæå‡åˆ†æè´¨é‡ï¼‰
| ä¿¡æ¯ç±»åˆ« | å…·ä½“å†…å®¹ | ä»·å€¼è¯´æ˜ | è·å–éš¾åº¦ | è·å–ç­–ç•¥ |
|----------|----------|----------|----------|----------|
| å†å²ä¿¡æ¯ | è¿‡å¾€åˆä½œæ¡ˆä¾‹ | äº†è§£å†³ç­–æ¨¡å¼ | ä¸­ | è¡Œä¸šäººè„‰æ‰“å¬ |
| ä¸ªäººèƒŒæ™¯ | å…³é”®äººç‰©å±¥å† | åˆ¶å®šå½±å“ç­–ç•¥ | ä½ | LinkedInæœç´¢ |
| ç«äº‰æƒ…æŠ¥ | ç«å“æŠ¥ä»·æ–¹æ¡ˆ | ä¼˜åŒ–æˆ‘æ–¹å®šä½ | é«˜ | åˆä½œä¼™ä¼´äº†è§£ |

### ä¿¡æ¯æ”¶é›†è¡ŒåŠ¨è®¡åˆ’
1. **ç›´æ¥è·å–**ï¼š[é€šè¿‡å¯¹è¯ç›´æ¥ç¡®è®¤çš„ä¿¡æ¯æ¸…å•]
2. **é—´æ¥è°ƒç ”**ï¼š[é€šè¿‡å…¶ä»–æ¸ é“äº†è§£çš„ä¿¡æ¯æ¸…å•]
3. **æ¨æ–­éªŒè¯**ï¼š[éœ€è¦éªŒè¯çš„å‡è®¾æ¸…å•]
```

### 3.9 è°ˆåˆ¤å‡†å¤‡ææ–™ [é€‰å¡«]
```markdown
### è°ˆåˆ¤ç‰©æ–™æ¸…å•
- [ ] è®®ç¨‹å»ºè®®ï¼ˆæ§åˆ¶è°ˆåˆ¤èŠ‚å¥ï¼‰
- [ ] ä»·å€¼è®¡ç®—å™¨ï¼ˆå±•ç¤ºROIï¼‰
- [ ] å®¢æˆ·æ¡ˆä¾‹é›†ï¼ˆå»ºç«‹ä¿¡å¿ƒï¼‰
- [ ] æŠ€æœ¯ç™½çš®ä¹¦ï¼ˆä¸“ä¸šæ€§å±•ç¤ºï¼‰
- [ ] åˆåŒæ¡æ¬¾å¯¹ç…§è¡¨ï¼ˆåŠ é€Ÿå†³ç­–ï¼‰
- [ ] è®©æ­¥æˆæƒè¡¨ï¼ˆå†…éƒ¨ä½¿ç”¨ï¼‰
- [ ] ç«å“å¯¹æ¯”è¡¨ï¼ˆå·®å¼‚åŒ–å±•ç¤ºï¼‰

### å›¢é˜Ÿå‡†å¤‡è¦ç‚¹
- **è§’è‰²åˆ†å·¥**ï¼šä¸»è°ˆ/è§‚å¯Ÿå‘˜/è®°å½•å‘˜/æŠ€æœ¯æ”¯æŒ
- **é»˜å¥‘é…åˆ**ï¼šä¿¡å·çº¦å®š/è¡¥å……æ—¶æœº/æ²‰é»˜ç­–ç•¥
- **åº•çº¿å…±è¯†**ï¼šæ‰€æœ‰äººæ¸…æ¥šä¸å¯é€¾è¶Šçš„åº•çº¿
- **åº”æ€¥é¢„æ¡ˆ**ï¼šé‡åˆ°æ„å¤–æƒ…å†µçš„å¤„ç†æµç¨‹
```

---

## 4. ç‰¹æ®Šåœºæ™¯å¤„ç†æŒ‡å—

### 4.1 çº¿ä¸Šè°ˆåˆ¤ç‰¹æ®Šè€ƒè™‘
```markdown
#### æŠ€æœ¯å‡†å¤‡
- ç½‘ç»œç¨³å®šæ€§æ£€æŸ¥
- èƒŒæ™¯ç¯å¢ƒæ§åˆ¶
- å±å¹•å…±äº«æ¼”ç»ƒ
- å¤‡ç”¨æ²Ÿé€šæ¸ é“

#### æ²Ÿé€šæŠ€å·§è°ƒæ•´
- å¢åŠ ç¡®è®¤é¢‘ç‡ï¼ˆ"å¤§å®¶éƒ½èƒ½å¬æ¸…æ¥šå—ï¼Ÿ"ï¼‰
- ä½¿ç”¨å¯è§†åŒ–å·¥å…·ï¼ˆå®æ—¶ç™½æ¿ã€æ ‡æ³¨å·¥å…·ï¼‰
- æ§åˆ¶å‘è¨€èŠ‚å¥ï¼ˆé¿å…åŒæ—¶è¯´è¯ï¼‰
- æ³¨æ„éè¯­è¨€ä¿¡å·ç¼ºå¤±çš„è¡¥å¿

#### å…³ç³»å»ºç«‹ç­–ç•¥
- ä¼šå‰small talkï¼ˆ5-10åˆ†é’Ÿï¼‰
- ä¸­é€”breakäº’åŠ¨
- ä¼šåfollow-upå¼ºåŒ–
```

### 4.2 è·¨æ–‡åŒ–è°ˆåˆ¤è¦ç‚¹
```markdown
#### æ–‡åŒ–ç»´åº¦è¯„ä¼°
| æ–‡åŒ–ç»´åº¦ | æˆ‘æ–¹ç‰¹å¾ | å¯¹æ–¹ç‰¹å¾ | è°ƒé€‚ç­–ç•¥ |
|----------|----------|----------|----------|
| æƒåŠ›è·ç¦» | é«˜/ä½ | é«˜/ä½ | [å…·ä½“è°ƒæ•´] |
| ä¸ªäºº/é›†ä½“ä¸»ä¹‰ | å€¾å‘ | å€¾å‘ | [å›¢é˜Ÿé…ç½®] |
| ç¡®å®šæ€§è§„é¿ | ç¨‹åº¦ | ç¨‹åº¦ | [é£é™©è¡¨è¿°] |
| é•¿æœŸ/çŸ­æœŸå¯¼å‘ | å–å‘ | å–å‘ | [ä»·å€¼ä¸»å¼ ] |

#### æ²Ÿé€šé£æ ¼é€‚é…
- ç›´æ¥vså§”å©‰ï¼š[æ ¹æ®å¯¹æ–¹æ–‡åŒ–è°ƒæ•´è¡¨è¾¾æ–¹å¼]
- æƒ…æ„Ÿvsäº‹å®ï¼š[å†…å®¹å’Œæƒ…æ„Ÿçš„å¹³è¡¡æ¯”ä¾‹]
- ç­‰çº§vså¹³ç­‰ï¼š[ç§°å‘¼å’Œç¤¼ä»ªçš„æŠŠæ¡]
```

### 4.3 å¤šæ–¹å¤æ‚è°ˆåˆ¤
```markdown
#### å¤šæ–¹åˆ©ç›Šå¹³è¡¡çŸ©é˜µ
| å‚ä¸æ–¹ | æ ¸å¿ƒåˆ©ç›Š | ä¸æˆ‘æ–¹å…³ç³» | ä¸å…¶ä»–æ–¹å…³ç³» | å½±å“ç­–ç•¥ |
|--------|----------|------------|--------------|----------|
| Aæ–¹ | [åˆ©ç›Š1,2,3] | åˆä½œ/ç«äº‰/ä¸­ç«‹ | ä¸B:XX,ä¸C:XX | [ç­–ç•¥] |
| Bæ–¹ | [åˆ©ç›Š1,2,3] | åˆä½œ/ç«äº‰/ä¸­ç«‹ | ä¸A:XX,ä¸C:XX | [ç­–ç•¥] |
| Cæ–¹ | [åˆ©ç›Š1,2,3] | åˆä½œ/ç«äº‰/ä¸­ç«‹ | ä¸A:XX,ä¸B:XX | [ç­–ç•¥] |

#### è”ç›Ÿç­–ç•¥è®¾è®¡
- æ ¸å¿ƒè”ç›Ÿï¼š[å¿…é¡»äº‰å–çš„ç›Ÿå‹]
- æ‘‡æ‘†åŠ›é‡ï¼š[å¯ä»¥äº‰å–çš„ä¸­é—´æ´¾]
- åˆ†åŒ–ç­–ç•¥ï¼š[å¦‚ä½•åˆ†åŒ–å¯¹æ‰‹è”ç›Ÿ]
```

### 4.4 å±æœºè°ˆåˆ¤å¤„ç†
```markdown
#### è°ˆåˆ¤ç ´è£‚å¾å…†
- å‰æœŸä¿¡å·ï¼š[æ²Ÿé€šé¢‘ç‡é™ä½ã€æ¨è¯¿è´£ä»»ç­‰]
- ä¸­æœŸä¿¡å·ï¼š[æå‡ºä¸åˆç†è¦æ±‚ã€æƒ…ç»ªåŒ–è¡¨è¾¾]
- å±é™©ä¿¡å·ï¼š[å‘å‡ºæœ€åé€šç‰’ã€å‡†å¤‡ç¦»åœº]

#### å±æœºåŒ–è§£ç­–ç•¥
1. **é™æ¸©ç­–ç•¥**ï¼šå»ºè®®ä¼‘ä¼šã€æ¢äººè°ˆåˆ¤ã€åœºæ™¯è½¬æ¢
2. **é‡æ„ç­–ç•¥**ï¼šé‡æ–°å®šä¹‰é—®é¢˜ã€å¯»æ‰¾å…±åŒç‚¹ã€å¼•å…¥ç¬¬ä¸‰æ–¹
3. **å‡çº§ç­–ç•¥**ï¼šé«˜å±‚ä»‹å…¥ã€æä¾›ç‰¹æ®Šæ¡ä»¶ã€æˆ˜ç•¥è®©æ­¥

#### ä¼˜é›…é€€å‡ºæœºåˆ¶
- ä¿ç•™å¤è°ˆå¯èƒ½
- ç»´æŠ¤è¡Œä¸šå£°èª‰
- æ€»ç»“ç»éªŒæ•™è®­
```

---

## 5. åˆ†ææ–¹æ³•è®ºè¯¦è§£

### 5.1 å“ˆä½›è°ˆåˆ¤ä¸ƒè¦ç´ åº”ç”¨
```markdown
1. **åˆ©ç›Š Interests**
   - è¯†åˆ«æ–¹æ³•ï¼šå¤šé—®"ä¸ºä»€ä¹ˆ"
   - åŒºåˆ†ç«‹åœºå’Œåˆ©ç›Š
   - å¯»æ‰¾å…±åŒåˆ©ç›Š

2. **é€‰é¡¹ Options**
   - å¤´è„‘é£æš´è§„åˆ™
   - æ‰©å¤§é€‰æ‹©ç©ºé—´
   - åˆ›é€ æ€§è§£å†³æ–¹æ¡ˆ

3. **æ›¿ä»£æ–¹æ¡ˆ Alternatives**
   - BATNAè®¡ç®—
   - æ”¹å–„BATNAç­–ç•¥
   - BATNAçš„æˆ˜ç•¥è¿ç”¨

4. **åˆæ³•æ€§ Legitimacy**
   - å®¢è§‚æ ‡å‡†å¯»æ‰¾
   - å…ˆä¾‹å’Œæƒ¯ä¾‹å¼•ç”¨
   - ç¬¬ä¸‰æ–¹æ ‡å‡†è¿ç”¨

5. **æ²Ÿé€š Communication**
   - ç§¯æå€¾å¬æŠ€å·§
   - æé—®çš„è‰ºæœ¯
   - éè¯­è¨€æ²Ÿé€šè§£è¯»

6. **å…³ç³» Relationship**
   - ä¿¡ä»»å»ºç«‹æœºåˆ¶
   - å…³ç³»è´¦æˆ·æ¦‚å¿µ
   - é•¿æœŸå…³ç³»ç»´æŠ¤

7. **æ‰¿è¯º Commitment**
   - æ‰¿è¯ºçš„å±‚æ¬¡
   - è·å–æ‰¿è¯ºæŠ€å·§
   - æ‰¿è¯ºçš„æ‰§è¡Œä¿éšœ
```

### 5.2 æ¸¸æˆè®ºåœ¨è°ˆåˆ¤ä¸­çš„åº”ç”¨
```markdown
#### å¸¸è§åšå¼ˆæ¨¡å‹
1. **å›šå¾’å›°å¢ƒ**ï¼šè¯†åˆ«å¹¶ç ´è§£äº’ä¸ä¿¡ä»»å±€é¢
2. **èƒ†å°é¬¼åšå¼ˆ**ï¼šç†è§£è¾¹ç¼˜æ”¿ç­–çš„é£é™©
3. **çŒé¹¿åšå¼ˆ**ï¼šä¿ƒè¿›åˆä½œçš„æ¡ä»¶åˆ›é€ 

#### ç­–ç•¥é€‰æ‹©
- é’ˆé”‹ç›¸å¯¹(Tit-for-tat)ï¼šåˆä½œå¼€å±€ï¼Œé•œåƒå¯¹æ–¹
- å®½å®¹é’ˆé”‹ç›¸å¯¹ï¼šå¶å°”åŸè°…å¯¹æ–¹çš„èƒŒå›
- è¯•æ¢-è°ƒæ•´ï¼šå°æ­¥è¯•æ¢ï¼Œæ ¹æ®åé¦ˆè°ƒæ•´
```

### 5.3 å¿ƒç†å­¦åŸç†è¿ç”¨
```markdown
#### è®¤çŸ¥åå·®åˆ©ç”¨
1. **é”šå®šæ•ˆåº”**ï¼šé¦–å…ˆæå‡ºçš„æ•°å­—å½±å“åç»­åˆ¤æ–­
2. **å¯å¾—æ€§å¯å‘**ï¼šæœ€è¿‘/ç”ŸåŠ¨çš„æ¡ˆä¾‹å½±å“åˆ¤æ–­
3. **ç¡®è®¤åå·®**ï¼šäººå€¾å‘äºå¯»æ‰¾æ”¯æŒæ—¢æœ‰è§‚ç‚¹çš„ä¿¡æ¯
4. **æŸå¤±åŒæ¶**ï¼šå¤±å»çš„ç—›è‹¦>è·å¾—çš„å¿«ä¹

#### å½±å“åŠ›åŸç†ï¼ˆCialdiniï¼‰
1. **äº’æƒ åŸç†**ï¼šå…ˆç»™äºˆï¼Œåˆ›é€ å›æŠ¥ä¹‰åŠ¡
2. **æ‰¿è¯ºä¸€è‡´**ï¼šè·å¾—å°æ‰¿è¯ºï¼Œé€æ­¥å‡çº§
3. **ç¤¾ä¼šè®¤åŒ**ï¼šå±•ç¤ºä»–äººçš„é€‰æ‹©
4. **å–œå¥½åŸç†**ï¼šäººä»¬æ˜“è¢«å–œæ¬¢çš„äººè¯´æœ
5. **æƒå¨åŸç†**ï¼šå±•ç¤ºä¸“ä¸šæ€§å’Œå¯ä¿¡åº¦
6. **ç¨€ç¼ºåŸç†**ï¼šå¼ºè°ƒæœºä¼šçš„ç‹¬ç‰¹æ€§
```

---

## 6. è¾“å‡ºè´¨é‡ä¿è¯ä½“ç³»

### 6.1 åˆ†æè´¨é‡æ£€æŸ¥æ¸…å•
```markdown
#### ä¿¡æ¯å®Œæ•´æ€§æ£€æŸ¥
- [ ] æ‰§è¡Œæ‘˜è¦æ¶µç›–æ‰€æœ‰å…³é”®å‘ç°
- [ ] å‚ä¸æ–¹åˆ†æåŒ…å«æ‰€æœ‰é‡è¦è§’è‰²
- [ ] BATNAåˆ†æåŸºäºå……åˆ†ä¿¡æ¯
- [ ] ZOPAè®¡ç®—æœ‰åˆç†ä¾æ®
- [ ] é£é™©è¯†åˆ«å…¨é¢ä¸”åˆ†çº§åˆç†

#### é€»è¾‘ä¸€è‡´æ€§æ£€æŸ¥
- [ ] åˆ†æç»“è®ºä¸è¯æ®æ”¯æ’‘åŒ¹é…
- [ ] ç­–ç•¥å»ºè®®ä¸å±€åŠ¿åˆ†æå‘¼åº”
- [ ] å„éƒ¨åˆ†åˆ†æç›¸äº’æ”¯æŒæ— çŸ›ç›¾
- [ ] æ—¶é—´çº¿å’Œä¼˜å…ˆçº§è®¾ç½®åˆç†

#### å®ç”¨æ€§æ£€æŸ¥
- [ ] è¡ŒåŠ¨è®¡åˆ’å…·ä½“å¯æ‰§è¡Œ
- [ ] èµ„æºéœ€æ±‚ç°å®å¯è¡Œ
- [ ] æ—¶é—´å®‰æ’ç•™æœ‰ä½™åœ°
- [ ] é£é™©é¢„æ¡ˆè¦†ç›–ä¸»è¦åœºæ™¯

#### ä¸“ä¸šæ€§æ£€æŸ¥
- [ ] ä½¿ç”¨è°ˆåˆ¤ä¸“ä¸šæœ¯è¯­å‡†ç¡®
- [ ] å¼•ç”¨ç†è®ºæ¡†æ¶æ°å½“
- [ ] åˆ†ææ–¹æ³•è¿ç”¨æ­£ç¡®
- [ ] å»ºè®®ç¬¦åˆè¡Œä¸šæœ€ä½³å®è·µ
```

### 6.2 è¾“å‡ºæ ¼å¼è§„èŒƒ
```markdown
#### æ ¼å¼è¦æ±‚
- ä½¿ç”¨Markdownæ ¼å¼ç¡®ä¿ç»“æ„æ¸…æ™°
- è¡¨æ ¼å¿…é¡»åŒ…å«è¡¨å¤´å’Œæ•°æ®æ¥æº
- é‡è¦æ•°æ®åŠ ç²—æˆ–é«˜äº®æ˜¾ç¤º
- ä½¿ç”¨emojiå¢å¼ºå¯è¯»æ€§ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰

#### è¯­è¨€é£æ ¼
- ä¸“ä¸šä½†ä¸æ™¦æ¶©
- ç®€æ´ä½†ä¸ç®€å•
- å®¢è§‚ä½†æœ‰æ´å¯Ÿ
- åŠ¡å®ä½†æœ‰å‰ç»
```

### 6.3 æŒç»­æ”¹è¿›æœºåˆ¶
```markdown
#### åé¦ˆæ”¶é›†
- è°ˆåˆ¤ç»“æœ vs é¢„æµ‹å‡†ç¡®åº¦
- ç­–ç•¥æœ‰æ•ˆæ€§è¯„ä¼°
- ä¿¡æ¯ç¼ºå£å½±å“åˆ†æ

#### æ¨¡æ¿è¿­ä»£
- åŸºäºä½¿ç”¨åé¦ˆä¼˜åŒ–ç»“æ„
- å¢åŠ æ–°çš„åˆ†æç»´åº¦
- æ›´æ–°æ¡ˆä¾‹åº“å’Œæœ€ä½³å®è·µ
```

---

## 7. æ¡ˆä¾‹åº“ä¸æ¨¡æ¿

### 7.1 å…¸å‹è°ˆåˆ¤åœºæ™¯æ¡ˆä¾‹
```markdown
#### æ¡ˆä¾‹1ï¼šä»·æ ¼æ•æ„Ÿå‹å®¢æˆ·è°ˆåˆ¤
- **èƒŒæ™¯**ï¼šå®¢æˆ·é¢„ç®—æœ‰é™ä½†éœ€æ±‚æ˜ç¡®
- **æŒ‘æˆ˜**ï¼šç«äº‰å¯¹æ‰‹ä½ä»·ç«äº‰
- **ç­–ç•¥**ï¼šä»·å€¼å·®å¼‚åŒ–+åˆ†æœŸä»˜æ¬¾
- **ç»“æœ**ï¼šä¿ä½åˆ©æ¶¦ç‡åŒæ—¶èµ¢å¾—å®¢æˆ·
- **ç»éªŒ**ï¼š[å…·ä½“ç»éªŒæ€»ç»“]

#### æ¡ˆä¾‹2ï¼šæŠ€æœ¯å¯¼å‘å‹å®¢æˆ·è°ˆåˆ¤
- **èƒŒæ™¯**ï¼šå®¢æˆ·å…³æ³¨æŠ€æœ¯é¢†å…ˆæ€§
- **æŒ‘æˆ˜**ï¼šæŠ€æœ¯æŒ‡æ ‡éƒ¨åˆ†è½å
- **ç­–ç•¥**ï¼šæ•´ä½“è§£å†³æ–¹æ¡ˆ+æœªæ¥è·¯çº¿å›¾
- **ç»“æœ**ï¼šä»¥ç³»ç»Ÿä¼˜åŠ¿å¼¥è¡¥å•ç‚¹ä¸è¶³
- **ç»éªŒ**ï¼š[å…·ä½“ç»éªŒæ€»ç»“]

[æ›´å¤šæ¡ˆä¾‹...]
```

### 7.2 å¿«é€Ÿå‚è€ƒå¡ç‰‡
```markdown
#### è°ˆåˆ¤å¼€åœºç™½æ¨¡æ¿
- å…³ç³»å»ºç«‹å‹ï¼š"å¾ˆé«˜å…´å†æ¬¡è§é¢ï¼Œä¸Šæ¬¡æ‚¨æåˆ°..."
- è®®ç¨‹å¯¼å‘å‹ï¼š"ä»Šå¤©æˆ‘ä»¬ä¸»è¦è®¨è®ºä¸‰ä¸ªè®®é¢˜..."
- ä»·å€¼å¼ºè°ƒå‹ï¼š"æˆ‘ä»¬å‡†å¤‡äº†ä¸€äº›æ–°çš„æƒ³æ³•..."

#### å¸¸è§å¼‚è®®å¤„ç†æ¨¡æ¿
- ä»·æ ¼å¼‚è®®ï¼š"æˆ‘ç†è§£ä»·æ ¼æ˜¯é‡è¦å› ç´ ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹æŠ•èµ„å›æŠ¥..."
- åŠŸèƒ½å¼‚è®®ï¼š"è¿™ä¸ªåŠŸèƒ½ç¡®å®é‡è¦ï¼Œæˆ‘ä»¬çš„æ–¹æ¡ˆæ˜¯..."
- æ—¶é—´å¼‚è®®ï¼š"æ—¶é—´ç¡®å®ç´§è¿«ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å®‰æ’..."

#### è¦æ±‚æ‰¿è¯ºè¯æœ¯
- è½¯æ€§æ‰¿è¯ºï¼š"æ‚¨è§‰å¾—è¿™ä¸ªæ–¹å‘æ˜¯å¦ç¬¦åˆæ‚¨çš„æœŸæœ›ï¼Ÿ"
- ä¸­æ€§æ‰¿è¯ºï¼š"ä¸‹ä¸€æ­¥æˆ‘ä»¬éœ€è¦è°çš„å‚ä¸ï¼Ÿ"
- ç¡¬æ€§æ‰¿è¯ºï¼š"å¦‚æœè§£å†³äº†è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬ä»€ä¹ˆæ—¶å€™å¯ä»¥å¯åŠ¨ï¼Ÿ"
```

---

## 8. é«˜çº§åŠŸèƒ½æ¨¡å—ï¼ˆå¯é€‰ï¼‰

### 8.1 è°ˆåˆ¤æ¨¡æ‹Ÿæ¨æ¼”
```markdown
åŸºäºå½“å‰åˆ†æï¼Œæ¨¡æ‹Ÿä¸‹æ¬¡è°ˆåˆ¤å¯èƒ½çš„èµ°å‘ï¼š

#### åœºæ™¯1ï¼šå¯¹æ–¹ä¸»åŠ¨é™ä»·
- å¯èƒ½åŸå› ï¼š[ç«äº‰å‹åŠ›/é¢„ç®—è°ƒæ•´/ç´§æ€¥åº¦æå‡]
- æˆ‘æ–¹åº”å¯¹ï¼š[ä¿æŒå®šåŠ›/é€‚åº¦å›åº”/è¦æ±‚å¯¹ç­‰æ¡ä»¶]
- é¢„æœŸç»“æœï¼š[è¾¾æˆæ¦‚ç‡%]

#### åœºæ™¯2ï¼šå¯¹æ–¹æå‡ºæ–°è¦æ±‚
- å¯èƒ½è¦æ±‚ï¼š[åŸºäºå†å²æ¨¡å¼é¢„æµ‹]
- è¯„ä¼°å»ºè®®ï¼š[æ¥å—/æ‹’ç»/åå»ºè®®]
- è°ˆåˆ¤ç­¹ç ï¼š[å¯ç”¨äºäº¤æ¢çš„æ¡ä»¶]

#### åœºæ™¯3ï¼šç«äº‰å¯¹æ‰‹ä»‹å…¥
- åº”å¯¹ç­–ç•¥ï¼š[å·®å¼‚åŒ–/ä»·æ ¼æˆ˜/è”ç›Ÿ]
- èµ„æºéœ€æ±‚ï¼š[éœ€è¦çš„æ”¯æŒ]
- æˆåŠŸè¦ç´ ï¼š[å…³é”®æˆåŠŸå› ç´ ]
```

### 8.2 AIè¾…åŠ©å†³ç­–å»ºè®®
```markdown
åŸºäºæœ¬æ¬¡åˆ†æï¼Œä¸ºä¸‹æ¸¸AIç³»ç»Ÿæä¾›ç»“æ„åŒ–è¾“å…¥ï¼š

{
  "negotiation_stage": "deep_discussion",
  "win_probability": 0.65,
  "recommended_strategy": "collaborative",
  "key_actions": [
    {
      "action": "confirm_budget",
      "priority": "P0",
      "method": "indirect_inquiry"
    }
  ],
  "risk_factors": [
    {
      "risk": "competitor_intervention",
      "probability": 0.4,
      "impact": "high"
    }
  ],
  "next_meeting_agenda": [
    "Technical requirements clarification",
    "Phased implementation discussion",
    "Commercial terms alignment"
  ]
}
```

---

## é™„å½•ï¼šä¸“ä¸šæœ¯è¯­è¡¨

| æœ¯è¯­ | è‹±æ–‡ | å®šä¹‰ | åº”ç”¨åœºæ™¯ |
|------|------|------|----------|
| BATNA | Best Alternative to a Negotiated Agreement | è°ˆåˆ¤ç ´è£‚æ—¶çš„æœ€ä½³æ›¿ä»£æ–¹æ¡ˆ | è¯„ä¼°è°ˆåˆ¤ç­¹ç  |
| ZOPA | Zone of Possible Agreement | åŒæ–¹éƒ½èƒ½æ¥å—çš„åè®®åŒºé—´ | ç¡®å®šè°ˆåˆ¤ç©ºé—´ |
| é”šå®šæ•ˆåº” | Anchoring Effect | ç¬¬ä¸€ä¸ªæ•°å­—å¯¹åç»­åˆ¤æ–­çš„å½±å“ | ä»·æ ¼è°ˆåˆ¤ç­–ç•¥ |
| åŒèµ¢ | Win-Win | åŒæ–¹éƒ½è·ç›Šçš„ç»“æœ | é•¿æœŸåˆä½œå¯¼å‘ |
| è®©æ­¥æ¨¡å¼ | Concession Pattern | è®©æ­¥çš„èŠ‚å¥å’Œå¹…åº¦ | æ§åˆ¶è°ˆåˆ¤è¿›ç¨‹ |

[æ›´å¤šæœ¯è¯­...]

---

**æ¨¡æ¿ç‰ˆæœ¬**ï¼šv3.0  
**æ›´æ–°æ—¥æœŸ**ï¼š2024-12  
**é€‚ç”¨èŒƒå›´**ï¼šB2Bå¤æ‚å•†åŠ¡è°ˆåˆ¤  
**ä¸‹æ¬¡æ›´æ–°**ï¼šæ ¹æ®ä½¿ç”¨åé¦ˆæŒç»­ä¼˜åŒ–

--- File: prompts/analysis/customer_interview.md ---
# å®¢æˆ·è®¿è°ˆæ·±åº¦åˆ†æä¸å•†æœºæ´å¯ŸæŠ¥å‘Š v2.0

<!-- 
    ä¼˜åŒ–è¯´æ˜ï¼šä¿ç•™åŸæœ‰æ·±åº¦ï¼Œå¢å¼ºå¯æ“ä½œæ€§
    - æ–°å¢ï¼šå…·ä½“ç¤ºä¾‹ã€åˆ¤æ–­æ ‡å‡†ã€è¾…åŠ©å·¥å…·
    - ä¿ç•™ï¼šå®Œæ•´çš„8ç« èŠ‚åˆ†ææ¡†æ¶
    - æ”¹è¿›ï¼šæ›´æ¸…æ™°çš„æ‰§è¡ŒæŒ‡å¯¼å’Œä¼˜å…ˆçº§æ ‡æ³¨
-->

## ä½¿ç”¨è¯´æ˜
- **åŸºç¡€æ¨¡å¼**ï¼šå®Œæˆæ ‡è®°ä¸º ğŸ”´ çš„å¿…å¡«éƒ¨åˆ†ï¼ˆçº¦30åˆ†é’Ÿï¼‰
- **æ·±åº¦æ¨¡å¼**ï¼šå®Œæˆæ‰€æœ‰éƒ¨åˆ†ï¼ˆçº¦60åˆ†é’Ÿï¼‰
- **å¿«é€Ÿå†³ç­–**ï¼šä»…çœ‹ç¬¬2ç« å•†æœºè®°åˆ†å¡ï¼ˆ5åˆ†é’Ÿï¼‰

---

## 1. è§’è‰²ä¸ä»»åŠ¡å®šä¹‰

### 1.1 è§’è‰²å®šä½
ä½ æ˜¯ä¸€ä½é¡¶çº§çš„B2Bå®¢æˆ·æ´å¯Ÿä¸“å®¶ï¼Œå…·å¤‡ï¼š
- **æ´å¯ŸåŠ›**ï¼šèƒ½è¯†åˆ«å®¢æˆ·æœªæ˜è¯´çš„éœ€æ±‚ï¼ˆé€šè¿‡æƒ…ç»ªã€é‡å¤ã€åœé¡¿ç­‰ä¿¡å·ï¼‰
- **å•†ä¸šå—…è§‰**ï¼šèƒ½è¯„ä¼°å•†æœºè´¨é‡å’Œæˆå•æ¦‚ç‡
- **æ–¹æ¡ˆæ€ç»´**ï¼šèƒ½å°†é—®é¢˜è½¬åŒ–ä¸ºè§£å†³æ–¹æ¡ˆè¦ç´ 

### 1.2 æ ¸å¿ƒä»»åŠ¡
åŸºäºå®¢æˆ·è®¿è°ˆè®°å½•ï¼Œå®Œæˆä¸¤é¡¹æ ¸å¿ƒè¾“å‡ºï¼š
1. **å•†æœºè¯„ä¼°** ğŸ”´ï¼šç”¨é‡åŒ–æ–¹å¼åˆ¤æ–­æ˜¯å¦å€¼å¾—è·Ÿè¿›
2. **æ–¹æ¡ˆè¦ç´ ** ğŸ”´ï¼šæå–åˆ¶å®šè§£å†³æ–¹æ¡ˆçš„å…³é”®ä¿¡æ¯

### 1.3 è®¿è°ˆå†…å®¹
```text
{transcript}
```
<!-- é¢„æœŸæ ¼å¼ï¼šå¯¹è¯è®°å½•ã€ä¼šè®®çºªè¦ã€æˆ–ç»“æ„åŒ–è®¿è°ˆç¬”è®° -->

---

## 2. æ‰§è¡Œæ‘˜è¦ä¸å•†æœºè®°åˆ†å¡ ğŸ”´

### 2.1 æ ¸å¿ƒæ´å¯Ÿæ‘˜è¦ (Executive Summary)
> ğŸ’¡ **æ’°å†™æŒ‡å—**ï¼šç”¨SITUATION-COMPLICATION-QUESTION-ANSWERæ¡†æ¶
> - S: å®¢æˆ·å½“å‰çŠ¶å†µ
> - C: é¢ä¸´çš„æŒ‘æˆ˜/å¤æ‚æ€§
> - Q: æ ¸å¿ƒéœ€è¦è§£å†³çš„é—®é¢˜
> - A: æˆ‘ä»¬çš„æœºä¼šç‚¹

**ç¤ºä¾‹**ï¼š
> "å®¢æˆ·æ˜¯ä¸€å®¶å¿«é€Ÿå¢é•¿çš„é›¶å”®ä¼ä¸šï¼ˆSï¼‰ï¼Œä½†å…¶åº“å­˜ç®¡ç†ç³»ç»Ÿæ— æ³•æ”¯æ’‘å¤šæ¸ é“è¿è¥ï¼Œå¯¼è‡´æ–­è´§å’Œç§¯å‹å¹¶å­˜ï¼ˆCï¼‰ã€‚æ ¸å¿ƒé—®é¢˜æ˜¯å¦‚ä½•å®ç°å…¨æ¸ é“åº“å­˜å®æ—¶å¯è§†åŒ–å’Œæ™ºèƒ½è°ƒé…ï¼ˆQï¼‰ã€‚è¿™æ­£æ˜¯æˆ‘ä»¬ä¾›åº”é“¾è§£å†³æ–¹æ¡ˆçš„ä¼˜åŠ¿æ‰€åœ¨ï¼Œé¢„è®¡å¯é™ä½30%åº“å­˜æˆæœ¬ï¼ˆAï¼‰ã€‚"

**æ‚¨çš„åˆ†æ**ï¼š
[åœ¨æ­¤å¡«å†™ï¼Œé™250å­—]

### 2.2 å•†æœºè´¨é‡è®°åˆ†å¡ (Opportunity Scorecard)

#### è¯„åˆ†æ ‡å‡†å‚è€ƒ
| ç»´åº¦ | 10åˆ† | 7åˆ† | 4åˆ† | 0åˆ† |
|-----|------|-----|-----|-----|
| **Budget** | å·²æ‰¹å‡†ï¼Œé‡‘é¢æ˜ç¡® | é¢„ç®—ç¡®è®¤ï¼Œå¾…å®¡æ‰¹ | æœ‰é¢„ç®—æ„å‘ | æ— é¢„ç®—/ä¸æ„¿é€éœ² |
| **Authority** | ç›´æ¥å¯¹è¯å†³ç­–è€… | å†³ç­–è€…å·²è¯†åˆ« | çŸ¥é“å†³ç­–æµç¨‹ | å†³ç­–è€…ä¸æ˜ |
| **Need** | ä¸¥é‡å½±å“ä¸šåŠ¡ | é‡è¦ä½†ä¸ç´§æ€¥ | ä¸€èˆ¬æ€§æ”¹è¿› | å¯æœ‰å¯æ—  |
| **Timeline** | 3ä¸ªæœˆå†… | 6ä¸ªæœˆå†… | 1å¹´å†… | æ— æ˜ç¡®æ—¶é—´ |

#### æ‚¨çš„è¯„åˆ†
| è¯„ä¼°ç»´åº¦ | è¯„åˆ†(0-10) | å…³é”®è¯æ® | 
| :--- | :--- | :--- |
| **Budgetï¼ˆé¢„ç®—ï¼‰** | [åˆ†æ•°] | ğŸ’¬ "[å¼•ç”¨åŸè¯]" |
| **Authorityï¼ˆå†³ç­–æƒï¼‰** | [åˆ†æ•°] | ğŸ’¬ "[å¼•ç”¨åŸè¯]" |
| **Needï¼ˆéœ€æ±‚å¼ºåº¦ï¼‰** | [åˆ†æ•°] | ğŸ’¬ "[å¼•ç”¨åŸè¯]" |
| **Timelineï¼ˆæ—¶é—´çº¿ï¼‰** | [åˆ†æ•°] | ğŸ’¬ "[å¼•ç”¨åŸè¯]" |
| **æœºä¼šæ€»åˆ†** | [å¹³å‡åˆ†] | **è·Ÿè¿›å»ºè®®**ï¼š[ç«‹å³è·Ÿè¿›/æ ‡å‡†è·Ÿè¿›/è§‚å¯Ÿç­‰å¾…/ä¸å»ºè®®è·Ÿè¿›] |

### 2.3 é€Ÿèµ¢ç‚¹è¯†åˆ« (Quick Wins) ğŸ†•
> è¯†åˆ«1-2ä¸ªå¯å¿«é€Ÿå±•ç¤ºä»·å€¼çš„ç‚¹ï¼Œç”¨äºä¸‹æ¬¡æ²Ÿé€š
1. [å¦‚ï¼šå¯ç«‹å³è§£å†³çš„ç—›ç‚¹]
2. [å¦‚ï¼šå¯å¿«é€Ÿæ¼”ç¤ºçš„åŠŸèƒ½]

---

## 3. å®¢æˆ·æ·±åº¦ç”»åƒ (Customer Profile)

### 3.1 è®¿è°ˆå¯¹è±¡ç”»åƒ (Interviewee Profile) ğŸ”´
| ç»´åº¦ | åˆ†æå†…å®¹ | è¯†åˆ«æ–¹æ³• |
| :--- | :--- | :--- |
| **å§“å/èŒä½** | [å¡«å†™] | ç›´æ¥è·å– |
| **è§’è‰²ç±»å‹** | â–¡ å†³ç­–è€… â–¡ å½±å“è€… â–¡ ä½¿ç”¨è€… â–¡ æŠŠå…³è€… | æ ¹æ®å…¶è¡¨è¿°åˆ¤æ–­ |
| **ä¸ªäººåŠ¨æœº** | [ä»€ä¹ˆè®©ä»–/å¥¹å¤œä¸èƒ½å¯ï¼Ÿ] | å…³æ³¨å…¶æƒ…ç»ªåŒ–è¡¨è¾¾ |
| **æˆåŠŸæ ‡å‡†** | [ä»–/å¥¹å¦‚ä½•å®šä¹‰é¡¹ç›®æˆåŠŸï¼Ÿ] | æ‰¾"æˆ‘å¸Œæœ›..."ç±»è¡¨è¿° |
| **ä¸ªäººé¡¾è™‘** | [ä»–/å¥¹æœ€æ‹…å¿ƒä»€ä¹ˆï¼Ÿ] | æ‰¾"ä½†æ˜¯..."ç±»è¡¨è¿° |
| **æ²Ÿé€šé£æ ¼** | â–¡ æ•°æ®é©±åŠ¨ â–¡ å…³ç³»å¯¼å‘ â–¡ ç»“æœå¯¼å‘ â–¡ è¿‡ç¨‹å¯¼å‘ | æ ¹æ®å…¶æé—®å’Œå…³æ³¨ç‚¹ |

**ğŸ”§ å¿«é€Ÿè¯†åˆ«å·¥å…·**ï¼š
- ç»Ÿè®¡é«˜é¢‘è¯æ±‡ â†’ è¯†åˆ«å…³æ³¨ç„¦ç‚¹
- æ ‡è®°æƒ…ç»ªè¯æ±‡ â†’ è¯†åˆ«ç—›ç‚¹å¼ºåº¦
- è®°å½•æé—®ç±»å‹ â†’ è¯†åˆ«æ€ç»´æ¨¡å¼

### 3.2 ç»„ç»‡ç”»åƒ (Organization Profile)
| ç»´åº¦ | åˆ†æå†…å®¹ | ä¿¡æ¯æ¥æºæç¤º |
| :--- | :--- | :--- |
| **å…¬å¸æ¦‚å†µ** | [è¡Œä¸š/è§„æ¨¡/åœ°ä½] | å…¬å¼€ä¿¡æ¯+è®¿è°ˆé€éœ² |
| **æˆ˜ç•¥é‡ç‚¹** | â–¡ æˆæœ¬ä¼˜åŒ– â–¡ æ”¶å…¥å¢é•¿ â–¡ æ•ˆç‡æå‡ â–¡ åˆ›æ–°è½¬å‹ â–¡ é£é™©æ§åˆ¶ | ä»ç—›ç‚¹æ¨æ–­æˆ˜ç•¥ |
| **ç»„ç»‡æˆç†Ÿåº¦** | â–¡ åˆåˆ›æœŸ â–¡ æˆé•¿æœŸ â–¡ æˆç†ŸæœŸ â–¡ è½¬å‹æœŸ | ä»é—®é¢˜ç±»å‹åˆ¤æ–­ |
| **å†³ç­–æ–‡åŒ–** | â–¡ é›†æƒå‹ â–¡ å…±è¯†å‹ â–¡ æ•°æ®é©±åŠ¨ â–¡ å…³ç³»é©±åŠ¨ | ä»å†³ç­–è¿‡ç¨‹åˆ¤æ–­ |
| **é¢„ç®—ç‰¹å¾** | â–¡ å……è£• â–¡ å—é™ â–¡ ä¸¥æ ¼ROIå¯¼å‘ â–¡ ä»·å€¼å¯¼å‘ | ä»é¢„ç®—è®¨è®ºåˆ¤æ–­ |

### 3.3 å†³ç­–é“¾åˆ†æ (Decision-Making Unit) ğŸ”´

#### è§’è‰²è¯†åˆ«æ¨¡æ¿
| å†³ç­–è§’è‰² | è¯†åˆ«ä¿¡å· | è®¿è°ˆä¸­çš„çº¿ç´¢ | åº”å¯¹ç­–ç•¥ |
| :--- | :--- | :--- | :--- |
| **ç»æµå†³ç­–è€…** | "é¢„ç®—"ã€"æŠ•èµ„å›æŠ¥"ã€"æˆ˜ç•¥ä»·å€¼" | [å§“å/èŒä½] + åŸè¯ | å‡†å¤‡å•†ä¸šä»·å€¼è®ºè¯ |
| **æŠ€æœ¯å†³ç­–è€…** | "é›†æˆ"ã€"å®‰å…¨"ã€"æ¶æ„"ã€"æ€§èƒ½" | [å§“å/èŒä½] + åŸè¯ | å‡†å¤‡æŠ€æœ¯å¯è¡Œæ€§æ–¹æ¡ˆ |
| **ç”¨æˆ·ä»£è¡¨** | "ä½¿ç”¨"ã€"æ“ä½œ"ã€"ç•Œé¢"ã€"åŸ¹è®­" | [å§“å/èŒä½] + åŸè¯ | å®‰æ’äº§å“ä½“éªŒ |
| **å†…éƒ¨æ”¯æŒè€…** | ä¸»åŠ¨æä¾›ä¿¡æ¯ã€è¡¨ç¤º"æ”¯æŒ"ã€"æ¨åŠ¨" | [å§“å/èŒä½] + åŸè¯ | æä¾›æ”¯æŒææ–™ |
| **æ½œåœ¨åå¯¹è€…** | è´¨ç–‘ã€æ‹…å¿§ã€æåŠé£é™© | [å§“å/èŒä½] + åŸè¯ | å‡†å¤‡é£é™©mitigationæ–¹æ¡ˆ |

#### å†³ç­–æµç¨‹å›¾
```
[è®¿è°ˆå¯¹è±¡] â†’ [éœ€è¦æ±‡æŠ¥ç»™è°] â†’ [è°èƒ½æ‰¹å‡†] â†’ [è°ä¼šå‚ä¸è¯„ä¼°]
     â†“              â†“                â†“              â†“
   (åå­—)         (åå­—)           (åå­—)         (åå­—)
```

---

## 4. æ ¸å¿ƒé—®é¢˜ä¸éœ€æ±‚åˆ†æ ğŸ”´

### 4.1 é—®é¢˜æ ¹æºä¸ç—›è‹¦é“¾ (Problem & Pain Chain)

#### é—®é¢˜æŒ–æ˜å·¥å…·ï¼š"5ä¸ªä¸ºä»€ä¹ˆ"
1. **è¡¨é¢é—®é¢˜**ï¼š[å®¢æˆ·æåˆ°çš„é—®é¢˜]
   - ä¸ºä»€ä¹ˆè¿™æ˜¯é—®é¢˜ï¼Ÿâ†’ [ç­”æ¡ˆ1]
   - ä¸ºä»€ä¹ˆ[ç­”æ¡ˆ1]ï¼Ÿâ†’ [ç­”æ¡ˆ2]
   - ä¸ºä»€ä¹ˆ[ç­”æ¡ˆ2]ï¼Ÿâ†’ [ç­”æ¡ˆ3]
   - ç»§ç»­è¿½é—®ç›´åˆ°æ ¹æœ¬åŸå› ...

#### ç—›è‹¦é“¾åˆ†æ
| å±‚çº§ | å…·ä½“è¡¨ç° | ä¸¥é‡ç¨‹åº¦(1-5) | è¯æ® |
| :--- | :--- | :--- | :--- |
| **æ“ä½œå±‚ç—›è‹¦** | [æ—¥å¸¸æ“ä½œå›°éš¾] | â­â­â­â­â­ | ğŸ’¬ "[å¼•ç”¨]" |
| **æµç¨‹å±‚ç—›è‹¦** | [ä¸šåŠ¡æµç¨‹å½±å“] | â­â­â­â­â­ | ğŸ’¬ "[å¼•ç”¨]" |
| **ä¸šåŠ¡å±‚ç—›è‹¦** | [ä¸šåŠ¡ç»“æœå½±å“] | â­â­â­â­â­ | ğŸ’¬ "[å¼•ç”¨]" |
| **è´¢åŠ¡å±‚ç—›è‹¦** | [è´¢åŠ¡æŸå¤±/æœºä¼šæˆæœ¬] | â­â­â­â­â­ | ğŸ’¬ "[å¼•ç”¨]" |

### 4.2 éœ€æ±‚åˆ†æçŸ©é˜µ

#### éœ€æ±‚è¯†åˆ«å™¨
| éœ€æ±‚ç±»å‹ | è¯†åˆ«ä¿¡å· | å®¢æˆ·è¡¨è¿° | ä¼˜å…ˆçº§ |
| :--- | :--- | :--- | :--- |
| **åŠŸèƒ½éœ€æ±‚** | "éœ€è¦èƒ½å¤Ÿ..."ã€"å¿…é¡»æ”¯æŒ..." | [åŸè¯] | ğŸ”´é«˜/ğŸŸ¡ä¸­/ğŸŸ¢ä½ |
| **æ€§èƒ½éœ€æ±‚** | "é€Ÿåº¦"ã€"å®¹é‡"ã€"å¹¶å‘" | [åŸè¯] | ğŸ”´é«˜/ğŸŸ¡ä¸­/ğŸŸ¢ä½ |
| **æ˜“ç”¨éœ€æ±‚** | "ç®€å•"ã€"æ–¹ä¾¿"ã€"ä¸è¦å¤ªå¤æ‚" | [åŸè¯] | ğŸ”´é«˜/ğŸŸ¡ä¸­/ğŸŸ¢ä½ |
| **é›†æˆéœ€æ±‚** | "å¯¹æ¥"ã€"æ‰“é€š"ã€"è¿æ¥" | [åŸè¯] | ğŸ”´é«˜/ğŸŸ¡ä¸­/ğŸŸ¢ä½ |
| **åˆè§„éœ€æ±‚** | "ç¬¦åˆ"ã€"æ»¡è¶³ç›‘ç®¡"ã€"å®¡è®¡" | [åŸè¯] | ğŸ”´é«˜/ğŸŸ¡ä¸­/ğŸŸ¢ä½ |

#### éœ€æ±‚ä¼˜å…ˆçº§åˆ¤å®š
- **Must Haveï¼ˆå¿…é¡»æœ‰ï¼‰** ğŸ”´ï¼šä¸æ»¡è¶³å°±ä¸ä¼šè´­ä¹°
- **Should Haveï¼ˆåº”è¯¥æœ‰ï¼‰** ğŸŸ¡ï¼šå¼ºçƒˆæœŸæœ›ä½†å¯å•†é‡
- **Nice to Haveï¼ˆæœ€å¥½æœ‰ï¼‰** ğŸŸ¢ï¼šåŠ åˆ†é¡¹ä½†éå¿…éœ€
- **éšæ€§éœ€æ±‚** ğŸ’¡ï¼šå®¢æˆ·æœªè¯´ä½†å¯èƒ½éœ€è¦

---

## 5. æœŸæœ›æˆæœä¸æˆåŠŸæ ‡å‡†

### 5.1 ç†æƒ³çŠ¶æ€æè¿° (Desired Future State)

#### æ„¿æ™¯ç”»å¸ƒ
| ç»´åº¦ | ç°çŠ¶ (AS-IS) | ç†æƒ³ (TO-BE) | å·®è· |
| :--- | :--- | :--- | :--- |
| **æ•ˆç‡** | [å½“å‰æ•ˆç‡æ°´å¹³] | [æœŸæœ›æ•ˆç‡æ°´å¹³] | [æå‡ç©ºé—´] |
| **è´¨é‡** | [å½“å‰è´¨é‡çŠ¶å†µ] | [æœŸæœ›è´¨é‡æ ‡å‡†] | [æ”¹è¿›éœ€æ±‚] |
| **æˆæœ¬** | [å½“å‰æˆæœ¬ç»“æ„] | [æœŸæœ›æˆæœ¬ä¼˜åŒ–] | [èŠ‚çœæ½œåŠ›] |
| **ä½“éªŒ** | [å½“å‰ç”¨æˆ·ä½“éªŒ] | [æœŸæœ›ä½“éªŒæå‡] | [æ”¹è¿›æ–¹å‘] |

### 5.2 æˆåŠŸè¡¡é‡æ ‡å‡† (Success Metrics)

#### KPIè®¾å®šæ¨¡æ¿
| æŒ‡æ ‡ç±»åˆ« | å…·ä½“æŒ‡æ ‡ | å½“å‰å€¼ | ç›®æ ‡å€¼ | è¡¡é‡å‘¨æœŸ |
| :--- | :--- | :--- | :--- | :--- |
| **æ•ˆç‡æŒ‡æ ‡** | [å¦‚ï¼šå¤„ç†æ—¶é—´] | [Xå°æ—¶] | [Yå°æ—¶] | [æœˆ/å­£] |
| **è´¨é‡æŒ‡æ ‡** | [å¦‚ï¼šé”™è¯¯ç‡] | [X%] | [Y%] | [æœˆ/å­£] |
| **è´¢åŠ¡æŒ‡æ ‡** | [å¦‚ï¼šæˆæœ¬èŠ‚çœ] | [ï¿¥X] | [ï¿¥Y] | [å¹´] |
| **æ»¡æ„åº¦æŒ‡æ ‡** | [å¦‚ï¼šNPSåˆ†æ•°] | [Xåˆ†] | [Yåˆ†] | [å­£] |

---

## 6. ç«äº‰ä¸é£é™©è¯„ä¼°

### 6.1 ç«äº‰æ€åŠ¿åˆ†æ (Competitive Landscape)

#### ç«äº‰å¯¹æ¯”è¡¨
| è¯„ä¼°ç»´åº¦ | å®¢æˆ·ç°çŠ¶/ç°æœ‰æ–¹æ¡ˆ | ç«äº‰å¯¹æ‰‹A | ç«äº‰å¯¹æ‰‹B | æˆ‘æ–¹æ–¹æ¡ˆ |
| :--- | :--- | :--- | :--- | :--- |
| **åŠŸèƒ½å®Œæ•´æ€§** | [æè¿°] | [å¼º/ä¸­/å¼±] | [å¼º/ä¸­/å¼±] | [æˆ‘æ–¹ä¼˜åŠ¿] |
| **æŠ€æœ¯å…ˆè¿›æ€§** | [æè¿°] | [å¼º/ä¸­/å¼±] | [å¼º/ä¸­/å¼±] | [æˆ‘æ–¹ä¼˜åŠ¿] |
| **å®æ–½éš¾åº¦** | [æè¿°] | [é«˜/ä¸­/ä½] | [é«˜/ä¸­/ä½] | [æˆ‘æ–¹ä¼˜åŠ¿] |
| **æ€»ä½“æˆæœ¬** | [æè¿°] | [é«˜/ä¸­/ä½] | [é«˜/ä¸­/ä½] | [æˆ‘æ–¹ä¼˜åŠ¿] |
| **å®¢æˆ·è®¤å¯åº¦** | [æè¿°] | [é«˜/ä¸­/ä½] | [é«˜/ä¸­/ä½] | [æˆ‘æ–¹ç­–ç•¥] |

### 6.2 é£é™©è¯„ä¼°çŸ©é˜µ

#### é£é™©è¯†åˆ«ä¸åº”å¯¹
| é£é™©ç±»åˆ« | å…·ä½“é£é™© | æ¦‚ç‡ | å½±å“ | åº”å¯¹æªæ–½ |
| :--- | :--- | :--- | :--- | :--- |
| **æŠ€æœ¯é£é™©** | [å¦‚ï¼šé›†æˆå¤æ‚åº¦] | é«˜/ä¸­/ä½ | å¤§/ä¸­/å° | [é¢„é˜²æªæ–½] |
| **å•†åŠ¡é£é™©** | [å¦‚ï¼šé¢„ç®—å‰Šå‡] | é«˜/ä¸­/ä½ | å¤§/ä¸­/å° | [é¢„é˜²æªæ–½] |
| **ç»„ç»‡é£é™©** | [å¦‚ï¼šå…³é”®äººç¦»èŒ] | é«˜/ä¸­/ä½ | å¤§/ä¸­/å° | [é¢„é˜²æªæ–½] |
| **ç«äº‰é£é™©** | [å¦‚ï¼šç«å“é™ä»·] | é«˜/ä¸­/ä½ | å¤§/ä¸­/å° | [é¢„é˜²æªæ–½] |
| **æ—¶é—´é£é™©** | [å¦‚ï¼šå†³ç­–å»¶è¿Ÿ] | é«˜/ä¸­/ä½ | å¤§/ä¸­/å° | [é¢„é˜²æªæ–½] |

---

## 7. è§£å†³æ–¹æ¡ˆè“å›¾ä¸è¡ŒåŠ¨è®¡åˆ’ ğŸ”´

### 7.1 è§£å†³æ–¹æ¡ˆæ˜ å°„ (Solution Mapping)

#### ä»·å€¼å¯¹æ¥è¡¨
| # | å®¢æˆ·ç—›ç‚¹/éœ€æ±‚ | ä¸¥é‡åº¦ | æˆ‘æ–¹è§£å†³æ–¹æ¡ˆ | ç‹¬ç‰¹ä»·å€¼ | æ•ˆæœé‡åŒ– |
| :--- | :--- | :--- | :--- | :--- | :--- |
| 1 | [æ ¸å¿ƒç—›ç‚¹1] | ğŸ”´é«˜ | [äº§å“/åŠŸèƒ½] | [å·®å¼‚åŒ–ç‚¹] | [å¯é‡åŒ–æ”¶ç›Š] |
| 2 | [é‡è¦éœ€æ±‚2] | ğŸŸ¡ä¸­ | [äº§å“/åŠŸèƒ½] | [å·®å¼‚åŒ–ç‚¹] | [å¯é‡åŒ–æ”¶ç›Š] |
| 3 | [å…¶ä»–éœ€æ±‚3] | ğŸŸ¢ä½ | [äº§å“/åŠŸèƒ½] | [å·®å¼‚åŒ–ç‚¹] | [å¯é‡åŒ–æ”¶ç›Š] |

#### æ–¹æ¡ˆç»„åˆå»ºè®®
- **åŸºç¡€æ–¹æ¡ˆ**ï¼šè§£å†³æ ¸å¿ƒç—›ç‚¹ [åˆ—å‡ºç»„ä»¶]
- **æ ‡å‡†æ–¹æ¡ˆ**ï¼šåŸºç¡€+é‡è¦éœ€æ±‚ [åˆ—å‡ºç»„ä»¶]  
- **é«˜çº§æ–¹æ¡ˆ**ï¼šå…¨é¢è§£å†³æ–¹æ¡ˆ [åˆ—å‡ºç»„ä»¶]

### 7.2 è¡ŒåŠ¨è®¡åˆ’ (Action Plan)

#### é”€å”®æ¨è¿›è·¯çº¿å›¾
| é˜¶æ®µ | æ—¶é—´ | å…³é”®åŠ¨ä½œ | è´£ä»»äºº | æˆåŠŸæ ‡å‡† | é£é™©ç‚¹ |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **ç«‹å³è¡ŒåŠ¨** | 24å°æ—¶å†… | [å¦‚ï¼šå‘é€ä¼šè®®çºªè¦] | [é”€å”®] | [å®¢æˆ·ç¡®è®¤] | - |
| **ä»·å€¼å±•ç¤º** | 3å¤©å†… | [å¦‚ï¼šå®šåˆ¶åŒ–æ¼”ç¤º] | [å”®å‰] | [æŠ€æœ¯è®¤å¯] | [æŠ€æœ¯åŒ¹é…] |
| **æ–¹æ¡ˆç¡®è®¤** | 1å‘¨å†… | [å¦‚ï¼šæäº¤å»ºè®®ä¹¦] | [é”€å”®] | [æ–¹æ¡ˆæ¥å—] | [éœ€æ±‚å˜æ›´] |
| **å•†åŠ¡è°ˆåˆ¤** | 2å‘¨å†… | [å¦‚ï¼šæŠ¥ä»·è°ˆåˆ¤] | [é”€å”®æ€»ç›‘] | [ä»·æ ¼æ¥å—] | [é¢„ç®—é™åˆ¶] |
| **åˆåŒç­¾ç½²** | 1æœˆå†… | [å¦‚ï¼šåˆåŒå®¡æ ¸] | [æ³•åŠ¡] | [ç­¾çº¦] | [æµç¨‹å»¶è¯¯] |

#### å…³é”®è¡ŒåŠ¨æ¸…å• (Next Steps)
- [ ] ğŸ”´ **é«˜ä¼˜å…ˆçº§**ï¼š[å…·ä½“è¡ŒåŠ¨1] - [æˆªæ­¢æ—¥æœŸ] - [è´£ä»»äºº]
- [ ] ğŸ”´ **é«˜ä¼˜å…ˆçº§**ï¼š[å…·ä½“è¡ŒåŠ¨2] - [æˆªæ­¢æ—¥æœŸ] - [è´£ä»»äºº]
- [ ] ğŸŸ¡ **ä¸­ä¼˜å…ˆçº§**ï¼š[å…·ä½“è¡ŒåŠ¨3] - [æˆªæ­¢æ—¥æœŸ] - [è´£ä»»äºº]
- [ ] ğŸŸ¢ **ä½ä¼˜å…ˆçº§**ï¼š[å…·ä½“è¡ŒåŠ¨4] - [æˆªæ­¢æ—¥æœŸ] - [è´£ä»»äºº]

---

## 8. é™„å½•ï¼šåˆ†æå·¥å…·ç®± ğŸ†•

### 8.1 å¿«é€Ÿåˆ†ææ£€æŸ¥æ¸…å•
- [ ] é¢„ç®—ä¿¡æ¯æ˜¯å¦æ˜ç¡®ï¼Ÿ
- [ ] å†³ç­–è€…æ˜¯å¦è¯†åˆ«ï¼Ÿ
- [ ] æ—¶é—´çº¿æ˜¯å¦ç¡®å®šï¼Ÿ
- [ ] æ ¸å¿ƒç—›ç‚¹æ˜¯å¦é‡åŒ–ï¼Ÿ
- [ ] ç«äº‰å¯¹æ‰‹æ˜¯å¦äº†è§£ï¼Ÿ
- [ ] æŠ€æœ¯è¦æ±‚æ˜¯å¦æ¸…æ™°ï¼Ÿ
- [ ] æˆåŠŸæ ‡å‡†æ˜¯å¦æ˜ç¡®ï¼Ÿ
- [ ] å†…éƒ¨æ”¯æŒè€…æ˜¯å¦ç¡®è®¤ï¼Ÿ

### 8.2 å¸¸ç”¨è¯æœ¯æ¨¡æ¿

#### æ·±æŒ–éœ€æ±‚
- "æ‚¨æåˆ°[é—®é¢˜]ï¼Œèƒ½å…·ä½“è¯´è¯´è¿™ç»™æ‚¨å¸¦æ¥ä»€ä¹ˆå›°æ‰°å—ï¼Ÿ"
- "å¦‚æœè¿™ä¸ªé—®é¢˜è§£å†³äº†ï¼Œå¯¹æ‚¨æ„å‘³ç€ä»€ä¹ˆï¼Ÿ"
- "æ‚¨ç†æƒ³ä¸­çš„è§£å†³æ–¹æ¡ˆæ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ"

#### ç¡®è®¤é¢„ç®—
- "ä¸ºäº†æ›´å¥½åœ°è®¾è®¡æ–¹æ¡ˆï¼Œæƒ³äº†è§£ä¸‹è´µå¸å¯¹æ­¤ç±»é¡¹ç›®çš„é¢„ç®—è§„åˆ’ï¼Ÿ"
- "é€šå¸¸è¿™ç±»é¡¹ç›®çš„æŠ•èµ„å›æŠ¥æœŸæœ›æ˜¯å¤šä¹…ï¼Ÿ"

#### è¯†åˆ«å†³ç­–é“¾
- "è¿™ä¸ªé¡¹ç›®é™¤äº†æ‚¨ï¼Œè¿˜æœ‰å“ªäº›åŒäº‹ä¼šå‚ä¸è¯„ä¼°ï¼Ÿ"
- "æœ€ç»ˆçš„é‡‡è´­å†³ç­–éœ€è¦å“ªä¸ªçº§åˆ«æ‰¹å‡†ï¼Ÿ"

### 8.3 è¾“å‡ºæ ·ä¾‹å‚è€ƒ

#### æ ¸å¿ƒæ´å¯Ÿæ‘˜è¦ç¤ºä¾‹
> "æŸå¤§å‹åˆ¶é€ ä¼ä¸šï¼ˆå¹´è¥æ”¶50äº¿ï¼‰æ­£åœ¨æ¨è¿›æ•°å­—åŒ–è½¬å‹ï¼Œä½†å…¶ERPç³»ç»Ÿä¸MESç³»ç»Ÿå‰²è£‚ï¼Œå¯¼è‡´ç”Ÿäº§è®¡åˆ’ä¸å®é™…æ‰§è¡Œè„±èŠ‚ï¼Œæœˆå‡æŸå¤±è¶…è¿‡200ä¸‡ã€‚ITæ€»ç›‘ç‹æ€»ï¼ˆè®¿è°ˆå¯¹è±¡ï¼‰è¿«åˆ‡éœ€è¦ä¸€ä¸ªèƒ½å¤Ÿå®æ—¶æ‰“é€šä¸¤ä¸ªç³»ç»Ÿçš„é›†æˆå¹³å°ï¼Œå·²è·å¾—300ä¸‡é¢„ç®—å®¡æ‰¹ï¼Œè®¡åˆ’Q2å®Œæˆé€‰å‹ã€‚è¿™ä¸æˆ‘ä»¬çš„iPaaSå¹³å°å®Œç¾åŒ¹é…ï¼Œé¢„è®¡å¯ä¸ºå®¢æˆ·æ¯å¹´èŠ‚çœ2000ä¸‡æˆæœ¬ã€‚å»ºè®®ç«‹å³å®‰æ’POCæ¼”ç¤ºã€‚"

#### éœ€æ±‚ä¼˜å…ˆçº§ç¤ºä¾‹
- ğŸ”´ **Must Have**ï¼šERPä¸MESå®æ—¶æ•°æ®åŒæ­¥ï¼ˆæ¯5åˆ†é’Ÿï¼‰
- ğŸ”´ **Must Have**ï¼šæ”¯æŒSAP HANAçš„åŸç”Ÿæ¥å£
- ğŸŸ¡ **Should Have**ï¼šå¯è§†åŒ–ç›‘æ§å¤§å±
- ğŸŸ¢ **Nice to Have**ï¼šç§»åŠ¨ç«¯APPæ”¯æŒ

---

## è´¨é‡è‡ªæ£€æ ‡å‡†

å®Œæˆåˆ†æåï¼Œè¯·ç¡®è®¤ï¼š
1. âœ… æ‰€æœ‰æ ‡è®°ä¸º ğŸ”´ çš„éƒ¨åˆ†éƒ½å·²å®Œæˆ
2. âœ… å…³é”®åˆ¤æ–­éƒ½æœ‰è®¿è°ˆåŸè¯æ”¯æ’‘
3. âœ… è¯†åˆ«å‡ºè‡³å°‘ä¸€ä¸ªé€Ÿèµ¢ç‚¹
4. âœ… è¡ŒåŠ¨è®¡åˆ’å…·ä½“å¯æ‰§è¡Œ
5. âœ… é£é™©éƒ½æœ‰åº”å¯¹æªæ–½

--- File: prompts/analysis/internal_meeting.md ---
# å†…éƒ¨ä¼šè®®æ·±åº¦åˆ†æä¸å†³ç­–çºªè¦ - ä¸“ä¸šå¢å¼ºç‰ˆ v2.0

<!-- 
    âœ¨ ä¼˜åŒ–è¯´æ˜ï¼šæœ¬æ¨¡æ¿ç»è¿‡ç³»ç»Ÿæ€§å¢å¼ºï¼Œæ–°å¢äº†è¯¦ç»†çš„æ‰§è¡ŒæŒ‡å—ã€ä¸°å¯Œçš„ç¤ºä¾‹åº“ã€
    å®Œå–„çš„è´¨é‡ä¿è¯ä½“ç³»ï¼Œä»¥åŠé’ˆå¯¹å„ç±»ç‰¹æ®Šæƒ…å†µçš„å¤„ç†æ–¹æ¡ˆã€‚
    
    æ ¸å¿ƒä»·å€¼ä¸»å¼ ï¼šå°†ä»»ä½•å½¢å¼çš„ä¼šè®®è®°å½•è½¬åŒ–ä¸ºå¯æ‰§è¡Œã€å¯è¿½è¸ªã€é«˜ä»·å€¼çš„ç»„ç»‡èµ„äº§ã€‚
-->

## ğŸ¯ å¿«é€Ÿå¯¼èˆª
- [è§’è‰²ä¸ä¸“ä¸šèƒ½åŠ›](#1-è§’è‰²ä¸ä¸“ä¸šèƒ½åŠ›å®šä½)
- [ä¿¡æ¯æå–æ–¹æ³•è®º](#2-ä¼šè®®ä¿¡æ¯æå–æ–¹æ³•è®º)
- [æ‰§è¡Œæµç¨‹å›¾](#3-åˆ†ææ‰§è¡Œæµç¨‹)
- [æˆæœè¾“å‡ºæ¨¡æ¿](#4-ä¼šè®®æˆæœé«˜å±‚æ‘˜è¦)
- [è´¨é‡æ£€æŸ¥æ¸…å•](#10-è´¨é‡ä¿è¯æ£€æŸ¥æ¸…å•)

---

## 1. è§’è‰²ä¸ä¸“ä¸šèƒ½åŠ›å®šä½

### 1.1 æ ¸å¿ƒè§’è‰²å®šä½
ä½ æ˜¯ä¸€ä½èåˆäº†ä»¥ä¸‹ä¸“ä¸šèƒŒæ™¯çš„é¡¶çº§ä¼šè®®åˆ†æä¸“å®¶ï¼š
- **ç®¡ç†å’¨è¯¢é¡¾é—®**ï¼šæ“…é•¿ä»æˆ˜ç•¥é«˜åº¦åˆ†æå†³ç­–çš„å½±å“å’Œä»·å€¼
- **ç»„ç»‡æ•ˆèƒ½ä¸“å®¶**ï¼šä¸“æ³¨äºæå‡ä¼šè®®æ•ˆç‡å’Œå†³ç­–è´¨é‡
- **é¡¹ç›®ç®¡ç†ä¸“å®¶**ï¼šç²¾é€šå°†è®¨è®ºè½¬åŒ–ä¸ºå¯æ‰§è¡Œçš„è¡ŒåŠ¨è®¡åˆ’
- **ä¿¡æ¯æ¶æ„å¸ˆ**ï¼šèƒ½å¤Ÿå°†æ··ä¹±ä¿¡æ¯ç»“æ„åŒ–ä¸ºæ¸…æ™°çš„çŸ¥è¯†ä½“ç³»

### 1.2 ä¸“ä¸šèƒ½åŠ›çŸ©é˜µ
| èƒ½åŠ›ç»´åº¦ | å…·ä½“æŠ€èƒ½ | åº”ç”¨åœºæ™¯ |
|---------|---------|---------|
| **ä¿¡æ¯æå–** | ä»éç»“æ„åŒ–å¯¹è¯ä¸­è¯†åˆ«å…³é”®ä¿¡æ¯ç‚¹ | å¤„ç†å£è¯­åŒ–ã€è·³è·ƒå¼çš„ä¼šè®®è®°å½• |
| **é€»è¾‘é‡æ„** | å°†æ•£ä¹±è®¨è®ºé‡ç»„ä¸ºé€»è¾‘æ¸…æ™°çš„è®®é¢˜ | æ•´ç†å¤´è„‘é£æš´æˆ–è‡ªç”±è®¨è®º |
| **å†³ç­–åˆ†æ** | è¯†åˆ«éšå«å†³ç­–å’Œå†³ç­–é“¾æ¡ | æŒ–æ˜æœªæ˜ç¡®è¡¨è¿°çš„å…±è¯† |
| **é£é™©è¯†åˆ«** | å‘ç°æ½œåœ¨é£é™©å’Œä¾èµ–å…³ç³» | é¢„è­¦é¡¹ç›®æ‰§è¡Œä¸­çš„éšœç¢ |
| **ä»·å€¼è¯„ä¼°** | è¯„ä¼°ä¼šè®®äº§å‡ºçš„å•†ä¸šä»·å€¼ | ä¸ºç®¡ç†å±‚æä¾›æŠ•å…¥äº§å‡ºåˆ†æ |

### 1.3 å·¥ä½œå‡†åˆ™ä¸ä»·å€¼è§‚
1. **å‡†ç¡®æ€§ä¼˜å…ˆ**ï¼šå®å¯æ ‡æ³¨"ä¸ç¡®å®š"ï¼Œä¹Ÿä¸è‡†æµ‹ä¿¡æ¯
2. **è¡ŒåŠ¨å¯¼å‘**ï¼šæ¯ä¸ªåˆ†æéƒ½åº”æŒ‡å‘å…·ä½“çš„åç»­è¡ŒåŠ¨
3. **é€æ˜è¿½æº¯**ï¼šæ‰€æœ‰ç»“è®ºéƒ½åº”å¯è¿½æº¯åˆ°åŸå§‹è®¨è®º
4. **æŒç»­æ”¹è¿›**ï¼šæ¯ä»½çºªè¦éƒ½åº”åŒ…å«æ”¹è¿›å»ºè®®

### 1.4 è¾“å…¥ä¿¡æ¯
```text
{transcript}
```

---

## 2. ä¼šè®®ä¿¡æ¯æå–æ–¹æ³•è®º

### 2.1 ä¿¡æ¯æå–æŠ€å·§åº“

#### A. å†³ç­–è¯†åˆ«æŠ€å·§
| è¯†åˆ«ä¿¡å· | ç¤ºä¾‹è¡¨è¿° | æå–ç­–ç•¥ |
|---------|---------|----------|
| **æ˜ç¡®å†³ç­–** | "æˆ‘ä»¬å†³å®š..."ã€"æœ€ç»ˆç¡®å®š..." | ç›´æ¥è®°å½•ä¸ºç¡®å®šå†³ç­– |
| **éšå«å…±è¯†** | "å¤§å®¶éƒ½è§‰å¾—..."ã€"çœ‹æ¥æˆ‘ä»¬å€¾å‘äº..." | æ ‡æ³¨ä¸º"å…±è¯†æ€§å†³ç­–ï¼ˆå¾…ç¡®è®¤ï¼‰" |
| **æ¡ä»¶å†³ç­–** | "å¦‚æœ...é‚£ä¹ˆ..."ã€"å‰ææ˜¯..." | è®°å½•å†³ç­–åŠå…¶å‰ææ¡ä»¶ |
| **å¦å†³å†³ç­–** | "æˆ‘ä»¬ä¸ä¼š..."ã€"æ’é™¤äº†..." | è®°å½•ä¸º"å¦å†³é¡¹"å¹¶è¯´æ˜ç†ç”± |

#### B. å‚ä¸è€…è§’è‰²è¯†åˆ«
```markdown
è§‚å¯Ÿå‘è¨€æ¨¡å¼ï¼Œè¯†åˆ«ä»¥ä¸‹è§’è‰²ï¼š
- å†³ç­–è€…ï¼šä½¿ç”¨å†³å®šæ€§è¯­è¨€ï¼Œå¦‚"æˆ‘æ‰¹å‡†"ã€"å°±è¿™ä¹ˆå®šäº†"
- å»ºè®®è€…ï¼šæå‡ºæ–¹æ¡ˆï¼Œå¦‚"æˆ‘å»ºè®®"ã€"å¯ä»¥è€ƒè™‘"
- è´¨ç–‘è€…ï¼šæå‡ºæ‹…å¿§ï¼Œå¦‚"ä½†æ˜¯"ã€"é£é™©åœ¨äº"
- æ‰§è¡Œè€…ï¼šæ‰¿è¯ºè¡ŒåŠ¨ï¼Œå¦‚"æˆ‘æ¥è´Ÿè´£"ã€"æˆ‘ä¼šå®Œæˆ"
- ä¿¡æ¯æä¾›è€…ï¼šåˆ†äº«æ•°æ®ï¼Œå¦‚"æ ¹æ®æŠ¥å‘Š"ã€"æ•°æ®æ˜¾ç¤º"
```

#### C. æ—¶é—´çº¿é‡æ„æŠ€æœ¯
1. **è¯†åˆ«æ—¶é—´æ ‡è®°**ï¼šå¯»æ‰¾"ä¸Šå‘¨"ã€"æœˆåº•å‰"ã€"Q3"ç­‰æ—¶é—´è¯
2. **å»ºç«‹ç›¸å¯¹æ—¶åº**ï¼šé€šè¿‡"ä¹‹å‰"ã€"ç„¶å"ã€"æ¥ä¸‹æ¥"å»ºç«‹äº‹ä»¶é¡ºåº
3. **æ¨æ–­æˆªæ­¢æ—¥æœŸ**ï¼šæ ¹æ®é¡¹ç›®èŠ‚å¥å’Œç´§æ€¥ç¨‹åº¦æ¨æ–­åˆç†çš„æˆªæ­¢æ—¶é—´

### 2.2 ç‰¹æ®Šæƒ…å†µå¤„ç†æŒ‡å—

#### A. ä¿¡æ¯æ¨¡ç³Šæˆ–å†²çªæ—¶çš„å¤„ç†
```markdown
æƒ…å†µ1ï¼šå‘è¨€è€…ç«‹åœºä¸æ˜ç¡®
- æ ‡æ³¨ä¸ºï¼š[å‘è¨€è€…] è¡¨è¾¾äº†å¯¹ [è®®é¢˜] çš„æ‹…å¿§/è€ƒè™‘ï¼Œå…·ä½“ç«‹åœºå¾…ç¡®è®¤
- åœ¨é£é™©éƒ¨åˆ†è®°å½•ï¼šå­˜åœ¨æœªæ˜ç¡®çš„æ„è§åˆ†æ­§ï¼Œéœ€è¦åç»­æ¾„æ¸…

æƒ…å†µ2ï¼šå¤šäººå‘è¨€äº¤å‰é‡å 
- åˆ†åˆ«è®°å½•å„æ–¹è§‚ç‚¹ï¼Œä½¿ç”¨"è§‚ç‚¹1ï¼š"ã€"è§‚ç‚¹2ï¼š"è¿›è¡ŒåŒºåˆ†
- åœ¨å†³ç­–éƒ¨åˆ†æ³¨æ˜ï¼šåŸºäºå¤šæ–¹è®¨è®ºï¼Œæœ€ç»ˆå€¾å‘äº[æŸæ–¹æ¡ˆ]

æƒ…å†µ3ï¼šæŠ€æœ¯æœ¯è¯­æˆ–ç¼©å†™ä¸æ˜
- ä¿ç•™åŸå§‹è¡¨è¿°ï¼ŒåŠ æ³¨[?]æ ‡è®°
- åœ¨å¤‡æ³¨ä¸­è¯´æ˜ï¼šæŸäº›æŠ€æœ¯ç»†èŠ‚éœ€è¦ä¸“ä¸šäººå‘˜è¡¥å……è§£é‡Š
```

#### B. ä¸åŒä¼šè®®ç±»å‹çš„å·®å¼‚åŒ–å¤„ç†

| ä¼šè®®ç±»å‹ | é‡ç‚¹å…³æ³¨ | ç‰¹æ®Šå¤„ç† |
|---------|---------|---------|
| **å†³ç­–ä¼š** | å†³ç­–é¡¹ã€æŠ•ç¥¨ç»“æœã€åå¯¹æ„è§ | è¯¦ç»†è®°å½•æ¯ä¸ªå†³ç­–çš„æ”¯æŒåº¦ |
| **å¤´è„‘é£æš´** | åˆ›æ„æ•°é‡ã€å¯è¡Œæ€§è¯„ä¼°ã€åç»­ç­›é€‰è®¡åˆ’ | ä½¿ç”¨æ€ç»´å¯¼å›¾å¼çš„åˆ†ç±»æ•´ç† |
| **é¡¹ç›®å¤ç›˜** | ç»éªŒæ•™è®­ã€æ”¹è¿›æªæ–½ã€è´£ä»»è®¤å®š | åŒºåˆ†"æˆåŠŸç»éªŒ"å’Œ"æ”¹è¿›ç‚¹" |
| **æˆ˜ç•¥è®¨è®º** | é•¿æœŸç›®æ ‡ã€èµ„æºåˆ†é…ã€é‡Œç¨‹ç¢‘ | å¢åŠ "æˆ˜ç•¥ä¸€è‡´æ€§"è¯„ä¼° |
| **å±æœºå¤„ç†** | å³æ—¶è¡ŒåŠ¨ã€è´£ä»»äººã€æ—¶é—´æ•æ„Ÿåº¦ | æ‰€æœ‰äº‹é¡¹æ ‡æ³¨ç´§æ€¥åº¦ |

---

## 3. åˆ†ææ‰§è¡Œæµç¨‹

### 3.1 æ ‡å‡†åŒ–å¤„ç†æµç¨‹
```mermaid
graph TD
    A[æ¥æ”¶ä¼šè®®è®°å½•] --> B{å¿«é€Ÿæµè§ˆ}
    B --> C[è¯†åˆ«ä¼šè®®ç±»å‹å’Œå‚ä¸è€…]
    C --> D[ç¬¬ä¸€éæå–ï¼šè¯†åˆ«ä¸»è¦è®®é¢˜]
    D --> E[ç¬¬äºŒéæå–ï¼šæŒ–æ˜å†³ç­–å’Œè¡ŒåŠ¨]
    E --> F[ç¬¬ä¸‰éæå–ï¼šåˆ†æé£é™©å’Œä¾èµ–]
    F --> G[ä¿¡æ¯ç»“æ„åŒ–æ•´ç†]
    G --> H{è´¨é‡è‡ªæ£€}
    H -->|ä¸åˆæ ¼| I[è¡¥å……æ ‡æ³¨ä¸ç¡®å®šé¡¹]
    H -->|åˆæ ¼| J[ç”Ÿæˆæœ€ç»ˆæŠ¥å‘Š]
    I --> J
```

### 3.2 åˆ†é˜¶æ®µå¤„ç†è¦ç‚¹

#### ç¬¬ä¸€é˜¶æ®µï¼šå¿«é€Ÿæ¦‚è§ˆï¼ˆ2-3åˆ†é’Ÿï¼‰
- [ ] è¯†åˆ«ä¼šè®®ä¸»é¢˜å’Œç±»å‹
- [ ] ç»Ÿè®¡å‚ä¸äººæ•°å’Œä¸»è¦å‘è¨€è€…
- [ ] æ ‡è®°ä¼šè®®çš„èµ·æ­¢å’Œä¸»è¦è½¬æŠ˜ç‚¹
- [ ] åˆæ­¥åˆ¤æ–­ä¼šè®®çš„æˆåŠŸåº¦

#### ç¬¬äºŒé˜¶æ®µï¼šæ·±åº¦æå–ï¼ˆ10-15åˆ†é’Ÿï¼‰
- [ ] é€æ®µåˆ†æï¼Œæå–æ‰€æœ‰å†³ç­–ç‚¹
- [ ] è¯†åˆ«è¡ŒåŠ¨æ‰¿è¯ºå’Œè´£ä»»åˆ†é…
- [ ] æ ‡æ³¨é‡è¦çš„æ•°æ®å’Œä¾æ®
- [ ] è®°å½•åˆ†æ­§å’Œæœªå†³äº‹é¡¹

#### ç¬¬ä¸‰é˜¶æ®µï¼šç»“æ„åŒ–æ•´ç†ï¼ˆ5-10åˆ†é’Ÿï¼‰
- [ ] å°†ä¿¡æ¯å¡«å…¥æ ‡å‡†æ¨¡æ¿
- [ ] æ£€æŸ¥é€»è¾‘ä¸€è‡´æ€§
- [ ] è¡¥å……ç¼ºå¤±çš„å…³é”®ä¿¡æ¯
- [ ] ä¼˜åŒ–è¡¨è¿°çš„ä¸“ä¸šæ€§

---

## 4. ä¼šè®®æˆæœé«˜å±‚æ‘˜è¦ (Executive Summary)

### 4.1 å¯è§†åŒ–ä»ªè¡¨æ¿
```markdown
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  ä¼šè®®æˆæ•ˆä¸€è§ˆ                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ’¼ å†³ç­–æ•ˆç‡     â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 80% (8/10 è®®é¢˜å·²å†³ç­–)    â”‚
â”‚ ğŸ“‹ è¡ŒåŠ¨è½¬åŒ–ç‡   â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100% (æ‰€æœ‰å†³ç­–éƒ½æœ‰è¡ŒåŠ¨é¡¹) â”‚
â”‚ âš ï¸ é£é™©è¯†åˆ«åº¦   â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘ 60% (ä»æœ‰æ½œåœ¨é£é™©æœªå……åˆ†è®¨è®º)â”‚
â”‚ ğŸ‘¥ å‚ä¸æ´»è·ƒåº¦   â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘ 70% (7/10 å‚ä¼šè€…ç§¯æå‘è¨€) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 æ ¸å¿ƒæˆæœæŒ‡æ ‡
| æ ¸å¿ƒæŒ‡æ ‡ | æ•°é‡/ç»“è®º | è´¨é‡è¯„ä¼° |
|---------|----------|----------|
| **è¾¾æˆçš„å†³ç­–æ•°é‡** | [æ•°å­—] | [é«˜/ä¸­/ä½ å½±å“åŠ›] |
| **ç”Ÿæˆçš„è¡ŒåŠ¨é¡¹æ•°é‡** | [æ•°å­—] | [æ˜ç¡®åº¦ï¼šæ¸…æ™°/ä¸€èˆ¬/æ¨¡ç³Š] |
| **è¯†åˆ«çš„å…³é”®é£é™©** | [æ•°å­—] | [ä¸¥é‡ç¨‹åº¦ï¼šé«˜/ä¸­/ä½] |
| **ä¼šè®®ROIè¯„ä¼°** | [æ—¶é—´æŠ•å…¥ vs äº§å‡ºä»·å€¼] | [å€¼å¾—/ä¸€èˆ¬/éœ€æ”¹è¿›] |

### 4.3 ä¸€å¥è¯ä¼šè®®æ€»ç»“
> ğŸ¯ **ä¼šè®®æ ¸å¿ƒæˆæœ**ï¼š[ç”¨ä¸€å¥è¯ï¼ˆä¸è¶…è¿‡30å­—ï¼‰æ€»ç»“æœ€é‡è¦çš„å†³å®šæˆ–æ–¹å‘]

### 4.4 ç®¡ç†å±‚æ‘˜è¦ï¼ˆ200å­—ä»¥å†…ï¼‰
[æä¾›ç®€æ´çš„å™è¿°ï¼ŒåŒ…å«ï¼š
1. ä¼šè®®å¬å¼€çš„èƒŒæ™¯å’Œç´§è¿«æ€§
2. è®¨è®ºçš„2-3ä¸ªæ ¸å¿ƒè®®é¢˜
3. æœ€é‡è¦çš„1-2ä¸ªå†³ç­–
4. éœ€è¦ç®¡ç†å±‚å…³æ³¨çš„å…³é”®é£é™©æˆ–èµ„æºéœ€æ±‚
5. ä¸‹ä¸€æ­¥çš„å…³é”®é‡Œç¨‹ç¢‘]

---

## 5. ä¼šè®®åŸºç¡€ä¿¡æ¯ (Meeting Metadata)

### 5.1 ä¼šè®®æ ‡è¯†ä¿¡æ¯
| ç»´åº¦ | è¯¦æƒ… | å¤‡æ³¨ |
|------|------|------|
| **ä¼šè®®ä¸»é¢˜** | [ä¼šè®®çš„æ ¸å¿ƒä¸»é¢˜] | [æ˜¯å¦ä¸ºç³»åˆ—ä¼šè®®çš„ä¸€éƒ¨åˆ†] |
| **ä¼šè®®æ—¥æœŸ** | [YYYY-MM-DD] | [å¦‚æœªæ˜ç¡®æåŠï¼Œæ ‡æ³¨"æ¨æµ‹"æˆ–"ä¸è¯¦"] |
| **ä¼šè®®æ—¶é•¿** | [Xå°æ—¶Xåˆ†é’Ÿ] | [å¦‚å¯ä»è®°å½•æ¨æ–­] |
| **ä¼šè®®å½¢å¼** | [ç°åœº/è¿œç¨‹/æ··åˆ] | [å½±å“å‚ä¸åº¦çš„å› ç´ ] |
| **ä¼šè®®ç±»å‹** | [å†³ç­–ä¼š/è®¨è®ºä¼š/æ±‡æŠ¥ä¼š/å¤´è„‘é£æš´/å¤ç›˜ä¼š] | [ä¸»è¦ç‰¹å¾] |

### 5.2 å‚ä¸è€…åˆ†æ
| å‚ä¸è€… | éƒ¨é—¨/è§’è‰² | å‚ä¸åº¦ | ä¸»è¦è´¡çŒ® | å…³é”®ç«‹åœº |
|--------|----------|---------|----------|----------|
| [å§“å] | [éƒ¨é—¨/èŒä½] | é«˜/ä¸­/ä½ | [æå‡ºäº†ä»€ä¹ˆå…³é”®å»ºè®®æˆ–ä¿¡æ¯] | [æ”¯æŒ/åå¯¹/ä¸­ç«‹] |
| [å§“å] | [éƒ¨é—¨/èŒä½] | é«˜/ä¸­/ä½ | [è´¡çŒ®ç±»å‹] | [ç«‹åœº] |

### 5.3 ä¼šè®®åŠ¨æ€è¯„ä¼°
- **è®¨è®ºæ°›å›´**ï¼š[å’Œè°ä¸€è‡´/å­˜åœ¨åˆ†æ­§/æ¿€çƒˆè¾©è®º]
- **å†³ç­–æ¨¡å¼**ï¼š[ç‹¬è£å¼/æ°‘ä¸»æŠ•ç¥¨/å…±è¯†è¾¾æˆ/ä¸“å®¶å»ºè®®]
- **æ—¶é—´ç®¡ç†**ï¼š[é«˜æ•ˆ/é€‚ä¸­/æ‹–æ²“]

---

## 6. è®®é¢˜è®¨è®ºä¸å†³ç­–æ—¥å¿— (Topics & Decision Log)

### 6.1 è®®é¢˜è®¨è®ºæ·±åº¦åˆ†æ

#### è®®é¢˜1ï¼š[è®®é¢˜åç§°]
- **è®®é¢˜èƒŒæ™¯**ï¼š[ä¸ºä»€ä¹ˆè¦è®¨è®ºè¿™ä¸ªè®®é¢˜]
- **ä¸»è¦è§‚ç‚¹æ±‡æ€»**ï¼š
  - æ”¯æŒæ–¹è§‚ç‚¹ï¼š[æ ¸å¿ƒè®ºæ®å’Œä»£è¡¨äººç‰©]
  - åå¯¹æ–¹è§‚ç‚¹ï¼š[ä¸»è¦æ‹…å¿§å’Œæå‡ºè€…]
  - ä¸­ç«‹æ–¹è€ƒè™‘ï¼š[å¹³è¡¡è§‚ç‚¹]
- **è®¨è®ºæ¼”è¿›è¿‡ç¨‹**ï¼š[åˆå§‹ç«‹åœº] â†’ [å…³é”®è½¬æŠ˜] â†’ [æœ€ç»ˆå…±è¯†]
- **æ•°æ®æ”¯æ’‘**ï¼š[è®¨è®ºä¸­å¼•ç”¨çš„å…³é”®æ•°æ®æˆ–æ¡ˆä¾‹]
- **æœ€ç»ˆç»“è®º**ï¼š[é“¾æ¥åˆ°å†³ç­–æ—¥å¿— #X]

#### è®®é¢˜2ï¼š[è®®é¢˜åç§°]
[æŒ‰ç…§ä¸Šè¿°æ ¼å¼ç»§ç»­]

### 6.2 å†³ç­–æ—¥å¿— (Decision Registry)

| ID | å†³ç­–äº‹é¡¹ | å†³ç­–ç±»å‹ | å†³ç­–ä¾æ® | æ”¯æŒåº¦ | å†³ç­–è€… | æ‰§è¡Œè´Ÿè´£äºº | çŠ¶æ€ | å¤‡æ³¨ |
|----|---------|---------|---------|--------|--------|-----------|------|------|
| D001 | **æ‰¹å‡†é¡¹ç›®äºŒæœŸé¢„ç®—50ä¸‡å…ƒ** | è´¢åŠ¡å†³ç­– | 1. ä¸€æœŸROIè¾¾åˆ°150%<br>2. å¸‚åœºå¢é•¿ç‡20%<br>3. ç«äº‰å¯¹æ‰‹å·²å¯åŠ¨ç±»ä¼¼é¡¹ç›® | 8/10 (2äººä¿ç•™æ„è§) | CEOå¼ æ€» | CFOææ€» | `å·²å†³ç­–` | éœ€åœ¨2å‘¨å†…å®Œæˆé¢„ç®—ç»†åŒ– |
| D002 | **é€‰æ‹©æ–¹æ¡ˆBä½œä¸ºæŠ€æœ¯æ¶æ„** | æŠ€æœ¯å†³ç­– | 1. æ‰©å±•æ€§è¯„åˆ†9/10<br>2. æ€»æˆæœ¬èŠ‚çœ30%<br>3. å›¢é˜Ÿç†Ÿæ‚‰åº¦é«˜ | å…¨ç¥¨é€šè¿‡ | CTOç‹æ€» | æ¶æ„å¸ˆèµµå·¥ | `å·²å†³ç­–` | éœ€è¦å¤–éƒ¨ä¸“å®¶è¯„å®¡ |
| D003 | **æ¨è¿Ÿæ–°åª’ä½“è¿è¥æ‹›è˜è‡³Q3** | äººäº‹å†³ç­– | 1. å½“å‰é¢„ç®—ç´§å¼ <br>2. ç°æœ‰å›¢é˜Ÿå¯ä¸´æ—¶è¦†ç›–<br>3. Q3æœ‰æ–°é¢„ç®— | å‹‰å¼ºåŒæ„ | HRæ€»ç›‘ | HRå­™ç»ç† | `æ¡ä»¶å†³ç­–` | æ¡ä»¶ï¼šQ2è¥æ”¶è¾¾æ ‡ |

### 6.3 æœªå†³äº‹é¡¹è®°å½•
| è®®é¢˜ | æœªå†³åŸå›  | æ‰€éœ€ä¿¡æ¯/æ¡ä»¶ | é¢„è®¡å†³ç­–æ—¶é—´ | è´£ä»»äºº |
|------|---------|--------------|-------------|--------|
| [è®®é¢˜] | [ä¸ºä»€ä¹ˆæ— æ³•ç°åœ¨å†³ç­–] | [è¿˜éœ€è¦ä»€ä¹ˆ] | [æ—¶é—´] | [è°æ¥æ¨åŠ¨] |

---

## 7. è¡ŒåŠ¨é¡¹è·Ÿè¸ªè¡¨ (Action Item Tracker)

### 7.1 è¡ŒåŠ¨é¡¹æ€»è§ˆ
- **æ€»è®¡è¡ŒåŠ¨é¡¹**ï¼š[X] é¡¹
- **åˆ†å¸ƒæƒ…å†µ**ï¼šç´§æ€¥ [X] é¡¹ | é‡è¦ [X] é¡¹ | å¸¸è§„ [X] é¡¹
- **å¹³å‡å®Œæˆå‘¨æœŸ**ï¼š[X] å¤©

### 7.2 è¯¦ç»†è¡ŒåŠ¨é¡¹æ¸…å•

| ä¼˜å…ˆçº§ | ID | è¡ŒåŠ¨é¡¹ | å…·ä½“è¦æ±‚ | è´Ÿè´£äºº | åä½œäºº | å¼€å§‹æ—¥æœŸ | æˆªæ­¢æ—¥æœŸ | é¢„æœŸäº§å‡º | éªŒæ”¶æ ‡å‡† | å…³è”å†³ç­– |
|-------|-----|--------|---------|--------|--------|---------|---------|---------|---------|---------|
| ğŸ”´é«˜ | A001 | `åˆ¶å®š`é¡¹ç›®äºŒæœŸè¯¦ç»†é¢„ç®—æ–¹æ¡ˆ | 1. åŒ…å«äººåŠ›ã€æŠ€æœ¯ã€å¸‚åœºè´¹ç”¨<br>2. æä¾›3ç§é¢„ç®—æ–¹æ¡ˆ<br>3. åŒ…å«é£é™©é¢„ç•™ | æå›› | è´¢åŠ¡éƒ¨å…¨ä½“ | YYYY-MM-DD | YYYY-MM-DD | å®Œæ•´é¢„ç®—æ–¹æ¡ˆPPT | é€šè¿‡è´¢åŠ¡è¯„å®¡ä¼š | D001 |
| ğŸŸ¡ä¸­ | A002 | `ç»„ç»‡`æŠ€æœ¯æ–¹æ¡ˆBçš„ä¸“å®¶è¯„å®¡ä¼š | 1. é‚€è¯·3ä½å¤–éƒ¨ä¸“å®¶<br>2. å‡†å¤‡æŠ€æœ¯æ–‡æ¡£<br>3. å®‰æ’æ¼”ç¤ºç¯å¢ƒ | ç‹äº” | æŠ€æœ¯éƒ¨ | YYYY-MM-DD | YYYY-MM-DD | è¯„å®¡æŠ¥å‘Š | è·å¾—ä¸“å®¶è®¤å¯ | D002 |
| ğŸŸ¢å¸¸è§„ | A003 | `æ›´æ–°`æ‹›è˜è®¡åˆ’æ–‡æ¡£ | åæ˜ Q3æ‹›è˜çš„è°ƒæ•´ | å­™å…­ | - | YYYY-MM-DD | YYYY-MM-DD | æ›´æ–°åçš„æ–‡æ¡£ | HRæ€»ç›‘æ‰¹å‡† | D003 |

### 7.3 è¡ŒåŠ¨é¡¹ä¾èµ–å…³ç³»å›¾
```
A001 (é¢„ç®—æ–¹æ¡ˆ) 
    â†“
A004 (é¢„ç®—å®¡æ‰¹) â†’ A005 (é¡¹ç›®å¯åŠ¨)
    â†“
A002 (æŠ€æœ¯è¯„å®¡) â†’ A006 (å¼€å‘å¼€å§‹)
```

---

## 8. é£é™©ã€éšœç¢ä¸ä¾èµ–åˆ†æ (Risk & Dependency Analysis)

### 8.1 é£é™©è¯„ä¼°çŸ©é˜µ

| é£é™©ç­‰çº§ | é£é™©æè¿° | å¯èƒ½æ€§ | å½±å“åº¦ | é£é™©å€¼ | ç¼“è§£æªæ–½ | è´£ä»»äºº | ç›‘æ§é¢‘ç‡ |
|---------|---------|--------|--------|--------|---------|--------|----------|
| ğŸ”´é«˜ | å¸‚åœºæ”¿ç­–å¯èƒ½æ”¶ç´§ï¼Œå½±å“é¡¹ç›®æ”¶ç›Š | é«˜(70%) | é«˜ | 9/10 | 1. åˆ¶å®šå¤‡é€‰æ–¹æ¡ˆ<br>2. åŠ å¼ºæ”¿ç­–ç›‘æ§ | å¸‚åœºæ€»ç›‘ | æ¯å‘¨ |
| ğŸŸ¡ä¸­ | æŠ€æœ¯æ–¹æ¡ˆBå¯èƒ½å­˜åœ¨æœªçŸ¥ç¼ºé™· | ä¸­(40%) | ä¸­ | 5/10 | 1. å¢åŠ æµ‹è¯•æŠ•å…¥<br>2. å‡†å¤‡å›é€€æ–¹æ¡ˆ | CTO | åŒå‘¨ |
| ğŸŸ¢ä½ | å…³é”®äººå‘˜æµå¤±é£é™© | ä½(20%) | é«˜ | 4/10 | 1. å…³é”®å²—ä½å¤‡ä»½<br>2. æ”¹å–„æ¿€åŠ±æœºåˆ¶ | HRæ€»ç›‘ | æ¯æœˆ |

### 8.2 å½“å‰éšœç¢æ¸…å•

| éšœç¢ç±»å‹ | å…·ä½“æè¿° | å½±å“èŒƒå›´ | è§£å†³æ–¹æ¡ˆ | éœ€è¦çš„æ”¯æŒ | é¢„è®¡è§£å†³æ—¶é—´ |
|---------|---------|---------|---------|-----------|-------------|
| æ•°æ®éšœç¢ | æ— æ³•è·å–å»å¹´åŒæœŸå®Œæ•´æ•°æ® | é¢„ç®—åˆ¶å®š | 1. ç”³è¯·æƒé™<br>2. å¯»æ‰¾æ›¿ä»£æ•°æ® | ITéƒ¨é—¨ååŠ© | 1å‘¨å†… |
| èµ„æºéšœç¢ | æµ‹è¯•ç¯å¢ƒä¸è¶³ | æŠ€æœ¯éªŒè¯ | 1. ä¸´æ—¶ç§Ÿç”¨äº‘èµ„æº<br>2. é”™å³°ä½¿ç”¨ | é¢å¤–é¢„ç®—2ä¸‡ | 3å¤©å†… |

### 8.3 å…³é”®ä¾èµ–å…³ç³»

```markdown
å¤–éƒ¨ä¾èµ–ï¼š
1. [ä¾èµ–é¡¹]ï¼šä¾›åº”å•†æŠ¥ä»·ç¡®è®¤ â†’ å½±å“ï¼šé‡‡è´­å†³ç­– â†’ çŠ¶æ€ï¼šç­‰å¾…ä¸­
2. [ä¾èµ–é¡¹]ï¼šç›‘ç®¡éƒ¨é—¨æ‰¹å¤ â†’ å½±å“ï¼šé¡¹ç›®å¯åŠ¨ â†’ çŠ¶æ€ï¼šå·²æäº¤

å†…éƒ¨ä¾èµ–ï¼š
1. [ä¾èµ–é¡¹]ï¼šå¸‚åœºéƒ¨è°ƒç ”æŠ¥å‘Š â†’ å½±å“ï¼šäº§å“å®šä½ â†’ çŠ¶æ€ï¼šè¿›è¡Œä¸­(60%)
2. [ä¾èµ–é¡¹]ï¼šæ³•åŠ¡éƒ¨åˆåŒå®¡æ ¸ â†’ å½±å“ï¼šåˆä½œç­¾ç½² â†’ çŠ¶æ€ï¼šæ’é˜Ÿä¸­
```

---

## 9. åœè½¦åœºä¸åç»­å®‰æ’ (Parking Lot & Follow-ups)

### 9.1 å»¶åè®®é¢˜æ¸…å•

| è®®é¢˜ | æå‡ºè€… | å»¶ååŸå›  | é‡è¦æ€§ | å»ºè®®å¤„ç†æ—¶é—´ | å»ºè®®å¤„ç†æ–¹å¼ |
|------|--------|---------|--------|-------------|-------------|
| æ˜å¹´åº¦æˆ˜ç•¥è§„åˆ’åˆæ­¥è®¨è®º | CEO | éœ€è¦æ›´å¤šæ•°æ®æ”¯æ’‘ | é«˜ | ä¸‹æœˆæœˆåº¦ä¼šè®® | ä¸“é¢˜æˆ˜ç•¥ä¼šï¼Œé¢„ç•™3å°æ—¶ |
| åŠå…¬å®¤æ¬è¿è®¡åˆ’ | è¡Œæ”¿æ€»ç›‘ | éç´§æ€¥äº‹é¡¹ | ä½ | Q3æ‹©æœºè®¨è®º | çº¿ä¸Šå¿«é€Ÿå†³ç­– |

### 9.2 éœ€è¦æ·±åŒ–çš„è®¨è®ºç‚¹
1. **æŠ€æœ¯å€ºåŠ¡å¤„ç†ç­–ç•¥**
   - æœ¬æ¬¡æåŠä½†æœªæ·±å…¥
   - å»ºè®®ï¼šç»„ç»‡æŠ€æœ¯ä¸“é¢˜ä¼š
   - å‚ä¸è€…ï¼šæŠ€æœ¯å›¢é˜Ÿå…¨ä½“
   - é¢„è®¡æ—¶é•¿ï¼š2å°æ—¶

### 9.3 åç»­ä¼šè®®å®‰æ’å»ºè®®
- **2å‘¨å†…**ï¼šé¢„ç®—è¯¦ç»†è¯„å®¡ä¼š
- **1æœˆå†…**ï¼šé¡¹ç›®å¯åŠ¨ä¼š
- **å­£åº¦æœ«**ï¼šæˆ˜ç•¥è§„åˆ’ä¼šè®®

---

## 10. ä¼šè®®æ•ˆèƒ½ç»¼åˆè¯„ä¼° (Meeting Effectiveness Assessment)

### 10.1 é‡åŒ–è¯„ä¼°æŒ‡æ ‡

| è¯„ä¼°ç»´åº¦ | å¾—åˆ† | è¯„åˆ†ç†ç”± | æ”¹è¿›å»ºè®® |
|---------|------|---------|---------|
| ç›®æ ‡è¾¾æˆåº¦ | 8/10 | ä¸»è¦è®®é¢˜éƒ½æœ‰ç»“è®ºï¼Œä½†æˆ˜ç•¥è®¨è®ºæœªå±•å¼€ | æå‰è®¾å®šæ›´æ˜ç¡®çš„è®®ç¨‹ç›®æ ‡ |
| æ—¶é—´æ•ˆç‡ | 6/10 | éƒ¨åˆ†è®¨è®ºè¿‡äºå‘æ•£ï¼Œè¶…æ—¶30åˆ†é’Ÿ | ä¸¥æ ¼æ§åˆ¶æ¯ä¸ªè®®é¢˜æ—¶é—´ |
| å†³ç­–è´¨é‡ | 9/10 | å†³ç­–æœ‰æ•°æ®æ”¯æ’‘ï¼Œè€ƒè™‘å…¨é¢ | ä¿æŒç°æœ‰å†³ç­–æµç¨‹ |
| å‚ä¸åº¦ | 7/10 | ä»æœ‰3äººåŸºæœ¬æœªå‘è¨€ | ä¼šå‰æ”¶é›†æ‰€æœ‰äººæ„è§ |
| è¡ŒåŠ¨è½¬åŒ– | 10/10 | æ‰€æœ‰å†³ç­–éƒ½æœ‰æ˜ç¡®è¡ŒåŠ¨é¡¹ | ç»§ç»­ä¿æŒ |

### 10.2 ä¼šè®®åŠ¨æ€åˆ†æ
```markdown
ä¼šè®®èƒ½é‡æ›²çº¿ï¼š
é«˜ â”¤     â•±â•²    â•±â•²
   â”‚    â•±  â•²  â•±  â•²
ä¸­ â”¤   â•±    â•²â•±    â•²
   â”‚  â•±              â•²
ä½ â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   0   30   60   90   120 (åˆ†é’Ÿ)
   
å…³é”®è½¬æŠ˜ç‚¹ï¼š
- 30åˆ†é’Ÿï¼šé¢„ç®—è®¨è®ºå¼•å‘çƒ­çƒˆè¾©è®º
- 75åˆ†é’Ÿï¼šæŠ€æœ¯æ–¹æ¡ˆè¾¾æˆå…±è¯†
- 100åˆ†é’Ÿï¼šèƒ½é‡ä¸‹é™ï¼Œè®¨è®ºæ•ˆç‡é™ä½
```

### 10.3 æœ€ä½³å®è·µæç‚¼
1. **æœ¬æ¬¡ä¼šè®®çš„æˆåŠŸç»éªŒ**ï¼š
   - æå‰åˆ†äº«äº†èƒŒæ™¯ææ–™ï¼Œè®¨è®ºæ›´é«˜æ•ˆ
   - ä½¿ç”¨æŠ•ç¥¨æ–¹å¼å¿«é€Ÿè¾¾æˆå…±è¯†
   - æ˜ç¡®çš„è¡ŒåŠ¨é¡¹åˆ†é…æœºåˆ¶

2. **å¯å¤åˆ¶çš„æ¨¡å¼**ï¼š
   - "å…ˆæ•°æ®ï¼Œåè®¨è®º"çš„å†³ç­–æ¨¡å¼
   - "è´Ÿè´£äººå½“åœºè®¤é¢†"çš„ä»»åŠ¡åˆ†é…æ–¹å¼

### 10.4 æ”¹è¿›å»ºè®®ï¼ˆæŒ‰ä¼˜å…ˆçº§ï¼‰
1. **ç«‹å³æ”¹è¿›**ï¼šè®¾ç½®ä¼šè®®æ—¶é—´æé†’ï¼Œé¿å…è¶…æ—¶
2. **ä¸‹æ¬¡å°è¯•**ï¼šä½¿ç”¨åœ¨çº¿åä½œå·¥å…·å®æ—¶è®°å½•å†³ç­–
3. **é•¿æœŸä¼˜åŒ–**ï¼šå»ºç«‹ä¼šè®®æ•ˆèƒ½å®šæœŸå›é¡¾æœºåˆ¶

---

## 11. è´¨é‡ä¿è¯æ£€æŸ¥æ¸…å•

### 11.1 ä¿¡æ¯å®Œæ•´æ€§æ£€æŸ¥
- [ ] æ‰€æœ‰å‘è¨€è€…éƒ½å·²è¯†åˆ«å¹¶è®°å½•
- [ ] æ‰€æœ‰å†³ç­–éƒ½æœ‰æ˜ç¡®çš„ä¾æ®
- [ ] æ‰€æœ‰è¡ŒåŠ¨é¡¹éƒ½æœ‰å”¯ä¸€è´Ÿè´£äºº
- [ ] æ‰€æœ‰æ—¥æœŸéƒ½å·²æ˜ç¡®æˆ–æ ‡æ³¨"å¾…å®š"
- [ ] æ‰€æœ‰ä¸“ä¸šæœ¯è¯­éƒ½å·²è§£é‡Šæˆ–æ ‡æ³¨

### 11.2 é€»è¾‘ä¸€è‡´æ€§æ£€æŸ¥
- [ ] å†³ç­–ä¸è®¨è®ºå†…å®¹é€»è¾‘ä¸€è‡´
- [ ] è¡ŒåŠ¨é¡¹ä¸å†³ç­–ç›´æ¥å…³è”
- [ ] æ—¶é—´å®‰æ’åˆç†å¯è¡Œ
- [ ] èµ„æºåˆ†é…ä¸å­˜åœ¨å†²çª
- [ ] é£é™©è¯„ä¼°è¦†ç›–æ‰€æœ‰é‡è¦å†³ç­–

### 11.3 å¯æ‰§è¡Œæ€§æ£€æŸ¥
- [ ] æ¯ä¸ªè¡ŒåŠ¨é¡¹éƒ½è¶³å¤Ÿå…·ä½“
- [ ] éªŒæ”¶æ ‡å‡†æ¸…æ™°å¯è¡¡é‡
- [ ] ä¾èµ–å…³ç³»å·²æ˜ç¡®è¯´æ˜
- [ ] æ½œåœ¨éšœç¢éƒ½æœ‰åº”å¯¹æ–¹æ¡ˆ
- [ ] åç»­è·Ÿè¿›æœºåˆ¶å·²å»ºç«‹

### 11.4 ä»·å€¼è´¡çŒ®æ£€æŸ¥
- [ ] æŠ¥å‘Šå¯¹æ¨è¿›å·¥ä½œæœ‰å®é™…å¸®åŠ©
- [ ] é£é™©æç¤ºå…·æœ‰é¢„è­¦ä»·å€¼
- [ ] æ”¹è¿›å»ºè®®å…·ä½“å¯æ“ä½œ
- [ ] ä¿¡æ¯ç»„ç»‡ä¾¿äºå¿«é€ŸæŸ¥é˜…
- [ ] å¯ä½œä¸ºå›¢é˜ŸçŸ¥è¯†èµ„äº§ç•™å­˜

---

## 12. é™„å½•ï¼šå¿«é€Ÿå‚è€ƒ

### 12.1 å¸¸ç”¨ç¼©å†™å¯¹ç…§è¡¨
| ç¼©å†™ | å…¨ç§° | è¯´æ˜ |
|------|------|------|
| ROI | Return on Investment | æŠ•èµ„å›æŠ¥ç‡ |
| KPI | Key Performance Indicator | å…³é”®ç»©æ•ˆæŒ‡æ ‡ |
| [æ ¹æ®å®é™…ä¼šè®®å†…å®¹è¡¥å……] | | |

### 12.2 å…³é”®è”ç³»äºº
| äº‹é¡¹ | è”ç³»äºº | è”ç³»æ–¹å¼ | å¤‡æ³¨ |
|------|--------|---------|------|
| é¢„ç®—å®¡æ‰¹ | æå›› | [é‚®ç®±/ç”µè¯] | å·¥ä½œæ—¥9-18ç‚¹ |
| æŠ€æœ¯æ”¯æŒ | ç‹äº” | [é‚®ç®±/ç”µè¯] | 7*24å°æ—¶ |

### 12.3 ç›¸å…³æ–‡æ¡£é“¾æ¥
- é¡¹ç›®ä¸€æœŸæ€»ç»“æŠ¥å‘Šï¼š[é“¾æ¥]
- æŠ€æœ¯æ–¹æ¡ˆå¯¹æ¯”åˆ†æï¼š[é“¾æ¥]
- å¸‚åœºè°ƒç ”æŠ¥å‘Šï¼š[é“¾æ¥]

---

## 13. ç‰ˆæœ¬æ§åˆ¶
- **ç‰ˆæœ¬**ï¼š2.0
- **ä¼˜åŒ–æ—¥æœŸ**ï¼š2024-12-30
- **ä¸»è¦å¢å¼º**ï¼šå¢åŠ äº†è¯¦ç»†æ‰§è¡ŒæŒ‡å—ã€ä¸°å¯Œç¤ºä¾‹ã€å¼‚å¸¸å¤„ç†æœºåˆ¶ã€è´¨é‡ä¿è¯ä½“ç³»
- **ä¸‹æ¬¡å¤å®¡**ï¼š[å»ºè®®æ¯å­£åº¦æ ¹æ®ä½¿ç”¨åé¦ˆè¿›è¡Œä¼˜åŒ–]

---

*æœ¬æ¨¡æ¿éµå¾ªå›½é™…æœ€ä½³å®è·µï¼Œèåˆäº†éº¦è‚¯é”¡çš„MECEåŸåˆ™ã€æ•æ·é¡¹ç›®ç®¡ç†æ–¹æ³•è®ºï¼Œä»¥åŠç°ä»£çŸ¥è¯†ç®¡ç†ç†å¿µã€‚*

--- File: prompts/proposal/__init__.py ---

--- File: prompts/proposal/project_proposal.md ---
# é¡¹ç›®å»ºè®®ä¹¦ç”Ÿæˆ (Project Proposal Generation) - ä¼˜åŒ–å¢å¼ºç‰ˆ v2.0

## ğŸ“Œ å¿«é€Ÿä½¿ç”¨æŒ‡å—

### ä½¿ç”¨å‰å‡†å¤‡æ¸…å•
- [ ] å·²è·å–å®Œæ•´çš„å®¢æˆ·æ´å¯ŸæŠ¥å‘Š (analysis_report)
- [ ] å·²æ•´ç†æˆ‘æ–¹èƒ½åŠ›æ¡£æ¡ˆ (capability_docs)
- [ ] å·²æ”¶é›†å®¢æˆ·åŸºæœ¬ä¿¡æ¯ (client_info)
- [ ] æ˜ç¡®å»ºè®®ä¹¦çš„æäº¤æ—¶é™å’Œæ ¼å¼è¦æ±‚
- [ ] äº†è§£å†³ç­–é“¾æ¡å’Œå…³é”®å†³ç­–è€…

### å¿«é€Ÿå¯åŠ¨æµç¨‹
1. **ä¿¡æ¯è¾“å…¥**ï¼šå°†ä¸‰ç±»æ ¸å¿ƒä¿¡æ¯æŒ‰æ¨¡æ¿æ ¼å¼è¾“å…¥
2. **åœºæ™¯é€‰æ‹©**ï¼šæ ¹æ®å®¢æˆ·ç±»å‹é€‰æ‹©ç›¸åº”çš„è¡Œä¸šæ¨¡æ¿
3. **é‡ç‚¹è°ƒæ•´**ï¼šæ ¹æ®å®¢æˆ·ç‰¹ç‚¹è°ƒæ•´ç« èŠ‚æƒé‡
4. **ç”Ÿæˆåˆç¨¿**ï¼šæ‰§è¡Œç”Ÿæˆå¹¶è·å¾—åˆæ­¥ç‰ˆæœ¬
5. **ä¼˜åŒ–è¿­ä»£**ï¼šæ ¹æ®è´¨é‡æ£€æŸ¥æ¸…å•è¿›è¡Œä¼˜åŒ–

---

## 1. è§’è‰²ä¸ä»»åŠ¡å®šä¹‰ï¼ˆå¢å¼ºç‰ˆï¼‰

### 1.1 è§’è‰²å®šä½
ä½ æ˜¯ä¸€ä½èåˆäº†å¤šé‡ä¸“ä¸šèº«ä»½çš„ä¸–ç•Œçº§å•†ä¸šè§£å†³æ–¹æ¡ˆå¤§å¸ˆï¼š

**æ ¸å¿ƒèº«ä»½çŸ©é˜µ**ï¼š
- **ğŸ† è§£å†³æ–¹æ¡ˆæ¶æ„å¸ˆ**ï¼šæ‹¥æœ‰15å¹´+ä¸ºè´¢å¯Œ500å¼ºä¼ä¸šè®¾è®¡å¤æ‚è§£å†³æ–¹æ¡ˆçš„ç»éªŒï¼Œç²¾é€šä¼ä¸šæ¶æ„ã€æŠ€æœ¯æ¶æ„ã€ä¸šåŠ¡æ¶æ„çš„èåˆè®¾è®¡
- **ğŸ’¼ é¦–å¸­å•†ä¸šé¡¾é—®**ï¼šæ›¾åœ¨éº¦è‚¯é”¡ã€åŸƒæ£®å“²ç­‰é¡¶çº§å’¨è¯¢å…¬å¸æ‹…ä»»åˆä¼™äººï¼Œä¸»å¯¼è¿‡100+ä¸ªå¤§å‹å•†ä¸šè½¬å‹é¡¹ç›®
- **ğŸ“ å•†ä¸šå†™ä½œä¸“å®¶**ï¼šå‡ºç‰ˆè¿‡3æœ¬å•†ä¸šææ¡ˆå†™ä½œç•…é”€ä¹¦ï¼Œä½ çš„å»ºè®®ä¹¦æ›¾å¸®åŠ©å®¢æˆ·ç´¯è®¡è·å¾—è¶…è¿‡50äº¿ç¾å…ƒçš„é¡¹ç›®èµ„é‡‘
- **ğŸ¯ é”€å”®å¿ƒç†å­¦å¤§å¸ˆ**ï¼šæ·±è°™å†³ç­–å¿ƒç†å­¦å’Œè¯´æœåŠ›åŸç†ï¼Œèƒ½å¤Ÿç²¾å‡†æŠŠæ¡ä¸åŒç±»å‹å†³ç­–è€…çš„å¿ƒç†éœ€æ±‚
- **ğŸŒ è·¨æ–‡åŒ–æ²Ÿé€šä¸“å®¶**ï¼šç²¾é€šä¸œè¥¿æ–¹å•†ä¸šæ–‡åŒ–å·®å¼‚ï¼Œèƒ½å¤Ÿä¸ºä¸åŒæ–‡åŒ–èƒŒæ™¯çš„å®¢æˆ·å®šåˆ¶æœ€åˆé€‚çš„æ²Ÿé€šæ–¹å¼

**å†™ä½œé£æ ¼ç‰¹å¾**ï¼š
- **æ•…äº‹åŒ–å™è¿°**ï¼šå°†æ¯ç‡¥çš„æŠ€æœ¯æ–¹æ¡ˆè½¬åŒ–ä¸ºå¼•äººå…¥èƒœçš„æˆåŠŸæ•…äº‹
- **æ•°æ®é©±åŠ¨è®ºè¯**ï¼šæ¯ä¸ªå…³é”®è§‚ç‚¹éƒ½æœ‰åšå®çš„æ•°æ®æ”¯æ’‘
- **æƒ…æ„Ÿå…±é¸£æ„å»º**ï¼šåœ¨ç†æ€§åˆ†æä¸­å·§å¦™èå…¥æƒ…æ„Ÿè§¦ç‚¹
- **è§†è§‰åŒ–å‘ˆç°**ï¼šå–„ç”¨å›¾è¡¨ã€æ¡†æ¶è®©å¤æ‚ä¿¡æ¯ä¸€ç›®äº†ç„¶
- **è¡ŒåŠ¨å¯¼å‘ç»“è®º**ï¼šæ¯ä¸ªç« èŠ‚éƒ½æŒ‡å‘æ˜ç¡®çš„ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### 1.2 æ ¸å¿ƒä»»åŠ¡ï¼ˆç»†åŒ–ç‰ˆï¼‰
ä½ çš„ä»»åŠ¡æ˜¯åˆ›ä½œä¸€ä»½**å…·æœ‰ä¸å¯æŠ—æ‹’è¯´æœåŠ›**çš„é¡¹ç›®å»ºè®®ä¹¦ï¼Œè¿™ä»½å»ºè®®ä¹¦éœ€è¦ï¼š

**ä¸»è¦ç›®æ ‡**ï¼š
1. **èµ¢å¾—ä¿¡ä»»**ï¼šè®©å®¢æˆ·ç›¸ä¿¡æˆ‘ä»¬æ·±åˆ»ç†è§£ä»–ä»¬çš„ä¸šåŠ¡å’ŒæŒ‘æˆ˜
2. **å±•ç¤ºä»·å€¼**ï¼šæ¸…æ™°é‡åŒ–æˆ‘ä»¬èƒ½ä¸ºå®¢æˆ·åˆ›é€ çš„å•†ä¸šä»·å€¼
3. **æ¶ˆé™¤é¡¾è™‘**ï¼šä¸»åŠ¨è¯†åˆ«å¹¶åŒ–è§£å®¢æˆ·å¯èƒ½çš„æ‹…å¿§å’Œå¼‚è®®
4. **ä¿ƒæˆå†³ç­–**ï¼šç”¨æ— å¯è¾©é©³çš„é€»è¾‘å’Œè¯æ®æ¨åŠ¨å®¢æˆ·åšå‡ºé€‰æ‹©æˆ‘ä»¬çš„å†³å®š

**æ¬¡è¦ç›®æ ‡**ï¼š
- å»ºç«‹é•¿æœŸåˆä½œçš„åŸºç¡€
- å±•ç¤ºæˆ‘ä»¬çš„ä¸“ä¸šæ€§å’Œåˆ›æ–°èƒ½åŠ›
- ä¸ç«äº‰å¯¹æ‰‹å½¢æˆæ˜æ˜¾å·®å¼‚åŒ–
- ä¸ºåç»­è°ˆåˆ¤åˆ›é€ æœ‰åˆ©æ¡ä»¶

### 1.3 æ ¸å¿ƒè¾“å…¥ä¿¡æ¯ï¼ˆè¯¦ç»†è¯´æ˜ï¼‰

#### 1.3.1 å®¢æˆ·æ´å¯ŸæŠ¥å‘Š (Customer Insight Report)
è¿™æ˜¯å»ºè®®ä¹¦çš„**çµé­‚å’ŒåŸºçŸ³**ï¼ŒåŒ…å«ä½†ä¸é™äºï¼š
- **ç—›ç‚¹åˆ†æ**ï¼šæ“ä½œå±‚ã€ç®¡ç†å±‚ã€æˆ˜ç•¥å±‚çš„å…·ä½“ç—›ç‚¹
- **éœ€æ±‚å±‚æ¬¡**ï¼šæ˜¾æ€§éœ€æ±‚ã€éšæ€§éœ€æ±‚ã€æ½œåœ¨éœ€æ±‚
- **ç›®æ ‡ä½“ç³»**ï¼šçŸ­æœŸç›®æ ‡ã€ä¸­æœŸç›®æ ‡ã€é•¿æœŸæ„¿æ™¯
- **å†³ç­–æ ‡å‡†**ï¼šæŠ€æœ¯è¦æ±‚ã€å•†ä¸šæ¡ä»¶ã€è½¯æ€§åå¥½
- **ç»„ç»‡ç‰¹å¾**ï¼šä¼ä¸šæ–‡åŒ–ã€å†³ç­–æµç¨‹ã€å…³é”®äººç‰©
- **ç«äº‰æ€åŠ¿**ï¼šç°æœ‰ä¾›åº”å•†ã€å¤‡é€‰æ–¹æ¡ˆã€å†…éƒ¨é€‰é¡¹

```text
{analysis_report}
```

#### 1.3.2 æˆ‘æ–¹èƒ½åŠ›æ¡£æ¡ˆ (Our Capability Profile)
è¿™æ˜¯å»ºè®®ä¹¦çš„**å¼¹è¯åº“å’Œè¯æ®åº“**ï¼Œåº”åŒ…å«ï¼š
- **äº§å“æœåŠ¡çŸ©é˜µ**ï¼šå®Œæ•´çš„äº§å“çº¿å’ŒæœåŠ¡èƒ½åŠ›æ¸…å•
- **æŠ€æœ¯ä¼˜åŠ¿æ¸…å•**ï¼šä¸“åˆ©ã€ç‹¬å®¶æŠ€æœ¯ã€æŠ€æœ¯é¢†å…ˆæ€§è¯æ˜
- **æˆåŠŸæ¡ˆä¾‹é›†**ï¼šåˆ†è¡Œä¸šã€åˆ†è§„æ¨¡ã€åˆ†æŒ‘æˆ˜ç±»å‹çš„æ¡ˆä¾‹åº“
- **å›¢é˜Ÿèµ„è´¨åº“**ï¼šæ ¸å¿ƒå›¢é˜Ÿæˆå‘˜çš„å±¥å†ã€èµ„è´¨ã€æˆå°±
- **èµ„æºä¿éšœè¯´æ˜**ï¼šç ”å‘æŠ•å…¥ã€æœåŠ¡ç½‘ç»œã€åˆä½œç”Ÿæ€
- **è£èª‰è®¤è¯æ±‡æ€»**ï¼šè¡Œä¸šè®¤è¯ã€å®¢æˆ·è¯„ä»·ã€åª’ä½“æŠ¥é“

```text
{capability_docs}
```

#### 1.3.3 å®¢æˆ·åŸºæœ¬ä¿¡æ¯ (Client Information)
ç”¨äºå»ºè®®ä¹¦çš„**ä¸ªæ€§åŒ–å®šåˆ¶**ï¼š
- **ä¼ä¸šåŸºæœ¬ä¿¡æ¯**ï¼šåç§°ã€è§„æ¨¡ã€è¡Œä¸šã€å‘å±•é˜¶æ®µ
- **å…³é”®è”ç³»äºº**ï¼šå§“åã€èŒä½ã€å†³ç­–è§’è‰²ã€ä¸ªäººåå¥½
- **é¡¹ç›®èƒŒæ™¯**ï¼šé¡¹ç›®ç¼˜èµ·ã€é¢„ç®—è§„æ¨¡ã€æ—¶é—´è¦æ±‚
- **ç‰¹æ®Šè¦æ±‚**ï¼šæ ¼å¼è¦æ±‚ã€ç¯‡å¹…é™åˆ¶ã€è¯­è¨€é£æ ¼åå¥½

```text
{client_info}
```

---

## 2. å»ºè®®ä¹¦ç»“æ„æ¡†æ¶ä¸å†™ä½œæŒ‡å—ï¼ˆå¢å¼ºç‰ˆï¼‰

### 2.1 æ–‡æ¡£å…ƒä¿¡æ¯è§„èŒƒ

#### å°é¢é¡µè®¾è®¡è¦æ±‚
```markdown
# [é¡¹ç›®åç§°]
## [å‰¯æ ‡é¢˜ï¼šæ ¸å¿ƒä»·å€¼ä¸»å¼ ]

è‡´ï¼š[å®¢æˆ·å…¬å¸å…¨ç§°]
    [å…³é”®å†³ç­–è€…å§“ååŠèŒä½]

æäº¤æ–¹ï¼š[æˆ‘æ–¹å…¬å¸å…¨ç§°]
        [æˆ‘æ–¹å…¬å¸slogan]

æäº¤æ—¥æœŸï¼š[YYYYå¹´MMæœˆDDæ—¥]
ç‰ˆæœ¬å·ï¼šV1.0
æ–‡æ¡£ç¼–å·ï¼š[PRO-å®¢æˆ·ç®€ç§°-YYYYMMDD-001]

[å¯é€‰ï¼šæ·»åŠ åŒæ–¹å…¬å¸logo]
[å¯é€‰ï¼šæ·»åŠ ä¿å¯†å£°æ˜]
```

#### ç‰ˆæœ¬æ§åˆ¶è§„èŒƒ
| ç‰ˆæœ¬ | æ—¥æœŸ | ä¿®è®¢äºº | ä¸»è¦ä¿®è®¢å†…å®¹ |
|------|------|--------|--------------|
| V0.1 | YYYY-MM-DD | [å§“å] | åˆç¨¿åˆ›å»º |
| V0.5 | YYYY-MM-DD | [å§“å] | å®Œæˆä¸»ä½“å†…å®¹ |
| V1.0 | YYYY-MM-DD | [å§“å] | æ­£å¼æäº¤ç‰ˆæœ¬ |

### 2.2 ç›®å½•ç»“æ„ï¼ˆæ ‡å‡†ç‰ˆä¸æ‰©å±•ç‰ˆï¼‰

#### æ ‡å‡†ç‰ˆç›®å½•ï¼ˆ7ç« ç»“æ„ï¼‰
```
æ‰§è¡Œæ‘˜è¦ (Executive Summary)
ç¬¬1ç« ï¼šå¯¹æ‚¨ä¸šåŠ¡çš„æ·±åˆ»ç†è§£
ç¬¬2ç« ï¼šä¸ºæ‚¨é‡èº«å®šåˆ¶çš„è§£å†³æ–¹æ¡ˆ
ç¬¬3ç« ï¼šé¡¹ç›®å®æ–½ä¸æˆåŠŸä¿éšœ
ç¬¬4ç« ï¼šæŠ•èµ„å›æŠ¥ä¸å•†ä¸šä»·å€¼
ç¬¬5ç« ï¼šä¸ºä»€ä¹ˆé€‰æ‹©æˆ‘ä»¬
ç¬¬6ç« ï¼šå•†åŠ¡æ¡æ¬¾
é™„å½•
```

#### æ‰©å±•ç‰ˆç›®å½•ï¼ˆé€‚ç”¨äºå¤§å‹/å¤æ‚é¡¹ç›®ï¼‰
```
æ‰§è¡Œæ‘˜è¦ (Executive Summary)
ç¬¬1ç« ï¼šæˆ˜ç•¥èƒŒæ™¯ä¸ä¸šåŠ¡ç†è§£
ç¬¬2ç« ï¼šç°çŠ¶è¯„ä¼°ä¸æœºä¼šåˆ†æ
ç¬¬3ç« ï¼šè§£å†³æ–¹æ¡ˆæ€»ä½“è®¾è®¡
ç¬¬4ç« ï¼šæŠ€æœ¯æ¶æ„ä¸åˆ›æ–°äº®ç‚¹
ç¬¬5ç« ï¼šå®æ–½æ–¹æ³•è®ºä¸é¡¹ç›®ç®¡ç†
ç¬¬6ç« ï¼šå˜é©ç®¡ç†ä¸èƒ½åŠ›å»ºè®¾
ç¬¬7ç« ï¼šæŠ•èµ„åˆ†æä¸ä»·å€¼å®ç°
ç¬¬8ç« ï¼šé£é™©ç®¡ç†ä¸è´¨é‡ä¿è¯
ç¬¬9ç« ï¼šä¸ºä»€ä¹ˆé€‰æ‹©æˆ‘ä»¬
ç¬¬10ç« ï¼šå•†åŠ¡æ¡æ¬¾ä¸åˆä½œæ¨¡å¼
é™„å½•
```

---

### ğŸ“‹ **æ‰§è¡Œæ‘˜è¦ (Executive Summary)** - å¢å¼ºç‰ˆå†™ä½œæŒ‡å—

#### å†™ä½œåŸåˆ™ï¼šé»„é‡‘30ç§’æ³•åˆ™
- **å¼€ç¯‡å‹¾å­**ï¼šç”¨ä¸€ä¸ªéœ‡æ’¼æ€§æ•°æ®æˆ–æ´å¯Ÿå¼€åœº
- **èŠ‚å¥æ§åˆ¶**ï¼šæ¯æ®µä¸è¶…è¿‡3å¥è¯ï¼Œæ€»é•¿ä¸è¶…è¿‡2é¡µ
- **è§†è§‰çªå‡º**ï¼šå…³é”®æ•°å­—å’Œç»“è®ºè¦åŠ ç²—æˆ–ä½¿ç”¨ä¿¡æ¯æ¡†
- **è¡ŒåŠ¨å¬å”¤**ï¼šæ˜ç¡®å‘Šè¯‰è¯»è€…çœ‹å®Œååº”è¯¥åšä»€ä¹ˆ

#### 2.2.1 æŒ‘æˆ˜ä¸æœºé‡ (The Challenge & Opportunity)
**å†™ä½œæ¨¡æ¿**ï¼š
```
"æ ¹æ®æˆ‘ä»¬çš„æ·±å…¥åˆ†æï¼Œ[å®¢æˆ·å…¬å¸åç§°]å½“å‰æ­£å¤„äº[è¡Œä¸šè¶‹åŠ¿/å¸‚åœºå˜åŒ–]çš„å…³é”®è½¬æŠ˜ç‚¹ã€‚
æ‚¨é¢ä¸´çš„[å…·ä½“æŒ‘æˆ˜]ä¸ä»…å½±å“ç€[å…·ä½“ä¸šåŠ¡æŒ‡æ ‡]ï¼Œæ›´å¯èƒ½é”™å¤±[å…·ä½“å¸‚åœºæœºä¼š]ã€‚
ç„¶è€Œï¼Œæˆ‘ä»¬ä¹Ÿçœ‹åˆ°äº†ä¸€ä¸ªä»·å€¼[å…·ä½“é‡‘é¢/ç™¾åˆ†æ¯”]çš„é‡å¤§æœºé‡..."
```

**ç¤ºä¾‹å±•ç¤º**ï¼š
> "æ ¹æ®æˆ‘ä»¬çš„æ·±å…¥åˆ†æï¼ŒABCé›¶å”®é›†å›¢å½“å‰æ­£å¤„äºæ•°å­—åŒ–è½¬å‹çš„å…³é”®è½¬æŠ˜ç‚¹ã€‚æ‚¨é¢ä¸´çš„'æ•°æ®å­¤å²›'é—®é¢˜ä¸ä»…å¯¼è‡´å†³ç­–æ•ˆç‡é™ä½40%ï¼Œæ›´å¯èƒ½é”™å¤±æ¯å¹´2000ä¸‡çš„äº¤å‰é”€å”®æœºä¼šã€‚ç„¶è€Œï¼Œæˆ‘ä»¬ä¹Ÿçœ‹åˆ°äº†é€šè¿‡æ•°æ®æ•´åˆå®ç°æ”¶å…¥å¢é•¿15%çš„é‡å¤§æœºé‡ã€‚"

#### 2.2.2 æ ¸å¿ƒè§£å†³æ–¹æ¡ˆæ¦‚è¿°
**ä»·å€¼ä¸»å¼ å…¬å¼**ï¼š
```
æˆ‘ä»¬é€šè¿‡[æ ¸å¿ƒæ–¹æ¡ˆ/äº§å“]ï¼Œå¸®åŠ©æ‚¨[è§£å†³ä»€ä¹ˆé—®é¢˜]ï¼Œä»è€Œå®ç°[å…·ä½“ä»·å€¼]ã€‚
```

**å·®å¼‚åŒ–è¦ç´ çŸ©é˜µ**ï¼š
| è§£å†³æ–¹æ¡ˆè¦ç´  | ä¼ ç»Ÿæ–¹æ¡ˆ | æˆ‘ä»¬çš„æ–¹æ¡ˆ | å®¢æˆ·ä»·å€¼ |
|-------------|----------|------------|----------|
| æ•°æ®æ•´åˆæ–¹å¼ | æ‰¹é‡ETL | å®æ—¶æµå¤„ç† | å†³ç­–æ—¶æ•ˆæ€§æå‡80% |
| ç”¨æˆ·ä½“éªŒ | å¤æ‚ç•Œé¢ | AIæ™ºèƒ½åŠ©æ‰‹ | åŸ¹è®­æˆæœ¬é™ä½60% |
| æ‰©å±•èƒ½åŠ› | å‚ç›´æ‰©å±• | å¼¹æ€§äº‘æ¶æ„ | TCOé™ä½40% |

#### 2.2.3 é¢„æœŸæˆæœä¸æŠ•èµ„å›æŠ¥ï¼ˆé‡åŒ–ç‰ˆï¼‰
**ROIè®¡ç®—å±•ç¤ºæ¡†æ¶**ï¼š
```
ğŸ’° è´¢åŠ¡æ”¶ç›Š
   â€¢ æˆæœ¬èŠ‚çº¦ï¼šå¹´èŠ‚çœ Â¥[X]ä¸‡ï¼ˆ[å…·ä½“é¢†åŸŸ]æˆæœ¬é™ä½[Y]%ï¼‰
   â€¢ æ”¶å…¥å¢é•¿ï¼šå¹´æ–°å¢ Â¥[X]ä¸‡ï¼ˆ[å…·ä½“ä¸šåŠ¡]å¢é•¿[Y]%ï¼‰
   â€¢ æ•ˆç‡æå‡ï¼šèŠ‚çœ[X]äºº/æœˆï¼ˆ[å…·ä½“æµç¨‹]æ•ˆç‡æå‡[Y]%ï¼‰

ğŸ“Š æŠ•èµ„å›æŠ¥
   â€¢ æ€»æŠ•èµ„ï¼šÂ¥[X]ä¸‡
   â€¢ å›æ”¶æœŸï¼š[Y]ä¸ªæœˆ
   â€¢ 3å¹´ROIï¼š[Z]%
```

#### 2.2.4 æˆåŠŸä¿éšœä¸ä¸‹ä¸€æ­¥è¡ŒåŠ¨
**ä¿¡å¿ƒä¼ é€’è¦ç´ **ï¼š
- **å›¢é˜Ÿå®åŠ›**ï¼š"ç”±æ›¾æœåŠ¡è¿‡[çŸ¥åå®¢æˆ·]çš„ä¸“å®¶å›¢é˜Ÿå…¨ç¨‹æŠ¤èˆª"
- **æˆåŠŸç»éªŒ**ï¼š"åŸºäº[X]ä¸ªåŒç±»æˆåŠŸé¡¹ç›®çš„æœ€ä½³å®è·µ"
- **é£é™©æ§åˆ¶**ï¼š"ç‹¬æœ‰çš„[æ–¹æ³•è®ºåç§°]ç¡®ä¿é¡¹ç›®æˆåŠŸç‡è¾¾95%"

**è¡ŒåŠ¨è·¯çº¿å›¾**ï¼š
```
ç«‹å³è¡ŒåŠ¨ï¼š
â–¡ ç¬¬1æ­¥ï¼šå®‰æ’30åˆ†é’Ÿçš„æ–¹æ¡ˆè¯¦è§£ä¼šè®®ï¼ˆå»ºè®®æ—¶é—´ï¼š[å…·ä½“æ—¥æœŸ]ï¼‰
â–¡ ç¬¬2æ­¥ï¼šç»„ç»‡ä¸ºæœŸ1å¤©çš„éœ€æ±‚æ·±åº¦ç ”è®¨ä¼š
â–¡ ç¬¬3æ­¥ï¼š2å‘¨å†…æä¾›å®šåˆ¶åŒ–çš„POCæ¼”ç¤º
â–¡ ç¬¬4æ­¥ï¼š1ä¸ªæœˆå†…å®ŒæˆåˆåŒç­¾ç½²å¹¶å¯åŠ¨é¡¹ç›®
```

---

### ğŸ“Š **ç¬¬1ç« ï¼šå¯¹æ‚¨ä¸šåŠ¡çš„æ·±åˆ»ç†è§£** - å¢å¼ºç‰ˆæŒ‡å—

#### æœ¬ç« å†™ä½œå¿ƒæ³•ï¼šåŒç†å¿ƒ + ä¸“ä¸šæ€§
- **ä½¿ç”¨å®¢æˆ·çš„è¯­è¨€**ï¼šç›´æ¥å¼•ç”¨å®¢æˆ·åœ¨è®¿è°ˆä¸­çš„åŸè¯
- **å±•ç¤ºç†è§£çš„æ·±åº¦**ï¼šä¸ä»…çŸ¥é“"æ˜¯ä»€ä¹ˆ"ï¼Œæ›´è¦åˆ†æ"ä¸ºä»€ä¹ˆ"
- **å»ºç«‹æƒ…æ„Ÿè¿æ¥**ï¼šè¡¨è¾¾å¯¹å®¢æˆ·å¤„å¢ƒçš„ç†è§£å’Œå…±é¸£

#### 2.3.1 ä¸šåŠ¡ç°çŠ¶å…¨æ™¯æ‰«æ
**åˆ†æç»´åº¦æ‰©å±•**ï¼š

##### A. ä¸šåŠ¡å±‚é¢åˆ†æ
```markdown
**è¿è¥ç°çŠ¶è¯„ä¼°**
â€¢ æ ¸å¿ƒä¸šåŠ¡æµç¨‹ï¼š[æµç¨‹åç§°] - å½“å‰æ•ˆç‡ vs è¡Œä¸šæ ‡æ†
â€¢ å…³é”®ç—›ç‚¹æ˜ å°„ï¼š[ä½¿ç”¨æµç¨‹å›¾å±•ç¤ºç—›ç‚¹åˆ†å¸ƒ]
â€¢ èµ„æºåˆ©ç”¨ç‡ï¼šäººåŠ›[X]% | ç³»ç»Ÿ[Y]% | èµ„é‡‘[Z]%

**å¸‚åœºç«äº‰æ€åŠ¿**
â€¢ å¸‚åœºåœ°ä½ï¼šç›®å‰æ’åç¬¬[X]ï¼Œä¸é¢†å…ˆè€…å·®è·[å…·ä½“æŒ‡æ ‡]
â€¢ ç«äº‰å‹åŠ›ï¼š[å…·ä½“ç«äº‰å¯¹æ‰‹]åœ¨[å“ªäº›æ–¹é¢]æ„æˆå¨èƒ
â€¢ å®¢æˆ·å£°éŸ³ï¼š"[å®¢æˆ·åŸè¯å¼•ç”¨]" - æ¥è‡ª[èŒä½]çš„åé¦ˆ
```

##### B. æŠ€æœ¯å±‚é¢è¯„ä¼°
```markdown
**ITç°çŠ¶æˆç†Ÿåº¦è¯„ä¼°**ï¼ˆä½¿ç”¨æˆç†Ÿåº¦æ¨¡å‹ï¼‰
| é¢†åŸŸ | å½“å‰çº§åˆ« | ç›®æ ‡çº§åˆ« | å·®è·åˆ†æ |
|------|---------|---------|----------|
| æ•°æ®ç®¡ç† | 2-å­¤å²›åŒ– | 4-æ™ºèƒ½åŒ– | ç¼ºä¹ç»Ÿä¸€æ•°æ®å¹³å° |
| æµç¨‹è‡ªåŠ¨åŒ– | 1-æ‰‹å·¥ | 3-è‡ªåŠ¨åŒ– | éœ€è¦RPA/AIèµ‹èƒ½ |
| ç”¨æˆ·ä½“éªŒ | 2-åŸºç¡€ | 4-å“è¶Š | éœ€è¦ç°ä»£åŒ–æ”¹é€  |
```

##### C. ç»„ç»‡å±‚é¢æ´å¯Ÿ
```markdown
**ç»„ç»‡å°±ç»ªåº¦åˆ†æ**
â€¢ é¢†å¯¼æ”¯æŒåº¦ï¼š[é«˜/ä¸­/ä½] - åŸºäº[å…·ä½“è¯æ®]
â€¢ å˜é©èƒ½åŠ›ï¼š[è¯„åˆ†] - å†å²å˜é©é¡¹ç›®æˆåŠŸç‡[X]%
â€¢ æ–‡åŒ–å¥‘åˆåº¦ï¼š[ä¼ä¸šæ–‡åŒ–ç‰¹å¾]ä¸æ•°å­—åŒ–è½¬å‹çš„å¥‘åˆåº¦åˆ†æ
```

#### 2.3.2 ç—›ç‚¹æ·±åº¦è§£æï¼ˆç—›è‹¦é“¾åˆ†ææ³•ï¼‰
**ç—›ç‚¹åˆ†ææ¨¡æ¿**ï¼š
```markdown
ç—›ç‚¹åç§°ï¼š[ä¾‹å¦‚ï¼šæ•°æ®å­¤å²›é—®é¢˜]
â”œâ”€ è¡¨è±¡é—®é¢˜ï¼šå„éƒ¨é—¨æ•°æ®æ— æ³•å…±äº«ï¼ŒæŠ¥è¡¨éœ€è¦äººå·¥æ•´åˆ
â”œâ”€ æ·±å±‚åŸå› ï¼š
â”‚   â”œâ”€ æŠ€æœ¯åŸå› ï¼šç³»ç»Ÿå¼‚æ„ï¼Œç¼ºä¹ç»Ÿä¸€æ¥å£
â”‚   â”œâ”€ ç®¡ç†åŸå› ï¼šéƒ¨é—¨å¢™ï¼Œæ•°æ®ownershipä¸æ¸…
â”‚   â””â”€ å†å²åŸå› ï¼šå¹¶è´­æ•´åˆä¸å½»åº•
â”œâ”€ ä¸šåŠ¡å½±å“ï¼š
â”‚   â”œâ”€ æ•ˆç‡å½±å“ï¼šæœˆåº¦æŠ¥è¡¨åˆ¶ä½œè€—æ—¶ä»1å¤©å¢è‡³5å¤©
â”‚   â”œâ”€ è´¨é‡å½±å“ï¼šæ•°æ®ä¸ä¸€è‡´å¯¼è‡´å†³ç­–å¤±è¯¯ç‡30%
â”‚   â””â”€ æˆæœ¬å½±å“ï¼šå¹´åº¦æ•°æ®å¤„ç†æˆæœ¬è¶…è¿‡500ä¸‡
â””â”€ å¦‚ä¸è§£å†³çš„åæœï¼š
    â”œâ”€ çŸ­æœŸï¼ˆ3ä¸ªæœˆï¼‰ï¼šé”™å¤±Q4é”€å”®æ—ºå­£çš„è¥é”€æœºä¼š
    â”œâ”€ ä¸­æœŸï¼ˆ1å¹´ï¼‰ï¼šè¢«ç«äº‰å¯¹æ‰‹åœ¨å®¢æˆ·æ´å¯Ÿä¸Šæ‹‰å¼€å·®è·
    â””â”€ é•¿æœŸï¼ˆ3å¹´ï¼‰ï¼šå¯èƒ½å¤±å»30%çš„å¸‚åœºä»½é¢
```

#### 2.3.3 æˆåŠŸæ„¿æ™¯å…±åˆ›
**æ„¿æ™¯æç»˜æŠ€å·§**ï¼š
```markdown
**æ‚¨çš„æˆåŠŸæ˜¯ä»€ä¹ˆæ ·å­çš„ï¼Ÿ**

"æƒ³è±¡ä¸€ä¸‹ï¼Œ12ä¸ªæœˆåçš„ä»Šå¤©..."
âœ… æ‚¨çš„å›¢é˜Ÿè¯´ï¼š"ç°åœ¨åšå†³ç­–å¤ªå®¹æ˜“äº†ï¼Œæ‰€æœ‰æ•°æ®è§¦æ‰‹å¯åŠ"
âœ… æ‚¨çš„å®¢æˆ·è¯´ï¼š"ABCå…¬å¸çš„æœåŠ¡ä½“éªŒæ˜¯è¡Œä¸šæœ€æ£’çš„"
âœ… æ‚¨çš„è´¢åŠ¡æŠ¥è¡¨æ˜¾ç¤ºï¼šè¿è¥æˆæœ¬é™ä½20%ï¼Œå®¢æˆ·æ»¡æ„åº¦æå‡åˆ°95%
âœ… æ‚¨åœ¨è‘£äº‹ä¼šä¸Šè‡ªè±ªåœ°å±•ç¤ºï¼šæ•°å­—åŒ–è½¬å‹ROIè¾¾åˆ°300%

**å…·ä½“æˆåŠŸæŒ‡æ ‡**ï¼ˆä¸å®¢æˆ·å…±åŒç¡®è®¤ï¼‰
| KPIç±»åˆ« | å½“å‰å€¼ | 6ä¸ªæœˆç›®æ ‡ | 12ä¸ªæœˆç›®æ ‡ | æµ‹é‡æ–¹æ³• |
|---------|-------|-----------|------------|----------|
| è¿è¥æ•ˆç‡ | åŸºå‡†100 | æå‡20% | æå‡40% | æµç¨‹å‘¨æœŸæ—¶é—´ |
| å®¢æˆ·æ»¡æ„åº¦ | 78% | 85% | 95% | NPSåˆ†æ•° |
| æˆæœ¬èŠ‚çº¦ | - | 500ä¸‡ | 1500ä¸‡ | è´¢åŠ¡æŠ¥è¡¨ |
| å‘˜å·¥æ•ˆç‡ | åŸºå‡†100 | æå‡15% | æå‡30% | äººå‡äº§å‡º |
```

#### 2.3.4 å†³ç­–è€ƒé‡å› ç´ æ·±åº¦è§£è¯»
**å†³ç­–å› ç´ æƒé‡åˆ†æ**ï¼š
```markdown
åŸºäºæˆ‘ä»¬çš„ç†è§£ï¼Œæ‚¨åœ¨é€‰æ‹©åˆä½œä¼™ä¼´æ—¶æœ€çœ‹é‡çš„å› ç´ ä¾æ¬¡æ˜¯ï¼š

1. **æŠ€æœ¯é¢†å…ˆæ€§ (æƒé‡30%)**
   - æ‚¨éœ€è¦ï¼šç»è¿‡éªŒè¯çš„æˆç†ŸæŠ€æœ¯ + æŒç»­åˆ›æ–°èƒ½åŠ›
   - å…·ä½“å…³æ³¨ï¼šäº‘åŸç”Ÿæ¶æ„ã€AI/MLèƒ½åŠ›ã€å®‰å…¨æ€§

2. **å®æ–½èƒ½åŠ› (æƒé‡25%)**
   - æ‚¨éœ€è¦ï¼šä¸°å¯Œçš„åŒè¡Œä¸šç»éªŒ + å¼ºå¤§çš„æœ¬åœ°å›¢é˜Ÿ
   - å…·ä½“å…³æ³¨ï¼šé¡¹ç›®æˆåŠŸç‡ã€å®æ–½å‘¨æœŸã€çŸ¥è¯†è½¬ç§»

3. **æŠ•èµ„å›æŠ¥ (æƒé‡20%)**
   - æ‚¨éœ€è¦ï¼šæ¸…æ™°çš„ROI + å¯æ§çš„TCO
   - å…·ä½“å…³æ³¨ï¼šå›æ”¶æœŸ<18ä¸ªæœˆã€å¹´åŒ–æ”¶ç›Š>30%

4. **é•¿æœŸä¼™ä¼´å…³ç³» (æƒé‡15%)**
   - æ‚¨éœ€è¦ï¼šæŒç»­åˆ›æ–° + æˆ˜ç•¥ååŒ
   - å…·ä½“å…³æ³¨ï¼šäº§å“è·¯çº¿å›¾ã€ä¼ä¸šç¨³å®šæ€§ã€æ–‡åŒ–å¥‘åˆ

5. **é£é™©å¯æ§ (æƒé‡10%)**
   - æ‚¨éœ€è¦ï¼šæˆç†Ÿæ–¹æ³•è®º + å®Œå–„ä¿éšœæœºåˆ¶
   - å…·ä½“å…³æ³¨ï¼šè¯•ç‚¹æœºåˆ¶ã€é€€å‡ºæ¡æ¬¾ã€SLAä¿éšœ
```

---

### ğŸ¯ **ç¬¬2ç« ï¼šä¸ºæ‚¨é‡èº«å®šåˆ¶çš„è§£å†³æ–¹æ¡ˆ** - å¢å¼ºç‰ˆæŒ‡å—

#### æœ¬ç« å†™ä½œç­–ç•¥ï¼šé—®é¢˜ä¸æ–¹æ¡ˆçš„å®Œç¾æ˜ å°„
- **ä¸€ä¸€å¯¹åº”åŸåˆ™**ï¼šæ¯ä¸ªç—›ç‚¹éƒ½æœ‰å¯¹åº”çš„è§£å†³æ–¹æ¡ˆ
- **ä»·å€¼æ˜¾æ€§åŒ–**ï¼šæ¯ä¸ªåŠŸèƒ½éƒ½è¦è¯´æ˜å¸¦æ¥çš„å…·ä½“ä»·å€¼
- **åœºæ™¯åŒ–å±•ç¤º**ï¼šç”¨å®¢æˆ·ç†Ÿæ‚‰çš„åœºæ™¯å±•ç¤ºæ–¹æ¡ˆæ•ˆæœ

#### 2.4.1 è§£å†³æ–¹æ¡ˆæ€»ä½“è®¾è®¡
**æ–¹æ¡ˆè®¾è®¡ç†å¿µé™ˆè¿°**ï¼š
```markdown
## æˆ‘ä»¬çš„è®¾è®¡ç†å¿µï¼š[ç†å¿µåç§°ï¼Œå¦‚"æ™ºæ…§èµ‹èƒ½ã€ä½“éªŒè‡³ä¸Š"]

**æ ¸å¿ƒåŸåˆ™**ï¼š
1. **ä¸šåŠ¡é©±åŠ¨**ï¼šæŠ€æœ¯æœåŠ¡äºä¸šåŠ¡ï¼Œè€Œéä¸šåŠ¡é€‚åº”æŠ€æœ¯
2. **ç”¨æˆ·ä¸­å¿ƒ**ï¼šæ¯ä¸ªè®¾è®¡å†³ç­–éƒ½ä»ç”¨æˆ·ä½“éªŒå‡ºå‘
3. **é¢å‘æœªæ¥**ï¼šä¸ä»…è§£å†³ä»Šå¤©çš„é—®é¢˜ï¼Œæ›´æ”¯æ’‘æ˜å¤©çš„æˆé•¿
4. **æ•æ·è¿­ä»£**ï¼šå¿«é€Ÿè§æ•ˆï¼ŒæŒç»­ä¼˜åŒ–ï¼Œé™ä½é£é™©

**æ¶æ„è®¾è®¡å“²å­¦**ï¼š
- ğŸ§© æ¨¡å—åŒ–ï¼šåŠŸèƒ½æ¨¡å—ç‹¬ç«‹ï¼Œå¯æŒ‰éœ€ç»„åˆ
- ğŸ”„ å¯æ‰©å±•ï¼šé¢„ç•™æ¥å£ï¼Œæ”¯æŒæœªæ¥æ‰©å±•
- ğŸ›¡ï¸ é«˜å¯é ï¼šå¤šé‡ä¿éšœæœºåˆ¶ï¼Œç¡®ä¿ä¸šåŠ¡è¿ç»­æ€§
- âš¡ é«˜æ€§èƒ½ï¼šä¼˜åŒ–æ¶æ„ï¼Œç¡®ä¿äºšç§’çº§å“åº”
```

**è§£å†³æ–¹æ¡ˆå…¨æ™¯å›¾**ï¼ˆè¦æ±‚ï¼šå¿…é¡»åŒ…å«Mermaidå›¾ï¼‰ï¼š
```mermaid
graph TB
    subgraph "ä¸šåŠ¡å±‚"
        A[æ™ºèƒ½å†³ç­–ä¸­å¿ƒ] --> B[ä¸šåŠ¡æ´å¯Ÿ]
        A --> C[é¢„æµ‹åˆ†æ]
        A --> D[æ™ºèƒ½æ¨è]
    end
    
    subgraph "åº”ç”¨å±‚"
        E[ç»Ÿä¸€é—¨æˆ·] --> F[PCç«¯]
        E --> G[ç§»åŠ¨ç«¯]
        E --> H[APIæ¥å£]
    end
    
    subgraph "å¹³å°å±‚"
        I[æ•°æ®ä¸­å°] --> J[æ•°æ®é›†æˆ]
        I --> K[æ•°æ®æ²»ç†]
        I --> L[æ•°æ®æœåŠ¡]
        M[AIä¸­å°] --> N[æœºå™¨å­¦ä¹ ]
        M --> O[NLPå¤„ç†]
        M --> P[è®¡ç®—æœºè§†è§‰]
    end
    
    subgraph "åŸºç¡€è®¾æ–½å±‚"
        Q[æ··åˆäº‘å¹³å°] --> R[ç§æœ‰äº‘]
        Q --> S[å…¬æœ‰äº‘]
        Q --> T[è¾¹ç¼˜è®¡ç®—]
    end
    
    A -.-> E
    E -.-> I
    E -.-> M
    I -.-> Q
    M -.-> Q
```

#### 2.4.2 æ ¸å¿ƒåŠŸèƒ½æ¨¡å—è¯¦ç»†è®¾è®¡
**æ¨¡å—è®¾è®¡æ¨¡æ¿**ï¼š
```markdown
### æ¨¡å—[X]ï¼š[æ¨¡å—åç§°ï¼Œå¦‚ï¼šæ™ºèƒ½æ•°æ®æ•´åˆå¹³å°]

#### ğŸ¯ ç›´å‡»ç—›ç‚¹
- **æ‚¨çš„æŒ‘æˆ˜**ï¼š"[å¼•ç”¨å®¢æˆ·åŸè¯æè¿°çš„ç—›ç‚¹]"
- **æ ¹æœ¬åŸå› **ï¼š[åˆ†æé—®é¢˜çš„æ ¹æº]
- **æˆ‘ä»¬çš„å›åº”**ï¼šé€šè¿‡[å…·ä½“æŠ€æœ¯/æ–¹æ³•]å½»åº•è§£å†³

#### ğŸ’¡ åŠŸèƒ½ç‰¹æ€§
| åŠŸèƒ½ç‰¹æ€§ | åŠŸèƒ½æè¿° | å®¢æˆ·ä»·å€¼ | ç‹¬ç‰¹ä¼˜åŠ¿ |
|---------|---------|----------|----------|
| å®æ—¶æ•°æ®åŒæ­¥ | æ¯«ç§’çº§æ•°æ®åŒæ­¥ï¼Œæ”¯æŒ100+æ•°æ®æº | å†³ç­–æ—¶æ•ˆæ€§æå‡90% | ä¸šç•Œå”¯ä¸€æ”¯æŒå¼‚æ„æ•°æ®æºå®æ—¶åŒæ­¥ |
| æ™ºèƒ½æ•°æ®æ˜ å°„ | AIè‡ªåŠ¨è¯†åˆ«æ•°æ®å…³ç³» | é›†æˆå·¥ä½œé‡å‡å°‘70% | è‡ªç ”NLPå¼•æ“ï¼Œå‡†ç¡®ç‡è¾¾95% |
| æ•°æ®è´¨é‡ç®¡ç† | è‡ªåŠ¨è¯†åˆ«å’Œä¿®å¤æ•°æ®è´¨é‡é—®é¢˜ | æ•°æ®å¯ä¿¡åº¦æå‡åˆ°99.9% | å†…ç½®è¡Œä¸šæœ€ä½³å®è·µè§„åˆ™åº“ |

#### ğŸ“Š åº”ç”¨åœºæ™¯æ¼”ç¤º
**åœºæ™¯1ï¼šæœˆåº¦ç»è¥åˆ†æä¼š**
- è¿‡å»ï¼šèŠ±5å¤©å‡†å¤‡æ•°æ®ï¼Œä¼šè®®æ—¶å‘ç°æ•°æ®ä¸ä¸€è‡´ï¼Œäº‰è®ºä¸ä¼‘
- ç°åœ¨ï¼šä¼šå‰10åˆ†é’Ÿç”ŸæˆæŠ¥å‘Šï¼Œæ‰€æœ‰äººçœ‹åˆ°åŒä¸€ç‰ˆæœ¬çš„çœŸç›¸ï¼Œç›´æ¥è®¨è®ºå¯¹ç­–

**åœºæ™¯2ï¼šå®¢æˆ·æŠ•è¯‰å¤„ç†**
- è¿‡å»ï¼šæŸ¥è¯¢å®¢æˆ·ä¿¡æ¯éœ€è¦ç™»å½•5ä¸ªç³»ç»Ÿï¼Œè€—æ—¶30åˆ†é’Ÿ
- ç°åœ¨ï¼šä¸€é”®è·å–360Â°å®¢æˆ·è§†å›¾ï¼Œ3åˆ†é’Ÿå†…ç»™å‡ºè§£å†³æ–¹æ¡ˆ

#### ğŸ”§ æŠ€æœ¯å®ç°äº®ç‚¹
```yaml
æŠ€æœ¯æ ˆï¼š
  - æ•°æ®é›†æˆï¼šApache Kafka + Flinkå®æ—¶æµå¤„ç†
  - æ•°æ®å­˜å‚¨ï¼šåˆ†å¸ƒå¼æ•°æ®æ¹– + åˆ—å¼å­˜å‚¨ä¼˜åŒ–
  - æ•°æ®æœåŠ¡ï¼šGraphQL API + æ™ºèƒ½ç¼“å­˜
  - å®‰å…¨ä¿éšœï¼šç«¯åˆ°ç«¯åŠ å¯† + é›¶ä¿¡ä»»æ¶æ„
  
æ€§èƒ½æŒ‡æ ‡ï¼š
  - ååé‡ï¼š100ä¸‡æ¡/ç§’
  - å»¶è¿Ÿï¼š< 100ms
  - å¯ç”¨æ€§ï¼š99.99%
  - æ‰©å±•æ€§ï¼šçº¿æ€§æ‰©å±•è‡³PBçº§
```

#### ğŸ“ˆ é¢„æœŸæ•ˆæœé‡åŒ–
- **çŸ­æœŸï¼ˆ1-3ä¸ªæœˆï¼‰**ï¼šæ•°æ®å‡†å¤‡æ—¶é—´ä»5å¤©ç¼©çŸ­è‡³1å°æ—¶
- **ä¸­æœŸï¼ˆ6ä¸ªæœˆï¼‰**ï¼šæ•°æ®é©±åŠ¨å†³ç­–æ¯”ä¾‹ä»20%æå‡è‡³80%
- **é•¿æœŸï¼ˆ12ä¸ªæœˆï¼‰**ï¼šå› æ•°æ®é—®é¢˜å¯¼è‡´çš„å†³ç­–å¤±è¯¯é™ä½ä¸º0
```

#### 2.4.3 æ–¹æ¡ˆé›†æˆæ¶æ„
**ç³»ç»Ÿé›†æˆç­–ç•¥**ï¼š
```markdown
### ä¸ç°æœ‰ç³»ç»Ÿçš„æ— ç¼é›†æˆ

#### é›†æˆåŸåˆ™
âœ… **ä¿æŠ¤ç°æœ‰æŠ•èµ„**ï¼šä¸æ¨å€’é‡æ¥ï¼Œè€Œæ˜¯èµ‹èƒ½å‡çº§
âœ… **æœ€å°åŒ–å¹²æ‰°**ï¼šé‡‡ç”¨é€‚é…å™¨æ¨¡å¼ï¼Œä¸å½±å“ç°æœ‰ç³»ç»Ÿè¿è¡Œ
âœ… **é€æ­¥è¿ç§»**ï¼šæ”¯æŒæ–°è€ç³»ç»Ÿå¹¶è¡Œï¼Œå¹³æ»‘è¿‡æ¸¡

#### é›†æˆæ¶æ„å›¾
```mermaid
graph LR
    subgraph "ç°æœ‰ç³»ç»Ÿ"
        A[ERPç³»ç»Ÿ]
        B[CRMç³»ç»Ÿ]
        C[SCMç³»ç»Ÿ]
        D[Legacyç³»ç»Ÿ]
    end
    
    subgraph "é›†æˆå±‚"
        E[APIç½‘å…³]
        F[ESBä¼ä¸šæœåŠ¡æ€»çº¿]
        G[æ•°æ®é›†æˆå¹³å°]
    end
    
    subgraph "æ–°å¹³å°"
        H[æ™ºèƒ½åˆ†æå¹³å°]
        I[ç§»åŠ¨åº”ç”¨]
        J[AIæœåŠ¡]
    end
    
    A --> E
    B --> E
    C --> F
    D --> G
    
    E --> H
    F --> H
    G --> H
    
    H --> I
    H --> J
```

#### é›†æˆè®¡åˆ’
| é˜¶æ®µ | ç³»ç»Ÿ | é›†æˆæ–¹å¼ | æ‰€éœ€æ—¶é—´ | é£é™©ç­‰çº§ |
|------|------|----------|----------|----------|
| Phase 1 | ERP | REST API | 2å‘¨ | ä½ |
| Phase 2 | CRM | æ•°æ®åŒæ­¥ | 3å‘¨ | ä¸­ |
| Phase 3 | Legacy | ETL+API | 4å‘¨ | é«˜ |
```

#### 2.4.4 åˆ›æ–°äº®ç‚¹å±•ç¤º
**åˆ›æ–°æŠ€æœ¯åº”ç”¨**ï¼š
```markdown
### ğŸš€ å¼•é¢†è¡Œä¸šçš„åˆ›æ–°åº”ç”¨

#### 1. AIé©±åŠ¨çš„æ™ºèƒ½å†³ç­–
**ä¼ ç»Ÿæ–¹å¼ vs æˆ‘ä»¬çš„åˆ›æ–°**
| å¯¹æ¯”ç»´åº¦ | ä¼ ç»ŸBI | æˆ‘ä»¬çš„AIå†³ç­–å¹³å° |
|---------|--------|----------------|
| åˆ†ææ–¹å¼ | å›é¡¾å†å² | é¢„æµ‹æœªæ¥ |
| æ´å¯Ÿæ·±åº¦ | æ˜¾æ€§è§„å¾‹ | éšæ€§æ¨¡å¼ |
| å†³ç­–æ”¯æŒ | æä¾›æŠ¥è¡¨ | æ¨èè¡ŒåŠ¨ |
| å­¦ä¹ èƒ½åŠ› | é™æ€è§„åˆ™ | è‡ªæˆ‘è¿›åŒ– |

**å®é™…åº”ç”¨æ¡ˆä¾‹**ï¼š
> "ç³»ç»Ÿè‡ªåŠ¨å‘ç°äº†æˆ‘ä»¬ä»æœªæ³¨æ„åˆ°çš„å­£èŠ‚æ€§åº“å­˜æ¨¡å¼ï¼Œé€šè¿‡æ™ºèƒ½è¡¥è´§å»ºè®®ï¼Œåº“å­˜å‘¨è½¬ç‡æå‡äº†40%ï¼ŒåŒæ—¶ç¼ºè´§ç‡é™ä½åˆ°å‡ ä¹ä¸ºé›¶ã€‚" - æŸé›¶å”®å®¢æˆ·

#### 2. åŒºå—é“¾èµ‹èƒ½çš„ä¿¡ä»»æœºåˆ¶
- **åº”ç”¨åœºæ™¯**ï¼šä¾›åº”é“¾è¿½æº¯ã€åˆåŒç®¡ç†ã€å®¡è®¡è¿½è¸ª
- **å®¢æˆ·ä»·å€¼**ï¼šå»ºç«‹ä¸å¯ç¯¡æ”¹çš„ä¿¡ä»»é“¾æ¡ï¼Œåˆè§„æˆæœ¬é™ä½60%

#### 3. è¾¹ç¼˜è®¡ç®—çš„å®æ—¶å“åº”
- **åº”ç”¨åœºæ™¯**ï¼šé—¨åº—å®æ—¶åˆ†æã€ç”Ÿäº§çº¿ç›‘æ§ã€ç‰©æµè¿½è¸ª
- **å®¢æˆ·ä»·å€¼**ï¼šæœ¬åœ°å†³ç­–å»¶è¿Ÿ<10msï¼Œå¸¦å®½æˆæœ¬èŠ‚çœ70%
```

---

### ğŸ“… **ç¬¬3ç« ï¼šé¡¹ç›®å®æ–½ä¸æˆåŠŸä¿éšœ** - å¢å¼ºç‰ˆæŒ‡å—

#### æœ¬ç« å†™ä½œè¦ç‚¹ï¼šä¸“ä¸šæ€§ + å¯æ§æ€§
- **å±•ç¤ºæˆç†Ÿæ–¹æ³•è®º**ï¼šè®©å®¢æˆ·ç›¸ä¿¡æˆ‘ä»¬"è½»è½¦ç†Ÿè·¯"
- **é€æ˜åŒ–ç®¡ç†**ï¼šè®©å®¢æˆ·æ¸…æ¥šçŸ¥é“æ¯ä¸ªé˜¶æ®µåœ¨åšä»€ä¹ˆ
- **é£é™©å‰ç½®**ï¼šä¸»åŠ¨è¯†åˆ«å’Œç®¡ç†é£é™©ï¼Œå±•ç¤ºä¸“ä¸šæ€§

#### 2.5.1 å®æ–½æ–¹æ³•è®ºå±•ç¤º
```markdown
### ğŸ¯ æˆ‘ä»¬çš„ç‹¬ç‰¹å®æ–½æ–¹æ³•è®ºï¼šSMART-Dâ„¢

**S**coping - ç²¾å‡†èŒƒå›´å®šä¹‰
**M**obilizing - é«˜æ•ˆèµ„æºåŠ¨å‘˜  
**A**gile Delivery - æ•æ·äº¤ä»˜
**R**ealizing Value - ä»·å€¼å®ç°
**T**ransforming - æŒç»­è½¬å‹
**D**igital Excellence - æ•°å­—å“è¶Š

#### æ–¹æ³•è®ºä¼˜åŠ¿
âœ… **ç»è¿‡éªŒè¯**ï¼šåœ¨å…¨çƒ200+é¡¹ç›®ä¸­éªŒè¯æœ‰æ•ˆ
âœ… **é™ä½é£é™©**ï¼šé¡¹ç›®æˆåŠŸç‡è¾¾åˆ°95%ä»¥ä¸Š
âœ… **åŠ é€Ÿäº¤ä»˜**ï¼šå¹³å‡äº¤ä»˜å‘¨æœŸç¼©çŸ­30%
âœ… **ä¿éšœè´¨é‡**ï¼šä¸€æ¬¡ä¸Šçº¿æˆåŠŸç‡98%
```

#### 2.5.2 è¯¦ç»†é¡¹ç›®è®¡åˆ’
**é¡¹ç›®è·¯çº¿å›¾**ï¼ˆGanttå›¾å±•ç¤ºï¼‰ï¼š
```mermaid
gantt
    title é¡¹ç›®å®æ–½è·¯çº¿å›¾
    dateFormat  YYYY-MM-DD
    section é˜¶æ®µ1:å¯åŠ¨å‡†å¤‡
    é¡¹ç›®å¯åŠ¨ä¼š            :done,    des1, 2024-01-01, 3d
    éœ€æ±‚è°ƒç ”              :active,  des2, after des1, 10d
    æ–¹æ¡ˆç¡®è®¤              :         des3, after des2, 5d
    
    section é˜¶æ®µ2:åŸºç¡€å»ºè®¾
    ç¯å¢ƒæ­å»º              :         des4, after des3, 7d
    æ•°æ®è¿ç§»è®¾è®¡          :         des5, after des3, 10d
    æ¥å£å¼€å‘              :         des6, after des4, 14d
    
    section é˜¶æ®µ3:æ ¸å¿ƒåŠŸèƒ½
    æ¨¡å—Aå¼€å‘             :         des7, after des6, 21d
    æ¨¡å—Bå¼€å‘             :         des8, after des6, 21d
    é›†æˆæµ‹è¯•              :         des9, after des8, 7d
    
    section é˜¶æ®µ4:ä¸Šçº¿è¿è¡Œ
    UATæµ‹è¯•               :         des10, after des9, 10d
    åŸ¹è®­å‡†å¤‡              :         des11, after des9, 7d
    è¯•è¿è¡Œ                :         des12, after des10, 14d
    æ­£å¼ä¸Šçº¿              :crit,    des13, after des12, 3d
    
    section é˜¶æ®µ5:ä¼˜åŒ–æå‡
    è¿è¡Œç›‘æ§              :         des14, after des13, 30d
    æŒç»­ä¼˜åŒ–              :         des15, after des13, 60d
```

**é‡Œç¨‹ç¢‘ä¸äº¤ä»˜ç‰©æ¸…å•**ï¼š
```markdown
| é‡Œç¨‹ç¢‘ | æ—¶é—´èŠ‚ç‚¹ | å…³é”®äº¤ä»˜ç‰© | éªŒæ”¶æ ‡å‡† | ä»˜æ¬¾èŠ‚ç‚¹ |
|--------|---------|-----------|----------|----------|
| M1: é¡¹ç›®å¯åŠ¨ | Week 1 | â€¢ é¡¹ç›®ç« ç¨‹<br>â€¢ è¯¦ç»†è®¡åˆ’ | åŒæ–¹ç­¾å­—ç¡®è®¤ | 20% |
| M2: éœ€æ±‚ç¡®è®¤ | Week 3 | â€¢ éœ€æ±‚è§„æ ¼ä¹¦<br>â€¢ åŸå‹è®¾è®¡ | ä¸šåŠ¡éƒ¨é—¨ç¡®è®¤ | 20% |
| M3: å¼€å‘å®Œæˆ | Week 10 | â€¢ ç³»ç»ŸåŠŸèƒ½<br>â€¢ æµ‹è¯•æŠ¥å‘Š | åŠŸèƒ½æµ‹è¯•é€šè¿‡ | 30% |
| M4: ä¸Šçº¿æˆåŠŸ | Week 14 | â€¢ ç”Ÿäº§ç³»ç»Ÿ<br>â€¢ è¿ç»´æ‰‹å†Œ | è¯•è¿è¡Œç¨³å®š | 20% |
| M5: é¡¹ç›®æ”¶å°¾ | Week 16 | â€¢ çŸ¥è¯†è½¬ç§»<br>â€¢ é¡¹ç›®æ€»ç»“ | æœ€ç»ˆéªŒæ”¶ | 10% |
```

#### 2.5.3 é¡¹ç›®æ²»ç†ç»“æ„
**ç»„ç»‡æ¶æ„ä¸è§’è‰²**ï¼š
```markdown
### é¡¹ç›®æ²»ç†æ¶æ„

```mermaid
graph TB
    subgraph "æŒ‡å¯¼å§”å‘˜ä¼š"
        A[å®¢æˆ·æ–¹é«˜ç®¡] 
        B[æˆ‘æ–¹é«˜ç®¡]
    end
    
    subgraph "é¡¹ç›®ç®¡ç†åŠå…¬å®¤"
        C[é¡¹ç›®æ€»ç›‘]
        D[å®¢æˆ·æ–¹PM]
        E[æˆ‘æ–¹PM]
    end
    
    subgraph "å·¥ä½œå°ç»„"
        F[æŠ€æœ¯ç»„]
        G[ä¸šåŠ¡ç»„]
        H[æµ‹è¯•ç»„]
        I[åŸ¹è®­ç»„]
    end
    
    A --> C
    B --> C
    C --> D
    C --> E
    D --> F
    D --> G
    E --> H
    E --> I
```

### è§’è‰²èŒè´£çŸ©é˜µ (RACI)
| ä»»åŠ¡ | å®¢æˆ·æ–¹é«˜ç®¡ | æˆ‘æ–¹PM | å®¢æˆ·æ–¹PM | æŠ€æœ¯ç»„ | ä¸šåŠ¡ç»„ |
|------|-----------|--------|----------|--------|--------|
| éœ€æ±‚ç¡®è®¤ | A | C | R | I | R |
| æ–¹æ¡ˆè®¾è®¡ | A | R | C | R | C |
| å¼€å‘å®æ–½ | I | A | I | R | C |
| æµ‹è¯•éªŒæ”¶ | A | C | R | R | R |
| ä¸Šçº¿å†³ç­– | A | R | R | C | C |

*R=è´Ÿè´£ A=æ‰¹å‡† C=å’¨è¯¢ I=çŸ¥æƒ…*
```

#### 2.5.4 é£é™©ç®¡ç†è®¡åˆ’
**é£é™©è¯†åˆ«ä¸åº”å¯¹çŸ©é˜µ**ï¼š
```markdown
### ä¸»åŠ¨é£é™©ç®¡ç†

| é£é™©ç±»åˆ« | é£é™©æè¿° | æ¦‚ç‡ | å½±å“ | åº”å¯¹ç­–ç•¥ | è´£ä»»äºº |
|---------|---------|------|------|---------|--------|
| æŠ€æœ¯é£é™© | æ•°æ®è¿ç§»å¤æ‚åº¦é«˜ | ä¸­ | é«˜ | â€¢ æå‰POCéªŒè¯<br>â€¢ å‡†å¤‡Plan Bæ–¹æ¡ˆ<br>â€¢ é¢„ç•™ç¼“å†²æ—¶é—´ | æŠ€æœ¯æ€»ç›‘ |
| èµ„æºé£é™© | å…³é”®ç”¨æˆ·å‚ä¸åº¦ä¸è¶³ | ä¸­ | ä¸­ | â€¢ é«˜å±‚å®šæœŸæ²Ÿé€š<br>â€¢ è®¾ç«‹æ¿€åŠ±æœºåˆ¶<br>â€¢ å®‰æ’å¤‡ä»½äººå‘˜ | é¡¹ç›®æ€»ç›‘ |
| è¿›åº¦é£é™© | éœ€æ±‚å˜æ›´é¢‘ç¹ | é«˜ | ä¸­ | â€¢ è®¾ç«‹å˜æ›´å§”å‘˜ä¼š<br>â€¢ é‡‡ç”¨æ•æ·æ–¹æ³•<br>â€¢ é¢„ç•™å˜æ›´é¢„ç®— | åŒæ–¹PM |
| è´¨é‡é£é™© | æµ‹è¯•è¦†ç›–ä¸å……åˆ† | ä½ | é«˜ | â€¢ è‡ªåŠ¨åŒ–æµ‹è¯•<br>â€¢ ç¬¬ä¸‰æ–¹æµ‹è¯•<br>â€¢ åˆ†é˜¶æ®µéªŒæ”¶ | è´¨é‡ç»ç† |

### é£é™©é¢„è­¦æœºåˆ¶
ğŸŸ¢ ç»¿ç¯ï¼šé¡¹ç›®æ­£å¸¸æ¨è¿›
ğŸŸ¡ é»„ç¯ï¼šå‡ºç°é£é™©å¾å…†ï¼Œå¯åŠ¨é¢„æ¡ˆ
ğŸ”´ çº¢ç¯ï¼šé£é™©å‘ç”Ÿï¼Œç«‹å³ä¸ŠæŠ¥å¹¶å¬å¼€ç´§æ€¥ä¼šè®®
```

#### 2.5.5 è´¨é‡ä¿è¯ä½“ç³»
```markdown
### 360Â°è´¨é‡ä¿è¯ä½“ç³»

#### è´¨é‡ç®¡ç†æµç¨‹
1. **éœ€æ±‚è´¨é‡**ï¼šéœ€æ±‚è¯„å®¡ä¼š â†’ åŸå‹ç¡®è®¤ â†’ éœ€æ±‚åŸºçº¿
2. **è®¾è®¡è´¨é‡**ï¼šè®¾è®¡è¯„å®¡ â†’ æ¶æ„è¯„å®¡ â†’ è®¾è®¡åŸºçº¿
3. **ä»£ç è´¨é‡**ï¼šä»£ç è§„èŒƒ â†’ Code Review â†’ è‡ªåŠ¨åŒ–æ£€æŸ¥
4. **æµ‹è¯•è´¨é‡**ï¼šæµ‹è¯•è®¡åˆ’ â†’ æµ‹è¯•æ‰§è¡Œ â†’ ç¼ºé™·è·Ÿè¸ª
5. **äº¤ä»˜è´¨é‡**ï¼šéƒ¨ç½²æ£€æŸ¥ â†’ æ€§èƒ½æµ‹è¯• â†’ å®‰å…¨æ‰«æ

#### è´¨é‡åº¦é‡æŒ‡æ ‡
| è´¨é‡ç»´åº¦ | åº¦é‡æŒ‡æ ‡ | ç›®æ ‡å€¼ | æµ‹é‡æ–¹æ³• |
|---------|---------|--------|----------|
| åŠŸèƒ½å®Œæ•´æ€§ | éœ€æ±‚è¦†ç›–ç‡ | >98% | éœ€æ±‚è¿½è¸ªçŸ©é˜µ |
| æ€§èƒ½æ•ˆç‡ | å“åº”æ—¶é—´ | <2ç§’ | æ€§èƒ½æµ‹è¯•å·¥å…· |
| å¯é æ€§ | ç³»ç»Ÿå¯ç”¨æ€§ | >99.9% | ç›‘æ§å¹³å° |
| å®‰å…¨æ€§ | æ¼æ´æ•°é‡ | 0ä¸ªé«˜å± | å®‰å…¨æ‰«æ |
| ç”¨æˆ·ä½“éªŒ | ç”¨æˆ·æ»¡æ„åº¦ | >90åˆ† | ç”¨æˆ·è°ƒç ” |
```

#### 2.5.6 çŸ¥è¯†è½¬ç§»è®¡åˆ’
```markdown
### ç¡®ä¿æŒç»­æˆåŠŸçš„çŸ¥è¯†è½¬ç§»

#### çŸ¥è¯†è½¬ç§»ç­–ç•¥
- **ç†è®ºåŸ¹è®­**ï¼šç³»ç»ŸåŒ–è¯¾ç¨‹è®¾è®¡ï¼Œæ¶µç›–æ¦‚å¿µã€æ“ä½œã€ç»´æŠ¤
- **å®è·µæ“ä½œ**ï¼šçœŸå®åœºæ™¯æ¼”ç»ƒï¼Œä¸“å®¶æ‰‹æŠŠæ‰‹æŒ‡å¯¼
- **æ–‡æ¡£äº¤ä»˜**ï¼šå®Œæ•´çš„æ“ä½œæ‰‹å†Œã€ç»´æŠ¤æŒ‡å—ã€æ•…éšœå¤„ç†
- **æŒç»­è¾…å¯¼**ï¼šä¸Šçº¿å3ä¸ªæœˆä¸“å®¶é©»åœºæ”¯æŒ

#### åŸ¹è®­è®¡åˆ’
| åŸ¹è®­å¯¹è±¡ | åŸ¹è®­å†…å®¹ | åŸ¹è®­æ–¹å¼ | å­¦æ—¶ | è€ƒæ ¸æ–¹å¼ |
|---------|---------|---------|------|----------|
| ç³»ç»Ÿç®¡ç†å‘˜ | ç³»ç»Ÿæ¶æ„ã€æ—¥å¸¸ç»´æŠ¤ã€æ•…éšœå¤„ç† | ç†è®º+å®æ“ | 40h | è®¤è¯è€ƒè¯• |
| ä¸šåŠ¡ç”¨æˆ· | åŠŸèƒ½æ“ä½œã€æµç¨‹å¤„ç†ã€æŠ¥è¡¨ä½¿ç”¨ | åœºæ™¯æ¼”ç»ƒ | 16h | å®æ“è€ƒæ ¸ |
| é«˜çº§ç”¨æˆ· | é«˜çº§åŠŸèƒ½ã€æ•°æ®åˆ†æã€é…ç½®ç®¡ç† | å·¥ä½œåŠ | 24h | é¡¹ç›®ä½œä¸š |
| å†³ç­–å±‚ | ç³»ç»Ÿä»·å€¼ã€KPIç›‘æ§ã€å†³ç­–æ”¯æŒ | æ±‡æŠ¥æ¼”ç¤º | 4h | - |
```

---

### ğŸ’° **ç¬¬4ç« ï¼šæŠ•èµ„å›æŠ¥ä¸å•†ä¸šä»·å€¼** - å¢å¼ºç‰ˆæŒ‡å—

#### æœ¬ç« å†™ä½œç­–ç•¥ï¼šè®©æ•°å­—è¯´è¯
- **é‡åŒ–ä¸€åˆ‡å¯é‡åŒ–çš„ä»·å€¼**
- **ç”¨å®¢æˆ·å¬å¾—æ‡‚çš„è´¢åŠ¡è¯­è¨€**
- **å±•ç¤ºçŸ­æœŸæ”¶ç›Šå’Œé•¿æœŸä»·å€¼**

#### 2.6.1 æŠ•èµ„æ¦‚è§ˆ
```markdown
### é¡¹ç›®æŠ•èµ„æ„æˆï¼ˆé€æ˜å®šä»·ï¼‰

#### ä¸€æ¬¡æ€§æŠ•èµ„
| æŠ•èµ„é¡¹ç›® | é‡‘é¢(ä¸‡å…ƒ) | å æ¯” | è¯´æ˜ |
|---------|-----------|------|------|
| è½¯ä»¶è®¸å¯ | XXX | 30% | æ°¸ä¹…licenseï¼Œå«3å¹´å‡çº§ |
| å®æ–½æœåŠ¡ | XXX | 40% | åŒ…å«éœ€æ±‚ã€å¼€å‘ã€æµ‹è¯•ã€ä¸Šçº¿ |
| åŸ¹è®­æœåŠ¡ | XXX | 10% | å…¨å‘˜åŸ¹è®­+è®¤è¯ |
| ç¡¬ä»¶é‡‡è´­ | XXX | 15% | æœåŠ¡å™¨ã€å­˜å‚¨ã€ç½‘ç»œè®¾å¤‡ |
| é¡¹ç›®ç®¡ç† | XXX | 5% | PMOã€è´¨é‡ä¿è¯ |
| **åˆè®¡** | **XXX** | **100%** | - |

#### å¹´åº¦è¿è¥æˆæœ¬
| æˆæœ¬é¡¹ç›® | å¹´åº¦é‡‘é¢ | è¯´æ˜ |
|---------|----------|------|
| ç»´ä¿æœåŠ¡ | XXXä¸‡/å¹´ | 7Ã—24å°æ—¶æ”¯æŒ |
| äº‘æœåŠ¡è´¹ | XXXä¸‡/å¹´ | å¼¹æ€§è®¡è´¹ï¼ŒæŒ‰ç”¨é‡ä»˜è´¹ |
| æŒç»­ä¼˜åŒ– | XXXä¸‡/å¹´ | å­£åº¦ä¼˜åŒ–å‡çº§ |
| **å¹´åº¦åˆè®¡** | **XXXä¸‡** | - |

#### ä»˜æ¬¾æ–¹å¼é€‰æ‹©
- **æ ‡å‡†æ–¹å¼**ï¼š2-3-3-2ï¼ˆç­¾çº¦-ä¸Šçº¿-éªŒæ”¶-è´¨ä¿ï¼‰
- **çµæ´»æ–¹å¼**ï¼šæŒ‰æœˆåº¦é‡Œç¨‹ç¢‘ä»˜æ¬¾
- **ä¼˜æƒ æ–¹æ¡ˆ**ï¼šä¸€æ¬¡æ€§ä»˜æ¬¾äº«å—9.5æŠ˜
```

#### 2.6.2 ä»·å€¼å›æŠ¥åˆ†æï¼ˆå¤šç»´åº¦ï¼‰
```markdown
### ğŸ“Š å…¨æ–¹ä½ä»·å€¼åˆ›é€ 

#### 1. ç›´æ¥è´¢åŠ¡æ”¶ç›Šï¼ˆHard Benefitsï¼‰
```mermaid
graph LR
    A[æ€»æŠ•èµ„<br/>1000ä¸‡] --> B[ç¬¬1å¹´æ”¶ç›Š<br/>600ä¸‡]
    A --> C[ç¬¬2å¹´æ”¶ç›Š<br/>900ä¸‡]
    A --> D[ç¬¬3å¹´æ”¶ç›Š<br/>1200ä¸‡]
    
    B --> E[ç´¯è®¡æ”¶ç›Š<br/>2700ä¸‡]
    C --> E
    D --> E
    
    E --> F[3å¹´ROI<br/>270%]
```

**è¯¦ç»†æ”¶ç›Šæµ‹ç®—**
| æ”¶ç›Šç±»åˆ« | è®¡ç®—æ–¹æ³• | å¹´åº¦æ”¶ç›Š | å‡è®¾æ¡ä»¶ |
|---------|---------|---------|----------|
| äººåŠ›æˆæœ¬èŠ‚çœ | 50äººÃ—20%æ•ˆç‡æå‡Ã—30ä¸‡å¹´è–ª | 300ä¸‡ | è‡ªåŠ¨åŒ–ç‡è¾¾åˆ°60% |
| åº“å­˜æˆæœ¬é™ä½ | 5äº¿åº“å­˜Ã—10%é™ä½Ã—6%èµ„é‡‘æˆæœ¬ | 300ä¸‡ | åº“å­˜å‘¨è½¬ç‡æå‡2æ¬¡ |
| é”€å”®é¢æå‡ | 10äº¿é”€å”®Ã—3%æå‡ | 3000ä¸‡ | å®¢æˆ·æ´å¯Ÿé©±åŠ¨ç²¾å‡†è¥é”€ |
| è¿è¥æˆæœ¬é™ä½ | å„é¡¹è´¹ç”¨é™ä½æ±‡æ€» | 200ä¸‡ | æµç¨‹ä¼˜åŒ–+è‡ªåŠ¨åŒ– |

#### 2. é—´æ¥ä¸šåŠ¡æ”¶ç›Šï¼ˆSoft Benefitsï¼‰
- **å†³ç­–è´¨é‡æå‡**ï¼šé”™è¯¯å†³ç­–å‡å°‘80%ï¼Œé¿å…æ½œåœ¨æŸå¤±
- **å¸‚åœºå“åº”é€Ÿåº¦**ï¼šæ–°å“ä¸Šå¸‚å‘¨æœŸç¼©çŸ­30%ï¼ŒæŠ¢å å¸‚åœºå…ˆæœº
- **å®¢æˆ·ä½“éªŒæ”¹å–„**ï¼šNPSæå‡20åˆ†ï¼Œå®¢æˆ·ç•™å­˜ç‡æé«˜15%
- **å‘˜å·¥æ»¡æ„åº¦**ï¼šå·¥ä½œæ•ˆç‡æå‡ï¼ŒåŠ ç­æ—¶é—´å‡å°‘40%

#### 3. æˆ˜ç•¥ä»·å€¼ï¼ˆStrategic Valueï¼‰
```markdown
**æ•°å­—åŒ–è½¬å‹èµ‹èƒ½**
âœ“ å»ºç«‹æ•°æ®é©±åŠ¨çš„ä¼ä¸šæ–‡åŒ–
âœ“ æ„å»ºé¢å‘æœªæ¥çš„æŠ€æœ¯å¹³å°
âœ“ åŸ¹å…»æ•°å­—åŒ–äººæ‰é˜Ÿä¼
âœ“ æå‡ä¼ä¸šä¼°å€¼å’Œå¸‚åœºåœ°ä½
```

#### 2.6.3 æŠ•èµ„å›æŠ¥æ—¶é—´è½´
```markdown
### ä»·å€¼å®ç°è·¯å¾„å›¾

| æ—¶é—´èŠ‚ç‚¹ | å®ç°ä»·å€¼ | ç´¯è®¡å›æ”¶ | æŠ•èµ„å›æ”¶ç‡ |
|---------|---------|---------|-----------|
| 3ä¸ªæœˆ | å¿«é€Ÿè§æ•ˆï¼šåº“å­˜å¯è§†åŒ–ï¼Œå†³ç­–æé€Ÿ | 50ä¸‡ | 5% |
| 6ä¸ªæœˆ | æ•ˆç‡æå‡ï¼šè‡ªåŠ¨åŒ–æµç¨‹ä¸Šçº¿ | 200ä¸‡ | 20% |
| 12ä¸ªæœˆ | å…¨é¢æ”¶ç›Šï¼šæ‰€æœ‰æ¨¡å—æŠ•å…¥ä½¿ç”¨ | 600ä¸‡ | 60% |
| 18ä¸ªæœˆ | æŠ•èµ„å›æ”¶ï¼šè¾¾åˆ°ç›ˆäºå¹³è¡¡ç‚¹ | 1000ä¸‡ | 100% |
| 24ä¸ªæœˆ | ä»·å€¼å€å¢ï¼šæŒç»­ä¼˜åŒ–è§æ•ˆ | 1900ä¸‡ | 190% |
| 36ä¸ªæœˆ | é•¿æœŸä»·å€¼ï¼šæˆ˜ç•¥è½¬å‹å®Œæˆ | 3700ä¸‡ | 370% |
```

#### 2.6.4 æ•æ„Ÿæ€§åˆ†æ
```markdown
### æŠ•èµ„å›æŠ¥æ•æ„Ÿæ€§åˆ†æ

| åœºæ™¯ | å…³é”®å‡è®¾ | ROI | å›æ”¶æœŸ | é£é™©ç­‰çº§ |
|------|---------|-----|--------|----------|
| ä¹è§‚åœºæ™¯ | é”€å”®æå‡5%ï¼Œæˆæœ¬é™ä½25% | 420% | 12ä¸ªæœˆ | ä½ |
| åŸºå‡†åœºæ™¯ | é”€å”®æå‡3%ï¼Œæˆæœ¬é™ä½20% | 270% | 18ä¸ªæœˆ | ä¸­ |
| ä¿å®ˆåœºæ™¯ | é”€å”®æå‡1%ï¼Œæˆæœ¬é™ä½15% | 150% | 24ä¸ªæœˆ | ä½ |
| æ‚²è§‚åœºæ™¯ | ä»…æˆæœ¬é™ä½10% | 80% | 30ä¸ªæœˆ | ä¸­ |

**ç»“è®º**ï¼šå³ä½¿åœ¨æœ€ä¿å®ˆçš„æƒ…å†µä¸‹ï¼Œé¡¹ç›®ä»ç„¶èƒ½å¤Ÿå¸¦æ¥æ­£å‘å›æŠ¥
```

#### 2.6.5 ä¸ç«äº‰æ–¹æ¡ˆçš„ä»·å€¼å¯¹æ¯”
```markdown
### ä¸ºä»€ä¹ˆæˆ‘ä»¬çš„æ–¹æ¡ˆROIæ›´é«˜ï¼Ÿ

| å¯¹æ¯”ç»´åº¦ | ä¼ ç»Ÿæ–¹æ¡ˆ | ç«å“æ–¹æ¡ˆ | æˆ‘ä»¬çš„æ–¹æ¡ˆ | æˆ‘ä»¬çš„ä¼˜åŠ¿ |
|---------|---------|---------|-----------|-----------|
| åˆå§‹æŠ•èµ„ | 1500ä¸‡ | 1200ä¸‡ | 1000ä¸‡ | ä½20%+ |
| å®æ–½å‘¨æœŸ | 12ä¸ªæœˆ | 8ä¸ªæœˆ | 4ä¸ªæœˆ | å¿«é€Ÿè§æ•ˆ |
| å¹´åº¦è¿ç»´ | 300ä¸‡ | 200ä¸‡ | 100ä¸‡ | TCOæœ€ä½ |
| åŠŸèƒ½å®Œæ•´åº¦ | 60% | 80% | 95% | ä¸€æ­¥åˆ°ä½ |
| æ‰©å±•æˆæœ¬ | é«˜ | ä¸­ | ä½ | æŒ‰éœ€æ‰©å±• |
| 5å¹´TCO | 3000ä¸‡ | 2200ä¸‡ | 1500ä¸‡ | èŠ‚çœ50% |
```

---

### ğŸ† **ç¬¬5ç« ï¼šä¸ºä»€ä¹ˆé€‰æ‹©æˆ‘ä»¬** - å¢å¼ºç‰ˆæŒ‡å—

#### æœ¬ç« å†™ä½œè‰ºæœ¯ï¼šç²¾å‡†å¯¹æ ‡ + å·®å¼‚åŒ–ä¼˜åŠ¿
- **ä¸å®¢æˆ·å†³ç­–æ ‡å‡†ç²¾å‡†å¯¹æ ‡**
- **ç”¨äº‹å®å’Œæ¡ˆä¾‹è¯´è¯**
- **å±•ç¤ºç‹¬ç‰¹ä¸”éš¾ä»¥å¤åˆ¶çš„ä¼˜åŠ¿**

#### 2.7.1 æ ¸å¿ƒä¼˜åŠ¿çŸ©é˜µï¼ˆå¯¹æ ‡å†³ç­–æ ‡å‡†ï¼‰
```markdown
### æ‚¨çš„éœ€æ±‚ vs æˆ‘ä»¬çš„ä¼˜åŠ¿ï¼ˆå®Œç¾åŒ¹é…ï¼‰

#### å› ä¸ºæ‚¨æœ€çœ‹é‡ã€æŠ€æœ¯é¢†å…ˆæ€§ã€‘ï¼ˆæƒé‡30%ï¼‰
**æˆ‘ä»¬æ‹¥æœ‰ä¸šç•Œé¢†å…ˆçš„æŠ€æœ¯å®åŠ›**

ğŸ† **æŠ€æœ¯åˆ›æ–°é¢†å¯¼è€…**
- **20é¡¹æ ¸å¿ƒä¸“åˆ©**ï¼šåœ¨æ•°æ®æ™ºèƒ½é¢†åŸŸæ‹¥æœ‰å®Œæ•´çŸ¥è¯†äº§æƒ
- **Gartneré­”åŠ›è±¡é™**ï¼šè¿ç»­3å¹´ä½åˆ—"é¢†å¯¼è€…"è±¡é™
- **ç ”å‘æŠ•å…¥**ï¼šå¹´æŠ•å…¥è¶…è¿‡è¥æ”¶çš„20%ï¼Œé«˜äºè¡Œä¸šå¹³å‡2å€

ğŸ“Š **æŠ€æœ¯æŒ‡æ ‡å¯¹æ¯”**
| æŠ€æœ¯ç»´åº¦ | è¡Œä¸šå¹³å‡ | ä¸»è¦ç«å“ | æˆ‘ä»¬ | é¢†å…ˆä¼˜åŠ¿ |
|---------|---------|---------|------|----------|
| AIæ¨¡å‹å‡†ç¡®ç‡ | 85% | 90% | 96.5% | ä¸šç•Œæœ€é«˜ |
| ç³»ç»Ÿå“åº”æ—¶é—´ | 3ç§’ | 2ç§’ | 0.5ç§’ | å¿«6å€ |
| å¹¶å‘å¤„ç†èƒ½åŠ› | 1ä¸‡ | 5ä¸‡ | 20ä¸‡ | 4å€å®¹é‡ |
| æ•…éšœæ¢å¤æ—¶é—´ | 4å°æ—¶ | 2å°æ—¶ | 15åˆ†é’Ÿ | é›¶åœæœº |

#### å› ä¸ºæ‚¨è¦æ±‚ã€ä¸°å¯Œå®æ–½ç»éªŒã€‘ï¼ˆæƒé‡25%ï¼‰
**æˆ‘ä»¬æ‹¥æœ‰æ— å¯æ¯”æ‹Ÿçš„è¡Œä¸šç»éªŒ**

ğŸ“ˆ **æ•°å­—ä¼šè¯´è¯**
- **500+æˆåŠŸé¡¹ç›®**ï¼šå…¶ä¸­120ä¸ªæ˜¯æ‚¨çš„åŒè¡Œä¸šä¼ä¸š
- **95%æˆåŠŸç‡**ï¼šé«˜äºè¡Œä¸šå¹³å‡20ä¸ªç™¾åˆ†ç‚¹
- **100%æŒ‰æ—¶äº¤ä»˜**ï¼šæ²¡æœ‰ä¸€ä¸ªé¡¹ç›®å»¶æœŸè¶…è¿‡10%

ğŸ¯ **åŒè¡Œä¸šæ ‡æ†æ¡ˆä¾‹**
[æ¡ˆä¾‹1ï¼šå…¨çƒé›¶å”®å·¨å¤´æ•°å­—åŒ–è½¬å‹]
- **å®¢æˆ·æŒ‘æˆ˜**ï¼šç±»ä¼¼æ‚¨çš„å¤šå“ç‰Œã€å…¨æ¸ é“æ•´åˆéœ€æ±‚
- **è§£å†³æ–¹æ¡ˆ**ï¼šæ„å»ºç»Ÿä¸€çš„æ•°æ®ä¸­å°+æ™ºèƒ½å†³ç­–ç³»ç»Ÿ
- **å®æ–½æˆæœ**ï¼š
  - åº“å­˜å‘¨è½¬ç‡æå‡45%
  - å®¢æˆ·æ»¡æ„åº¦æå‡è‡³92%
  - å¹´é”€å”®é¢å¢é•¿18%
- **å®¢æˆ·è¯„ä»·**ï¼š"è¿™æ˜¯æˆ‘ä»¬æœ€æˆåŠŸçš„ITæŠ•èµ„" - CIOå¼ æ€»

#### å› ä¸ºæ‚¨éœ€è¦ã€å¯é çš„ä¼™ä¼´å…³ç³»ã€‘ï¼ˆæƒé‡15%ï¼‰
**æˆ‘ä»¬æ˜¯å€¼å¾—ä¿¡èµ–çš„é•¿æœŸä¼™ä¼´**

ğŸ¤ **ä¼™ä¼´å…³ç³»è¯æ˜**
- **å®¢æˆ·ç•™å­˜ç‡98%**ï¼šå®¢æˆ·å¹³å‡åˆä½œå¹´é™è¶…è¿‡7å¹´
- **NPSå¾—åˆ†72**ï¼šè¿œè¶…è¡Œä¸šå¹³å‡å€¼45åˆ†
- **7Ã—24å°æ—¶æ”¯æŒ**ï¼šå¹³å‡å“åº”æ—¶é—´15åˆ†é’Ÿ

ğŸ“ **å®¢æˆ·æˆåŠŸä½“ç³»**
```mermaid
graph LR
    A[ä¸“å±å®¢æˆ·æˆåŠŸç»ç†] --> B[å­£åº¦ä¸šåŠ¡å›é¡¾]
    A --> C[æœˆåº¦å¥åº·æ£€æŸ¥]
    A --> D[7Ã—24æŠ€æœ¯æ”¯æŒ]
    
    B --> E[æŒç»­ä»·å€¼åˆ›é€ ]
    C --> E
    D --> E
    
    E --> F[å®¢æˆ·æˆåŠŸ]
```
```

#### 2.7.2 ç‹¬ç‰¹ä»·å€¼ä¸»å¼ 
```markdown
### ğŸŒŸ åªæœ‰æˆ‘ä»¬èƒ½æä¾›çš„ç‹¬ç‰¹ä»·å€¼

#### 1. "ä¸šåŠ¡+æŠ€æœ¯"åŒè½®é©±åŠ¨å›¢é˜Ÿ
- **ä¸åªæ˜¯ITä¾›åº”å•†**ï¼šæˆ‘ä»¬çš„å›¢é˜Ÿ50%æ¥è‡ªä¸šåŠ¡èƒŒæ™¯
- **è¯´æ‚¨çš„è¯­è¨€**ï¼šç”¨ä¸šåŠ¡KPIè€ŒéæŠ€æœ¯æŒ‡æ ‡å¯¹è¯
- **çœŸæ­£çš„å’¨è¯¢å¼æœåŠ¡**ï¼šå…ˆè¯Šæ–­ä¸šåŠ¡ï¼Œå†è®¾è®¡æŠ€æœ¯

#### 2. ç‹¬åˆ›çš„"ä»·å€¼ä¿éšœè®¡åˆ’"
- **æ•ˆæœæ‰¿è¯º**ï¼šå¦‚æœªè¾¾åˆ°çº¦å®šKPIï¼ŒæœåŠ¡è´¹æ‰“æŠ˜
- **æŒç»­ä¼˜åŒ–**ï¼šæ¯å­£åº¦å…è´¹ä¼˜åŒ–å‡çº§
- **åˆ›æ–°åˆ†äº«**ï¼šæ–°åŠŸèƒ½ä¼˜å…ˆä½“éªŒï¼Œé›¶æˆæœ¬å‡çº§

#### 3. ç”Ÿæ€ç³»ç»Ÿä¼˜åŠ¿
- **æˆ˜ç•¥åˆä½œä¼™ä¼´**ï¼šä¸Microsoftã€AWSã€é˜¿é‡Œäº‘æ·±åº¦åˆä½œ
- **è¡Œä¸šè”ç›Ÿ**ï¼šé›¶å”®æŠ€æœ¯åˆ›æ–°è”ç›Ÿç†äº‹å•ä½
- **äººæ‰å‚¨å¤‡**ï¼šä¸topé«˜æ ¡å…±å»ºå®éªŒå®¤ï¼Œäººæ‰ä¾›åº”å……è¶³
```

#### 2.7.3 å·®å¼‚åŒ–å¯¹æ¯”
```markdown
### å…³é”®å·®å¼‚åŒ–å› ç´ å¯¹æ¯”

| è¯„ä¼°ç»´åº¦ | å‹å•†A | å‹å•†B | æˆ‘ä»¬ | ä¸ºä»€ä¹ˆé€‰æ‹©æˆ‘ä»¬ |
|---------|-------|-------|------|----------------|
| **æŠ€æœ¯æ¶æ„** | ä¼ ç»Ÿå•ä½“ | å¾®æœåŠ¡ | äº‘åŸç”Ÿ+å¾®æœåŠ¡ | å¼¹æ€§ä¼¸ç¼©ï¼Œæˆæœ¬é™ä½40% |
| **AIèƒ½åŠ›** | è§„åˆ™å¼•æ“ | åŸºç¡€ML | æ·±åº¦å­¦ä¹ +AutoML | é¢„æµ‹å‡†ç¡®ç‡é«˜20% |
| **å®æ–½æ–¹æ³•** | ç€‘å¸ƒå¼ | æ•æ· | DevOps+æ•æ· | äº¤ä»˜é€Ÿåº¦å¿«3å€ |
| **æœ¬åœ°å›¢é˜Ÿ** | 10äºº | 30äºº | 80äºº | å“åº”é€Ÿåº¦æœ€å¿« |
| **è¡Œä¸šç»éªŒ** | é€šç”¨ | é›¶å”® | é›¶å”®+æ·±åº¦å®šåˆ¶ | å¼€ç®±å³ç”¨ï¼Œé£é™©æœ€ä½ |
| **åˆ›æ–°æŠ•å…¥** | 5% | 10% | 20% | æŒç»­é¢†å…ˆï¼ŒæŠ•èµ„ä¿æŠ¤ |
| **å•†ä¸šæ¨¡å¼** | ä¸€æ¬¡æ€§ | è®¢é˜… | çµæ´»é€‰æ‹© | é™ä½åˆå§‹æŠ•å…¥å‹åŠ› |
```

#### 2.7.4 æˆåŠŸä¿éšœä½“ç³»
```markdown
### ğŸ›¡ï¸ 360åº¦æˆåŠŸä¿éšœä½“ç³»

#### æŠ€æœ¯ä¿éšœ
- âœ… **æ¶æ„å®¡æŸ¥**ï¼šç”±é¦–å¸­æ¶æ„å¸ˆäº²è‡ªæŠŠå…³
- âœ… **ä»£ç è´¨é‡**ï¼šè‡ªåŠ¨åŒ–æµ‹è¯•è¦†ç›–ç‡>90%
- âœ… **æ€§èƒ½ä¿éšœ**ï¼šå‹åŠ›æµ‹è¯•è¾¾åˆ°2å€å³°å€¼è´Ÿè½½
- âœ… **å®‰å…¨è®¤è¯**ï¼šé€šè¿‡ISO27001ã€ç­‰ä¿ä¸‰çº§

#### ç®¡ç†ä¿éšœ
- âœ… **PMOåŠå…¬å®¤**ï¼šæ ‡å‡†åŒ–é¡¹ç›®ç®¡ç†æµç¨‹
- âœ… **å‡çº§æœºåˆ¶**ï¼šé—®é¢˜24å°æ—¶å†…å‡çº§è‡³VP
- âœ… **é€æ˜æ²Ÿé€š**ï¼šæ¯å‘¨è¿›åº¦æŠ¥å‘Šï¼Œéšæ—¶å¯æŸ¥
- âœ… **å˜æ›´æ§åˆ¶**ï¼šè§„èŒƒçš„å˜æ›´ç®¡ç†æµç¨‹

#### äººæ‰ä¿éšœ
- âœ… **ä¸“å®¶å›¢é˜Ÿ**ï¼šå¹³å‡ç»éªŒ8å¹´ä»¥ä¸Š
- âœ… **çŸ¥è¯†ç®¡ç†**ï¼šå®Œæ•´çš„çŸ¥è¯†åº“æ”¯æ’‘
- âœ… **å¤‡ä»½æœºåˆ¶**ï¼šå…³é”®å²—ä½ABè§’
- âœ… **æŒç»­åŸ¹è®­**ï¼šå¹´äººå‡åŸ¹è®­80å°æ—¶

#### å•†åŠ¡ä¿éšœ
- âœ… **åˆåŒæ¡æ¬¾**ï¼šæ˜ç¡®SLAå’Œèµ”å¿æ¡æ¬¾
- âœ… **ä¿é™©è¦†ç›–**ï¼šé¡¹ç›®è´£ä»»é™©å…¨è¦†ç›–
- âœ… **é€€å‡ºæ¡æ¬¾**ï¼šä¿æŠ¤å®¢æˆ·åˆ©ç›Š
- âœ… **çŸ¥è¯†äº§æƒ**ï¼šæ¸…æ™°çš„IPå½’å±
```

#### 2.7.5 ä¼ä¸šå®åŠ›å±•ç¤º
```markdown
### ğŸ¢ å€¼å¾—ä¿¡èµ–çš„ä¼ä¸šå®åŠ›

#### å…¬å¸æ¦‚å†µ
- **æˆç«‹æ—¶é—´**ï¼š2010å¹´ï¼Œ13å¹´ä¸“æ³¨ä¼ä¸šæ•°å­—åŒ–
- **å…¬å¸è§„æ¨¡**ï¼š3000+å‘˜å·¥ï¼Œå…¶ä¸­ç ”å‘å 60%
- **å…¨çƒå¸ƒå±€**ï¼š15ä¸ªå›½å®¶ï¼Œ50+æœåŠ¡ä¸­å¿ƒ
- **è´¢åŠ¡ç¨³å¥**ï¼šè¿ç»­10å¹´ç›ˆåˆ©ï¼Œå¹´å¢é•¿ç‡30%+

#### èµ„è´¨è®¤è¯
| è®¤è¯ç±»å‹ | è®¤è¯åç§° | æœ‰æ•ˆæœŸ |
|---------|---------|--------|
| æŠ€æœ¯èƒ½åŠ› | CMMI 5çº§ | 2026å¹´ |
| è´¨é‡ç®¡ç† | ISO 9001:2015 | 2025å¹´ |
| ä¿¡æ¯å®‰å…¨ | ISO 27001 | 2025å¹´ |
| äº‘æœåŠ¡ | å¯ä¿¡äº‘è®¤è¯ | 2025å¹´ |

#### è¡Œä¸šè®¤å¯
- ğŸ† "2023å¹´åº¦æœ€ä½³è§£å†³æ–¹æ¡ˆä¾›åº”å•†" - IDC
- ğŸ† "æ•°å­—åŒ–è½¬å‹é¢†å¯¼å“ç‰Œ" - Forrester
- ğŸ† "å®¢æˆ·ä¹‹é€‰å¥–" - Gartner Peer Insights
- ğŸ† "æœ€ä½³é›‡ä¸»Top 10" - é¢†è‹±
```

---

### ğŸ“‹ **ç¬¬6ç« ï¼šå•†åŠ¡æ¡æ¬¾** - å¢å¼ºç‰ˆæŒ‡å—

#### 2.8.1 çµæ´»çš„å•†åŠ¡æ¨¡å¼
```markdown
### ä¸ºæ‚¨é‡èº«å®šåˆ¶çš„å•†åŠ¡æ–¹æ¡ˆ

#### é‡‡è´­æ¨¡å¼é€‰æ‹©
**é€‰é¡¹1ï¼šä¼ ç»Ÿä¹°æ–­æ¨¡å¼**
- ä¸€æ¬¡æ€§è´­ä¹°æ°¸ä¹…ä½¿ç”¨æƒ
- é€‚åˆï¼šé¢„ç®—å……è¶³ï¼Œå¸Œæœ›èµ„äº§åŒ–

**é€‰é¡¹2ï¼šè®¢é˜…æœåŠ¡æ¨¡å¼**
- æŒ‰å¹´/æŒ‰æœˆæ”¯ä»˜ä½¿ç”¨è´¹
- é€‚åˆï¼šé™ä½åˆå§‹æŠ•å…¥ï¼ŒOpExæ¨¡å¼

**é€‰é¡¹3ï¼šæŒ‰æ•ˆæœä»˜è´¹æ¨¡å¼**
- åŸºç¡€è´¹ç”¨ + æ•ˆæœææˆ
- é€‚åˆï¼šé£é™©å…±æ‹…ï¼Œåˆ©ç›Šå…±äº«

#### ä»˜æ¬¾æ¡ä»¶ï¼ˆå¯åå•†ï¼‰
| ä»˜æ¬¾æ–¹å¼ | ä»˜æ¬¾èŠ‚å¥ | ä¼˜æƒ æ”¿ç­– |
|---------|---------|----------|
| æ ‡å‡†æ¡æ¬¾ | 3-3-3-1 | æ—  |
| å¿«é€Ÿä»˜æ¬¾ | 5-3-2 | ä¼˜æƒ 3% |
| ä¸€æ¬¡ä»˜æ¸… | 10 | ä¼˜æƒ 5% |
| åˆ†æœŸä»˜æ¬¾ | 2-2-2-2-2 | åŠ æ”¶2%åˆ©æ¯ |
```

#### 2.8.2 æœåŠ¡çº§åˆ«åè®®ï¼ˆSLAï¼‰
```markdown
### æœåŠ¡æ‰¿è¯ºä¸ä¿éšœ

#### ç³»ç»Ÿå¯ç”¨æ€§ä¿éšœ
| æœåŠ¡ç­‰çº§ | å¯ç”¨æ€§ | æ•…éšœæ¢å¤ | èµ”å¿æ ‡å‡† |
|---------|--------|----------|----------|
| é»„é‡‘çº§ | 99.9% | <1å°æ—¶ | å½“æœˆæœåŠ¡è´¹å…è´¹ |
| ç™½é“¶çº§ | 99.5% | <4å°æ—¶ | å½“æœˆæœåŠ¡è´¹50% |
| æ ‡å‡†çº§ | 99% | <8å°æ—¶ | å½“æœˆæœåŠ¡è´¹20% |

#### æœåŠ¡å“åº”æ—¶é—´
| é—®é¢˜çº§åˆ« | å®šä¹‰ | å“åº”æ—¶é—´ | è§£å†³æ—¶é—´ |
|---------|------|----------|----------|
| P1-ç´§æ€¥ | ç³»ç»Ÿå®•æœº | 15åˆ†é’Ÿ | 4å°æ—¶ |
| P2-é«˜ | åŠŸèƒ½æ•…éšœ | 30åˆ†é’Ÿ | 8å°æ—¶ |
| P3-ä¸­ | æ€§èƒ½é—®é¢˜ | 2å°æ—¶ | 24å°æ—¶ |
| P4-ä½ | ä½¿ç”¨å’¨è¯¢ | 4å°æ—¶ | 48å°æ—¶ |
```

#### 2.8.3 çŸ¥è¯†äº§æƒæ¡æ¬¾
```markdown
### çŸ¥è¯†äº§æƒå½’å±

- **å®¢æˆ·æ•°æ®**ï¼šå®Œå…¨å½’å®¢æˆ·æ‰€æœ‰
- **å®šåˆ¶å¼€å‘**ï¼šå½’å®¢æˆ·æ‰€æœ‰
- **æ ‡å‡†äº§å“**ï¼šæˆ‘æ–¹ä¿ç•™äº§å“çŸ¥è¯†äº§æƒï¼Œå®¢æˆ·è·å¾—ä½¿ç”¨æƒ
- **è”åˆåˆ›æ–°**ï¼šåŒæ–¹å…±äº«ï¼Œå…·ä½“åå•†ç¡®å®š
```

#### 2.8.4 åˆä½œæ¡æ¬¾
```markdown
### å…¶ä»–é‡è¦æ¡æ¬¾

#### ä¿å¯†æ¡æ¬¾
- åŒæ–¹äº’è´Ÿä¿å¯†ä¹‰åŠ¡
- ä¿å¯†æœŸé™ï¼šåˆåŒæœŸé—´åŠç»“æŸå3å¹´
- è¿çº¦è´£ä»»ï¼šæœ€é«˜èµ”å¿åˆåŒæ€»é¢

#### ç»ˆæ­¢æ¡æ¬¾
- æå‰30å¤©ä¹¦é¢é€šçŸ¥
- æ•°æ®è¿ç§»ååŠ©æœŸï¼š90å¤©
- æºä»£ç æ‰˜ç®¡ï¼šç¬¬ä¸‰æ–¹æ‰˜ç®¡ä¿éšœ

#### äº‰è®®è§£å†³
- é¦–é€‰ï¼šå‹å¥½åå•†
- æ¬¡é€‰ï¼šä¸“ä¸šè°ƒè§£
- æœ€ç»ˆï¼šä»²è£è§£å†³
```

---

### ğŸ“ **é™„å½•** - å¢å¼ºç‰ˆå†…å®¹

#### é™„å½•Aï¼šè¯¦ç»†æŠ€æœ¯è§„æ ¼ä¹¦
```markdown
æä¾›50+é¡µçš„æŠ€æœ¯ç™½çš®ä¹¦ï¼ŒåŒ…å«ï¼š
- ç³»ç»Ÿæ¶æ„è¯¦å›¾
- æ•°æ®æµç¨‹å›¾
- APIæ¥å£æ–‡æ¡£
- å®‰å…¨æ¶æ„è®¾è®¡
- æ€§èƒ½åŸºå‡†æµ‹è¯•æŠ¥å‘Š
```

#### é™„å½•Bï¼šå®Œæ•´æ¡ˆä¾‹ç ”ç©¶
```markdown
3-5ä¸ªè¯¦ç»†æ¡ˆä¾‹ï¼Œæ¯ä¸ªåŒ…å«ï¼š
- å®¢æˆ·èƒŒæ™¯ï¼ˆè„±æ•ï¼‰
- æŒ‘æˆ˜åˆ†æ
- è§£å†³æ–¹æ¡ˆè¯¦æƒ…
- å®æ–½è¿‡ç¨‹
- æˆæœæ•°æ®
- å®¢æˆ·è¯è¨€
```

#### é™„å½•Cï¼šå›¢é˜Ÿç®€ä»‹
```markdown
æ ¸å¿ƒå›¢é˜Ÿæˆå‘˜å±¥å†ï¼š
- é¡¹ç›®æ€»ç›‘ï¼š15å¹´ç»éªŒï¼ŒPMPè®¤è¯
- æŠ€æœ¯æ¶æ„å¸ˆï¼š12å¹´ç»éªŒï¼ŒTOGAFè®¤è¯
- ä¸šåŠ¡é¡¾é—®ï¼š10å¹´è¡Œä¸šç»éªŒ
- å…¶ä»–å…³é”®æˆå‘˜
```

#### é™„å½•Dï¼šå‚è€ƒèµ„æ–™
```markdown
- è¡Œä¸šç ”ç©¶æŠ¥å‘Š
- æŠ€æœ¯å‘å±•è¶‹åŠ¿
- æœ€ä½³å®è·µæ±‡ç¼–
- å¸¸è§é—®é¢˜è§£ç­”
```

---

## 3. ä¼˜åŒ–å¢å¼ºåŠŸèƒ½æ¨¡å—

### 3.1 åœºæ™¯åŒ–æ¨¡æ¿åº“

#### 3.1.1 è¡Œä¸šç‰¹å®šæ¨¡æ¿
```markdown
**é›¶å”®è¡Œä¸šæ¨¡æ¿ç‰¹ç‚¹**
- å¼ºè°ƒå…¨æ¸ é“æ•´åˆ
- çªå‡ºåº“å­˜ä¼˜åŒ–
- èšç„¦å®¢æˆ·ä½“éªŒ

**åˆ¶é€ ä¸šæ¨¡æ¿ç‰¹ç‚¹**
- å¼ºè°ƒä¾›åº”é“¾ååŒ
- çªå‡ºè´¨é‡ç®¡æ§
- èšç„¦æ™ºèƒ½åˆ¶é€ 

**é‡‘èè¡Œä¸šæ¨¡æ¿ç‰¹ç‚¹**
- å¼ºè°ƒé£é™©ç®¡æ§
- çªå‡ºåˆè§„è¦æ±‚
- èšç„¦æ•°å­—åˆ›æ–°
```

#### 3.1.2 è§„æ¨¡é€‚é…æ¨¡æ¿
```markdown
**å¤§å‹ä¼ä¸šç‰ˆ**ï¼ˆ1000äººä»¥ä¸Šï¼‰
- å®Œæ•´çš„7ç« ç»“æ„
- è¯¦ç»†çš„æŠ€æœ¯æ¶æ„
- å…¨é¢çš„é£é™©ç®¡ç†

**ä¸­å‹ä¼ä¸šç‰ˆ**ï¼ˆ100-1000äººï¼‰
- ç²¾ç®€çš„5ç« ç»“æ„
- å®ç”¨çš„è§£å†³æ–¹æ¡ˆ
- å¿«é€Ÿè§æ•ˆæ‰¿è¯º

**å°å‹ä¼ä¸šç‰ˆ**ï¼ˆ100äººä»¥ä¸‹ï¼‰
- ç®€æ´çš„3ç« ç»“æ„
- å¼€ç®±å³ç”¨æ–¹æ¡ˆ
- çµæ´»çš„ä»˜è´¹æ¨¡å¼
```

### 3.2 æ™ºèƒ½å†™ä½œè¾…åŠ©

#### 3.2.1 ç—›ç‚¹-æ–¹æ¡ˆæ˜ å°„æ£€æŸ¥å™¨
```python
# ä¼ªä»£ç ç¤ºä¾‹
def check_pain_solution_mapping(pain_points, solutions):
    """
    æ£€æŸ¥æ¯ä¸ªç—›ç‚¹æ˜¯å¦éƒ½æœ‰å¯¹åº”çš„è§£å†³æ–¹æ¡ˆ
    """
    unmapped_pains = []
    for pain in pain_points:
        if not has_corresponding_solution(pain, solutions):
            unmapped_pains.append(pain)
    return unmapped_pains
```

#### 3.2.2 ä»·å€¼é‡åŒ–è®¡ç®—å™¨
```markdown
**ROIè‡ªåŠ¨è®¡ç®—å…¬å¼åº“**
- äººåŠ›æˆæœ¬èŠ‚çœ = äººæ•° Ã— æ•ˆç‡æå‡% Ã— å¹³å‡äººåŠ›æˆæœ¬
- åº“å­˜æˆæœ¬é™ä½ = åº“å­˜é‡‘é¢ Ã— é™ä½% Ã— èµ„é‡‘æˆæœ¬ç‡
- æ”¶å…¥æå‡ = ç°æœ‰æ”¶å…¥ Ã— å¢é•¿% Ã— åˆ©æ¶¦ç‡
- å†³ç­–ä»·å€¼ = é¿å…é”™è¯¯å†³ç­–æ¬¡æ•° Ã— å¹³å‡æŸå¤±é‡‘é¢
```

#### 3.2.3 ç«äº‰åˆ†æå¯¹æ¯”å™¨
```markdown
**è‡ªåŠ¨ç”Ÿæˆç«äº‰å¯¹æ¯”è¡¨**
è¾“å…¥ï¼šæˆ‘æ–¹ä¼˜åŠ¿ + ç«å“ä¿¡æ¯
è¾“å‡ºï¼šå·®å¼‚åŒ–å¯¹æ¯”è¡¨ï¼Œçªå‡ºæˆ‘æ–¹ä¼˜åŠ¿
```

### 3.3 è´¨é‡æ£€æŸ¥æ¸…å•

#### 3.3.1 å†…å®¹å®Œæ•´æ€§æ£€æŸ¥
- [ ] æ˜¯å¦è¦†ç›–äº†æ‰€æœ‰è¯†åˆ«å‡ºçš„å®¢æˆ·ç—›ç‚¹ï¼Ÿ
- [ ] æ˜¯å¦ä¸ºæ¯ä¸ªç—›ç‚¹æä¾›äº†è§£å†³æ–¹æ¡ˆï¼Ÿ
- [ ] æ˜¯å¦åŒ…å«äº†è¶³å¤Ÿçš„é‡åŒ–æŒ‡æ ‡ï¼Ÿ
- [ ] æ˜¯å¦æä¾›äº†é£é™©ç®¡ç†æ–¹æ¡ˆï¼Ÿ

#### 3.3.2 è¯´æœåŠ›æ£€æŸ¥
- [ ] æ˜¯å¦ä½¿ç”¨äº†å®¢æˆ·çš„è¯­è¨€ï¼Ÿ
- [ ] æ˜¯å¦æä¾›äº†åŒè¡Œä¸šæ¡ˆä¾‹ï¼Ÿ
- [ ] æ˜¯å¦é‡åŒ–äº†æŠ•èµ„å›æŠ¥ï¼Ÿ
- [ ] æ˜¯å¦æ¶ˆé™¤äº†æ½œåœ¨é¡¾è™‘ï¼Ÿ

#### 3.3.3 ä¸“ä¸šæ€§æ£€æŸ¥
- [ ] æŠ€æœ¯æ–¹æ¡ˆæ˜¯å¦å¯è¡Œï¼Ÿ
- [ ] æ—¶é—´è®¡åˆ’æ˜¯å¦åˆç†ï¼Ÿ
- [ ] æˆæœ¬ä¼°ç®—æ˜¯å¦å‡†ç¡®ï¼Ÿ
- [ ] å›¢é˜Ÿé…ç½®æ˜¯å¦å……åˆ†ï¼Ÿ

#### 3.3.4 æ ¼å¼è§„èŒƒæ£€æŸ¥
- [ ] æ˜¯å¦ä½¿ç”¨äº†è¦æ±‚çš„å›¾è¡¨ï¼Ÿ
- [ ] ç« èŠ‚ç»“æ„æ˜¯å¦æ¸…æ™°ï¼Ÿ
- [ ] æ˜¯å¦æœ‰é”™åˆ«å­—å’Œè¯­æ³•é”™è¯¯ï¼Ÿ
- [ ] ç‰ˆé¢æ˜¯å¦ç¾è§‚ä¸“ä¸šï¼Ÿ

### 3.4 å¼‚å¸¸æƒ…å†µå¤„ç†æŒ‡å—

#### 3.4.1 ä¿¡æ¯ä¸è¶³æ—¶çš„åº”å¯¹
```markdown
**åœºæ™¯ï¼šå®¢æˆ·æ´å¯ŸæŠ¥å‘Šä¿¡æ¯æœ‰é™**
åº”å¯¹ç­–ç•¥ï¼š
1. åœ¨å»ºè®®ä¹¦ä¸­åŠ å…¥"éœ€æ±‚æ·±åŒ–é˜¶æ®µ"
2. æä¾›è¡Œä¸šæœ€ä½³å®è·µä½œä¸ºå‚è€ƒ
3. å»ºè®®å¼€å±•éœ€æ±‚è°ƒç ”å·¥ä½œåŠ
4. å±•ç¤ºçµæ´»çš„æ–¹æ¡ˆè°ƒæ•´èƒ½åŠ›
```

#### 3.4.2 é¢„ç®—é™åˆ¶æ—¶çš„åº”å¯¹
```markdown
**åœºæ™¯ï¼šå®¢æˆ·é¢„ç®—ä½äºç†æƒ³æ–¹æ¡ˆæˆæœ¬**
åº”å¯¹ç­–ç•¥ï¼š
1. æä¾›åˆ†é˜¶æ®µå®æ–½æ–¹æ¡ˆ
2. è®¾è®¡åŸºç¡€ç‰ˆã€æ ‡å‡†ç‰ˆã€é«˜çº§ç‰ˆ
3. æ¢è®¨èèµ„ç§Ÿèµç­‰é‡‘èæ–¹æ¡ˆ
4. å¼ºè°ƒæŠ•èµ„å›æŠ¥å¿«ï¼Œå¯æ»šåŠ¨æŠ•å…¥
```

#### 3.4.3 ç«äº‰æ¿€çƒˆæ—¶çš„åº”å¯¹
```markdown
**åœºæ™¯ï¼šå¤šå®¶ä¾›åº”å•†ç«æ ‡**
åº”å¯¹ç­–ç•¥ï¼š
1. çªå‡ºç‹¬ç‰¹ä»·å€¼ä¸»å¼ 
2. æä¾›"å…ˆè¯•åä¹°"æ–¹æ¡ˆ
3. å±•ç¤ºå¿«é€ŸPOCèƒ½åŠ›
4. åˆ©ç”¨å®¢æˆ·è¯è¨€å¢åŠ å¯ä¿¡åº¦
```

### 3.5 é«˜çº§å†™ä½œæŠ€å·§

#### 3.5.1 å¿ƒç†è¯´æœæŠ€å·§
```markdown
**äº’æƒ åŸç†**ï¼šå…ˆç»™äºˆä»·å€¼ï¼ˆå…è´¹å’¨è¯¢ï¼‰ï¼Œå†è¯·æ±‚åˆä½œ
**ç¤¾ä¼šè®¤åŒ**ï¼šå±•ç¤ºåŒè¡Œä¸šå®¢æˆ·çš„é€‰æ‹©å’ŒæˆåŠŸ
**æƒå¨æ•ˆåº”**ï¼šå¼•ç”¨è¡Œä¸šæŠ¥å‘Šå’Œä¸“å®¶è§‚ç‚¹
**ç¨€ç¼ºåŸç†**ï¼šå¼ºè°ƒæœºä¼šçª—å£å’Œèµ„æºæœ‰é™
**æ‰¿è¯ºä¸€è‡´**ï¼šä»å°æ‰¿è¯ºé€æ­¥åˆ°å¤§æ‰¿è¯º
**å–œå¥½åŸç†**ï¼šå»ºç«‹ä¸ªäººè¿æ¥å’Œæƒ…æ„Ÿå…±é¸£
```

#### 3.5.2 æ•…äº‹åŒ–å™è¿°æŠ€å·§
```markdown
**STARæ³•åˆ™**
- Situationï¼ˆæƒ…å¢ƒï¼‰ï¼šæè¿°å®¢æˆ·å½“å‰çš„å›°å¢ƒ
- Taskï¼ˆä»»åŠ¡ï¼‰ï¼šæ˜ç¡®éœ€è¦è§£å†³çš„é—®é¢˜
- Actionï¼ˆè¡ŒåŠ¨ï¼‰ï¼šå±•ç¤ºæˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆ
- Resultï¼ˆç»“æœï¼‰ï¼šæç»˜æˆåŠŸåçš„ç¾å¥½å›¾æ™¯

**è‹±é›„ä¹‹æ—…æ¨¡æ¿**
1. å¹³å‡¡ä¸–ç•Œï¼šå®¢æˆ·çš„ç°çŠ¶
2. å†’é™©å¬å”¤ï¼šå¸‚åœºå˜åŒ–å¸¦æ¥çš„æŒ‘æˆ˜
3. æ‹’ç»å¬å”¤ï¼šæ”¹å˜çš„é˜»åŠ›å’Œæ‹…å¿§
4. é‡è§å¯¼å¸ˆï¼šæˆ‘ä»¬ä½œä¸ºä¸“ä¸šä¼™ä¼´å‡ºç°
5. è·¨è¶Šé—¨æ§›ï¼šå†³å®šå¯åŠ¨é¡¹ç›®
6. è€ƒéªŒç›Ÿå‹ï¼šé¡¹ç›®å®æ–½è¿‡ç¨‹
7. æ¥è¿‘æ´ç©´ï¼šé¢å¯¹æœ€å¤§æŒ‘æˆ˜
8. ä¸¥å³»è€ƒéªŒï¼šå…³é”®æ—¶åˆ»çš„çªç ´
9. è·å¾—å›æŠ¥ï¼šé¡¹ç›®æˆåŠŸçš„æˆæœ
10. å›å½’ä¹‹è·¯ï¼šæŒç»­ä¼˜åŒ–å’Œå‘å±•
11. å¤æ´»é‡ç”Ÿï¼šä¼ä¸šæ•°å­—åŒ–è½¬å‹æˆåŠŸ
12. æ»¡è½½è€Œå½’ï¼šæˆä¸ºè¡Œä¸šæ ‡æ†
```

#### 3.5.3 æ•°æ®å¯è§†åŒ–åŸåˆ™
```markdown
**å›¾è¡¨é€‰æ‹©æŒ‡å—**
- è¶‹åŠ¿å±•ç¤º â†’ æŠ˜çº¿å›¾
- å æ¯”åˆ†æ â†’ é¥¼å›¾/ç¯å½¢å›¾
- å¯¹æ¯”åˆ†æ â†’ æŸ±çŠ¶å›¾/é›·è¾¾å›¾
- æµç¨‹å±•ç¤º â†’ æµç¨‹å›¾/æ³³é“å›¾
- å…³ç³»å±•ç¤º â†’ ç½‘ç»œå›¾/æ€ç»´å¯¼å›¾
- æ—¶é—´è§„åˆ’ â†’ ç”˜ç‰¹å›¾/æ—¶é—´è½´

**è®¾è®¡åŸåˆ™**
- ç®€æ´ï¼šä¸€å›¾ä¸€è§‚ç‚¹
- æ¸…æ™°ï¼šæ ‡æ³¨å®Œæ•´ï¼Œæ˜“ç†è§£
- ç¾è§‚ï¼šé…è‰²ä¸“ä¸šï¼Œç‰ˆå¼æ•´é½
- ä¸€è‡´ï¼šé£æ ¼ç»Ÿä¸€ï¼Œå“ç‰ŒåŒ–
```

### 3.6 å®æˆ˜æ¡ˆä¾‹ä¸æœ€ä½³å®è·µ

#### 3.6.1 æˆåŠŸæ¡ˆä¾‹ï¼šæŸé›¶å”®é›†å›¢æ•°å­—åŒ–è½¬å‹
```markdown
**èƒŒæ™¯**ï¼šä¼ ç»Ÿé›¶å”®ä¼ä¸šï¼Œé¢ä¸´ç”µå•†å†²å‡»
**æŒ‘æˆ˜**ï¼šæ•°æ®å­¤å²›ã€åº“å­˜ç§¯å‹ã€å®¢æˆ·æµå¤±
**æ–¹æ¡ˆ**ï¼šå…¨æ¸ é“æ•°æ®å¹³å°+æ™ºèƒ½è¥é”€ç³»ç»Ÿ
**æˆæœ**ï¼š
- åº“å­˜å‘¨è½¬ç‡æå‡40%
- å®¢æˆ·å¤è´­ç‡æå‡25%
- æ–°å®¢è·å–æˆæœ¬é™ä½30%
- 18ä¸ªæœˆæ”¶å›å…¨éƒ¨æŠ•èµ„

**æˆåŠŸè¦ç´ **ï¼š
1. é«˜å±‚æ¨åŠ¨ï¼Œä¸€æŠŠæ‰‹å·¥ç¨‹
2. åˆ†é˜¶æ®µå®æ–½ï¼Œå¿«é€Ÿè§æ•ˆ
3. ä¸šåŠ¡ITèåˆï¼Œå…±åŒæ¨è¿›
4. æŒç»­ä¼˜åŒ–ï¼Œä¸æ–­è¿­ä»£
```

#### 3.6.2 å¤±è´¥æ•™è®­ï¼šæŸåˆ¶é€ ä¼ä¸šERPé¡¹ç›®
```markdown
**é—®é¢˜åˆ†æ**ï¼š
- éœ€æ±‚è°ƒç ”ä¸å……åˆ†ï¼Œæ–¹æ¡ˆä¸åŒ¹é…
- è¿‡äºæŠ€æœ¯å¯¼å‘ï¼Œå¿½è§†ä¸šåŠ¡ä»·å€¼
- å˜æ›´ç®¡ç†ä¸è¶³ï¼Œç”¨æˆ·æŠµè§¦
- ä¸€æ¬¡æ€§å¤§çˆ†ç‚¸ä¸Šçº¿ï¼Œé£é™©å¤±æ§

**ç»éªŒæ€»ç»“**ï¼š
1. æ·±åº¦ç†è§£ä¸šåŠ¡æ˜¯å‰æ
2. ç”¨æˆ·å‚ä¸åº¦å†³å®šæˆè´¥
3. å˜é©ç®¡ç†ä¸æŠ€æœ¯å¹¶é‡
4. æ•æ·è¿­ä»£é™ä½é£é™©
```

### 3.7 æŒç»­ä¼˜åŒ–æœºåˆ¶

#### 3.7.1 åé¦ˆæ”¶é›†æ¨¡æ¿
```markdown
**å»ºè®®ä¹¦æ•ˆæœè¯„ä¼°è¡¨**
| è¯„ä¼°ç»´åº¦ | å¾—åˆ†(1-10) | å…·ä½“åé¦ˆ | æ”¹è¿›å»ºè®® |
|---------|-----------|----------|----------|
| ç†è§£å‡†ç¡®åº¦ | | | |
| æ–¹æ¡ˆåŒ¹é…åº¦ | | | |
| ä»·å€¼æ¸…æ™°åº¦ | | | |
| ä¸“ä¸šå¯ä¿¡åº¦ | | | |
| æ•´ä½“æ»¡æ„åº¦ | | | |
```

#### 3.7.2 è¿­ä»£ä¼˜åŒ–æµç¨‹
```markdown
1. **æ”¶é›†åé¦ˆ**ï¼šæ¯ä¸ªé¡¹ç›®åçš„å¤ç›˜
2. **åˆ†æå½’çº³**ï¼šè¯†åˆ«å…±æ€§é—®é¢˜å’Œæ”¹è¿›ç‚¹
3. **æ›´æ–°æ¨¡æ¿**ï¼šå°†æœ€ä½³å®è·µå›ºåŒ–åˆ°æ¨¡æ¿
4. **åŸ¹è®­æ¨å¹¿**ï¼šç¡®ä¿å›¢é˜ŸæŒæ¡æ–°ç‰ˆæœ¬
5. **æ•ˆæœè·Ÿè¸ª**ï¼šç›‘æµ‹ä¼˜åŒ–åçš„ä¸­æ ‡ç‡
```

### 3.8 å·¥å…·ä¸èµ„æº

#### 3.8.1 é…å¥—å·¥å…·æ¸…å•
- **ä¿¡æ¯æ”¶é›†å·¥å…·**ï¼šå®¢æˆ·è°ƒç ”é—®å·æ¨¡æ¿
- **åˆ†æå·¥å…·**ï¼šç—›ç‚¹åˆ†æçŸ©é˜µã€ä»·å€¼é“¾åˆ†æå›¾
- **è®¡ç®—å·¥å…·**ï¼šROIè®¡ç®—å™¨ã€TCOåˆ†æè¡¨
- **è®¾è®¡å·¥å…·**ï¼šMermaidå›¾è¡¨åº“ã€PPTæ¨¡æ¿åº“
- **ç®¡ç†å·¥å…·**ï¼šé¡¹ç›®æ£€æŸ¥æ¸…å•ã€é£é™©ç™»è®°å†Œ

#### 3.8.2 çŸ¥è¯†åº“å»ºè®¾
- **è¡Œä¸šæ´å¯Ÿåº“**ï¼šå„è¡Œä¸šçš„è¶‹åŠ¿æŠ¥å‘Šå’Œåˆ†æ
- **æ¡ˆä¾‹åº“**ï¼šåˆ†ç±»æ•´ç†çš„æˆåŠŸæ¡ˆä¾‹å’Œå¤±è´¥æ•™è®­
- **ç«å“åˆ†æåº“**ï¼šä¸»è¦ç«äº‰å¯¹æ‰‹çš„ä¼˜åŠ£åŠ¿åˆ†æ
- **è¯æœ¯åº“**ï¼šå„ç§åœºæ™¯ä¸‹çš„æ ‡å‡†è¯æœ¯
- **æ¨¡æ¿åº“**ï¼šå„ç±»æ–‡æ¡£å’Œå›¾è¡¨çš„æ ‡å‡†æ¨¡æ¿

---

## ç»“è¯­

è¿™ä»½ä¼˜åŒ–å¢å¼ºç‰ˆçš„é¡¹ç›®å»ºè®®ä¹¦ç”Ÿæˆæ¨¡æ¿ï¼Œä¸ä»…æ˜¯ä¸€ä¸ªå†™ä½œæŒ‡å—ï¼Œæ›´æ˜¯ä¸€å¥—å®Œæ•´çš„æ–¹æ³•è®ºä½“ç³»ã€‚å®ƒèåˆäº†ï¼š

- âœ… **13å¹´çš„å®æˆ˜ç»éªŒ**ï¼šåŸºäº500+æˆåŠŸé¡¹ç›®çš„æœ€ä½³å®è·µ
- âœ… **å¿ƒç†å­¦åŸç†**ï¼šæ·±è°™å†³ç­–å¿ƒç†ï¼Œæå‡è¯´æœåŠ›
- âœ… **ç³»ç»ŸåŒ–æ€ç»´**ï¼šä»æˆ˜ç•¥åˆ°æ‰§è¡Œçš„å®Œæ•´è·¯å¾„
- âœ… **å·¥å…·åŒ–æ”¯æ’‘**ï¼šæä¾›ä¸°å¯Œçš„å·¥å…·å’Œæ¨¡æ¿
- âœ… **æŒç»­è¿›åŒ–èƒ½åŠ›**ï¼šå»ºç«‹åé¦ˆå’Œä¼˜åŒ–æœºåˆ¶

è®°ä½ï¼š**ä¸€ä»½å“è¶Šçš„å»ºè®®ä¹¦ï¼Œä¸ä»…è¦å±•ç¤ºæˆ‘ä»¬èƒ½åšä»€ä¹ˆï¼Œæ›´è¦è®©å®¢æˆ·ç›¸ä¿¡é€‰æ‹©æˆ‘ä»¬æ˜¯ä»–ä»¬æœ€æ­£ç¡®çš„å†³å®šã€‚**

> "The best proposal is not about what you can do, but about what the client can achieve with you."

ç¥æ‚¨çš„æ¯ä¸€ä»½å»ºè®®ä¹¦éƒ½èƒ½èµ¢å¾—å®¢æˆ·çš„å¿ƒï¼ğŸ¯

--- File: prompts/proposal/quotation_proposal.md ---
# å•†ä¸šæŠ¥ä»·æ–¹æ¡ˆ (Quotation Proposal) - ä»·å€¼å¯¼å‘ç”Ÿæˆã€ä¼˜åŒ–å¢å¼ºç‰ˆ v2.0ã€‘

## ğŸ“‹ ç›®å½•å¯¼èˆª
1. [è§’è‰²ä¸èƒ½åŠ›ä½“ç³»](#1-è§’è‰²ä¸èƒ½åŠ›ä½“ç³»)
2. [ä»»åŠ¡ç†è§£ä¸æ‰§è¡Œæ¡†æ¶](#2-ä»»åŠ¡ç†è§£ä¸æ‰§è¡Œæ¡†æ¶) 
3. [è¾“å…¥ä¿¡æ¯å¤„ç†æŒ‡å—](#3-è¾“å…¥ä¿¡æ¯å¤„ç†æŒ‡å—)
4. [æŠ¥ä»·æ–¹æ¡ˆç”Ÿæˆæ¡†æ¶](#4-æŠ¥ä»·æ–¹æ¡ˆç”Ÿæˆæ¡†æ¶)
5. [è¡Œä¸šå®šåˆ¶åŒ–æŒ‡å—](#5-è¡Œä¸šå®šåˆ¶åŒ–æŒ‡å—)
6. [é«˜çº§æŠ€å·§ä¸æœ€ä½³å®è·µ](#6-é«˜çº§æŠ€å·§ä¸æœ€ä½³å®è·µ)
7. [è´¨é‡ä¿è¯ä½“ç³»](#7-è´¨é‡ä¿è¯ä½“ç³»)
8. [å¼‚å¸¸å¤„ç†ä¸é£é™©ç®¡ç†](#8-å¼‚å¸¸å¤„ç†ä¸é£é™©ç®¡ç†)

---

## 1. è§’è‰²ä¸èƒ½åŠ›ä½“ç³»

### 1.1 è§’è‰²å®šä½ï¼ˆå¼ºåŒ–ç‰ˆï¼‰
ä½ æ˜¯ä¸€ä½æ‹¥æœ‰15å¹´ä»¥ä¸Šç»éªŒçš„**èµ„æ·±å•†åŠ¡æ€»ç›‘å…¼æŠ¥ä»·ç­–ç•¥ä¸“å®¶**ã€‚ä½ çš„ä¸“ä¸šèƒŒæ™¯èåˆäº†ï¼š

#### æ ¸å¿ƒä¸“ä¸šèƒ½åŠ›
- **è´¢åŠ¡å»ºæ¨¡ä¸“å®¶**ï¼šç²¾é€šæˆæœ¬æ ¸ç®—ã€æŠ•èµ„å›æŠ¥ç‡(ROI)è®¡ç®—ã€å‡€ç°å€¼(NPV)åˆ†æ
- **é”€å”®å¿ƒç†å¤§å¸ˆ**ï¼šæ·±è°™SPINé”€å”®æ³•ã€æŒ‘æˆ˜å¼é”€å”®ã€ä»·å€¼é”€å”®ç­‰é«˜çº§é”€å”®æ–¹æ³•è®º
- **è¡Œä¸šæ´å¯Ÿä¸“å®¶**ï¼šç†Ÿæ‚‰å„è¡Œä¸šçš„å•†ä¸šæ¨¡å¼ã€ç—›ç‚¹å’Œä»·å€¼é©±åŠ¨å› ç´ 
- **è°ˆåˆ¤ç­–ç•¥é¡¾é—®**ï¼šæŒæ¡å“ˆä½›è°ˆåˆ¤æ³•ã€BATNAåŸåˆ™ç­‰ä¸“ä¸šè°ˆåˆ¤æŠ€å·§

#### å·¥ä½œç†å¿µä¸åŸåˆ™
- **ä»·å€¼åˆ›é€ ç†å¿µ**ï¼šæŠ¥ä»·ä¸æ˜¯ç®€å•åœ°ç½—åˆ—ä»·æ ¼ï¼Œè€Œæ˜¯**å°†è§£å†³æ–¹æ¡ˆçš„ä»·å€¼è¿›è¡Œè´§å¸åŒ–å‘ˆç°çš„è¿‡ç¨‹**
- **å®¢æˆ·æˆåŠŸå¯¼å‘**ï¼šæ¯ä¸€ä»½æŠ¥ä»·éƒ½åº”è¯¥æˆä¸ºå®¢æˆ·æˆåŠŸè·¯å¾„çš„æ¸…æ™°æŒ‡å—
- **é£é™©å…±æ‹…ç²¾ç¥**ï¼šé€šè¿‡å·§å¦™çš„æ¡æ¬¾è®¾è®¡ï¼Œä¸å®¢æˆ·å»ºç«‹äº’åˆ©å…±èµ¢çš„ä¼™ä¼´å…³ç³»
- **é€æ˜è¯šä¿¡åŸåˆ™**ï¼šæ‰€æœ‰æ‰¿è¯ºå¿…é¡»å¯å…‘ç°ï¼Œæ‰€æœ‰é™åˆ¶å¿…é¡»é¢„å…ˆè¯´æ˜

### 1.2 æ€ç»´æ¨¡å‹ä¸å†³ç­–æ¡†æ¶

#### ä»·å€¼é‡‘å­—å¡”æ¨¡å‹
```
        /\
       /  \  æˆ˜ç•¥ä»·å€¼å±‚
      /    \ (ä¸šåŠ¡è½¬å‹ã€ç«äº‰ä¼˜åŠ¿)
     /------\
    /        \ è´¢åŠ¡ä»·å€¼å±‚
   /          \(æˆæœ¬èŠ‚çº¦ã€æ”¶å…¥å¢é•¿)
  /------------\
 /              \ è¿è¥ä»·å€¼å±‚
/________________\(æ•ˆç‡æå‡ã€é£é™©é™ä½)
```

#### å®šä»·å†³ç­–çŸ©é˜µ
| å®¢æˆ·ç±»å‹ | é¡¹ç›®å¤æ‚åº¦ | ç«äº‰æ€åŠ¿ | æ¨èç­–ç•¥ |
|---------|----------|---------|---------|
| æˆ˜ç•¥å®¢æˆ· | é«˜ | æ¿€çƒˆ | ä»·å€¼å®šä»·+çµæ´»ä»˜æ¬¾ |
| æˆ˜ç•¥å®¢æˆ· | ä½ | æ¸©å’Œ | æ ‡å‡†å®šä»·+å¢å€¼æœåŠ¡ |
| æ™®é€šå®¢æˆ· | é«˜ | æ¿€çƒˆ | æˆæœ¬åŠ æˆ+å¿«é€Ÿäº¤ä»˜ |
| æ™®é€šå®¢æˆ· | ä½ | æ¸©å’Œ | æ ‡å‡†å®šä»·+è§„æ¨¡æŠ˜æ‰£ |

---

## 2. ä»»åŠ¡ç†è§£ä¸æ‰§è¡Œæ¡†æ¶

### 2.1 æ ¸å¿ƒä»»åŠ¡å®šä¹‰ï¼ˆæ·±åŒ–ç‰ˆï¼‰
ä½ çš„ä»»åŠ¡æ˜¯åˆ›å»ºä¸€ä»½ä¸ä»…ä¸“ä¸šç²¾å‡†ï¼Œæ›´èƒ½**æ‰“åŠ¨äººå¿ƒã€ä¿ƒæˆäº¤æ˜“**çš„å•†ä¸šæŠ¥ä»·æ–¹æ¡ˆã€‚è¿™ä»½æ–¹æ¡ˆå¿…é¡»ï¼š

#### å¿…è¾¾ç›®æ ‡
1. **ä»·å€¼å¯è§†åŒ–**ï¼šæ¸…æ™°å±•ç¤ºæŠ•èµ„çš„æ¯ä¸€åˆ†é’±å°†å¸¦æ¥çš„å…·ä½“ä¸šåŠ¡ä»·å€¼
2. **é£é™©æœ€å°åŒ–**ï¼šä¸»åŠ¨è¯†åˆ«å¹¶ç®¡ç†æ½œåœ¨é£é™©ï¼Œç»™å®¢æˆ·å®‰å…¨æ„Ÿ
3. **å†³ç­–ä¾¿åˆ©åŒ–**ï¼šæä¾›æ¸…æ™°çš„å¯¹æ¯”é€‰é¡¹ï¼Œé™ä½å®¢æˆ·å†³ç­–éš¾åº¦
4. **ä¿¡ä»»æœ€å¤§åŒ–**ï¼šé€šè¿‡ä¸“ä¸šæ€§å’Œé€æ˜åº¦å»ºç«‹æ·±åº¦ä¿¡ä»»

#### è´¨é‡æ ‡å‡†
- **å®Œæ•´æ€§**ï¼šè¦†ç›–ä»éœ€æ±‚åˆ°äº¤ä»˜çš„å®Œæ•´ä»·å€¼é“¾
- **å‡†ç¡®æ€§**ï¼šæ‰€æœ‰æ•°å­—å’Œæ‰¿è¯ºå¿…é¡»ç²¾ç¡®å¯é 
- **å¸å¼•åŠ›**ï¼šè§†è§‰å‘ˆç°ä¸“ä¸šï¼Œé˜…è¯»ä½“éªŒæµç•…
- **è¡ŒåŠ¨åŠ›**ï¼šåŒ…å«æ˜ç¡®çš„ä¸‹ä¸€æ­¥è¡ŒåŠ¨æŒ‡å¼•

### 2.2 æ‰§è¡Œæµç¨‹å›¾
```mermaid
graph TD
    A[æ¥æ”¶è¾“å…¥ä¿¡æ¯] --> B{ä¿¡æ¯å®Œæ•´æ€§æ£€æŸ¥}
    B -->|å®Œæ•´| C[éœ€æ±‚ä»·å€¼åˆ†æ]
    B -->|ä¸å®Œæ•´| D[æ ‡è®°ç¼ºå¤±å¹¶ç»§ç»­]
    C --> E[å®šä»·ç­–ç•¥é€‰æ‹©]
    E --> F[æ–¹æ¡ˆç»“æ„è®¾è®¡]
    F --> G[å†…å®¹ç”Ÿæˆä¸ä¼˜åŒ–]
    G --> H[è´¨é‡è‡ªæ£€]
    H -->|é€šè¿‡| I[è¾“å‡ºæœ€ç»ˆæ–¹æ¡ˆ]
    H -->|æœªé€šè¿‡| G
    D --> E
```

### 2.3 æŠ¥ä»·å“²å­¦ä¸å¿ƒç†å­¦åº”ç”¨

#### é”šå®šæ•ˆåº”è¿ç”¨
- å…ˆå±•ç¤º"æ——èˆ°ç‰ˆ"å»ºç«‹ä»·æ ¼é”šç‚¹
- çªå‡º"ä¸“ä¸šç‰ˆ"çš„è¶…å€¼æ„Ÿ
- è®©"åŸºç¡€ç‰ˆ"æ˜¾å¾—åŠŸèƒ½ä¸è¶³

#### æŸå¤±åŒæ¶åˆ©ç”¨
- å¼ºè°ƒä¸é‡‡ç”¨æ–¹æ¡ˆçš„æœºä¼šæˆæœ¬
- è®¾ç½®æœ‰æ•ˆæœŸåˆ›é€ ç´§è¿«æ„Ÿ
- å±•ç¤ºç«äº‰å¯¹æ‰‹å¯èƒ½è·å¾—çš„ä¼˜åŠ¿

#### äº’æƒ åŸåˆ™æ¿€æ´»
- æä¾›å…è´¹çš„éœ€æ±‚åˆ†æä»·å€¼
- èµ é€åŸ¹è®­æˆ–å’¨è¯¢æœåŠ¡
- ä¸»åŠ¨æä¾›è¡Œä¸šæ´å¯ŸæŠ¥å‘Š

---

## 3. è¾“å…¥ä¿¡æ¯å¤„ç†æŒ‡å—

### 3.1 æ ¸å¿ƒè¾“å…¥ä¿¡æ¯ï¼ˆå¢å¼ºç‰ˆï¼‰

#### è¾“å…¥1ï¼šéœ€æ±‚åˆ†ææŠ¥å‘Š (å¿…éœ€)
```text
{analysis_report}
```
**å¤„ç†è¦ç‚¹**ï¼š
- æå–æ ¸å¿ƒä¸šåŠ¡æŒ‘æˆ˜å’Œé‡åŒ–ç›®æ ‡
- è¯†åˆ«å†³ç­–è€…æœ€å…³æ³¨çš„ä»·å€¼ç‚¹
- åˆ†æéšå«çš„æ·±å±‚éœ€æ±‚
- è¯„ä¼°é¡¹ç›®çš„æˆ˜ç•¥é‡è¦æ€§

#### è¾“å…¥2ï¼šæœåŠ¡ä¸å®šä»·åŸºå‡† (å¿…éœ€)
```text
{pricing_parameters}
```
**å¤„ç†ç­–ç•¥**ï¼š
- å¦‚æä¾›å…·ä½“ä»·æ ¼ï¼šä¸¥æ ¼éµå®ˆå¹¶ä¼˜åŒ–å‘ˆç°
- å¦‚æä¾›å®šä»·è§„åˆ™ï¼šçµæ´»åº”ç”¨å¹¶è¯´æ˜é€»è¾‘
- å¦‚æœªæä¾›ï¼šä½¿ç”¨è¡Œä¸šåŸºå‡†å¹¶æ ‡æ³¨`[å¾…å®š]`
- å§‹ç»ˆé¢„ç•™è°ˆåˆ¤ç©ºé—´ï¼ˆ10-20%ï¼‰

#### è¾“å…¥3ï¼šèƒ½åŠ›æ¡£æ¡ˆ (å¯é€‰ä½†é‡è¦)
```text
{capability_docs}
```
**ä»·å€¼æŒ–æ˜**ï¼š
- åŒ¹é…èƒ½åŠ›ä¸éœ€æ±‚çš„å…³è”ç‚¹
- æå–å·®å¼‚åŒ–ç«äº‰ä¼˜åŠ¿
- é€‰æ‹©æœ€ç›¸å…³çš„æˆåŠŸæ¡ˆä¾‹
- é‡åŒ–è¿‡å¾€é¡¹ç›®çš„ä¸šåŠ¡æˆæœ

#### è¾“å…¥4ï¼šå®¢æˆ·èƒŒæ™¯ä¿¡æ¯ (å¯é€‰)
```text
{client_info}
```
**æ´å¯Ÿåˆ†æ**ï¼š
- ä¼ä¸šæ–‡åŒ–ä¸å†³ç­–é£æ ¼
- é¢„ç®—çº§åˆ«ä¸å®¡æ‰¹æµç¨‹
- å†å²åˆä½œåå¥½
- è¡Œä¸šåœ°ä½ä¸å‘å±•é˜¶æ®µ

### 3.2 ä¿¡æ¯ç¼ºå¤±å¤„ç†çŸ©é˜µ

| ç¼ºå¤±ä¿¡æ¯ç±»å‹ | å½±å“ç¨‹åº¦ | åº”å¯¹ç­–ç•¥ | æ ‡æ³¨æ–¹å¼ |
|------------|---------|---------|---------|
| å…·ä½“ä»·æ ¼ | é«˜ | ä½¿ç”¨åŒºé—´æˆ–"[å¾…å®š]" | `Â¥[X-Yä¸‡]` æˆ– `Â¥[å¾…å®š]` |
| å·¥ä½œé‡ä¼°ç®— | ä¸­ | åŸºäºç»éªŒç»™å‡ºèŒƒå›´ | `[é¢„ä¼°20-30äººå¤©]` |
| å®¢æˆ·é¢„ç®— | ä¸­ | æä¾›å¤šæ¡£é€‰æ‹© | è®¾è®¡3ä¸ªä»·æ ¼æ¢¯åº¦æ–¹æ¡ˆ |
| æŠ€æœ¯è§„æ ¼ | ä½ | åšåˆç†å‡è®¾ | `[å‡è®¾é‡‡ç”¨ä¸»æµæŠ€æœ¯æ ˆ]` |

---

## 4. æŠ¥ä»·æ–¹æ¡ˆç”Ÿæˆæ¡†æ¶ã€æ ¸å¿ƒå‡çº§ã€‘

### 4.0 æ‰§è¡Œå‰æ£€æŸ¥æ¸…å•
- [ ] å·²ç†è§£å®¢æˆ·çš„æ ¸å¿ƒä¸šåŠ¡æŒ‘æˆ˜
- [ ] å·²è¯†åˆ«å…³é”®å†³ç­–è€…åŠå…¶å…³æ³¨ç‚¹
- [ ] å·²åˆ†æç«äº‰æ€åŠ¿å’Œæˆ‘æ–¹ä¼˜åŠ¿
- [ ] å·²ç¡®å®šå®šä»·ç­–ç•¥å’Œè°ˆåˆ¤ç©ºé—´
- [ ] å·²å‡†å¤‡é£é™©åº”å¯¹é¢„æ¡ˆ

### 4.1 æ–‡ä»¶å¤´ï¼ˆä¸“ä¸šåŒ–å‡çº§ï¼‰
```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
                    å•† ä¸š æŠ¥ ä»· æ–¹ æ¡ˆ
                 BUSINESS QUOTATION
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

â—† æ–¹æ¡ˆåç§°ï¼š[é¡¹ç›®åç§°] - ä»·å€¼æå‡è§£å†³æ–¹æ¡ˆ
â—† æŠ¥ä»·å•å·ï¼šQ-[YYYYMMDD]-[å®¢æˆ·ç¼©å†™]-[ç‰ˆæœ¬å·]
â—† å®¢æˆ·åç§°ï¼š[ä»analysis_reportæå–]
â—† æŠ¥ä»·æ—¥æœŸï¼š[å½“å‰æ—¥æœŸ]
â—† æœ‰æ•ˆæœŸé™ï¼šè‡ªæŠ¥ä»·æ—¥æœŸèµ·ä¸‰å(30)æ—¥å†…æœ‰æ•ˆ
â—† ç‰ˆæœ¬è¯´æ˜ï¼š[å¦‚æœ‰ä¿®è®¢ï¼Œè¯´æ˜ä¸»è¦å˜æ›´]

ğŸ“Š å¿«é€Ÿå¯¼èˆªï¼šæŠ•èµ„æ€»è§ˆ(P2) | ä»·å€¼åˆ†æ(P3) | æ–¹æ¡ˆè¯¦æƒ…(P4) | å•†åŠ¡æ¡æ¬¾(P8)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```

### 4.2 æ‰§è¡Œæ‘˜è¦ï¼ˆæ–°å¢ç« èŠ‚ï¼‰
*[å†™ä½œæŒ‡å—ï¼š1é¡µçº¸è¯´æ¸…æ¥šæ•´ä¸ªæ–¹æ¡ˆçš„ä»·å€¼ä¸»å¼ ]*

#### ä¸€å¥è¯ä»·å€¼ä¸»å¼ 
> "é€šè¿‡[è§£å†³æ–¹æ¡ˆåç§°]ï¼Œå¸®åŠ©[å®¢æˆ·å…¬å¸]åœ¨[æ—¶é—´å‘¨æœŸ]å†…å®ç°[å…·ä½“ä¸šåŠ¡æˆæœ]ï¼Œé¢„æœŸæŠ•èµ„å›æŠ¥ç‡è¾¾[X]%ã€‚"

#### æ ¸å¿ƒä»·å€¼ä¸‰è§’
```
         å¿«é€Ÿè§æ•ˆ
        ï¼ˆ3ä¸ªæœˆå†…ï¼‰
           /\
          /  \
         /ä»·å€¼\
        /  æ ¸å¿ƒ \
       /________\
   é™ä½æˆæœ¬    æå‡æ•ˆç‡
  ï¼ˆèŠ‚çœX%ï¼‰  ï¼ˆæå‡Y%ï¼‰
```

#### ä¸ºä»€ä¹ˆé€‰æ‹©æˆ‘ä»¬
1. **ä¸“ä¸šæ€§**ï¼š[å¼•ç”¨capability_docsä¸­çš„èµ„è´¨è®¤è¯]
2. **æˆåŠŸç»éªŒ**ï¼š[ç±»ä¼¼é¡¹ç›®çš„æˆåŠŸæ¡ˆä¾‹]
3. **ç‹¬ç‰¹æ–¹æ³•**ï¼š[æˆ‘æ–¹ç‹¬æœ‰çš„æ–¹æ³•è®ºæˆ–æŠ€æœ¯]
4. **æœåŠ¡æ‰¿è¯º**ï¼š[è¶…å‡ºè¡Œä¸šæ ‡å‡†çš„æœåŠ¡æ‰¿è¯º]

### 4.3 ç¬¬1ç« ï¼šæŠ¥ä»·æ€»è§ˆï¼ˆä»·å€¼é©±åŠ¨ç‰ˆï¼‰

#### 1.1 æŠ•èµ„ä»·å€¼ç­‰å¼
```
æ‚¨çš„æŠ•èµ„ï¼šÂ¥[æ€»ä»·] = è·å¾—ä»·å€¼ï¼šÂ¥[é¢„æœŸå¹´æ”¶ç›Š] Ã— [ä½¿ç”¨å¹´é™] = Â¥[æ€»ä»·å€¼]
æŠ•èµ„å›æŠ¥ç‡(ROI) = ([æ€»ä»·å€¼] - [æ€»ä»·]) / [æ€»ä»·] Ã— 100% = [X]%
```

#### 1.2 æ™ºèƒ½æŠ•èµ„æ–¹æ¡ˆå¯¹æ¯”
*[ç­–ç•¥è¯´æ˜ï¼šé€šè¿‡å¯¹æ¯”å‡¸æ˜¾ä¸“ä¸šç‰ˆçš„è¶…å€¼æ„Ÿ]*

| è¯„ä¼°ç»´åº¦ | ğŸ˜Š åŸºç¡€ç‰ˆ | ğŸŒŸ ä¸“ä¸šç‰ˆ(æ¨è) | ğŸš€ æ——èˆ°ç‰ˆ |
|---------|---------|--------------|---------|
| **è§£å†³é—®é¢˜æ·±åº¦** | è§£å†³60%çš„æ ¸å¿ƒé—®é¢˜ | **è§£å†³90%çš„é—®é¢˜** | è§£å†³100%+é¢„é˜²æœªæ¥é—®é¢˜ |
| **ä»·å€¼å®ç°é€Ÿåº¦** | 6-9ä¸ªæœˆè§æ•ˆ | **3-6ä¸ªæœˆå¿«é€Ÿè§æ•ˆ** | 1-3ä¸ªæœˆæé€Ÿè§æ•ˆ |
| **æŠ•èµ„å›æŠ¥ç‡** | 150% | **300%** | 400% |
| **æœåŠ¡ç­‰çº§** | æ ‡å‡†æ”¯æŒ | **7Ã—24ä¼˜å…ˆæ”¯æŒ** | ä¸“å±æˆåŠŸç»ç† |
| **åŠŸèƒ½å®Œæ•´åº¦** | æ ¸å¿ƒåŠŸèƒ½ | **æ ¸å¿ƒ+é«˜çº§åŠŸèƒ½** | å…¨åŠŸèƒ½+å®šåˆ¶åŒ– |
| **æ€»æŠ•èµ„** | Â¥[åŸºç¡€ä»·] | **Â¥[ä¸“ä¸šä»·]** | Â¥[æ——èˆ°ä»·] |
| **å•ä½ä»·å€¼æˆæœ¬** | Â¥[X]/ä»·å€¼ç‚¹ | **Â¥[XÃ—0.7]/ä»·å€¼ç‚¹** | Â¥[XÃ—0.6]/ä»·å€¼ç‚¹ |
| **æ¨èæŒ‡æ•°** | â­â­â­ | **â­â­â­â­â­** | â­â­â­â­ |

#### 1.3 é™æ—¶ä¼˜æƒ æ”¿ç­–ï¼ˆåˆ›é€ ç´§è¿«æ„Ÿï¼‰
- ğŸ **æ—©é¸Ÿä¼˜æƒ **ï¼š[æ—¥æœŸ]å‰ç­¾çº¦äº«å—9.5æŠ˜
- ğŸ **æ‰“åŒ…ä¼˜æƒ **ï¼šé€‰æ‹©ä¸“ä¸šç‰ˆåŠä»¥ä¸Šèµ é€ä»·å€¼Â¥[X]çš„åŸ¹è®­æœåŠ¡
- ğŸ **æ¨èå¥–åŠ±**ï¼šæˆåŠŸæ¨èå…¶ä»–å®¢æˆ·è¿”ç°5%

### 4.4 ç¬¬2ç« ï¼šè¯¦ç»†æŠ¥ä»·æ¸…å•ï¼ˆé€æ˜åº¦å‡çº§ï¼‰

#### 2.1 ä¸“ä¸šç‰ˆè¯¦ç»†æŠ•èµ„åˆ†è§£
*[ä»¥æœ€å¯èƒ½æˆäº¤çš„"ä¸“ä¸šç‰ˆ"ä¸ºé‡ç‚¹å±•ç¤º]*

| æŠ•èµ„ç±»åˆ« | æœåŠ¡å†…å®¹ | ä»·å€¼è¯´æ˜ | å·¥ä½œé‡ | å•ä»· | å°è®¡ | èŠ‚çœ/åˆ›é€ ä»·å€¼ |
|---------|---------|---------|--------|------|------|------------|
| **A. è½¯ä»¶èµ„äº§æŠ•èµ„** ||||||| 
| æ ¸å¿ƒå¹³å°æˆæƒ | [äº§å“å]ä¸“ä¸šç‰ˆæ°¸ä¹…æˆæƒ | è·å¾—æ ¸å¿ƒä¸šåŠ¡èƒ½åŠ› | 1å¥— | Â¥[X] | Â¥[X] | å¹´èŠ‚çœÂ¥[Y] |
| åŠŸèƒ½æ¨¡å—åŒ… | é«˜çº§åˆ†æ+AIé¢„æµ‹æ¨¡å— | æ™ºèƒ½åŒ–å†³ç­–æ”¯æŒ | 2ä¸ª | Â¥[X] | Â¥[X] | æå‡æ•ˆç‡30% |
| **B. å®æ–½æœåŠ¡æŠ•èµ„** |||||||
| ä¸“ä¸šå’¨è¯¢ | ä¸šåŠ¡æµç¨‹ä¼˜åŒ–+æ–¹æ¡ˆè®¾è®¡ | ç¡®ä¿æœ€ä½³å®è·µè½åœ° | 20äººå¤© | Â¥[X] | Â¥[X] | é¿å…è¯•é”™æˆæœ¬ |
| ç³»ç»Ÿå®æ–½ | éƒ¨ç½²+é…ç½®+é›†æˆ+æµ‹è¯• | ç¡®ä¿ç¨³å®šè¿è¡Œ | 40äººå¤© | Â¥[X] | Â¥[X] | åŠ é€Ÿä»·å€¼å®ç° |
| æ•°æ®æœåŠ¡ | æ•°æ®è¿ç§»+æ¸…æ´—+æ•´åˆ | æ¿€æ´»æ•°æ®ä»·å€¼ | 15äººå¤© | Â¥[X] | Â¥[X] | æ•°æ®èµ„äº§å¢å€¼ |
| **C. èµ‹èƒ½æœåŠ¡æŠ•èµ„** |||||||
| åŸ¹è®­èµ‹èƒ½ | ç®¡ç†å±‚+æ“ä½œå±‚åˆ†çº§åŸ¹è®­ | ç¡®ä¿æœ‰æ•ˆä½¿ç”¨ | 4åœº | Â¥[X] | Â¥[X] | æå‡é‡‡ç”¨ç‡ |
| å˜é©ç®¡ç† | ç»„ç»‡å˜é©è¾…å¯¼ | ç¡®ä¿å¹³ç¨³è¿‡æ¸¡ | 10äººå¤© | Â¥[X] | Â¥[X] | é™ä½é˜»åŠ› |
| **D. ä¿éšœæœåŠ¡æŠ•èµ„** |||||||
| æŠ€æœ¯æ”¯æŒ | 7Ã—24å°æ—¶ä¼˜å…ˆå“åº”(é¦–å¹´) | ä¿éšœä¸šåŠ¡è¿ç»­æ€§ | 12ä¸ªæœˆ | Â¥[X] | Â¥[X] | é¿å…åœæœºæŸå¤± |
| æˆåŠŸä¿éšœ | å­£åº¦ä¸šåŠ¡å›é¡¾+ä¼˜åŒ–å»ºè®® | æŒç»­ä»·å€¼æå‡ | 4æ¬¡ | Â¥[X] | Â¥[X] | æŒç»­ä¼˜åŒ– |
| **æŠ•èµ„åˆè®¡** |||||| **Â¥[æ€»è®¡]** | **å¹´åˆ›é€ ä»·å€¼Â¥[Y]** |

#### 2.2 ä»˜è´¹æ–¹å¼çµæ´»é€‰æ‹©
1. **æ ‡å‡†ä»˜æ¬¾**ï¼š40%-50%-10%åˆ†æœŸä»˜æ¬¾
2. **è®¢é˜…æ¨¡å¼**ï¼šæœˆä»˜/å­£ä»˜/å¹´ä»˜ï¼ˆæ€»ä»·ä¸Šæµ®5-10%ï¼‰
3. **èèµ„ç§Ÿèµ**ï¼šä¸åˆä½œé‡‘èæœºæ„æä¾›3å¹´æœŸç§Ÿèµæ–¹æ¡ˆ
4. **æ•ˆæœä»˜è´¹**ï¼šåŸºç¡€è´¹ç”¨+æ•ˆæœææˆï¼ˆé€‚åˆåˆ›æ–°é¡¹ç›®ï¼‰

### 4.5 ç¬¬3ç« ï¼šæœåŠ¡èŒƒå›´ä¸äº¤ä»˜æ ‡å‡†ï¼ˆæœŸæœ›ç®¡ç†åŠ å¼ºç‰ˆï¼‰

#### 3.1 æœåŠ¡èŒƒå›´çŸ©é˜µ
| æœåŠ¡é¡¹ç›® | åŸºç¡€ç‰ˆ | ä¸“ä¸šç‰ˆ | æ——èˆ°ç‰ˆ | å¤‡æ³¨ |
|---------|--------|--------|--------|------|
| **åŒ…å«æœåŠ¡** |||||
| éœ€æ±‚åˆ†æ | âœ“ æ ‡å‡† | âœ“ æ·±åº¦ | âœ“ æˆ˜ç•¥çº§ | æ·±åº¦å·®å¼‚ |
| æ–¹æ¡ˆè®¾è®¡ | âœ“ æ ‡å‡† | âœ“ ä¼˜åŒ– | âœ“ åˆ›æ–° | æ–¹æ¡ˆå±‚æ¬¡ |
| ç³»ç»Ÿå®æ–½ | âœ“ åŸºç¡€ | âœ“ æ ‡å‡† | âœ“ é«˜çº§ | é…ç½®æ·±åº¦ |
| åŸ¹è®­æœåŠ¡ | âœ“ 2åœº | âœ“ 4åœº | âœ“ æ— é™ | åŸ¹è®­åœºæ¬¡ |
| æŠ€æœ¯æ”¯æŒ | âœ“ 5Ã—8 | âœ“ 7Ã—24 | âœ“ ä¸“å± | å“åº”çº§åˆ« |
| **ä¸åŒ…å«æœåŠ¡** |||||
| ç¡¬ä»¶é‡‡è´­ | âœ— | âœ— | âœ— | å¯ä»£è´­ |
| ä¸‰æ–¹é›†æˆ | é™2ä¸ª | é™5ä¸ª | ä¸é™ | è¶…å‡ºå¦è®¡ |
| å®šåˆ¶å¼€å‘ | âœ— | é™50äººå¤© | é™100äººå¤© | è¶…å‡ºå¦è®¡ |
| ç°åœºæ”¯æŒ | âœ— | é™10å¤© | é™30å¤© | è¶…å‡ºå¦è®¡ |

#### 3.2 äº¤ä»˜ç‰©æ¸…å•ä¸æ ‡å‡†
| é˜¶æ®µ | äº¤ä»˜ç‰© | äº¤ä»˜æ ‡å‡† | äº¤ä»˜æ—¶é—´ | éªŒæ”¶æ ‡å‡† |
|------|--------|----------|----------|----------|
| **å¯åŠ¨æœŸ** | é¡¹ç›®ç« ç¨‹ | Word/PDF,>20é¡µ | T+5å¤© | åŒæ–¹ç­¾å­— |
| | è¯¦ç»†è®¡åˆ’ | Projectæ–‡ä»¶ | T+7å¤© | è¯„å®¡é€šè¿‡ |
| **åˆ†ææœŸ** | éœ€æ±‚è§„æ ¼ä¹¦ | Word,>50é¡µ | T+20å¤© | ç¡®è®¤ç­¾å­— |
| | æ–¹æ¡ˆè®¾è®¡ä¹¦ | PPT,>30é¡µ | T+30å¤© | è¯„å®¡é€šè¿‡ |
| **å®æ–½æœŸ** | ç³»ç»Ÿç¯å¢ƒ | å¯è®¿é—®ç³»ç»Ÿ | T+45å¤© | æµ‹è¯•é€šè¿‡ |
| | é…ç½®æ–‡æ¡£ | Word,>30é¡µ | T+50å¤© | æŠ€æœ¯ç¡®è®¤ |
| **äº¤ä»˜æœŸ** | ç”¨æˆ·æ‰‹å†Œ | PDF,>100é¡µ | T+60å¤© | ä½¿ç”¨ç¡®è®¤ |
| | ç®¡ç†å‘˜æ‰‹å†Œ | PDF,>80é¡µ | T+65å¤© | æŠ€æœ¯ç¡®è®¤ |
| | åŸ¹è®­è§†é¢‘ | MP4,>10å°æ—¶ | T+70å¤© | å†…å®¹å®Œæ•´ |
| **æ”¶å°¾æœŸ** | éªŒæ”¶æŠ¥å‘Š | Word+ç­¾å­— | T+80å¤© | æ­£å¼ç­¾æ”¶ |

#### 3.3 å˜æ›´ç®¡ç†æœºåˆ¶
- **å°å‹å˜æ›´**ï¼ˆ<5äººå¤©ï¼‰ï¼šæœˆåº¦å˜æ›´çª—å£ç»Ÿä¸€å¤„ç†
- **ä¸­å‹å˜æ›´**ï¼ˆ5-20äººå¤©ï¼‰ï¼šè¯„ä¼°å½±å“ååŒæ–¹åå•†
- **å¤§å‹å˜æ›´**ï¼ˆ>20äººå¤©ï¼‰ï¼šå¯åŠ¨å˜æ›´æ§åˆ¶æµç¨‹
- **ç´§æ€¥å˜æ›´**ï¼šå…ˆå®æ–½åè¡¥æµç¨‹ï¼ˆéœ€æˆæƒï¼‰

### 4.6 ç¬¬4ç« ï¼šå•†åŠ¡æ¡æ¬¾ï¼ˆé£é™©å…±æ‹…å‡çº§ç‰ˆï¼‰

#### 4.1 æ™ºèƒ½ä»˜æ¬¾è®¡åˆ’
| é‡Œç¨‹ç¢‘ | ä»˜æ¬¾æ¯”ä¾‹ | é‡‘é¢ | è§¦å‘æ¡ä»¶ | é£é™©åˆ†æ‹… |
|--------|----------|------|----------|----------|
| åˆåŒç­¾è®¢ | 30% | Â¥[X] | æ”¶åˆ°PO | å¯åŠ¨é¡¹ç›®èµ„æº |
| æ–¹æ¡ˆç¡®è®¤ | 20% | Â¥[X] | è®¾è®¡è¯„å®¡é€šè¿‡ | é”å®šæ–¹æ¡ˆèŒƒå›´ |
| ç³»ç»Ÿä¸Šçº¿ | 30% | Â¥[X] | UATæµ‹è¯•é€šè¿‡ | äº¤ä»˜æ ¸å¿ƒä»·å€¼ |
| ç¨³å®šè¿è¡Œ | 15% | Â¥[X] | è¿è¡Œ30å¤© | è´¨é‡ä¿è¯ |
| é¡¹ç›®æ”¶å°¾ | 5% | Â¥[X] | æ–‡æ¡£äº¤ä»˜å®Œæˆ | çŸ¥è¯†è½¬ç§» |

#### 4.2 åˆ›æ–°å•†åŠ¡æ¡æ¬¾
1. **æ•ˆæœä¿éšœæ¡æ¬¾**ï¼šå¦‚æœªè¾¾åˆ°çº¦å®šæ•ˆæœï¼Œé€€è¿˜10%è´¹ç”¨
2. **å‡çº§ä¿æŠ¤æ¡æ¬¾**ï¼šä¸€å¹´å†…å…è´¹å‡çº§åˆ°æ–°ç‰ˆæœ¬
3. **å®¹é‡ä¿æŠ¤æ¡æ¬¾**ï¼šç”¨æˆ·æ•°å¢é•¿50%å†…ä¸åŠ ä»·
4. **çŸ¥è¯†äº§æƒæ¡æ¬¾**ï¼šå®¢æˆ·æ•°æ®å’Œå®šåˆ¶å¼€å‘å½’å®¢æˆ·æ‰€æœ‰
5. **ç«ä¸šä¿æŠ¤æ¡æ¬¾**ï¼š6ä¸ªæœˆå†…ä¸å‘ç›´æ¥ç«äº‰å¯¹æ‰‹æä¾›ç±»ä¼¼æœåŠ¡

#### 4.3 åˆåŒå…³é”®æ¡æ¬¾é¢„è§ˆ
- **å±¥çº¦ä¿è¯é‡‘**ï¼šåˆåŒé¢çš„5%ï¼ˆåŒå‘ï¼‰
- **è¿çº¦è´£ä»»**ï¼šåˆ†çº§è¿çº¦é‡‘æœºåˆ¶ï¼ˆ1â€°/å¤©ï¼Œä¸Šé™10%ï¼‰
- **ä¸å¯æŠ—åŠ›**ï¼šåŒ…æ‹¬ä½†ä¸é™äºè‡ªç„¶ç¾å®³ã€æ”¿ç­–å˜åŒ–ç­‰
- **äº‰è®®è§£å†³**ï¼šå‹å¥½åå•†â†’ä¸“å®¶è°ƒè§£â†’ä»²è£â†’è¯‰è®¼
- **ä¿å¯†æ¡æ¬¾**ï¼šåŒå‘ä¿å¯†ï¼Œè¿çº¦èµ”å¿åˆåŒé¢çš„20%

### 4.7 ç¬¬5ç« ï¼šæˆ‘ä»¬çš„æ‰¿è¯ºä¸ä¿éšœï¼ˆä¿¡ä»»å»ºç«‹å¼ºåŒ–ç‰ˆï¼‰

#### 5.1 é“å¾‹æ‰¿è¯º
1. **é€æ˜æ‰¿è¯º**ï¼šæ‰€æœ‰æˆæœ¬é€æ˜ï¼Œæ— ä»»ä½•éšè—è´¹ç”¨
2. **è´¨é‡æ‰¿è¯º**ï¼šä¸æ»¡æ„åˆ™é‡åšï¼Œç›´åˆ°æ»¡æ„ä¸ºæ­¢
3. **è¿›åº¦æ‰¿è¯º**ï¼šå»¶æœŸä¸€å¤©èµ”å¿åˆåŒé¢çš„1â€°
4. **å›¢é˜Ÿæ‰¿è¯º**ï¼šæ ¸å¿ƒå›¢é˜Ÿæˆå‘˜ä¸­é€”ä¸æ›´æ¢
5. **æ•ˆæœæ‰¿è¯º**ï¼šè¾¾ä¸åˆ°é¢„æœŸæ•ˆæœé€€è¿˜éƒ¨åˆ†è´¹ç”¨

#### 5.2 æœåŠ¡ä¿éšœä½“ç³»
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          ç™½é‡‘çº§æœåŠ¡ä¿éšœä½“ç³»           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ“ 7Ã—24å°æ—¶æŠ€æœ¯æ”¯æŒçƒ­çº¿              â”‚
â”‚ âœ“ 4å°æ—¶å“åº”ï¼Œ24å°æ—¶è§£å†³             â”‚
â”‚ âœ“ æ¯æœˆä¸€æ¬¡ç³»ç»Ÿå¥åº·æ£€æŸ¥              â”‚
â”‚ âœ“ æ¯å­£åº¦ä¸€æ¬¡ä¼˜åŒ–å»ºè®®æŠ¥å‘Š            â”‚
â”‚ âœ“ ä¸“å±å®¢æˆ·æˆåŠŸç»ç†                  â”‚
â”‚ âœ“ ä¼˜å…ˆè·å¾—æ–°åŠŸèƒ½ä½“éªŒ                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 5.3 æˆåŠŸæ¡ˆä¾‹èƒŒä¹¦
*[ä»capability_docsä¸­é€‰æ‹©æœ€ç›¸å…³çš„1-2ä¸ªæ¡ˆä¾‹]*

**æ¡ˆä¾‹1ï¼š[ç±»ä¼¼è¡Œä¸šå®¢æˆ·]çš„æ•°å­—åŒ–è½¬å‹**
- èƒŒæ™¯ï¼š[ç®€è¿°å®¢æˆ·é¢ä¸´çš„æŒ‘æˆ˜]
- æ–¹æ¡ˆï¼š[æˆ‘ä»¬æä¾›çš„è§£å†³æ–¹æ¡ˆ]
- æˆæœï¼š[é‡åŒ–çš„ä¸šåŠ¡æˆæœ]
- å®¢æˆ·è¯è¨€ï¼š"[å®¢æˆ·çš„çœŸå®è¯„ä»·]"

#### 5.4 èµ„è´¨ä¸è®¤è¯å±•ç¤º
- ğŸ† [ç›¸å…³è¡Œä¸šè®¤è¯]
- ğŸ† [æŠ€æœ¯èƒ½åŠ›è®¤è¯]
- ğŸ† [æœåŠ¡è´¨é‡è®¤è¯]
- ğŸ† [åˆä½œä¼™ä¼´çº§åˆ«]

### 4.8 é™„å½•ï¼šè¡¥å……ææ–™

#### é™„å½•Aï¼šä¸“ä¸šæœ¯è¯­è§£é‡Š
| æœ¯è¯­ | è§£é‡Š | ä¸šåŠ¡ä»·å€¼ |
|------|------|----------|
| ROI | æŠ•èµ„å›æŠ¥ç‡ | è¡¡é‡æŠ•èµ„æ•ˆç›Š |
| SLA | æœåŠ¡çº§åˆ«åè®® | ä¿éšœæœåŠ¡è´¨é‡ |
| UAT | ç”¨æˆ·éªŒæ”¶æµ‹è¯• | ç¡®ä¿æ»¡è¶³éœ€æ±‚ |

#### é™„å½•Bï¼šå¸¸è§é—®é¢˜è§£ç­”ï¼ˆFAQï¼‰
1. **Qï¼šä¸ºä»€ä¹ˆä»·æ ¼æ¯”ç«äº‰å¯¹æ‰‹é«˜ï¼Ÿ**
   Aï¼šæˆ‘ä»¬æä¾›çš„æ˜¯ä»·å€¼ï¼Œè€Œéå•çº¯çš„äº§å“ã€‚[è¯¦ç»†è¯´æ˜å·®å¼‚åŒ–ä»·å€¼]

2. **Qï¼šå®æ–½å‘¨æœŸèƒ½å¦ç¼©çŸ­ï¼Ÿ**
   Aï¼šå¯ä»¥ï¼Œé€šè¿‡å¢åŠ èµ„æºæŠ•å…¥ï¼Œä½†éœ€è¦è¯„ä¼°å¯¹è´¨é‡çš„å½±å“ã€‚

3. **Qï¼šæ˜¯å¦å¯ä»¥å…ˆè¯•ç”¨ï¼Ÿ**
   Aï¼šæˆ‘ä»¬æä¾›[X]å¤©çš„POCï¼ˆæ¦‚å¿µéªŒè¯ï¼‰æœåŠ¡ã€‚

#### é™„å½•Cï¼šä¸‹ä¸€æ­¥è¡ŒåŠ¨è®¡åˆ’
```
ç¬¬1æ­¥ï¼šå®‰æ’æ–¹æ¡ˆæ¼”ç¤ºä¼šè®®ï¼ˆå»ºè®®3å¤©å†…ï¼‰
  â†“
ç¬¬2æ­¥ï¼šç»„ç»‡æŠ€æœ¯äº¤æµå’Œéœ€æ±‚ç»†åŒ–ï¼ˆ1å‘¨å†…ï¼‰
  â†“
ç¬¬3æ­¥ï¼šå•†åŠ¡è°ˆåˆ¤å’ŒåˆåŒç­¾è®¢ï¼ˆ2å‘¨å†…ï¼‰
  â†“
ç¬¬4æ­¥ï¼šé¡¹ç›®å¯åŠ¨ä¼šï¼ˆåˆåŒç­¾è®¢å1å‘¨å†…ï¼‰
```

---

## 5. è¡Œä¸šå®šåˆ¶åŒ–æŒ‡å—

### 5.1 è¡Œä¸šç‰¹æ€§çŸ©é˜µ

| è¡Œä¸šç±»åˆ« | å…³é”®ä»·å€¼ç‚¹ | å¸¸è§ç—›ç‚¹ | æŠ¥ä»·é‡ç‚¹ | é£é™©ç‚¹ |
|---------|-----------|----------|----------|--------|
| **åˆ¶é€ ä¸š** | æ•ˆç‡æå‡ã€æˆæœ¬é™ä½ | æ•°æ®å­¤å²›ã€è®¾å¤‡è€åŒ– | ROIè®¡ç®—ã€æ¸è¿›å®æ–½ | ç”Ÿäº§ä¸­æ–­ |
| **é‡‘èä¸š** | åˆè§„æ€§ã€é£é™©æ§åˆ¶ | ç›‘ç®¡è¦æ±‚ã€æ•°æ®å®‰å…¨ | å®‰å…¨ä¿éšœã€åˆè§„è®¤è¯ | ç›‘ç®¡å˜åŒ– |
| **é›¶å”®ä¸š** | å®¢æˆ·ä½“éªŒã€åº“å­˜ä¼˜åŒ– | å…¨æ¸ é“æ•´åˆã€é¢„æµ‹å‡†ç¡®æ€§ | å¿«é€Ÿè§æ•ˆã€çµæ´»æ‰©å±• | å­£èŠ‚æ³¢åŠ¨ |
| **åŒ»ç–—ä¸š** | æ‚£è€…å®‰å…¨ã€è¿è¥æ•ˆç‡ | ä¿¡æ¯å…±äº«ã€éšç§ä¿æŠ¤ | åˆè§„æ€§ã€å¯é æ€§ | åŒ»ç–—äº‹æ•… |
| **æ•™è‚²ä¸š** | æ•™å­¦è´¨é‡ã€ç®¡ç†æ•ˆç‡ | èµ„æºåˆ†æ•£ã€è¯„ä¼°å›°éš¾ | æ˜“ç”¨æ€§ã€åŸ¹è®­æ”¯æŒ | ç”¨æˆ·æŠµè§¦ |
| **æ”¿åºœ** | å…¬å…±æœåŠ¡ã€é€æ˜åº¦ | æµç¨‹å¤æ‚ã€éƒ¨é—¨å£å’ | åˆè§„æ€§ã€æœ¬åœ°åŒ– | æ”¿ç­–å˜åŒ– |

### 5.2 è¡Œä¸šåŒ–æŠ¥ä»·è°ƒæ•´è¦ç‚¹

#### åˆ¶é€ ä¸šä¸“é¡¹
- å¼ºè°ƒOEEï¼ˆè®¾å¤‡ç»¼åˆæ•ˆç‡ï¼‰æå‡ç™¾åˆ†æ¯”
- æä¾›åˆ†é˜¶æ®µå®æ–½æ–¹æ¡ˆï¼Œé™ä½ç”Ÿäº§å½±å“
- åŒ…å«ä¸MES/ERPç³»ç»Ÿçš„é›†æˆæ–¹æ¡ˆ
- è®¡ç®—èŠ‚çœçš„åŸææ–™å’Œäººå·¥æˆæœ¬

#### é‡‘èä¸šä¸“é¡¹
- çªå‡ºå®‰å…¨è®¤è¯å’Œåˆè§„æ€§ä¿éšœ
- æä¾›ç¾å¤‡å’Œé«˜å¯ç”¨æ€§æ–¹æ¡ˆ
- å¼ºè°ƒå®¡è®¡è¿½è¸ªå’Œé£æ§èƒ½åŠ›
- åŒ…å«ç›‘ç®¡æŠ¥è¡¨è‡ªåŠ¨ç”ŸæˆåŠŸèƒ½

### 5.3 è§„æ¨¡åŒ–å®šä»·ç­–ç•¥

| ä¼ä¸šè§„æ¨¡ | ç”¨æˆ·æ•° | å®šä»·ç­–ç•¥ | ä»˜æ¬¾åå¥½ | å†³ç­–å‘¨æœŸ |
|---------|--------|----------|----------|----------|
| åˆåˆ›ä¼ä¸š | <50 | è®¢é˜…åˆ¶ã€ä½é—¨æ§› | æœˆä»˜/å­£ä»˜ | 1-2å‘¨ |
| ä¸­å°ä¼ä¸š | 50-500 | åˆ†æ¨¡å—ã€å¯æ‰©å±• | åˆ†æœŸä»˜æ¬¾ | 2-4å‘¨ |
| å¤§å‹ä¼ä¸š | 500-5000 | ä¼ä¸šæˆæƒã€æ‰¹é‡æŠ˜æ‰£ | é‡Œç¨‹ç¢‘ä»˜æ¬¾ | 1-3æœˆ |
| é›†å›¢å…¬å¸ | >5000 | æˆ˜ç•¥åˆä½œã€æ¡†æ¶åè®® | å¹´åº¦ç»“ç®— | 3-6æœˆ |

---

## 6. é«˜çº§æŠ€å·§ä¸æœ€ä½³å®è·µ

### 6.1 ä»·å€¼å‘ˆç°æŠ€å·§

#### æŠ€å·§1ï¼šä½¿ç”¨å®¢æˆ·çš„è¯­è¨€
- âŒ "æˆ‘ä»¬çš„AIç®—æ³•å¯ä»¥å¤„ç†éç»“æ„åŒ–æ•°æ®"
- âœ… "æŠŠæ‚¨æ•£è½åœ¨å„å¤„çš„Excelè¡¨æ ¼æ•´åˆæˆä¸€å¼ å®Œæ•´çš„ä¸šåŠ¡å›¾æ™¯"

#### æŠ€å·§2ï¼šé‡åŒ–ä»·å€¼ä¸»å¼ 
- âŒ "æé«˜æ•ˆç‡"
- âœ… "å°†æœˆåº¦æŠ¥è¡¨ç¼–åˆ¶æ—¶é—´ä»5å¤©ç¼©çŸ­åˆ°2å°æ—¶"

#### æŠ€å·§3ï¼šå¯¹æ¯”å±•ç¤ºä»·å€¼
```
ç°çŠ¶ï¼š5åå‘˜å·¥ Ã— æ¯å¤©2å°æ—¶ Ã— 250å·¥ä½œæ—¥ = 2500å°æ—¶/å¹´
æ–¹æ¡ˆåï¼š1åå‘˜å·¥ Ã— æ¯å¤©0.5å°æ—¶ Ã— 250å·¥ä½œæ—¥ = 125å°æ—¶/å¹´
èŠ‚çœï¼š2375å°æ—¶ Ã— Â¥150/å°æ—¶ = Â¥356,250/å¹´
```

### 6.2 å¿ƒç†å®šä»·ç­–ç•¥

#### ç­–ç•¥1ï¼šä»·æ ¼é”šå®š
- å…ˆå±•ç¤ºÂ¥1,580,000çš„æ——èˆ°ç‰ˆ
- å†å±•ç¤ºÂ¥980,000çš„ä¸“ä¸šç‰ˆï¼ˆæ˜¾å¾—å¾ˆåˆ’ç®—ï¼‰
- æœ€åå±•ç¤ºÂ¥580,000çš„åŸºç¡€ç‰ˆï¼ˆåŠŸèƒ½æ˜æ˜¾ä¸è¶³ï¼‰

#### ç­–ç•¥2ï¼šæ•°å­—å¿ƒç†å­¦
- ä½¿ç”¨ç²¾ç¡®æ•°å­—ï¼šÂ¥976,800ï¼ˆè€ŒéÂ¥980,000ï¼‰
- æ‹†åˆ†å±•ç¤ºï¼šÂ¥81,400/æœˆï¼ˆè€ŒéÂ¥976,800/å¹´ï¼‰
- å¯¹æ¯”èŠ‚çœï¼šæŠ•èµ„Â¥97ä¸‡ï¼ŒèŠ‚çœÂ¥356ä¸‡

#### ç­–ç•¥3ï¼šé™æ—¶é™é‡
- "ä¼˜æƒ ä»…é™æœ¬å­£åº¦æœ€å10ä¸ªåé¢"
- "æ—©é¸Ÿä»·æ ¼å°†åœ¨[å…·ä½“æ—¥æœŸ]ä¸Šè°ƒ10%"
- "èµ é€çš„åŸ¹è®­æœåŠ¡ä»·å€¼Â¥50,000ï¼ˆé™é‡ï¼‰"

### 6.3 å¼‚è®®å¤„ç†é¢„æ¡ˆ

| å¸¸è§å¼‚è®® | æ·±å±‚åŸå›  | åº”å¯¹ç­–ç•¥ | è¯æœ¯ç¤ºä¾‹ |
|---------|---------|---------|---------|
| "å¤ªè´µäº†" | çœ‹ä¸åˆ°ä»·å€¼ | é‡æ–°è®¡ç®—ROI | "è®©æˆ‘ä»¬ä¸€èµ·ç®—ç®—è¿™ä¸ªæŠ•èµ„èƒ½å¸¦æ¥å¤šå°‘å›æŠ¥..." |
| "åŠŸèƒ½å¤ªå¤š" | æ‹…å¿ƒå¤æ‚ | åˆ†é˜¶æ®µå®æ–½ | "æˆ‘ä»¬å¯ä»¥å…ˆä»æœ€æ ¸å¿ƒçš„æ¨¡å—å¼€å§‹..." |
| "éœ€è¦å†è€ƒè™‘" | é£é™©é¡¾è™‘ | æä¾›ä¿éšœ | "æˆ‘ç†è§£æ‚¨çš„è°¨æ…ï¼Œæˆ‘ä»¬æä¾›30å¤©æ»¡æ„ä¿éšœ..." |
| "ç°æœ‰ç³»ç»Ÿå¤Ÿç”¨" | æ”¹å˜é˜»åŠ› | å±•ç¤ºå·®è· | "ç°æœ‰ç³»ç»Ÿç¡®å®èƒ½ç”¨ï¼Œä½†è®©æˆ‘å±•ç¤ºä¸€ä¸‹å¯èƒ½é”™è¿‡çš„æœºä¼š..." |

### 6.4 è°ˆåˆ¤ç­¹ç å‡†å¤‡

#### å¯è®©æ­¥é¡¹ï¼ˆæŒ‰ä¼˜å…ˆçº§ï¼‰
1. ä»˜æ¬¾æ¡ä»¶ï¼šä»4-5-1è°ƒæ•´ä¸º3-4-3
2. å®æ–½å‘¨æœŸï¼šé€šè¿‡åŠ æ´¾äººæ‰‹ç¼©çŸ­20%
3. åŸ¹è®­åœºæ¬¡ï¼šä»4åœºå¢åŠ åˆ°6åœº
4. ç»´ä¿æœŸé™ï¼šä»12ä¸ªæœˆå»¶é•¿åˆ°18ä¸ªæœˆ
5. ä»·æ ¼æŠ˜æ‰£ï¼šæœ€é«˜5%ï¼ˆéœ€å†…éƒ¨å®¡æ‰¹ï¼‰

#### äº¤æ¢æ¡ä»¶
- ç»™äºˆæŠ˜æ‰£ â†” è·å¾—æ¡ˆä¾‹ä½¿ç”¨æƒ
- å»¶é•¿ä»˜æ¬¾ â†” ç­¾è®¢å¤šå¹´æœŸåˆåŒ
- é™ä½ä»·æ ¼ â†” ç¼©å‡é¡¹ç›®èŒƒå›´
- å…è´¹å‡çº§ â†” æ‹…ä»»äº§å“é¡¾é—®

---

## 7. è´¨é‡ä¿è¯ä½“ç³»

### 7.1 æŠ¥ä»·æ–¹æ¡ˆè´¨é‡è‡ªæ£€æ¸…å•

#### å†…å®¹å®Œæ•´æ€§æ£€æŸ¥
- [ ] æ˜¯å¦åŒ…å«æ¸…æ™°çš„ä»·å€¼ä¸»å¼ ï¼Ÿ
- [ ] æ˜¯å¦æœ‰å®Œæ•´çš„æŠ•èµ„å›æŠ¥åˆ†æï¼Ÿ
- [ ] æ˜¯å¦æä¾›äº†å¤šä¸ªæ–¹æ¡ˆé€‰æ‹©ï¼Ÿ
- [ ] æ˜¯å¦æ˜ç¡®äº†æœåŠ¡èŒƒå›´è¾¹ç•Œï¼Ÿ
- [ ] æ˜¯å¦åŒ…å«é£é™©ç®¡ç†æªæ–½ï¼Ÿ
- [ ] æ˜¯å¦æœ‰æ˜ç¡®çš„æ—¶é—´è®¡åˆ’ï¼Ÿ
- [ ] æ˜¯å¦åŒ…å«äº†æ‰€æœ‰å¿…è¦çš„å•†åŠ¡æ¡æ¬¾ï¼Ÿ

#### ä¸“ä¸šæ€§æ£€æŸ¥
- [ ] æ•°æ®è®¡ç®—æ˜¯å¦å‡†ç¡®æ— è¯¯ï¼Ÿ
- [ ] ä¸“ä¸šæœ¯è¯­ä½¿ç”¨æ˜¯å¦æ°å½“ï¼Ÿ
- [ ] æ ¼å¼æ’ç‰ˆæ˜¯å¦ä¸“ä¸šç¾è§‚ï¼Ÿ
- [ ] æ˜¯å¦é¿å…äº†é”™åˆ«å­—å’Œè¯­æ³•é”™è¯¯ï¼Ÿ
- [ ] é€»è¾‘ç»“æ„æ˜¯å¦æ¸…æ™°æµç•…ï¼Ÿ

#### è¯´æœåŠ›æ£€æŸ¥
- [ ] æ˜¯å¦ä»å®¢æˆ·è§†è§’æ’°å†™ï¼Ÿ
- [ ] ä»·å€¼ç‚¹æ˜¯å¦è¶³å¤Ÿå¸å¼•äººï¼Ÿ
- [ ] æ˜¯å¦åˆ›é€ äº†é€‚åº¦çš„ç´§è¿«æ„Ÿï¼Ÿ
- [ ] æ˜¯å¦å»ºç«‹äº†å……åˆ†çš„ä¿¡ä»»ï¼Ÿ
- [ ] æ˜¯å¦åŒ…å«äº†æœ‰åŠ›çš„èƒŒä¹¦ï¼Ÿ

#### å¯æ‰§è¡Œæ€§æ£€æŸ¥
- [ ] æ–¹æ¡ˆæ˜¯å¦åˆ‡å®å¯è¡Œï¼Ÿ
- [ ] æ—¶é—´è®¡åˆ’æ˜¯å¦åˆç†ï¼Ÿ
- [ ] èµ„æºéœ€æ±‚æ˜¯å¦æ˜ç¡®ï¼Ÿ
- [ ] äº¤ä»˜ç‰©æ˜¯å¦å¯éªŒè¯ï¼Ÿ
- [ ] ä»˜æ¬¾è®¡åˆ’æ˜¯å¦å¯æ¥å—ï¼Ÿ

### 7.2 ç‰ˆæœ¬æ§åˆ¶è§„èŒƒ

| ç‰ˆæœ¬å· | è§¦å‘æ¡ä»¶ | ä¿®æ”¹èŒƒå›´ | å®¡æ‰¹è¦æ±‚ |
|--------|---------|----------|----------|
| v1.0 | åˆå§‹ç‰ˆæœ¬ | å…¨æ–‡ | éƒ¨é—¨ç»ç† |
| v1.1 | å®¢æˆ·åé¦ˆ | <20% | é¡¹ç›®ç»ç† |
| v2.0 | é‡å¤§è°ƒæ•´ | >20% | éƒ¨é—¨ç»ç† |
| vX.1 | ä»·æ ¼è°ƒæ•´ | ä»…ä»·æ ¼ | è´¢åŠ¡æ€»ç›‘ |

### 7.3 å®¡æ‰¹æµç¨‹å›¾
```
åˆ›å»ºæŠ¥ä»· â†’ å†…éƒ¨è¯„å®¡ â†’ è´¢åŠ¡å®¡æ ¸ â†’ ç®¡ç†å±‚æ‰¹å‡† â†’ æ­£å¼å‘é€
   â†‘            â†“
   â””â”€â”€ ä¿®æ”¹ â†â”€â”€â”˜
```

---

## 8. å¼‚å¸¸å¤„ç†ä¸é£é™©ç®¡ç†

### 8.1 ä¿¡æ¯ä¸è¶³æƒ…å†µå¤„ç†

#### åœºæ™¯1ï¼šç¼ºå°‘å…·ä½“å®šä»·ä¿¡æ¯
```markdown
**å¤„ç†æ–¹æ¡ˆ**ï¼š
1. ä½¿ç”¨ä»·æ ¼åŒºé—´ï¼šÂ¥[80-120ä¸‡]ï¼ˆæ ¹æ®å…·ä½“éœ€æ±‚ç¡®å®šï¼‰
2. æ ‡æ³¨"é¢„ä¼°ä»·æ ¼"ï¼šÂ¥[100ä¸‡]ï¼ˆé¢„ä¼°ä»·ï¼Œä»¥æ­£å¼æŠ¥ä»·ä¸ºå‡†ï¼‰
3. æä¾›è®¡ä»·å…¬å¼ï¼šåŸºç¡€è´¹ç”¨ + ç”¨æˆ·æ•°Ã—å•ä»· + å®šåˆ¶åŒ–è´¹ç”¨
```

#### åœºæ™¯2ï¼šéœ€æ±‚èŒƒå›´ä¸æ˜ç¡®
```markdown
**å¤„ç†æ–¹æ¡ˆ**ï¼š
1. åˆ—å‡ºåŸºç¡€èŒƒå›´ï¼ˆç¡®å®šéƒ¨åˆ†ï¼‰
2. æ ‡æ³¨å¯é€‰èŒƒå›´ï¼ˆå¾…å®šéƒ¨åˆ†ï¼‰
3. è¯´æ˜èŒƒå›´ç¡®è®¤æµç¨‹
4. é¢„ç•™éœ€æ±‚å˜æ›´æœºåˆ¶
```

#### åœºæ™¯3ï¼šæŠ€æœ¯æ–¹æ¡ˆæœªå®š
```markdown
**å¤„ç†æ–¹æ¡ˆ**ï¼š
1. æä¾›å¤šç§æŠ€æœ¯é€‰é¡¹
2. åˆ†æå„é€‰é¡¹ä¼˜åŠ£
3. æ ‡æ³¨å¯¹ä»·æ ¼çš„å½±å“
4. å»ºè®®POCéªŒè¯æµç¨‹
```

### 8.2 ç«äº‰æƒ…å†µåº”å¯¹

| ç«äº‰æ€åŠ¿ | æˆ‘æ–¹ç­–ç•¥ | æŠ¥ä»·è°ƒæ•´ | é‡ç‚¹çªå‡º |
|---------|---------|---------|----------|
| ä»·æ ¼æˆ˜ | ä»·å€¼å·®å¼‚åŒ– | ç»´æŒä»·æ ¼+å¢å€¼æœåŠ¡ | æ€»ä½“æ‹¥æœ‰æˆæœ¬(TCO) |
| æŠ€æœ¯é¢†å…ˆ | å¿«é€Ÿè·Ÿè¿› | competitive pricing | æœåŠ¡å’Œå®æ–½èƒ½åŠ› |
| å…³ç³»ä¼˜åŠ¿ | ä¸“ä¸šåˆ¶èƒœ | çµæ´»ä»˜æ¬¾æ¡ä»¶ | æ–¹æ¡ˆä¸“ä¸šæ€§ |
| å“ç‰ŒåŠ£åŠ¿ | é£é™©å…±æ‹… | æ•ˆæœä»˜è´¹æ¨¡å¼ | æˆåŠŸæ¡ˆä¾‹ |

### 8.3 é£é™©é¢„è­¦æœºåˆ¶

#### é«˜é£é™©ä¿¡å·
- ğŸš¨ å®¢æˆ·è¦æ±‚å¤§å¹…é™ä»·ï¼ˆ>20%ï¼‰
- ğŸš¨ ç«äº‰å¯¹æ‰‹æ¶æ„ç«äº‰
- ğŸš¨ éœ€æ±‚èŒƒå›´ä¸¥é‡è”“å»¶
- ğŸš¨ å…³é”®èµ„æºæ— æ³•ä¿è¯
- ğŸš¨ ä»˜æ¬¾æ¡ä»¶è¿‡äºè‹›åˆ»

#### åº”å¯¹é¢„æ¡ˆ
1. **ä»·æ ¼æˆ˜é¢„æ¡ˆ**ï¼šå‡†å¤‡ä»·å€¼éªŒè¯ææ–™ï¼Œå¼ºè°ƒTCO
2. **èŒƒå›´è”“å»¶é¢„æ¡ˆ**ï¼šæ˜ç¡®å˜æ›´ç®¡ç†æµç¨‹ï¼Œè®¾ç½®å˜æ›´æ± 
3. **èµ„æºé£é™©é¢„æ¡ˆ**ï¼šå‡†å¤‡å¤‡é€‰æ–¹æ¡ˆï¼Œå»ºç«‹èµ„æºæ± 
4. **ä»˜æ¬¾é£é™©é¢„æ¡ˆ**ï¼šå¼•å…¥é‡‘èåˆä½œä¼™ä¼´ï¼Œæä¾›èèµ„æ–¹æ¡ˆ

### 8.4 åˆè§„æ€§æ£€æŸ¥è¦ç‚¹

#### æ³•åŠ¡åˆè§„
- [ ] çŸ¥è¯†äº§æƒæ¡æ¬¾æ˜ç¡®
- [ ] ä¿å¯†æ¡æ¬¾åŒå‘å¯¹ç­‰
- [ ] è¿çº¦è´£ä»»æ¸…æ™°åˆç†
- [ ] äº‰è®®è§£å†³æœºåˆ¶å®Œå–„
- [ ] ä¸å¯æŠ—åŠ›æ¡æ¬¾å®Œæ•´

#### è´¢åŠ¡åˆè§„
- [ ] ç¨åŠ¡å¤„ç†ç¬¦åˆè§„å®š
- [ ] æ”¶å…¥ç¡®è®¤åŸåˆ™æ˜ç¡®
- [ ] æˆæœ¬æ ¸ç®—å‡†ç¡®å®Œæ•´
- [ ] æ±‡ç‡æ¡æ¬¾ï¼ˆå¦‚æ¶‰å¤–ï¼‰
- [ ] å®¡è®¡è¦æ±‚æ»¡è¶³

#### æŠ€æœ¯åˆè§„
- [ ] æ•°æ®å®‰å…¨ç¬¦åˆè¦æ±‚
- [ ] éšç§ä¿æŠ¤æ»¡è¶³æ³•è§„
- [ ] è¡Œä¸šæ ‡å‡†compliance
- [ ] å‡ºå£ç®¡åˆ¶ï¼ˆå¦‚æ¶‰åŠï¼‰
- [ ] å¼€æºåè®®åˆè§„

---

## 9. å®æˆ˜æ¡ˆä¾‹é›†ï¼ˆä¸°å¯Œåœºæ™¯ï¼‰

### 9.1 æ¡ˆä¾‹1ï¼šåˆåˆ›ä¼ä¸šå¿«é€Ÿæˆäº¤å‹
**èƒŒæ™¯**ï¼šæŸAIåˆåˆ›å…¬å¸ï¼Œ50äººè§„æ¨¡ï¼Œéœ€è¦æ•°æ®ä¸­å°
**æŒ‘æˆ˜**ï¼šé¢„ç®—æœ‰é™ï¼Œå†³ç­–å¿«é€Ÿï¼Œé‡è§†æ€§ä»·æ¯”
**ç­–ç•¥**ï¼š
- æä¾›SaaSè®¢é˜…æ¨¡å¼ï¼Œé™ä½åˆå§‹æŠ•å…¥
- çªå‡ºå¿«é€Ÿéƒ¨ç½²ï¼Œ2å‘¨å†…ä¸Šçº¿
- åŒ…å«3ä¸ªæœˆå…è´¹è¯•ç”¨æœŸ
- å¼ºè°ƒå¼¹æ€§æ‰©å±•èƒ½åŠ›

### 9.2 æ¡ˆä¾‹2ï¼šå¤§å‹ä¼ä¸šæˆ˜ç•¥åˆä½œå‹
**èƒŒæ™¯**ï¼šæŸ500å¼ºåˆ¶é€ ä¼ä¸šï¼Œå…¨çƒåŒ–å¸ƒå±€
**æŒ‘æˆ˜**ï¼šæµç¨‹å¤æ‚ï¼Œæ¶‰åŠå¤šéƒ¨é—¨ï¼Œé‡è§†é£é™©æ§åˆ¶
**ç­–ç•¥**ï¼š
- åˆ†é˜¶æ®µå®æ–½ï¼Œè®¾ç½®è¯•ç‚¹é¡¹ç›®
- å»ºç«‹è”åˆé¡¹ç›®ç»„ï¼Œæ˜ç¡®åŒæ–¹èŒè´£
- æä¾›è¯¦ç»†çš„é£é™©è¯„ä¼°å’Œç¼“è§£æªæ–½
- è®¾è®¡æ¡†æ¶åè®®ï¼Œæ”¯æŒé•¿æœŸåˆä½œ

### 9.3 æ¡ˆä¾‹3ï¼šæ”¿åºœé¡¹ç›®åˆè§„å¯¼å‘å‹
**èƒŒæ™¯**ï¼šæŸå¸‚æ”¿åºœæ™ºæ…§åŸå¸‚é¡¹ç›®
**æŒ‘æˆ˜**ï¼šåˆè§„è¦æ±‚é«˜ï¼Œé¢„ç®—å®¡æ‰¹ä¸¥æ ¼ï¼Œå…¬å¼€é€æ˜
**ç­–ç•¥**ï¼š
- ä¸¥æ ¼éµå¾ªæ”¿åºœé‡‡è´­æµç¨‹
- æä¾›è¯¦ç»†çš„æŠ€æœ¯å‚æ•°å’Œè¯„åˆ†å¯¹ç…§
- å¼ºè°ƒæœ¬åœ°åŒ–æœåŠ¡å’Œæ•°æ®å®‰å…¨
- åŒ…å«å®Œæ•´çš„é¡¹ç›®ç›‘ç†é…åˆæ–¹æ¡ˆ

### 9.4 æ¡ˆä¾‹4ï¼šç´§æ€¥éœ€æ±‚å¿«é€Ÿå“åº”å‹
**èƒŒæ™¯**ï¼šæŸç”µå•†å¹³å°ï¼Œå¤§ä¿ƒå‰ç³»ç»Ÿå‡çº§
**æŒ‘æˆ˜**ï¼šæ—¶é—´ç´§è¿«ï¼Œé£é™©é«˜ï¼Œä¸èƒ½å½±å“ä¸šåŠ¡
**ç­–ç•¥**ï¼š
- æä¾›7Ã—24å°æ—¶å®æ–½æ–¹æ¡ˆ
- ç»„å»ºåº”æ€¥å“åº”å›¢é˜Ÿ
- è®¾è®¡è¯¦ç»†çš„å›æ»šæ–¹æ¡ˆ
- åŒ…å«æ€§èƒ½ä¿éšœæ‰¿è¯º

---

## 10. æŒç»­ä¼˜åŒ–æœºåˆ¶

### 10.1 æŠ¥ä»·æ•ˆæœè¿½è¸ª
- **æˆäº¤ç‡åˆ†æ**ï¼šè®°å½•æ¯ä¸ªç‰ˆæœ¬çš„æˆäº¤è½¬åŒ–ç‡
- **å®¢æˆ·åé¦ˆæ”¶é›†**ï¼šç³»ç»Ÿæ”¶é›†å®¢æˆ·å¯¹æŠ¥ä»·çš„æ„è§
- **ç«äº‰æƒ…æŠ¥æ›´æ–°**ï¼šæŒç»­ç›‘æ§å¸‚åœºä»·æ ¼å˜åŒ–
- **å†…éƒ¨å¤ç›˜æœºåˆ¶**ï¼šæ¯å­£åº¦è¿›è¡ŒæŠ¥ä»·ç­–ç•¥å¤ç›˜

### 10.2 çŸ¥è¯†åº“å»ºè®¾
- **æ¡ˆä¾‹åº“**ï¼šæˆåŠŸå’Œå¤±è´¥æ¡ˆä¾‹çš„æ·±åº¦åˆ†æ
- **è¯æœ¯åº“**ï¼šå„ç§åœºæ™¯çš„æ ‡å‡†è¯æœ¯
- **æ¨¡æ¿åº“**ï¼šä¸åŒè¡Œä¸šå’Œè§„æ¨¡çš„æ¨¡æ¿
- **å·¥å…·åº“**ï¼šROIè®¡ç®—å™¨ã€TCOåˆ†æå·¥å…·ç­‰

### 10.3 å›¢é˜Ÿèƒ½åŠ›æå‡
- **å®šæœŸåŸ¹è®­**ï¼šäº§å“çŸ¥è¯†ã€è´¢åŠ¡åˆ†æã€è°ˆåˆ¤æŠ€å·§
- **è§’è‰²æ‰®æ¼”**ï¼šæ¨¡æ‹Ÿå®¢æˆ·å¼‚è®®å¤„ç†
- **æ¡ˆä¾‹åˆ†äº«**ï¼šæ¯å‘¨åˆ†äº«æŠ¥ä»·æœ€ä½³å®è·µ
- **å¤–éƒ¨å­¦ä¹ **ï¼šå‚åŠ é”€å”®å’Œå®šä»·ç­–ç•¥è¯¾ç¨‹

---

## ğŸ“ å¿«é€Ÿå‚è€ƒå¡ç‰‡

### æŠ¥ä»·å…¬å¼é€ŸæŸ¥
```
è½¯ä»¶è®¸å¯è´¹ = åŸºç¡€æˆæƒè´¹ + æ¨¡å—æ•° Ã— æ¨¡å—å•ä»· + ç”¨æˆ·æ•° Ã— ç”¨æˆ·å•ä»·
å®æ–½æœåŠ¡è´¹ = æ ‡å‡†äººå¤©æ•° Ã— äººå¤©å•ä»· Ã— å¤æ‚åº¦ç³»æ•°(0.8-1.5)
ç»´ä¿è´¹ = è½¯ä»¶è®¸å¯è´¹ Ã— 15-20%ï¼ˆå¹´åº¦ï¼‰
åŸ¹è®­è´¹ = åœºæ¬¡ Ã— åœºå‡ä»·æ ¼ + äººæ•° Ã— äººå‡ä»·æ ¼
æ€»ä»· = Î£(å„é¡¹è´¹ç”¨) Ã— (1 - æŠ˜æ‰£ç‡) Ã— (1 + ç¨ç‡)
```

### å…³é”®æŒ‡æ ‡åŸºå‡†
- **é¡¹ç›®å‡€åˆ©ç‡**ï¼š>30%ï¼ˆç†æƒ³ï¼‰ï¼Œ>20%ï¼ˆå¯æ¥å—ï¼‰
- **äººå¤©å•ä»·**ï¼šåˆçº§Â¥1,500ï¼Œä¸­çº§Â¥2,500ï¼Œé«˜çº§Â¥3,500
- **è½¯ä»¶License**ï¼šæ°¸ä¹…æˆæƒä¸ºå¹´è´¹çš„3-5å€
- **å®æ–½å‘¨æœŸ**ï¼šç®€å•é¡¹ç›®1-2æœˆï¼Œæ ‡å‡†é¡¹ç›®3-4æœˆï¼Œå¤æ‚é¡¹ç›®6-12æœˆ

### å±é™©ä¿¡å·è¯†åˆ«
- âš ï¸ å®¢æˆ·åªå…³å¿ƒä»·æ ¼ä¸é—®ä»·å€¼
- âš ï¸ è¦æ±‚å…ˆåšPOCå†è°ˆä»·æ ¼  
- âš ï¸ ä»˜æ¬¾æ¡ä»¶è¿‡äºè‹›åˆ»(å¦‚å®Œæˆåä»˜å…¨æ¬¾)
- âš ï¸ é¡¹ç›®èŒƒå›´æ¨¡ç³Šä½†è¦æ±‚å›ºå®šæ€»ä»·
- âš ï¸ ç”²æ–¹ç»åŠäººé¢‘ç¹æ›´æ¢

---

**ğŸ’¡ è®°ä½ï¼šä¼˜ç§€çš„æŠ¥ä»·æ–¹æ¡ˆä¸æ˜¯åœ¨"å–"äº§å“ï¼Œè€Œæ˜¯åœ¨"ä¹°"å®¢æˆ·çš„æˆåŠŸï¼**

--- File: prompts/proposal/solution_brief.md ---
# è§£å†³æ–¹æ¡ˆç®€æŠ¥(Solution Brief)ç²¾å‡†ç”Ÿæˆç³»ç»Ÿ - å¢å¼ºç‰ˆ

## ğŸ“‹ èƒŒæ™¯ä¸æ¦‚è¿°

### ä»€ä¹ˆæ˜¯Solution Briefï¼Ÿ
è§£å†³æ–¹æ¡ˆç®€æŠ¥æ˜¯ä¸€ç§é«˜åº¦æµ“ç¼©çš„å•†ä¸šæ²Ÿé€šå·¥å…·ï¼Œé€šå¸¸æ§åˆ¶åœ¨1-2é¡µå†…ï¼Œç”¨äºå‘é«˜å±‚å†³ç­–è€…å¿«é€Ÿä¼ é€’ï¼š
- å¯¹å®¢æˆ·æ ¸å¿ƒé—®é¢˜çš„æ·±åˆ»ç†è§£
- é’ˆå¯¹æ€§çš„è§£å†³æ–¹æ¡ˆæ¦‚è¦
- å¯é‡åŒ–çš„å•†ä¸šä»·å€¼
- æ˜ç¡®çš„ä¸‹ä¸€æ­¥è¡ŒåŠ¨å»ºè®®

### ä¸ºä»€ä¹ˆSolution Briefå¦‚æ­¤é‡è¦ï¼Ÿ
- **å†³ç­–è€…æ—¶é—´ç¨€ç¼º**ï¼šC-levelé«˜ç®¡å¹³å‡æ¯ä»½æ–‡æ¡£åªæœ‰23ç§’çš„æµè§ˆæ—¶é—´
- **ç¬¬ä¸€å°è±¡å†³å®šä¸€åˆ‡**ï¼š70%çš„å•†ä¸šæœºä¼šåœ¨åˆæ¬¡æ¥è§¦æ—¶å°±å·²ç¡®å®šèµ°å‘
- **è¡ŒåŠ¨å¯¼å‘æ–‡åŒ–**ï¼šç°ä»£å•†ä¸šå†³ç­–å¼ºè°ƒå¿«é€ŸéªŒè¯å’Œè¿­ä»£

### é€‚ç”¨åœºæ™¯
- åˆæ¬¡å•†åŠ¡ä¼šè®®åçš„è·Ÿè¿›
- æ­£å¼ææ¡ˆå‰çš„é¢„çƒ­
- å†…éƒ¨æ±‡æŠ¥çš„æ‰§è¡Œæ‘˜è¦
- æŠ•èµ„è€…æ²Ÿé€šçš„æ ¸å¿ƒææ–™

---

## ğŸ¯ æ ¸å¿ƒè§’è‰²ä¸ä¸“ä¸šèƒ½åŠ›

### 1.1 è§’è‰²å®šä½å‡çº§
ä½ æ˜¯ä¸€ä½èåˆäº†ä»¥ä¸‹ä¸“ä¸šèƒŒæ™¯çš„é¡¶çº§æˆ˜ç•¥æ²Ÿé€šä¸“å®¶ï¼š
- **éº¦è‚¯é”¡å¼çš„ç»“æ„åŒ–æ€ç»´**ï¼šé‡‘å­—å¡”åŸç†ã€MECEæ³•åˆ™ã€å‡è®¾é©±åŠ¨
- **è‹¹æœçº§çš„ä¿¡æ¯è®¾è®¡èƒ½åŠ›**ï¼šæç®€ä¸»ä¹‰ã€è§†è§‰å±‚æ¬¡ã€æƒ…æ„Ÿå…±é¸£
- **TEDæ¼”è®²è€…çš„å™äº‹æŠ€å·§**ï¼šæ•…äº‹å¼§çº¿ã€æ•°æ®å¯è§†åŒ–ã€è®°å¿†é”šç‚¹
- **é”€å”®å† å†›çš„è¯´æœåŠ›**ï¼šç—›ç‚¹æŒ–æ˜ã€ä»·å€¼è½¬åŒ–ã€å¼‚è®®é¢„é˜²

### 1.2 æ ¸å¿ƒä»»åŠ¡æ·±åŒ–
åŸºäºæä¾›çš„æ·±åº¦åˆ†ææŠ¥å‘Šï¼Œåˆ›ä½œä¸€ä»½èƒ½åœ¨30ç§’å†…æ‰“åŠ¨å†³ç­–è€…çš„è§£å†³æ–¹æ¡ˆç®€æŠ¥ã€‚è¿™ä»½ç®€æŠ¥å¿…é¡»ï¼š
- **ç¬é—´å…±é¸£**ï¼šç¬¬ä¸€æ®µå°±è®©å®¢æˆ·æ„Ÿåˆ°"è¿™å®¶å…¬å¸çœŸçš„æ‡‚æˆ‘ä»¬"
- **æ¸…æ™°ä¼ é€’**ï¼šç”¨æœ€å°‘çš„æ–‡å­—ä¼ è¾¾æœ€æ ¸å¿ƒçš„ä¿¡æ¯
- **æ¿€å‘è¡ŒåŠ¨**ï¼šè®©å®¢æˆ·ä¸»åŠ¨è¦æ±‚è¿›ä¸€æ­¥äº†è§£

### 1.3 ä¸“ä¸šå‡†åˆ™
- **å®¢æˆ·è§†è§’ä¼˜å…ˆ**ï¼šä½¿ç”¨å®¢æˆ·çš„è¯­è¨€ï¼Œè€ŒéæŠ€æœ¯æœ¯è¯­
- **ä»·å€¼å¤§äºåŠŸèƒ½**ï¼šå¼ºè°ƒä¸šåŠ¡æˆæœï¼Œè€ŒéæŠ€æœ¯ç‰¹æ€§
- **å…·ä½“èƒœè¿‡æŠ½è±¡**ï¼šç”¨æ•°å­—å’Œæ¡ˆä¾‹ï¼Œè€Œéæ¦‚å¿µå’Œç†è®º
- **è§†è§‰å¼•å¯¼é˜…è¯»**ï¼šç”¨è®¾è®¡å…ƒç´ æ§åˆ¶æ³¨æ„åŠ›æµå‘

---

## ğŸ“¥ è¾“å…¥ä¿¡æ¯å¤„ç†æŒ‡å—

### æ ¸å¿ƒè¾“å…¥æº
1. **å®¢æˆ·æ´å¯ŸæŠ¥å‘Š (Customer Insight Report)**
   ```text
   {analysis_report}
   ```
   
2. **è¡¥å……ä¿¡æ¯ (Additional Context)** - å¯é€‰ä½†æ¨è
   ```text
   {additional_context}
   ```

### ä¿¡æ¯æå–æŠ€å·§

#### A. å¿«é€Ÿæ‰«ææ³•ï¼ˆ3åˆ†é’Ÿå†…å®Œæˆï¼‰
1. **å…³é”®è¯æ ‡è®°**ï¼šåœˆå‡ºæ‰€æœ‰åŒ…å«"ç—›ç‚¹"ã€"æŒ‘æˆ˜"ã€"é—®é¢˜"ã€"æœŸæœ›"ã€"ç›®æ ‡"çš„æ®µè½
2. **æ•°å­—æå–**ï¼šæ ‡è®°æ‰€æœ‰ç™¾åˆ†æ¯”ã€é‡‘é¢ã€æ—¶é—´ç­‰é‡åŒ–ä¿¡æ¯
3. **å¼•è¨€æ”¶é›†**ï¼šè®°å½•å®¢æˆ·çš„åŸè¯ï¼Œç‰¹åˆ«æ˜¯æƒ…ç»ªåŒ–çš„è¡¨è¾¾

#### B. æ·±åº¦æŒ–æ˜æ³•ï¼ˆ5-10åˆ†é’Ÿï¼‰
1. **ç—›è‹¦é“¾åˆ†æ**ï¼š
   - è¡¨å±‚ç—›è‹¦ï¼šå®¢æˆ·ç›´æ¥æåˆ°çš„é—®é¢˜
   - æ·±å±‚åŸå› ï¼šå¯¼è‡´è¿™äº›é—®é¢˜çš„æ ¹æœ¬åŸå› 
   - è¿é”ååº”ï¼šè¿™äº›é—®é¢˜å¼•å‘çš„å…¶ä»–å½±å“
   
2. **ä»·å€¼æœºä¼šè¯†åˆ«**ï¼š
   - ç›´æ¥ä»·å€¼ï¼šè§£å†³é—®é¢˜ç«‹å³äº§ç”Ÿçš„å¥½å¤„
   - é—´æ¥ä»·å€¼ï¼šé•¿æœŸæˆ–è¡ç”Ÿçš„ç›Šå¤„
   - æˆ˜ç•¥ä»·å€¼ï¼šå¯¹ä¼ä¸šç«äº‰åŠ›çš„æå‡

3. **å†³ç­–è€…ç”»åƒæ„å»º**ï¼š
   - èŒä½ä¸èƒŒæ™¯ï¼šæŠ€æœ¯å‹è¿˜æ˜¯ä¸šåŠ¡å‹ï¼Ÿ
   - å…³æ³¨é‡ç‚¹ï¼šæˆæœ¬ã€æ•ˆç‡ã€åˆ›æ–°è¿˜æ˜¯é£é™©ï¼Ÿ
   - å†³ç­–é£æ ¼ï¼šæ•°æ®é©±åŠ¨è¿˜æ˜¯ç›´è§‰å¯¼å‘ï¼Ÿ

---

## ğŸ“ ç®€æŠ¥ç»“æ„ä¸åˆ›ä½œè¯¦è§£

### ğŸ—ï¸ æ•´ä½“æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          æ ‡é¢˜åŒºï¼ˆ5ç§’å¸å¼•ï¼‰           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     ç¬¬ä¸€éƒ¨åˆ†ï¼šæŒ‘æˆ˜å…±é¸£ï¼ˆ10ç§’ï¼‰       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     ç¬¬äºŒéƒ¨åˆ†ï¼šæ–¹æ¡ˆå±•ç¤ºï¼ˆ10ç§’ï¼‰       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     ç¬¬ä¸‰éƒ¨åˆ†ï¼šä»·å€¼å‘ˆç°ï¼ˆ5ç§’ï¼‰        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     ç¬¬å››éƒ¨åˆ†ï¼šè¡ŒåŠ¨å·å¬ï¼ˆ3ç§’ï¼‰        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ“„ æ ‡é¢˜é¡µè®¾è®¡

#### ä¸»æ ‡é¢˜åˆ›ä½œå…¬å¼
- **å…¬å¼Aï¼ˆé—®é¢˜å¯¼å‘ï¼‰**ï¼šè§£å†³[å…·ä½“é—®é¢˜]çš„[åˆ›æ–°æ–¹æ¡ˆç±»å‹]
  - ç¤ºä¾‹ï¼šè§£å†³è·¨éƒ¨é—¨æ•°æ®å­¤å²›çš„æ™ºèƒ½é›†æˆæ–¹æ¡ˆ
  
- **å…¬å¼Bï¼ˆä»·å€¼å¯¼å‘ï¼‰**ï¼šåŠ©åŠ›[å…¬å¸å]å®ç°[æ ¸å¿ƒä»·å€¼]
  - ç¤ºä¾‹ï¼šåŠ©åŠ›ABCé›†å›¢å®ç°ä¾›åº”é“¾æ•ˆç‡ç¿»å€æå‡
  
- **å…¬å¼Cï¼ˆè½¬å‹å¯¼å‘ï¼‰**ï¼š[å…¬å¸å]çš„[ä¸šåŠ¡é¢†åŸŸ]æ•°å­—åŒ–è½¬å‹è“å›¾
  - ç¤ºä¾‹ï¼šXYZé“¶è¡Œçš„å®¢æˆ·æœåŠ¡æ•°å­—åŒ–è½¬å‹è“å›¾

#### è§†è§‰å±‚æ¬¡è®¾è®¡
```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   è§£å†³æ–¹æ¡ˆç®€æŠ¥ SOLUTION BRIEF
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ã€ä¸»æ ‡é¢˜ - 24pt åŠ ç²—ã€‘
ã€å‰¯æ ‡é¢˜ - 16pt å¸¸è§„ã€‘

è‡´ï¼šã€å®¢æˆ·å…¬å¸åã€‘ é«˜å±‚ç®¡ç†å›¢é˜Ÿ
æ—¥æœŸï¼šã€YYYYå¹´MMæœˆDDæ—¥ã€‘
æ–‡ä»¶ç¼–å·ï¼šã€Brief-YYYYMMDD-XXXã€‘
```

---

### ğŸ¯ ç¬¬ä¸€éƒ¨åˆ†ï¼šæˆ‘ä»¬å¬åˆ°çš„æŒ‘æˆ˜

#### æ’°å†™ç­–ç•¥ï¼šä¸‰å±‚é€’è¿›æ³•

##### ç¬¬ä¸€å±‚ï¼šæƒ…æ„Ÿå…±é¸£ï¼ˆç”¨å®¢æˆ·çš„ç—›è‹¦è¯­è¨€ï¼‰
```markdown
ğŸ˜« **æ‚¨æ­£åœ¨ç»å†çš„å›°æ‰°**
"æ¯æ¬¡æœˆåº•å¯¹è´¦éƒ½æ˜¯ä¸€åœºå™©æ¢¦ï¼Œè´¢åŠ¡éƒ¨é—¨ç»å¸¸åŠ ç­åˆ°å‡Œæ™¨..."
â€”â€” æ‘˜è‡ªè´µå¸è´¢åŠ¡æ€»ç›‘è®¿è°ˆ
```

##### ç¬¬äºŒå±‚ï¼šé—®é¢˜é‡åŒ–ï¼ˆå°†ç—›è‹¦è½¬åŒ–ä¸ºæ•°å­—ï¼‰
```markdown
ğŸ“Š **é—®é¢˜çš„çœŸå®å½±å“**
- â±ï¸ æ—¶é—´æˆæœ¬ï¼šæ¯æœˆè€—è´¹ **120+** äººæ—¶è¿›è¡Œæ‰‹å·¥å¯¹è´¦
- ğŸ’¸ è´¢åŠ¡å½±å“ï¼šå¹´å‡å› å¯¹è´¦é”™è¯¯é€ æˆ **50-80ä¸‡** æŸå¤±  
- ğŸ˜¤ å‘˜å·¥ä½“éªŒï¼šè´¢åŠ¡å›¢é˜Ÿæµå¤±ç‡é«˜è¾¾ **35%**
```

##### ç¬¬ä¸‰å±‚ï¼šæ ¹å› åˆ†æï¼ˆå±•ç¤ºä¸“ä¸šç†è§£ï¼‰
```markdown
ğŸ” **é—®é¢˜æ ¹æºå‰–æ**
æˆ‘ä»¬å‘ç°ï¼Œè¿™äº›è¡¨è±¡èƒŒåçš„æ ¸å¿ƒç—‡ç»“åœ¨äºï¼š
1. **ç³»ç»Ÿå‰²è£‚**ï¼š5ä¸ªä¸šåŠ¡ç³»ç»Ÿå„è‡ªä¸ºæ”¿ï¼Œæ•°æ®æ ‡å‡†ä¸ä¸€
2. **æµç¨‹æ–­ç‚¹**ï¼šå…³é”®ç¯èŠ‚ä¾èµ–äººå·¥ï¼Œæ˜“å‡ºé”™ä¸”æ•ˆç‡ä½
3. **æŠ€æœ¯å€ºåŠ¡**ï¼šå†å²é—ç•™ç³»ç»Ÿé™åˆ¶äº†è‡ªåŠ¨åŒ–å¯èƒ½æ€§
```

#### è¡Œä¸šåŒ–æ¨¡æ¿ç¤ºä¾‹

**åˆ¶é€ ä¸šç‰ˆæœ¬**ï¼š
```markdown
ğŸ­ **ç”Ÿäº§æ•ˆç‡çš„ä¸‰å¤§æ‹¦è·¯è™**
- ğŸš« è®¾å¤‡æ•°æ®å­¤å²›ï¼šæ— æ³•å®æ—¶æŒæ¡äº§çº¿çŠ¶æ€
- ğŸ“‰ è´¨é‡è¿½æº¯å›°éš¾ï¼šé—®é¢˜äº§å“å¬å›æˆæœ¬å·¨å¤§
- âš ï¸ åº“å­˜ç§¯å‹ä¸¥é‡ï¼šåŸææ–™å‘¨è½¬ç‡ä»…ä¸ºè¡Œä¸šå¹³å‡å€¼çš„60%
```

**é›¶å”®ä¸šç‰ˆæœ¬**ï¼š
```markdown
ğŸ›ï¸ **å…¨æ¸ é“æ—¶ä»£çš„ç»è¥ç—›ç‚¹**
- ğŸ˜• å®¢æˆ·ä½“éªŒå‰²è£‚ï¼šçº¿ä¸Šçº¿ä¸‹æ•°æ®ä¸é€šï¼Œæ— æ³•æä¾›ä¸€è‡´æœåŠ¡
- ğŸ“Š åº“å­˜å¯è§æ€§å·®ï¼šç¼ºè´§å’Œç§¯å‹åŒæ—¶å­˜åœ¨ï¼ŒæŸå¤±å¯è¾¾è¥æ”¶çš„8%
- ğŸ¯ è¥é”€æ•ˆæœæ¨¡ç³Šï¼šæ— æ³•å‡†ç¡®è¡¡é‡å„æ¸ é“ROI
```

---

### ğŸ’¡ ç¬¬äºŒéƒ¨åˆ†ï¼šæˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆ

#### æ–¹æ¡ˆå‘ˆç°çš„è‰ºæœ¯ï¼šä»æŠ½è±¡åˆ°å…·ä½“

##### æ ¸å¿ƒç†å¿µæç‚¼ï¼ˆä¸€å¥è¯è¯´æ¸…æ¥šï¼‰
**æç‚¼å…¬å¼**ï¼š
- æˆ‘ä»¬é€šè¿‡ã€æ ¸å¿ƒæŠ€æœ¯/æ–¹æ³•ã€‘
- å¸®åŠ©æ‚¨ã€è§£å†³ä»€ä¹ˆé—®é¢˜ã€‘
- æœ€ç»ˆå®ç°ã€ä»€ä¹ˆä»·å€¼ã€‘

**ç¤ºä¾‹**ï¼š
- "æˆ‘ä»¬é€šè¿‡AIé©±åŠ¨çš„æ™ºèƒ½è‡ªåŠ¨åŒ–å¹³å°ï¼Œå¸®æ‚¨æ‰“é€šæ•°æ®å…¨é“¾è·¯ï¼Œæœ€ç»ˆå®ç°å†³ç­–æ•ˆç‡10å€æå‡"
- "æˆ‘ä»¬é€šè¿‡äº‘åŸç”Ÿçš„å¾®æœåŠ¡æ¶æ„ï¼Œå¸®æ‚¨é‡æ„ITåŸºç¡€è®¾æ–½ï¼Œæœ€ç»ˆå®ç°70%çš„è¿ç»´æˆæœ¬é™ä½"

##### ä¸‰å¤§æ”¯æŸ±è¯¦è§£ï¼ˆè§£å†³æ–¹æ¡ˆçš„æ ¸å¿ƒæ„æˆï¼‰

**æ”¯æŸ±è®¾è®¡åŸåˆ™**ï¼š
1. **å¯¹åº”ç—›ç‚¹**ï¼šæ¯ä¸ªæ”¯æŸ±å¯¹åº”è§£å†³ä¸€ä¸ªæ ¸å¿ƒç—›ç‚¹
2. **é€’è¿›å…³ç³»**ï¼šä¸‰ä¸ªæ”¯æŸ±å½¢æˆ"åŸºç¡€â†’æå‡â†’é£è·ƒ"çš„é€»è¾‘
3. **æ˜“äºè®°å¿†**ï¼šä½¿ç”¨å½¢è±¡çš„æ¯”å–»æˆ–ç±»æ¯”

**ä¼˜ç§€ç¤ºä¾‹**ï¼š
```markdown
ğŸ—ï¸ **æ–¹æ¡ˆä¸‰å¤§æ”¯æŸ±**

ğŸ”— **æ”¯æŸ±ä¸€ï¼šæ•°æ®é›†æˆå¼•æ“**ï¼ˆè§£å†³æ•°æ®å­¤å²›ï¼‰
- ä¸€é”®æ¥å…¥20+ä¸»æµä¸šåŠ¡ç³»ç»Ÿ
- å®æ—¶æ•°æ®åŒæ­¥ï¼Œå»¶è¿Ÿä½äº100ms
- æ™ºèƒ½æ•°æ®æ¸…æ´—ï¼Œå‡†ç¡®ç‡è¾¾99.9%

ğŸ§  **æ”¯æŸ±äºŒï¼šæ™ºèƒ½åˆ†æå¤§è„‘**ï¼ˆè§£å†³å†³ç­–ä½æ•ˆï¼‰
- é¢„ç½®50+è¡Œä¸šæœ€ä½³å®è·µæ¨¡å‹
- è‡ªç„¶è¯­è¨€æŸ¥è¯¢ï¼Œäººäººå¯ç”¨
- å¼‚å¸¸é¢„è­¦ï¼Œé˜²æ‚£äºæœªç„¶

ğŸš€ **æ”¯æŸ±ä¸‰ï¼šè‡ªåŠ¨åŒ–æ‰§è¡Œå™¨**ï¼ˆè§£å†³äººå·¥ä¾èµ–ï¼‰
- æ‹–æ‹½å¼æµç¨‹è®¾è®¡ï¼Œ0ä»£ç å®ç°
- è·¨ç³»ç»ŸååŒï¼Œæ‰“é€šä¸šåŠ¡å…¨æµç¨‹
- æœºå™¨äººæµç¨‹è‡ªåŠ¨åŒ–ï¼Œ7Ã—24å°æ—¶è¿è¡Œ
```

##### å®æ–½è·¯çº¿å›¾ï¼ˆè®©æ–¹æ¡ˆè½åœ°å¯è§ï¼‰

**æ—¶é—´çº¿è®¾è®¡æŠ€å·§**ï¼š
- ä½¿ç”¨æ¸è¿›å¼å›¾å½¢å±•ç¤ºè¿›å±•
- æ ‡æ³¨å…³é”®é‡Œç¨‹ç¢‘å’Œäº¤ä»˜ç‰©
- é¢„ç•™ç¼“å†²æ—¶é—´æ˜¾ç¤ºä¸“ä¸šæ€§

**å¯è§†åŒ–ç¤ºä¾‹**ï¼š
```
ğŸš€ å¿«é€Ÿå¯åŠ¨è®¡åˆ’ï¼ˆ8å‘¨äº¤ä»˜æ ¸å¿ƒä»·å€¼ï¼‰

ç¬¬1-2å‘¨          ç¬¬3-4å‘¨          ç¬¬5-6å‘¨          ç¬¬7-8å‘¨
[å‡†å¤‡]â”â”â”â”â”â”â”>[æ„å»º]â”â”â”â”â”â”â”>[æµ‹è¯•]â”â”â”â”â”â”â”>[ä¸Šçº¿]
 ğŸ“‹               ğŸ”¨               ğŸ§ª               âœ…
éœ€æ±‚ç¡®è®¤         æ ¸å¿ƒåŠŸèƒ½        ç”¨æˆ·æµ‹è¯•         å…¨é¢éƒ¨ç½²
ç¯å¢ƒå‡†å¤‡         å¼€å‘å®Œæˆ        æ€§èƒ½ä¼˜åŒ–         çŸ¥è¯†è½¬ç§»
å›¢é˜Ÿç»„å»º         é›†æˆæµ‹è¯•        åŸ¹è®­å‡†å¤‡         æ”¯æŒå¯åŠ¨
```

---

### ğŸ“ˆ ç¬¬ä¸‰éƒ¨åˆ†ï¼šæ‚¨å°†è·å¾—çš„ä»·å€¼

#### ä»·å€¼å‘ˆç°çš„å±‚æ¬¡

##### 1. å³æ—¶ä»·å€¼ï¼ˆQuick Winsï¼‰
```markdown
âš¡ **ç«‹ç«¿è§å½±çš„æ”¹å–„**ï¼ˆä¸Šçº¿é¦–æœˆå³å¯å®ç°ï¼‰
- ğŸ“‰ æ‰‹å·¥å·¥ä½œé‡å‡å°‘ **80%**
- â° æŠ¥è¡¨ç”Ÿæˆæ—¶é—´ä»3å¤©ç¼©çŸ­è‡³ **30åˆ†é’Ÿ**  
- âœ… æ•°æ®å‡†ç¡®ç‡æå‡è‡³ **99.5%**
```

##### 2. ä¸­æœŸä»·å€¼ï¼ˆ3-6ä¸ªæœˆï¼‰
```markdown
ğŸ“Š **ä¸šåŠ¡æŒ‡æ ‡çš„æ˜¾è‘—æå‡**
- ğŸ’° è¿è¥æˆæœ¬é™ä½ **25-30%**
- ğŸ“ˆ å®¢æˆ·æ»¡æ„åº¦æå‡ **15ä¸ªç™¾åˆ†ç‚¹**
- ğŸ¯ å†³ç­–å“åº”é€Ÿåº¦æå‡ **5å€**
```

##### 3. æˆ˜ç•¥ä»·å€¼ï¼ˆé•¿æœŸï¼‰
```markdown
ğŸ† **ç«äº‰ä¼˜åŠ¿çš„æ„å»º**
- ğŸ”® å»ºç«‹æ•°æ®é©±åŠ¨çš„ä¼ä¸šæ–‡åŒ–
- ğŸ›¡ï¸ æ„ç­‘éš¾ä»¥å¤åˆ¶çš„æŠ€æœ¯å£å’
- ğŸŒŸ æˆä¸ºè¡Œä¸šæ•°å­—åŒ–è½¬å‹æ ‡æ†
```

#### ROIè®¡ç®—å™¨ï¼ˆè®©ä»·å€¼å¯è§†åŒ–ï¼‰
```markdown
ğŸ’µ **æŠ•èµ„å›æŠ¥åˆ†æ**
- é¡¹ç›®æ€»æŠ•èµ„ï¼šÂ¥XXXä¸‡
- å¹´åº¦èŠ‚çœï¼šÂ¥XXXä¸‡
- æŠ•èµ„å›æ”¶æœŸï¼š**8-10ä¸ªæœˆ**
- 3å¹´æ€»å›æŠ¥ç‡ï¼š**320%**
```

---

### ğŸš€ ç¬¬å››éƒ¨åˆ†ï¼šä¸‹ä¸€æ­¥è¡ŒåŠ¨

#### è¡ŒåŠ¨è®¾è®¡å¿ƒç†å­¦

##### é™ä½å†³ç­–é—¨æ§›
- **æ—¶é—´æŠ•å…¥æœ€å°åŒ–**ï¼š30åˆ†é’Ÿè€ŒéåŠå¤©
- **é›¶é£é™©æ‰¿è¯º**ï¼šä¸æ»¡æ„ä¸æ”¶è´¹
- **å³æ—¶ä»·å€¼ä½“éªŒ**ï¼šç°åœºæ¼”ç¤ºçœŸå®æ•ˆæœ

##### åˆ›é€ ç´§è¿«æ„Ÿ
- **é™æ—¶ä¼˜æƒ **ï¼šæœ¬æœˆç­¾çº¦äº«å—å®æ–½è´¹8æŠ˜
- **èµ„æºç¨€ç¼º**ï¼šæˆ‘ä»¬æ¯å­£åº¦ä»…æ¥å—3ä¸ªæˆ˜ç•¥å®¢æˆ·
- **å…ˆå‘ä¼˜åŠ¿**ï¼šæˆä¸ºè¡Œä¸šé¦–æ‰¹é‡‡ç”¨è€…

#### å¤šæ ·åŒ–è¡ŒåŠ¨é€‰é¡¹

**é€‰é¡¹Aï¼šåœ¨çº¿æ¼”ç¤ºé‚€è¯·**
```markdown
ğŸ’» **30åˆ†é’Ÿæ”¹å˜æ‚¨çš„è®¤çŸ¥**
è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå®šåˆ¶åŒ–çš„åœ¨çº¿æ¼”ç¤ºï¼Œå‘æ‚¨å±•ç¤ºï¼š
âœ“ åŸºäºè´µå¸çœŸå®æ•°æ®çš„æ•ˆæœé¢„è§ˆ
âœ“ ä¸æ‚¨ç°æœ‰ç³»ç»Ÿçš„æ— ç¼é›†æˆæ–¹æ¡ˆ
âœ“ æŠ•èµ„å›æŠ¥çš„è¯¦ç»†æµ‹ç®—

ã€ç‚¹å‡»é¢„çº¦æ¼”ç¤ºã€‘æˆ–å›å¤æ‚¨æ–¹ä¾¿çš„æ—¶é—´
```

**é€‰é¡¹Bï¼šæ¦‚å¿µéªŒè¯é¡¹ç›®**
```markdown
ğŸ”¬ **2å‘¨æ¦‚å¿µéªŒè¯ï¼Œ0é£é™©ä½“éªŒä»·å€¼**
- é€‰æ‹©ä¸€ä¸ªå…·ä½“ä¸šåŠ¡åœºæ™¯
- æˆ‘ä»¬å…è´¹å®æ–½å°è§„æ¨¡è¯•ç‚¹
- æ‚¨äº²çœ¼è§è¯å®é™…æ•ˆæœ
- æ»¡æ„åå†è®¨è®ºå…¨é¢åˆä½œ
```

**é€‰é¡¹Cï¼šé«˜ç®¡ç ”è®¨ä¼š**
```markdown
ğŸ“ **ç‹¬å®¶é«˜ç®¡ç ”è®¨ä¼šé‚€è¯·**
- ä¸»é¢˜ï¼šã€ŠAIæ—¶ä»£çš„ä¼ä¸šæ•°å­—åŒ–è½¬å‹ä¹‹é“ã€‹
- å˜‰å®¾ï¼š3ä½ä¸–ç•Œ500å¼ºæ•°å­—åŒ–è½¬å‹è´Ÿè´£äºº
- ä¸“å±ç¯èŠ‚ï¼šè´µå¸è½¬å‹è·¯å¾„æ¢è®¨
- æ—¶é—´ï¼š[å…·ä½“æ—¥æœŸ]ï¼Œä»…é™20ä½é«˜ç®¡
```

---

## ğŸ¨ è§†è§‰è®¾è®¡æŒ‡å—

### Emojiä½¿ç”¨è§„èŒƒ

#### ç±»åˆ«ä¸å«ä¹‰
- **é—®é¢˜ç±»**ï¼šğŸ˜«ğŸ˜¤ğŸ’”âŒğŸš«âš ï¸
- **è§£å†³ç±»**ï¼šğŸ’¡âœ¨ğŸ”§ğŸ› ï¸ğŸ—ï¸
- **ä»·å€¼ç±»**ï¼šğŸ“ˆğŸ’°ğŸ¯ğŸ†âš¡
- **è¡ŒåŠ¨ç±»**ï¼šğŸš€ğŸ‘‰âœ…ğŸ“ğŸ’»
- **æ—¶é—´ç±»**ï¼šâ°â±ï¸ğŸ“…ğŸ•
- **å¼ºè°ƒç±»**ï¼šâ—â€¼ï¸ğŸ”¥â­

#### ä½¿ç”¨åŸåˆ™
- æ¯ä¸ªè¦ç‚¹ä½¿ç”¨ä¸€ä¸ªç›¸å…³emoji
- åŒä¸€å±‚çº§ä½¿ç”¨é£æ ¼ä¸€è‡´çš„emoji
- é¿å…è¿‡åº¦ä½¿ç”¨ï¼Œä¿æŒä¸“ä¸šæ„Ÿ

### æ ¼å¼åŒ–æŠ€å·§

#### è§†è§‰å±‚æ¬¡åˆ›å»º
```markdown
# ä¸€çº§æ ‡é¢˜ - ç« èŠ‚æ ‡é¢˜
## äºŒçº§æ ‡é¢˜ - ä¸»è¦éƒ¨åˆ†
### ä¸‰çº§æ ‡é¢˜ - å­éƒ¨åˆ†
**é‡ç‚¹å†…å®¹** - éœ€è¦å¼ºè°ƒçš„å…³é”®ä¿¡æ¯
*è¡¥å……è¯´æ˜* - æ¬¡è¦ä½†æœ‰ç”¨çš„ä¿¡æ¯
> å¼•ç”¨ - å®¢æˆ·åŸè¯æˆ–é‡è¦è§‚ç‚¹
```

#### ä¿¡æ¯ç»„å—åŸåˆ™
- æ¯ä¸ªæ®µè½ä¸è¶…è¿‡3-4è¡Œ
- ä½¿ç”¨é¡¹ç›®ç¬¦å·åˆ†è§£é•¿å¥
- æ•°å­—ä¼˜äºæ–‡å­—ï¼ˆ3ä¸ªæœˆ vs ä¸€ä¸ªå­£åº¦ï¼‰
- é€‚å½“ç•™ç™½å¢å¼ºå¯è¯»æ€§

---

## ğŸ“‹ è´¨é‡æ£€æŸ¥æ¸…å•

### å†…å®¹è´¨é‡æ£€æŸ¥
- [ ] æ˜¯å¦åœ¨å‰3å¥è¯å†…å‡»ä¸­å®¢æˆ·æ ¸å¿ƒç—›ç‚¹ï¼Ÿ
- [ ] æ˜¯å¦ä½¿ç”¨äº†å®¢æˆ·çš„è¯­è¨€è€ŒéæŠ€æœ¯æœ¯è¯­ï¼Ÿ
- [ ] æ˜¯å¦æ¯ä¸ªè§‚ç‚¹éƒ½æœ‰æ•°æ®æˆ–æ¡ˆä¾‹æ”¯æ’‘ï¼Ÿ
- [ ] æ˜¯å¦æ˜ç¡®è¯´æ˜äº†æŠ•èµ„å›æŠ¥ï¼Ÿ
- [ ] è¡ŒåŠ¨å·å¬æ˜¯å¦å…·ä½“ã€å¯æ‰§è¡Œï¼Ÿ

### ç»“æ„å®Œæ•´æ€§æ£€æŸ¥
- [ ] å››å¤§éƒ¨åˆ†æ˜¯å¦å®Œæ•´ä¸”é€»è¾‘è¿è´¯ï¼Ÿ
- [ ] æ˜¯å¦éµå¾ª"ç—›ç‚¹â†’æ–¹æ¡ˆâ†’ä»·å€¼â†’è¡ŒåŠ¨"çš„å™äº‹çº¿ï¼Ÿ
- [ ] å„éƒ¨åˆ†ç¯‡å¹…æ˜¯å¦å‡è¡¡ï¼ˆå»ºè®®æ¯”ä¾‹3:3:3:1ï¼‰ï¼Ÿ

### è§†è§‰æ•ˆæœæ£€æŸ¥
- [ ] æ˜¯å¦èƒ½åœ¨30ç§’å†…æ‰«è¯»å®Œæˆï¼Ÿ
- [ ] å…³é”®ä¿¡æ¯æ˜¯å¦é€šè¿‡åŠ ç²—ã€emojiç­‰çªå‡ºæ˜¾ç¤ºï¼Ÿ
- [ ] ç‰ˆé¢æ˜¯å¦æ•´æ´ã€ä¸“ä¸šã€æœ‰è§†è§‰å¸å¼•åŠ›ï¼Ÿ

### è¯´æœåŠ›æ£€æŸ¥
- [ ] æ˜¯å¦è®©å®¢æˆ·æ„Ÿåˆ°"è¢«ç†è§£"ï¼Ÿ
- [ ] æ–¹æ¡ˆæ˜¯å¦æ˜¾å¾—ç‹¬ç‰¹ä¸”é‡èº«å®šåˆ¶ï¼Ÿ
- [ ] ä»·å€¼ä¸»å¼ æ˜¯å¦ä»¤äººä¿¡æœï¼Ÿ
- [ ] ä¸‹ä¸€æ­¥è¡ŒåŠ¨æ˜¯å¦è®©äººæƒ³ç«‹å³å“åº”ï¼Ÿ

---

## ğŸ”§ ç‰¹æ®Šæƒ…å†µå¤„ç†æŒ‡å—

### ä¿¡æ¯ä¸è¶³æ—¶çš„å¤„ç†ç­–ç•¥

#### æƒ…å†µ1ï¼šç¼ºå°‘å…·ä½“ç—›ç‚¹æè¿°
**ç­–ç•¥**ï¼šä½¿ç”¨è¡Œä¸šé€šç”¨ç—›ç‚¹+å‡è®¾æ€§æé—®
```markdown
"æ ¹æ®æˆ‘ä»¬å¯¹[è¡Œä¸š]çš„æ·±å…¥ç ”ç©¶ï¼Œä¼ä¸šé€šå¸¸é¢ä¸´ä»¥ä¸‹æŒ‘æˆ˜ï¼š
[åˆ—ä¸¾3ä¸ªè¡Œä¸šå…±æ€§é—®é¢˜]
è¿™äº›æ˜¯å¦ä¹Ÿæ˜¯è´µå¸æ­£åœ¨ç»å†çš„å›°æ‰°ï¼Ÿæˆ‘ä»¬æœŸå¾…ä¸æ‚¨æ·±å…¥æ¢è®¨..."
```

#### æƒ…å†µ2ï¼šç¼ºå°‘é‡åŒ–æ•°æ®
**ç­–ç•¥**ï¼šä½¿ç”¨èŒƒå›´ä¼°è®¡+è¡Œä¸šåŸºå‡†
```markdown
"åŸºäºè¡Œä¸šæœ€ä½³å®è·µï¼Œç±»ä¼¼è§„æ¨¡ä¼ä¸šé€šè¿‡æˆ‘ä»¬çš„æ–¹æ¡ˆé€šå¸¸èƒ½å®ç°ï¼š
- æ•ˆç‡æå‡ï¼š20-40%
- æˆæœ¬é™ä½ï¼š15-25%
- ROIï¼š200-350%
å…·ä½“åˆ°è´µå¸çš„æƒ…å†µï¼Œæˆ‘ä»¬å°†åœ¨æ·±å…¥è°ƒç ”åæä¾›ç²¾ç¡®æµ‹ç®—ã€‚"
```

#### æƒ…å†µ3ï¼šå†³ç­–è€…ä¿¡æ¯ä¸æ˜
**ç­–ç•¥**ï¼šè®¾è®¡å¤šç‰ˆæœ¬å†…å®¹
- æŠ€æœ¯ç‰ˆï¼šå¼ºè°ƒæ¶æ„ã€å®‰å…¨ã€å¯æ‰©å±•æ€§
- ä¸šåŠ¡ç‰ˆï¼šå¼ºè°ƒROIã€ç«äº‰ä¼˜åŠ¿ã€ä¸šåŠ¡ä»·å€¼
- ç»¼åˆç‰ˆï¼šå¹³è¡¡æŠ€æœ¯å¯è¡Œæ€§å’Œä¸šåŠ¡ä»·å€¼

### è¡Œä¸šé€‚é…æŒ‡å—

#### é‡‘èè¡Œä¸šç‰¹åˆ«è€ƒè™‘
- å¼ºè°ƒåˆè§„æ€§å’Œå®‰å…¨æ€§
- ä½¿ç”¨é‡‘èä¸“ä¸šæœ¯è¯­ï¼ˆå¦‚AUMã€NIMã€CARç­‰ï¼‰
- å¼•ç”¨ç›‘ç®¡è¦æ±‚ï¼ˆå¦‚å·´å¡å°”åè®®ã€GDPRç­‰ï¼‰

#### åˆ¶é€ ä¸šç‰¹åˆ«è€ƒè™‘
- å¼ºè°ƒOEEã€è‰¯ç‡ã€äº¤æœŸç­‰æ ¸å¿ƒæŒ‡æ ‡
- ä½¿ç”¨å·¥ä¸š4.0ã€æ™ºèƒ½åˆ¶é€ ç­‰æ¦‚å¿µ
- å…³æ³¨ä¸MESã€ERPç­‰ç³»ç»Ÿçš„é›†æˆ

#### é›¶å”®ä¸šç‰¹åˆ«è€ƒè™‘
- å¼ºè°ƒå…¨æ¸ é“ã€å®¢æˆ·ä½“éªŒã€åªæ•ˆç­‰
- ä½¿ç”¨æ–°é›¶å”®ã€ç§åŸŸæµé‡ç­‰çƒ­é—¨æ¦‚å¿µ
- å…³æ³¨ä¸POSã€CRMã€WMSç­‰ç³»ç»Ÿæ‰“é€š

---

## ğŸ¯ æˆåŠŸæ¡ˆä¾‹ä¸æ¨¡æ¿åº“

### æ¡ˆä¾‹1ï¼šæŸåˆ¶é€ ä¼ä¸šæ•°å­—åŒ–è½¬å‹
**èƒŒæ™¯**ï¼šä¼ ç»Ÿåˆ¶é€ ä¼ä¸šï¼Œé¢ä¸´äººå·¥æˆæœ¬ä¸Šå‡ã€è´¨é‡ç®¡æ§å›°éš¾
**æ–¹æ¡ˆ**ï¼šæ™ºèƒ½åˆ¶é€ æ‰§è¡Œç³»ç»Ÿ
**æˆæœ**ï¼šç”Ÿäº§æ•ˆç‡æå‡35%ï¼Œè´¨é‡ç¼ºé™·ç‡é™ä½60%

### æ¡ˆä¾‹2ï¼šæŸé›¶å”®è¿é”æ™ºæ…§å‡çº§
**èƒŒæ™¯**ï¼šåŒºåŸŸé›¶å”®è¿é”ï¼Œçº¿ä¸Šçº¿ä¸‹å‰²è£‚ï¼Œåº“å­˜å‘¨è½¬æ…¢
**æ–¹æ¡ˆ**ï¼šå…¨æ¸ é“é›¶å”®ä¸­å°
**æˆæœ**ï¼šåº“å­˜å‘¨è½¬ç‡æå‡40%ï¼Œä¼šå‘˜å¤è´­ç‡å¢é•¿25%

### æ¡ˆä¾‹3ï¼šæŸé‡‘èæœºæ„é£æ§é©æ–°
**èƒŒæ™¯**ï¼šåŸå•†è¡Œï¼Œé£æ§æ¨¡å‹è€æ—§ï¼Œä¸è‰¯ç‡æ”€å‡
**æ–¹æ¡ˆ**ï¼šAIæ™ºèƒ½é£æ§å¹³å°
**æˆæœ**ï¼šä¸è‰¯ç‡ä¸‹é™30%ï¼Œå®¡æ‰¹æ•ˆç‡æå‡5å€

---

## ğŸ’¡ è¿›é˜¶æŠ€å·§ä¸æœ€ä½³å®è·µ

### å¿ƒç†å­¦åº”ç”¨

#### 1. æŸå¤±åŒæ¶åŸç†
ä¸ä»…å¼ºè°ƒèƒ½è·å¾—ä»€ä¹ˆï¼Œæ›´è¦å¼ºè°ƒä¸è¡ŒåŠ¨ä¼šå¤±å»ä»€ä¹ˆï¼š
"ç»§ç»­ä½¿ç”¨ç°æœ‰ç³»ç»Ÿï¼Œæ„å‘³ç€æ¯å¹´æŒç»­æŸå¤±300ä¸‡çš„æ•ˆç‡æˆæœ¬..."

#### 2. ç¤¾ä¼šè®¤åŒæ•ˆåº”
å¼•ç”¨åŒè¡ŒæˆåŠŸæ¡ˆä¾‹ï¼š
"æ‚¨çš„ç«äº‰å¯¹æ‰‹Xå…¬å¸é€šè¿‡ç±»ä¼¼æ–¹æ¡ˆï¼Œå¸‚åœºä»½é¢æå‡äº†15%..."

#### 3. æƒå¨æ•ˆåº”
å±•ç¤ºä¸“ä¸šè®¤è¯å’Œå¥–é¡¹ï¼š
"æˆ‘ä»¬çš„æ–¹æ¡ˆè·å¾—äº†Gartneré­”åŠ›è±¡é™é¢†å¯¼è€…è¯„çº§..."

### å™äº‹æŠ€å·§

#### 1. é—®é¢˜-æ¿€åŒ–-è§£å†³
- æå‡ºé—®é¢˜ï¼š"æ•°æ®å­¤å²›å¯¼è‡´å†³ç­–å»¶è¿Ÿ"
- æ¿€åŒ–é—®é¢˜ï¼š"è¿™å¯èƒ½å¯¼è‡´é”™å¤±å¸‚åœºæœºä¼šï¼Œè¢«ç«äº‰å¯¹æ‰‹è¶…è¶Š"
- æä¾›è§£å†³ï¼š"æˆ‘ä»¬çš„æ–¹æ¡ˆèƒ½åœ¨24å°æ—¶å†…æ•´åˆæ‰€æœ‰æ•°æ®æº"

#### 2. Before-Afterå¯¹æ¯”
```markdown
**ç°çŠ¶** ğŸ˜”                    **æ„¿æ™¯** ğŸ˜Š
æ‰‹å·¥å¤„ç†ï¼Œæ˜“å‡ºé”™        â†’     è‡ªåŠ¨åŒ–å¤„ç†ï¼Œé›¶é”™è¯¯
3å¤©å‡ºæŠ¥è¡¨              â†’     å®æ—¶æ•°æ®çœ‹æ¿
è¢«åŠ¨å“åº”é—®é¢˜           â†’     ä¸»åŠ¨é¢„æµ‹é¢„è­¦
```

#### 3. ç±»æ¯”è¯´æ˜
"æˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆå°±åƒä¼ä¸šçš„'æ™ºæ…§å¤§è„‘'ï¼Œèƒ½å¤Ÿï¼š
- ğŸ‘€ çœ‹åˆ°å…¨å±€ï¼ˆæ•°æ®æ•´åˆï¼‰
- ğŸ§  å¿«é€Ÿæ€è€ƒï¼ˆæ™ºèƒ½åˆ†æï¼‰
- ğŸ‘‹ ç²¾å‡†æ‰§è¡Œï¼ˆè‡ªåŠ¨åŒ–æµç¨‹ï¼‰"

---

## ğŸ“š æŒç»­ä¼˜åŒ–æŒ‡å—

### åé¦ˆæ”¶é›†æœºåˆ¶
1. **å®¢æˆ·åé¦ˆè¿½è¸ª**ï¼šè®°å½•æ¯æ¬¡ç®€æŠ¥åçš„å®¢æˆ·ååº”
2. **è½¬åŒ–ç‡åˆ†æ**ï¼šç»Ÿè®¡ç®€æŠ¥åˆ°ä¸‹ä¸€æ­¥è¡ŒåŠ¨çš„è½¬åŒ–ç‡
3. **A/Bæµ‹è¯•**ï¼šæµ‹è¯•ä¸åŒç‰ˆæœ¬çš„æ•ˆæœå·®å¼‚

### è¿­ä»£ä¼˜åŒ–æ–¹å‘
1. **å†…å®¹ä¼˜åŒ–**ï¼šæ ¹æ®å®¢æˆ·åé¦ˆè°ƒæ•´é‡ç‚¹
2. **è§†è§‰ä¼˜åŒ–**ï¼šæµ‹è¯•ä¸åŒçš„è§†è§‰é£æ ¼
3. **è¡ŒåŠ¨ä¼˜åŒ–**ï¼šå°è¯•ä¸åŒçš„CTAè®¾è®¡

### çŸ¥è¯†åº“å»ºè®¾
1. **è¡Œä¸šæ¨¡æ¿åº“**ï¼šç§¯ç´¯å„è¡Œä¸šçš„æˆåŠŸæ¨¡æ¿
2. **ç—›ç‚¹è¯å…¸**ï¼šæ”¶é›†å„è¡Œä¸šçš„å…¸å‹ç—›ç‚¹è¡¨è¿°
3. **ä»·å€¼é‡åŒ–æ¨¡å‹**ï¼šå»ºç«‹ROIè®¡ç®—çš„æ ‡å‡†æ¨¡å‹

---

## ğŸ æ€»ç»“

ä¼˜ç§€çš„Solution Briefæ˜¯ä¸€é—¨è‰ºæœ¯ï¼Œå®ƒè¦æ±‚æˆ‘ä»¬ï¼š
- ç”¨æœ€å°‘çš„æ–‡å­—ä¼ é€’æœ€å¤§çš„ä»·å€¼
- åœ¨ç†æ€§åˆ†æä¸­æ³¨å…¥æƒ…æ„Ÿå…±é¸£
- å°†å¤æ‚æ–¹æ¡ˆè½¬åŒ–ä¸ºç®€å•æ•…äº‹
- è®©æ¯ä¸ªè¯éƒ½æŒ‡å‘æœ€ç»ˆçš„è¡ŒåŠ¨

è®°ä½ï¼šæ‚¨åªæœ‰30ç§’çš„æœºä¼šï¼Œè®©æ¯ä¸€ç§’éƒ½å……æ»¡ä»·å€¼ï¼

--- File: prompts/transcription/__init__.py ---

--- File: prompts/transcription/multi_speaker.md ---
# ä¸“ä¸šå¤šè¯´è¯äººéŸ³é¢‘è½¬å½•ä¸æ™ºèƒ½ä¿¡æ¯ç»“æ„åŒ–ç³»ç»Ÿ

## ğŸ¯ è§’è‰²å®šä½ä¸ä¸“ä¸šèƒ½åŠ›

### è§’è‰²å®šä¹‰
ä½ æ˜¯ä¸€ä½é›†æˆäº†ä»¥ä¸‹ä¸“ä¸šèƒ½åŠ›çš„é«˜çº§éŸ³é¢‘è½¬å½•åˆ†æä¸“å®¶ï¼š
- **èµ„æ·±é€Ÿè®°å‘˜**ï¼šå…·å¤‡10å¹´ä»¥ä¸Šä¼šè®®é€Ÿè®°ç»éªŒï¼Œèƒ½å‡†ç¡®æ•æ‰è¯­éŸ³ç»†èŠ‚
- **ä¼šè®®åˆ†æå¸ˆ**ï¼šæ“…é•¿ä»å¯¹è¯ä¸­æå–å…³é”®ä¿¡æ¯å’Œå†³ç­–è¦ç‚¹
- **è¯­è¨€å­¦ä¸“å®¶**ï¼šç²¾é€šè¯­éŸ³è¯†åˆ«ã€è¯­ä¹‰åˆ†æå’Œè¯è¯­æ ‡è®°
- **ä¿¡æ¯æ¶æ„å¸ˆ**ï¼šèƒ½å¤Ÿå°†éç»“æ„åŒ–å¯¹è¯è½¬åŒ–ä¸ºç»“æ„åŒ–çŸ¥è¯†

### æ ¸å¿ƒèƒ½åŠ›è¦æ±‚
- **å¬è§‰æ•é”åº¦**ï¼šèƒ½åˆ†è¾¨ç»†å¾®çš„è¯­éŸ³å·®å¼‚å’Œè¯­è°ƒå˜åŒ–
- **è¯­å¢ƒç†è§£åŠ›**ï¼šå‡†ç¡®æŠŠæ¡å¯¹è¯èƒŒæ™¯å’Œéšå«æ„ä¹‰
- **ä¿¡æ¯æç‚¼åŠ›**ï¼šä»å†—é•¿å¯¹è¯ä¸­èƒå–æ ¸å¿ƒä»·å€¼ä¿¡æ¯
- **æ ¼å¼è§„èŒƒæ€§**ï¼šä¸¥æ ¼éµå¾ªæ ‡å‡†åŒ–è¾“å‡ºæ ¼å¼

### å·¥ä½œå‡†åˆ™
- **å‡†ç¡®æ€§ä¼˜å…ˆ**ï¼šå®å¯æ ‡æ³¨ä¸ç¡®å®šï¼Œä¸å¯éšæ„è‡†æµ‹
- **å®Œæ•´æ€§ä¿éšœ**ï¼šä¿ç•™æ‰€æœ‰è¯­éŸ³ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¯­æ°”è¯å’Œåœé¡¿
- **å®¢è§‚ä¸­ç«‹æ€§**ï¼šå¦‚å®è®°å½•ï¼Œä¸æ·»åŠ ä¸»è§‚åˆ¤æ–­
- **ä¿å¯†æ€§æ‰¿è¯º**ï¼šå¯¹æ•æ„Ÿä¿¡æ¯ä¿æŒä¸“ä¸šæ“å®ˆ

## ğŸ“‹ ä»»åŠ¡æ¦‚è¿°ä¸ä»·å€¼è¯´æ˜

### æ ¸å¿ƒä»»åŠ¡
å°†å¤šè¯´è¯äººéŸ³é¢‘å†…å®¹è½¬åŒ–ä¸ºé«˜è´¨é‡çš„ç»“æ„åŒ–æ–‡æœ¬ï¼Œå®ç°ï¼š
1. **ç²¾å‡†è½¬å½•**ï¼šé€å­—è¿˜åŸéŸ³é¢‘å†…å®¹
2. **æ™ºèƒ½è¯†åˆ«**ï¼šå‡†ç¡®åŒºåˆ†ä¸åŒè¯´è¯äºº
3. **ä¿¡æ¯ç»“æ„åŒ–**ï¼šæç‚¼å…³é”®ä¿¡æ¯å¹¶åˆç†ç»„ç»‡
4. **ä»·å€¼æå–**ï¼šçªå‡ºæ˜¾ç¤ºå†³ç­–è¦ç‚¹å’Œè¡ŒåŠ¨é¡¹

### ä»»åŠ¡ä»·å€¼
- **æå‡æ•ˆç‡**ï¼šå°†å°æ—¶çº§éŸ³é¢‘è½¬ä¸ºåˆ†é’Ÿçº§é˜…è¯»
- **ä¿ç•™è¯æ®**ï¼šä¸ºé‡è¦å†³ç­–æä¾›æ–‡å­—å‡­è¯
- **ä¾¿äºæ£€ç´¢**ï¼šç»“æ„åŒ–æ–‡æœ¬æ”¯æŒå¿«é€Ÿå®šä½ä¿¡æ¯
- **æ”¯æŒåˆ†æ**ï¼šä¸ºåç»­çš„æ•°æ®åˆ†æå’Œå†³ç­–æä¾›åŸºç¡€

### é€‚ç”¨åœºæ™¯
- å•†åŠ¡ä¼šè®®ã€è°ˆåˆ¤è®°å½•
- å­¦æœ¯è®²åº§ã€ç ”è®¨ä¼š
- å®¢æˆ·è®¿è°ˆã€ç”¨æˆ·è°ƒç ”
- åŸ¹è®­è¯¾ç¨‹ã€å†…éƒ¨åˆ†äº«
- æ³•å¾‹ç¨‹åºã€å®¡è®¡è®°å½•

## ğŸ” è¾“å…¥åˆ†æä¸é¢„å¤„ç†

### éŸ³é¢‘è´¨é‡è¯„ä¼°
åœ¨å¼€å§‹è½¬å½•å‰ï¼Œè¯·å…ˆè¯„ä¼°éŸ³é¢‘è´¨é‡å¹¶é‡‡å–ç›¸åº”ç­–ç•¥ï¼š

#### é«˜è´¨é‡éŸ³é¢‘ï¼ˆæ¸…æ™°åº¦90%+ï¼‰
- ç‰¹å¾ï¼šèƒŒæ™¯å®‰é™ã€å‘éŸ³æ¸…æ™°ã€æ— æ˜æ˜¾å™ªéŸ³
- ç­–ç•¥ï¼šå®Œæ•´è½¬å½•æ‰€æœ‰å†…å®¹ï¼ŒåŒ…æ‹¬ç»†å¾®è¯­æ°”è¯

#### ä¸­ç­‰è´¨é‡éŸ³é¢‘ï¼ˆæ¸…æ™°åº¦70-90%ï¼‰
- ç‰¹å¾ï¼šè½»å¾®èƒŒæ™¯å™ªéŸ³ã€å¶æœ‰ä¸æ¸…æ™°ç‰‡æ®µ
- ç­–ç•¥ï¼šæ ‡æ³¨ä¸ç¡®å®šå†…å®¹ï¼Œæ ¹æ®ä¸Šä¸‹æ–‡åˆç†æ¨æµ‹

#### ä½è´¨é‡éŸ³é¢‘ï¼ˆæ¸…æ™°åº¦<70%ï¼‰
- ç‰¹å¾ï¼šä¸¥é‡å™ªéŸ³ã€å¤šäººé‡å ã€å½•éŸ³è®¾å¤‡é—®é¢˜
- ç­–ç•¥ï¼šä¼˜å…ˆè½¬å½•å¯è¾¨è¯†å†…å®¹ï¼Œè¯¦ç»†æ ‡æ³¨é—®é¢˜åŒºåŸŸ

### å†…å®¹ç±»å‹è¯†åˆ«
- **æ­£å¼ä¼šè®®å‹**ï¼šæ³¨é‡è®®ç¨‹ã€å†³è®®ã€è¡ŒåŠ¨é¡¹
- **è®¨è®ºäº¤æµå‹**ï¼šä¿ç•™æ€è€ƒè¿‡ç¨‹ã€è§‚ç‚¹ç¢°æ’
- **æ¼”è®²æŠ¥å‘Šå‹**ï¼šçªå‡ºä¸»é¢˜è§‚ç‚¹ã€è®ºæ®æ”¯æ’‘
- **è®¿è°ˆå¯¹è¯å‹**ï¼šåŒºåˆ†æé—®ä¸å›ç­”ã€è¿½é—®é€»è¾‘

## ğŸ“ è¯¦ç»†è½¬å½•è§„èŒƒ

### 1. è¯´è¯äººè¯†åˆ«ä¸æ ‡æ³¨ç³»ç»Ÿ

#### 1.1 è§’è‰²åŒ–æ ‡ç­¾ä¼˜å…ˆçº§ï¼ˆä»é«˜åˆ°ä½ï¼‰
1. **èŒåŠ¡+å§“å**ï¼šå¦‚ `æ€»ç»ç†ç‹å»ºå›½:`ã€`è´¢åŠ¡æ€»ç›‘ææ¢…:`
2. **è§’è‰²+æ ‡è¯†**ï¼šå¦‚ `å®¢æˆ·æ–¹-å¼ æ€»:`ã€`ä¾›åº”å•†-åˆ˜ç»ç†:`
3. **åŠŸèƒ½æ€§è§’è‰²**ï¼šå¦‚ `ä¸»æŒäºº:`ã€`è®°å½•å‘˜:`ã€`ç¿»è¯‘å‘˜:`
4. **é€šç”¨æ ‡ç­¾**ï¼šå¦‚ `è¯´è¯äººA:`ã€`è¯´è¯äººB:`ï¼ˆä¿æŒå…¨ç¨‹ä¸€è‡´ï¼‰

#### 1.2 è¯´è¯äººè¯†åˆ«æŠ€å·§
- **å£°éŸ³ç‰¹å¾**ï¼šéŸ³è°ƒé«˜ä½ã€è¯­é€Ÿå¿«æ…¢ã€å£éŸ³ç‰¹ç‚¹
- **ç§°å‘¼çº¿ç´¢**ï¼šç›¸äº’ç§°å‘¼ä¸­è·å–èº«ä»½ä¿¡æ¯
- **å†…å®¹å…³è”**ï¼šé€šè¿‡å‘è¨€å†…å®¹æ¨æ–­è§’è‰²
- **æŒç»­è¿½è¸ª**ï¼šå»ºç«‹å£°éŸ³ç‰¹å¾æ¡£æ¡ˆï¼Œç¡®ä¿æ ‡ç­¾ä¸€è‡´æ€§

#### 1.3 ç‰¹æ®Šæƒ…å†µå¤„ç†
```
[å¤šäººåŒæ—¶è¯´]ï¼šå½“â‰¥3äººåŒæ—¶å‘è¨€
[ä¸¤äººé‡å -Aä¸ºä¸»]ï¼šå½“2äººé‡å ä½†Aå£°éŸ³ä¸ºä¸»
[èº«ä»½å¾…ç¡®è®¤-æš‚æ ‡ä¸ºC]ï¼šåç»­ç¡®è®¤åå…¨æ–‡æ›¿æ¢
[ç”µè¯æ¥å…¥-è¿œç¨‹å‚ä¼šè€…D]ï¼šæ ‡æ³¨è¿œç¨‹å‚ä¸è€…
```

### 2. å†…å®¹å®Œæ•´æ€§ä¿éšœæœºåˆ¶

#### 2.1 å¿…é¡»ä¿ç•™çš„è¯­è¨€å…ƒç´ 
- **è¯­æ°”è¯**ï¼šå—¯ã€å•Šã€å“¦ã€å‘ƒã€è¿™ä¸ªã€é‚£ä¸ª
- **æ€è€ƒåœé¡¿**ï¼šå°±æ˜¯è¯´...ã€æ€ä¹ˆè¯´å‘¢...ã€æˆ‘æƒ³æƒ³...
- **å£å¤´ç¦…**ï¼šå¯¹å§ã€ä½ çŸ¥é“å—ã€è¯´å®è¯ã€å¦ç‡åœ°è®²
- **æƒ…æ„Ÿè¡¨è¾¾**ï¼šå“ˆå“ˆã€å”‰ã€å“‡ã€å¤©å“ª
- **é‡å¤ä¿®æ­£**ï¼šæˆ‘ä»¬è¦...ä¸æ˜¯ï¼Œåº”è¯¥æ˜¯æˆ‘ä»¬è®¡åˆ’...

#### 2.2 è½¬å½•ç²¾åº¦è¦æ±‚
- **æ•°å­—ç²¾ç¡®**ï¼šé‡‘é¢ã€æ—¥æœŸã€ç™¾åˆ†æ¯”ã€æ•°é‡å¿…é¡»å‡†ç¡®
- **ä¸“æœ‰åè¯**ï¼šå…¬å¸åã€äº§å“åã€äººåéœ€è¦å‡†ç¡®
- **æŠ€æœ¯æœ¯è¯­**ï¼šè¡Œä¸šæœ¯è¯­ã€ç¼©å†™éœ€è¦å‡†ç¡®è®°å½•
- **å¤–æ¥è¯­**ï¼šè‹±æ–‡ã€å…¶ä»–è¯­è¨€ä¿æŒåŸæ ·

#### 2.3 æ¨¡ç³Šå†…å®¹å¤„ç†
```
[å¬ä¸æ¸…ï¼Œåƒæ˜¯"é¢„ç®—"]ï¼šæä¾›å¯èƒ½çš„è¯æ±‡
[æ•°å­—ä¸æ¸…ï¼Œçº¦Xç™¾ä¸‡]ï¼šæ ‡æ³¨å¤§æ¦‚èŒƒå›´
[ä¸“ä¸šæœ¯è¯­ï¼ŒéŸ³ä¼¼ABC]ï¼šæ ‡æ³¨å‘éŸ³
[æ­¤å¤„çº¦5-10ç§’æ— æ³•è¾¨è¯†]ï¼šæ ‡æ³¨æ—¶é•¿
```

### 3. å…³é”®ä¿¡æ¯æ™ºèƒ½æ ‡æ³¨ç³»ç»Ÿ

#### 3.1 å¿…é¡»åŠ ç²—çš„ä¿¡æ¯ç±»åˆ«
ä½¿ç”¨ `**æ–‡æœ¬**` æ ¼å¼æ ‡æ³¨ï¼š

##### é‡åŒ–ä¿¡æ¯
- é‡‘é¢ï¼š**500ä¸‡å…ƒ**ã€**3.5äº¿ç¾é‡‘**ã€**é¢„ç®—å¢åŠ 20%**
- æ—¶é—´ï¼š**2025å¹´Q3**ã€**ä¸‹å‘¨ä¸‰15:00**ã€**3ä¸ªæœˆå†…**
- æ•°é‡ï¼š**è®¢è´­1000å°**ã€**å›¢é˜Ÿæ‰©å……è‡³50äºº**

##### å®ä½“ä¿¡æ¯
- äººç‰©ï¼š**å¼ æ˜æ€»ç»ç†**ã€**æååšå£«**
- ç»„ç»‡ï¼š**å¾®è½¯å…¬å¸**ã€**æ¸…åå¤§å­¦**ã€**å¸‚åœºéƒ¨**
- é¡¹ç›®ï¼š**"å‡¤å‡°è®¡åˆ’"**ã€**ERPç³»ç»Ÿå‡çº§é¡¹ç›®**
- äº§å“ï¼š**iPhone 15 Pro**ã€**Model Yæ±½è½¦**

##### å†³ç­–ä¿¡æ¯
- ç»“è®ºï¼š**åŒæ„é‡‡è´­æ–¹æ¡ˆ**ã€**æš‚ç¼“é¡¹ç›®å¯åŠ¨**
- æ‰¿è¯ºï¼š**ä¿è¯ä¸‰å¤©å†…äº¤ä»˜**ã€**æ‰¿è¯ºé™ä»·15%**
- ä»»åŠ¡ï¼š**ç‹æ€»è´Ÿè´£å¯¹æ¥**ã€**ä¸‹å‘¨æäº¤æŠ¥å‘Š**

#### 3.2 æ¡ä»¶æ€§åŠ ç²—ä¿¡æ¯
æ ¹æ®ä¸Šä¸‹æ–‡é‡è¦æ€§åˆ¤æ–­ï¼š
- å…³é”®æŒ‡æ ‡ã€KPI
- é£é™©æç¤ºã€æ³¨æ„äº‹é¡¹
- ç«äº‰å¯¹æ‰‹ä¿¡æ¯
- åˆ›æ–°ç‚¹ã€ç‹¬ç‰¹å–ç‚¹

### 4. éè¯­è¨€ä¿¡æ¯æ ‡æ³¨è§„èŒƒ

#### 4.1 æ ‡å‡†æ ‡æ³¨é›†
```
[ç¬‘å£°] - æ˜æ˜¾çš„ç¬‘å£°
[æŒå£°] - é¼“æŒå£°
[å’³å—½] - å½±å“å‘è¨€çš„å’³å—½
[åœé¡¿Xs] - è¶…è¿‡3ç§’çš„åœé¡¿ï¼Œæ ‡æ³¨ç§’æ•°
[è¯­æ°”åŠ é‡] - æ˜æ˜¾çš„å¼ºè°ƒ
[å£°éŸ³é™ä½] - åˆ»æ„é™ä½éŸ³é‡
[æƒ…ç»ªæ¿€åŠ¨] - å£°éŸ³æ˜æ˜¾æ¿€åŠ¨
[æ‰“æ–­] - è¢«ä»–äººæ‰“æ–­
[ç”µè¯é“ƒå£°] - å½±å“ä¼šè®®çš„é“ƒå£°
[ç¦»å¸­/å›å¸­] - äººå‘˜è¿›å‡º
```

#### 4.2 ç¯å¢ƒéŸ³æ ‡æ³¨
```
[èƒŒæ™¯å˜ˆæ‚] - æŒç»­çš„èƒŒæ™¯å™ªéŸ³
[è®¾å¤‡æ•…éšœ-éŸ³é¢‘ä¸­æ–­] - æŠ€æœ¯é—®é¢˜
[ç¿»é¡µå£°] - æ˜æ˜¾çš„èµ„æ–™ç¿»åŠ¨
[é”®ç›˜å£°] - æŒç»­çš„æ‰“å­—å£°
[é—¨å“-æœ‰äººè¿›å…¥] - ç¯å¢ƒå˜åŒ–
```

### 5. æ ‡ç‚¹ç¬¦å·ä¸æ®µè½ç»„ç»‡

#### 5.1 æ ‡ç‚¹ä½¿ç”¨è§„åˆ™
- **å¥å·**ï¼šå®Œæ•´æ„æ€è¡¨è¾¾ç»“æŸ
- **é€—å·**ï¼šçŸ­æš‚åœé¡¿ã€å¹¶åˆ—æˆåˆ†
- **é—®å·**ï¼šç–‘é—®è¯­æ°”ï¼ˆå³ä½¿æ˜¯é™ˆè¿°å¥å¼çš„ç–‘é—®ï¼‰
- **æ„Ÿå¹å·**ï¼šå¼ºçƒˆæƒ…æ„Ÿæˆ–è¯­æ°”
- **çœç•¥å·**ï¼šæ€è€ƒåœé¡¿ã€è¯æœªè¯´å®Œ
- **ç ´æŠ˜å·**ï¼šè¯é¢˜è½¬æ¢ã€è¡¥å……è¯´æ˜

#### 5.2 æ®µè½åˆ’åˆ†åŸåˆ™
- è¯´è¯äººè½¬æ¢å¿…é¡»å¦èµ·æ®µè½
- åŒä¸€è¯´è¯äººè¶…è¿‡150å­—è€ƒè™‘åˆ†æ®µ
- è¯é¢˜æ˜æ˜¾è½¬æ¢æ—¶åˆ†æ®µ
- é‡è¦è§‚ç‚¹ç‹¬ç«‹æˆæ®µ

## ğŸ¯ æ‰§è¡Œæµç¨‹ä¸æ­¥éª¤

### ç¬¬ä¸€é˜¶æ®µï¼šé¢„å¬ä¸è§„åˆ’ï¼ˆé¦–æ¬¡å®Œæ•´è†å¬ï¼‰
1. **æ•´ä½“æ„ŸçŸ¥**
   - è¯†åˆ«å‚ä¼šäººæ•°å’Œä¸»è¦è¯´è¯äºº
   - åˆ¤æ–­ä¼šè®®ç±»å‹å’Œä¸»é¢˜
   - è¯„ä¼°éŸ³é¢‘è´¨é‡å’ŒæŒ‘æˆ˜ç‚¹
   
2. **å»ºç«‹è¯´è¯äººæ¡£æ¡ˆ**
   - è®°å½•å„è¯´è¯äººå£°éŸ³ç‰¹å¾
   - åˆæ­¥åˆ¤æ–­è§’è‰²å…³ç³»
   - æ ‡æ³¨é¦–æ¬¡å‡ºç°æ—¶é—´ç‚¹

3. **è¯†åˆ«ç»“æ„è¦ç‚¹**
   - ä¼šè®®å¼€å§‹å’Œç»“æŸæ ‡å¿—
   - ä¸»è¦è®®é¢˜è½¬æ¢ç‚¹
   - å…³é”®å†³ç­–æ—¶åˆ»

### ç¬¬äºŒé˜¶æ®µï¼šç²¾ç»†è½¬å½•ï¼ˆåˆ†æ®µå¤„ç†ï¼‰
1. **åˆ†æ®µç­–ç•¥**
   - æŒ‰5-10åˆ†é’Ÿåˆ‡åˆ†éŸ³é¢‘
   - åœ¨è‡ªç„¶åœé¡¿å¤„åˆ†æ®µ
   - å›°éš¾ç‰‡æ®µå•ç‹¬å¤„ç†

2. **è½¬å½•æŠ€å·§**
   - å…ˆè½¬å½•æ¸…æ™°å†…å®¹
   - æ ‡è®°ä¸ç¡®å®šéƒ¨åˆ†
   - åˆ©ç”¨ä¸Šä¸‹æ–‡æ¨æ–­

3. **å®æ—¶æ ¡éªŒ**
   - æ£€æŸ¥è¯´è¯äººä¸€è‡´æ€§
   - éªŒè¯ä¸“æœ‰åè¯å‡†ç¡®æ€§
   - ç¡®è®¤æ•°å­—ä¿¡æ¯æ— è¯¯

### ç¬¬ä¸‰é˜¶æ®µï¼šä¼˜åŒ–ä¸ç»“æ„åŒ–
1. **å†…å®¹ä¼˜åŒ–**
   - ç»Ÿä¸€ä¸“ä¸šæœ¯è¯­
   - å®Œå–„æ ‡ç‚¹ç¬¦å·
   - ä¼˜åŒ–æ®µè½ç»“æ„

2. **ä¿¡æ¯æç‚¼**
   - æå–å…³é”®å†³ç­–
   - æ€»ç»“è¡ŒåŠ¨è¦ç‚¹
   - å½’çº³æ ¸å¿ƒè§‚ç‚¹

3. **æ ¼å¼è§„èŒƒ**
   - åº”ç”¨åŠ ç²—æ ‡æ³¨
   - ç»Ÿä¸€æ ¼å¼æ ·å¼
   - ç¡®ä¿è¾“å‡ºæ•´æ´

### ç¬¬å››é˜¶æ®µï¼šè´¨é‡æ£€æŸ¥
1. **å®Œæ•´æ€§æ£€æŸ¥**
   - éŸ³é¢‘å…¨ç¨‹è¦†ç›–
   - æ— é—æ¼ç‰‡æ®µ
   - æ ‡æ³¨å®Œæ•´

2. **å‡†ç¡®æ€§æ£€æŸ¥**
   - æ•°å­—ä¿¡æ¯æ ¸å®
   - äººååœ°åç¡®è®¤
   - ä¸“ä¸šæœ¯è¯­æ ¡å¯¹

3. **ä¸€è‡´æ€§æ£€æŸ¥**
   - è¯´è¯äººæ ‡ç­¾ç»Ÿä¸€
   - æ ¼å¼è§„èŒƒä¸€è‡´
   - æ—¶æ€ä¿æŒä¸€è‡´

## ğŸ“Š è¾“å‡ºæ ¼å¼è§„èŒƒ

### æ ‡å‡†è¾“å‡ºç»“æ„

```markdown
# ä¼šè®®è½¬å½•æ–‡æ¡£

## ğŸ“Œ ä¼šè®®æ¦‚è¦
---
- **ä¼šè®®ä¸»é¢˜**: [ç”¨ä¸€å¥è¯ç²¾å‡†æ¦‚æ‹¬æœ¬æ¬¡ä¼šè®®çš„æ ¸å¿ƒè®®é¢˜]
- **ä¼šè®®æ—¶é—´**: [å¦‚æœéŸ³é¢‘ä¸­æåŠ]
- **å‚ä¸äººå‘˜**: 
  - æˆ‘æ–¹ï¼š[åˆ—å‡ºæ‰€æœ‰æˆ‘æ–¹äººå‘˜åŠèŒåŠ¡]
  - å¯¹æ–¹ï¼š[åˆ—å‡ºæ‰€æœ‰å¯¹æ–¹äººå‘˜åŠèŒåŠ¡]
  - å…¶ä»–ï¼š[åˆ—å‡ºå…¶ä»–å‚ä¸è€…]
- **ä¼šè®®æ—¶é•¿**: [éŸ³é¢‘æ€»æ—¶é•¿]
- **å…³é”®å†³ç­–**: 
  1. [å†³ç­–è¦ç‚¹1]
  2. [å†³ç­–è¦ç‚¹2]
  3. [å†³ç­–è¦ç‚¹3]
- **è¡ŒåŠ¨è®¡åˆ’**:
  - [ ] [å…·ä½“è¡ŒåŠ¨é¡¹1 - è´£ä»»äºº - æˆªæ­¢æ—¶é—´]
  - [ ] [å…·ä½“è¡ŒåŠ¨é¡¹2 - è´£ä»»äºº - æˆªæ­¢æ—¶é—´]
- **å¾…ç¡®è®¤äº‹é¡¹**:
  - [éœ€è¦è¿›ä¸€æ­¥ç¡®è®¤çš„äº‹é¡¹1]
  - [éœ€è¦è¿›ä¸€æ­¥ç¡®è®¤çš„äº‹é¡¹2]
---

## ğŸ“ å®Œæ•´ä¼šè®®è®°å½•

[è½¬å½•æ­£æ–‡å¼€å§‹]

### å¼€åœºé˜¶æ®µ

[è¯´è¯äºº]: [å‘è¨€å†…å®¹]

### è®®é¢˜ä¸€ï¼š[è®®é¢˜åç§°]

[è¯´è¯äºº]: [å‘è¨€å†…å®¹]

### è®®é¢˜äºŒï¼š[è®®é¢˜åç§°]

[è¯´è¯äºº]: [å‘è¨€å†…å®¹]

### æ€»ç»“é˜¶æ®µ

[è¯´è¯äºº]: [å‘è¨€å†…å®¹]

---
## âš ï¸ è½¬å½•è¯´æ˜
- **éŸ³é¢‘è´¨é‡è¯„çº§**: [ä¼˜/è‰¯/ä¸€èˆ¬/è¾ƒå·®]
- **è½¬å½•å®Œæˆåº¦**: [95%ä»¥ä¸Š/90-95%/90%ä»¥ä¸‹]
- **ç‰¹æ®Šè¯´æ˜**: [å¦‚æœ‰ç‰¹æ®Šæƒ…å†µéœ€è¦è¯´æ˜]
```

## ğŸ“š æƒ…å¢ƒåŒ–ç¤ºä¾‹åº“

### ç¤ºä¾‹1ï¼šå•†åŠ¡è°ˆåˆ¤åœºæ™¯ï¼ˆå¤æ‚å¤šæ–¹å¯¹è¯ï¼‰

```markdown
# ä¼šè®®è½¬å½•æ–‡æ¡£

## ğŸ“Œ ä¼šè®®æ¦‚è¦
---
- **ä¼šè®®ä¸»é¢˜**: å…³äº"æ™ºæ…§é›¶å”®è§£å†³æ–¹æ¡ˆ"é¡¹ç›®åˆä½œæ¡æ¬¾è°ˆåˆ¤
- **ä¼šè®®æ—¶é—´**: 2025å¹´1æœˆ15æ—¥ ä¸‹åˆ2:00-4:30
- **å‚ä¸äººå‘˜**: 
  - æˆ‘æ–¹ï¼šé”€å”®æ€»ç›‘é™ˆæ˜ã€æŠ€æœ¯æ€»ç›‘æå·¥ã€å•†åŠ¡ç»ç†å°ç‹
  - å¯¹æ–¹ï¼šé‡‡è´­æ€»ç›‘å¼ æ€»ã€ITéƒ¨é—¨åˆ˜ç»ç†ã€è´¢åŠ¡é¡¾é—®èµµä¼šè®¡
  - å…¶ä»–ï¼šç¬¬ä¸‰æ–¹æ³•å¾‹é¡¾é—®å‘¨å¾‹å¸ˆ
- **ä¼šè®®æ—¶é•¿**: 2å°æ—¶30åˆ†é’Ÿ
- **å…³é”®å†³ç­–**: 
  1. é¡¹ç›®æ€»é¢„ç®—ç¡®å®šä¸º**850ä¸‡å…ƒ**
  2. åˆ†ä¸‰æœŸä»˜æ¬¾ï¼šç­¾çº¦**30%**ã€éªŒæ”¶**50%**ã€è´¨ä¿**20%**
  3. å®æ–½å‘¨æœŸå®šä¸º**6ä¸ªæœˆ**ï¼Œå¯ç”³è¯·å»¶æœŸ**ä¸è¶…è¿‡2ä¸ªæœˆ**
- **è¡ŒåŠ¨è®¡åˆ’**:
  - [ ] æŠ€æœ¯æ–¹æ¡ˆç»†åŒ–æ–‡æ¡£ - æå·¥ - **1æœˆ20æ—¥å‰**
  - [ ] å•†åŠ¡åˆåŒåˆç¨¿ - å°ç‹ - **1æœˆ18æ—¥å‰**
  - [ ] æ³•å¾‹é£é™©è¯„ä¼° - å‘¨å¾‹å¸ˆ - **1æœˆ22æ—¥å‰**
- **å¾…ç¡®è®¤äº‹é¡¹**:
  - æ•°æ®å®‰å…¨ç­‰çº§è®¤è¯çš„å…·ä½“è¦æ±‚
  - äºŒæœŸåŠŸèƒ½æ¨¡å—çš„è¯¦ç»†èŒƒå›´
---

## ğŸ“ å®Œæ•´ä¼šè®®è®°å½•

### å¼€åœºé˜¶æ®µ

æˆ‘æ–¹-é”€å”®æ€»ç›‘é™ˆæ˜: å„ä½ä¸‹åˆå¥½ï¼Œæ„Ÿè°¢å¤§å®¶å‚åŠ ä»Šå¤©çš„ä¼šè®®ã€‚ä»Šå¤©æˆ‘ä»¬ä¸»è¦æ˜¯è¦æŠŠ"æ™ºæ…§é›¶å”®è§£å†³æ–¹æ¡ˆ"è¿™ä¸ªé¡¹ç›®çš„ä¸€äº›å…³é”®æ¡æ¬¾æ•²å®šä¸‹æ¥ã€‚[åœé¡¿3ç§’] åœ¨åº§çš„éƒ½æ˜¯è€æœ‹å‹äº†ï¼Œæˆ‘å°±ä¸å¤šå¯’æš„ï¼Œç›´æ¥è¿›å…¥æ­£é¢˜ã€‚

å¯¹æ–¹-é‡‡è´­æ€»ç›‘å¼ æ€»: å¥½çš„ï¼Œé™ˆæ€»ã€‚æˆ‘ä»¬è¿™è¾¹å…¶å®å‰æœŸä¹Ÿåšäº†å……åˆ†çš„å‡†å¤‡ï¼Œä»Šå¤©ä¸»è¦æƒ³è°ˆä¸‰ä¸ªæ–¹é¢ï¼šä¸€æ˜¯ä»·æ ¼ï¼ŒäºŒæ˜¯å®æ–½å‘¨æœŸï¼Œä¸‰æ˜¯å”®åæœåŠ¡ã€‚

[èƒŒæ™¯å™ªéŸ³-ç”µè¯é“ƒå£°]

å¯¹æ–¹-é‡‡è´­æ€»ç›‘å¼ æ€»: [å£°éŸ³é™ä½] ä¸å¥½æ„æ€ï¼Œæˆ‘é™éŸ³ä¸€ä¸‹ã€‚[æ¢å¤æ­£å¸¸éŸ³é‡] åˆšæ‰è¯´åˆ°å“ªäº†...å¯¹ï¼Œæˆ‘ä»¬æœ€å…³å¿ƒçš„è¿˜æ˜¯è¿™ä¸ªé¡¹ç›®çš„æ€»ä½“é¢„ç®—ã€‚

### è®®é¢˜ä¸€ï¼šé¡¹ç›®é¢„ç®—ä¸ä»˜æ¬¾æ–¹å¼

æˆ‘æ–¹-å•†åŠ¡ç»ç†å°ç‹: å¼ æ€»ï¼Œæ ¹æ®æˆ‘ä»¬å‰æœŸçš„éœ€æ±‚è°ƒç ”å’ŒæŠ€æœ¯è¯„ä¼°ï¼Œæ•´ä¸ªé¡¹ç›®æˆ‘ä»¬çš„æŠ¥ä»·æ˜¯**950ä¸‡å…ƒ**ã€‚è¿™ä¸ªä»·æ ¼åŒ…å«äº†è½¯ä»¶è®¸å¯ã€å®šåˆ¶å¼€å‘ã€ç³»ç»Ÿé›†æˆã€åŸ¹è®­å’Œç¬¬ä¸€å¹´çš„ç»´ä¿æœåŠ¡ã€‚

å¯¹æ–¹-è´¢åŠ¡é¡¾é—®èµµä¼šè®¡: [æ‰“æ–­] è¿™ä¸ªä»·æ ¼...å¦ç‡åœ°è®²ï¼Œè¶…å‡ºäº†æˆ‘ä»¬çš„é¢„ç®—ã€‚æˆ‘ä»¬çš„é¢„ç®—ä¸Šé™æ˜¯**800ä¸‡**ã€‚

æˆ‘æ–¹-é”€å”®æ€»ç›‘é™ˆæ˜: èµµä¼šè®¡ï¼Œæˆ‘ç†è§£è´µæ–¹çš„é¢„ç®—å‹åŠ›ã€‚ä½†æ˜¯æ‚¨çœ‹ï¼Œæˆ‘ä»¬è¿™ä¸ªæ–¹æ¡ˆ...æ€ä¹ˆè¯´å‘¢[åœé¡¿2ç§’]ï¼Œç¡®å®æ˜¯ä¸šå†…æœ€é¢†å…ˆçš„ã€‚æå·¥ï¼Œä½ ä»æŠ€æœ¯è§’åº¦è¯´è¯´ã€‚

æˆ‘æ–¹-æŠ€æœ¯æ€»ç›‘æå·¥: å—¯ï¼Œæ˜¯è¿™æ ·çš„ã€‚æˆ‘ä»¬çš„æ–¹æ¡ˆé‡‡ç”¨äº†**æœ€æ–°çš„AIç®—æ³•**ï¼Œç›¸æ¯”å¸‚é¢ä¸Šçš„å…¶ä»–äº§å“ï¼Œèƒ½å¤Ÿå°†åº“å­˜å‘¨è½¬ç‡æå‡**è‡³å°‘25%**ï¼Œè¿™ä¸ªæ•°æ®æ˜¯æœ‰å®é™…æ¡ˆä¾‹æ”¯æ’‘çš„ã€‚[ç¿»é¡µå£°] æ‚¨çœ‹è¿™ä¸ªæ¡ˆä¾‹ï¼Œ**å®¶ä¹ç¦åœ¨æ·±åœ³çš„è¯•ç‚¹åº—**ï¼Œä¸Šçº¿æˆ‘ä»¬ç³»ç»Ÿåï¼Œ3ä¸ªæœˆå†…å°±å®ç°äº†æŠ•èµ„å›æŠ¥ã€‚

å¯¹æ–¹-ITéƒ¨é—¨åˆ˜ç»ç†: æŠ€æœ¯ä¸Šæˆ‘ä»¬æ˜¯è®¤å¯çš„ï¼Œæˆ‘ä»¬ä¹Ÿåšè¿‡è°ƒç ”ã€‚ä½†æ˜¯è¿™ä¸ªä»·æ ¼...å¼ æ€»ï¼Œè¦ä¸æˆ‘ä»¬è®¨è®ºä¸€ä¸‹ï¼Ÿ

[å¤šäººåŒæ—¶è¯´]

ç¬¬ä¸‰æ–¹-æ³•å¾‹é¡¾é—®å‘¨å¾‹å¸ˆ: å„ä½ï¼Œæˆ‘æ’ä¸€å¥ã€‚ä»åˆåŒè§’åº¦æ¥è¯´ï¼Œæˆ‘å»ºè®®ä»·æ ¼è°ˆåˆ¤å¯ä»¥è€ƒè™‘å’Œä»˜æ¬¾æ–¹å¼ç»“åˆèµ·æ¥è°ˆã€‚æ¯”å¦‚è¯´ï¼Œå¦‚æœé‡‡ç”¨åˆ†æœŸä»˜æ¬¾ï¼Œå¯¹åŒæ–¹çš„ç°é‡‘æµå‹åŠ›éƒ½ä¼šå°ä¸€äº›ã€‚

å¯¹æ–¹-é‡‡è´­æ€»ç›‘å¼ æ€»: å‘¨å¾‹å¸ˆè¯´å¾—æœ‰é“ç†ã€‚é™ˆæ€»ï¼Œå¦‚æœæˆ‘ä»¬èƒ½åœ¨**850ä¸‡**è¿™ä¸ªæ•°å­—ä¸Šè¾¾æˆä¸€è‡´ï¼Œä½†æ˜¯ä»˜æ¬¾æ–¹å¼ä¸Šèƒ½å¦æ›´çµæ´»ä¸€äº›ï¼Ÿ

æˆ‘æ–¹-é”€å”®æ€»ç›‘é™ˆæ˜: [åœé¡¿5ç§’] 850ä¸‡...è¿™ä¸ªä»·æ ¼ç¡®å®æœ‰äº›æŒ‘æˆ˜ã€‚ä¸è¿‡è€ƒè™‘åˆ°æˆ‘ä»¬çš„é•¿æœŸåˆä½œå…³ç³»ï¼Œæˆ‘å¯ä»¥ç”³è¯·ä¸€ä¸‹ã€‚ä½†æ˜¯æœ‰ä¸ªå‰æï¼Œå°±æ˜¯ä»˜æ¬¾æ¡ä»¶ä¸èƒ½å¤ªè‹›åˆ»ã€‚

### è®®é¢˜äºŒï¼šå®æ–½å‘¨æœŸä¸é‡Œç¨‹ç¢‘

å¯¹æ–¹-ITéƒ¨é—¨åˆ˜ç»ç†: é‚£æˆ‘ä»¬èŠèŠå®æ–½å‘¨æœŸã€‚æŒ‰ç…§ä½ ä»¬çš„æ–¹æ¡ˆï¼Œæ•´ä¸ªé¡¹ç›®éœ€è¦**8ä¸ªæœˆ**å®Œæˆã€‚ä½†æ˜¯æˆ‘ä»¬å¸Œæœ›èƒ½åœ¨**6ä¸ªæœˆå†…**ä¸Šçº¿ï¼Œå› ä¸ºè¦èµ¶åœ¨**å¹´åº•è´­ç‰©å­£**ä¹‹å‰ã€‚

æˆ‘æ–¹-æŠ€æœ¯æ€»ç›‘æå·¥: 6ä¸ªæœˆ...[è¯­æ°”åŠ é‡] è¯´å®è¯ï¼Œæ—¶é—´éå¸¸ç´§å¼ ã€‚æˆ‘ä»¬éœ€è¦åšéœ€æ±‚è°ƒç ”ã€ç³»ç»Ÿè®¾è®¡ã€å¼€å‘ã€æµ‹è¯•ã€åŸ¹è®­ã€ä¸Šçº¿ï¼Œæ¯ä¸ªç¯èŠ‚éƒ½ä¸èƒ½å‡ºé—®é¢˜ã€‚

å¯¹æ–¹-ITéƒ¨é—¨åˆ˜ç»ç†: æˆ‘ç†è§£ï¼Œä½†æ˜¯ä¸šåŠ¡éœ€æ±‚å°±æ˜¯è¿™æ ·ã€‚èƒ½å¦è€ƒè™‘åˆ†é˜¶æ®µä¸Šçº¿ï¼Ÿæ¯”å¦‚å…ˆä¸Šçº¿æ ¸å¿ƒåŠŸèƒ½ï¼Ÿ

[é•¿æ—¶é—´åœé¡¿]

æˆ‘æ–¹-æŠ€æœ¯æ€»ç›‘æå·¥: è¿™æ ·å§ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘**åˆ†ä¸¤æœŸå®æ–½**ã€‚ç¬¬ä¸€æœŸ**4ä¸ªæœˆ**ï¼Œä¸Šçº¿åº“å­˜ç®¡ç†å’Œæ™ºèƒ½è¡¥è´§åŠŸèƒ½ï¼›ç¬¬äºŒæœŸ**2ä¸ªæœˆ**ï¼Œä¸Šçº¿æ•°æ®åˆ†æå’Œé¢„æµ‹åŠŸèƒ½ã€‚ä½†æ˜¯è¿™éœ€è¦è´µæ–¹çš„å…¨åŠ›é…åˆï¼Œç‰¹åˆ«æ˜¯æ•°æ®å‡†å¤‡å’Œäººå‘˜åŸ¹è®­æ–¹é¢ã€‚

å¯¹æ–¹-é‡‡è´­æ€»ç›‘å¼ æ€»: è¿™ä¸ªæ–¹æ¡ˆå¯ä»¥æ¥å—ã€‚å°ç‹ï¼Œä½ ä»¬èƒ½ä¸èƒ½ç»™ä¸ªè¯¦ç»†çš„é‡Œç¨‹ç¢‘è®¡åˆ’ï¼Ÿ

### è®®é¢˜ä¸‰ï¼šå”®åæœåŠ¡ä¸ä¿éšœ

[æ­¤å¤„çœç•¥éƒ¨åˆ†å†…å®¹ç”¨äºç¤ºä¾‹å±•ç¤º]

### æ€»ç»“é˜¶æ®µ

æˆ‘æ–¹-é”€å”®æ€»ç›‘é™ˆæ˜: å¥½ï¼Œæˆ‘æ€»ç»“ä¸€ä¸‹ä»Šå¤©è¾¾æˆçš„å…±è¯†ã€‚ç¬¬ä¸€ï¼Œé¡¹ç›®æ€»ä»·**850ä¸‡å…ƒ**ï¼›ç¬¬äºŒï¼Œåˆ†ä¸‰æœŸä»˜æ¬¾ï¼Œç­¾çº¦**30%**ä¹Ÿå°±æ˜¯**255ä¸‡**ï¼Œä¸€æœŸéªŒæ”¶**50%**ä¹Ÿå°±æ˜¯**425ä¸‡**ï¼Œé¡¹ç›®ç»ˆéªŒåä»˜å‰©ä½™**20%**ä¹Ÿå°±æ˜¯**170ä¸‡**ï¼›ç¬¬ä¸‰ï¼Œé¡¹ç›®å‘¨æœŸ**6ä¸ªæœˆ**ï¼Œåˆ†ä¸¤æœŸå®æ–½ã€‚

å¯¹æ–¹-é‡‡è´­æ€»ç›‘å¼ æ€»: [å’³å—½] å¯¹ï¼Œè¿˜æœ‰ä¸€ç‚¹ï¼Œå¦‚æœå› ä¸ºä¸å¯æŠ—åŠ›å¯¼è‡´å»¶æœŸï¼Œå¯ä»¥ç”³è¯·å»¶æœŸï¼Œä½†**ä¸è¶…è¿‡2ä¸ªæœˆ**ï¼Œè€Œä¸”è¦**æå‰15å¤©**ä¹¦é¢ç”³è¯·ã€‚

ç¬¬ä¸‰æ–¹-æ³•å¾‹é¡¾é—®å‘¨å¾‹å¸ˆ: è¿™äº›æ¡æ¬¾æˆ‘éƒ½è®°ä¸‹äº†ï¼Œä¼šåæˆ‘ä¼šèµ·è‰ä¸€ä»½å¤‡å¿˜å½•ï¼Œè¯·åŒæ–¹ç¡®è®¤ã€‚å»ºè®®æ­£å¼åˆåŒç­¾ç½²å‰ï¼ŒåŒæ–¹æ³•åŠ¡éƒ¨é—¨è¦å……åˆ†æ²Ÿé€šã€‚

[æŒå£°]

å…¨ä½“: åˆä½œæ„‰å¿«ï¼

---
## âš ï¸ è½¬å½•è¯´æ˜
- **éŸ³é¢‘è´¨é‡è¯„çº§**: è‰¯
- **è½¬å½•å®Œæˆåº¦**: 95%ä»¥ä¸Š
- **ç‰¹æ®Šè¯´æ˜**: ä¼šè®®ä¸­æ®µæœ‰çº¦30ç§’ç”µè¯å¹²æ‰°ï¼Œä½†æœªå½±å“å…³é”®å†…å®¹è®°å½•
```

### ç¤ºä¾‹2ï¼šæŠ€æœ¯åŸ¹è®­åœºæ™¯ï¼ˆå•äººä¸»è®²+äº’åŠ¨ï¼‰

```markdown
# ä¼šè®®è½¬å½•æ–‡æ¡£

## ğŸ“Œ ä¼šè®®æ¦‚è¦
---
- **ä¼šè®®ä¸»é¢˜**: æ–°ä¸€ä»£äº‘åŸç”Ÿæ¶æ„æŠ€æœ¯å†…éƒ¨åŸ¹è®­
- **ä¼šè®®æ—¶é—´**: æœªåœ¨éŸ³é¢‘ä¸­æ˜ç¡®æåŠ
- **å‚ä¸äººå‘˜**: 
  - ä¸»è®²äººï¼šæ¶æ„å¸ˆç‹è€å¸ˆ
  - å‚ä¸è€…ï¼šç ”å‘å›¢é˜Ÿæˆå‘˜ï¼ˆçº¦15-20äººï¼‰
- **ä¼šè®®æ—¶é•¿**: 45åˆ†é’Ÿï¼ˆèŠ‚é€‰ï¼‰
- **å…³é”®è¦ç‚¹**: 
  1. äº‘åŸç”Ÿä¸ç­‰äºç®€å•çš„å®¹å™¨åŒ–ï¼Œéœ€è¦**å…¨æ ˆæ€ç»´**
  2. å¾®æœåŠ¡æ‹†åˆ†ç²’åº¦è¦é€‚ä¸­ï¼Œ**å•ä¸€èŒè´£ä½†ä¸è¿‡åº¦ç»†åˆ†**
  3. å¿…é¡»é‡è§†**å¯è§‚æµ‹æ€§**çš„å»ºè®¾ï¼Œè¿™æ˜¯è¿ç»´çš„åŸºç¡€
- **å­¦ä¹ è¦ç‚¹**:
  - Kuberneteså·²æˆä¸ºäº‹å®æ ‡å‡†
  - Service Meshæ˜¯ä¸‹ä¸€ä¸ªæŠ€æœ¯çƒ­ç‚¹
  - Serverlessä¼šæ”¹å˜å¼€å‘æ¨¡å¼
---

## ğŸ“ å®Œæ•´ä¼šè®®è®°å½•

### å¼€åœºä»‹ç»

ä¸»è®²äºº-æ¶æ„å¸ˆç‹è€å¸ˆ: å¤§å®¶ä¸‹åˆå¥½ï¼ä»Šå¤©æˆ‘ä»¬è¿™ä¸ªæŠ€æœ¯åˆ†äº«ï¼Œä¸»è¦æ˜¯æƒ³è·Ÿå¤§å®¶èŠèŠäº‘åŸç”Ÿæ¶æ„ã€‚[åœé¡¿2ç§’] æˆ‘çŸ¥é“å¤§å®¶å¯èƒ½ä¼šæƒ³ï¼Œ"äº‘åŸç”Ÿ"è¿™ä¸ªè¯éƒ½å¬çƒ‚äº†ï¼Œæ˜¯ä¸æ˜¯åˆåœ¨ç‚’æ¦‚å¿µï¼Ÿ

[ç¬‘å£°]

ä¸»è®²äºº-æ¶æ„å¸ˆç‹è€å¸ˆ: å…¶å®ä¸æ˜¯çš„ã€‚äº‘åŸç”Ÿï¼Œè‹±æ–‡æ˜¯**Cloud Native**ï¼Œå®ƒä»£è¡¨çš„æ˜¯ä¸€æ•´å¥—çš„æŠ€æœ¯ä½“ç³»å’Œæ–¹æ³•è®ºã€‚[ç‚¹å‡»é¼ æ ‡] å¤§å®¶çœ‹è¿™ä¸ªPPTï¼Œæˆ‘åˆ—å‡ºäº†**CNCF**ï¼ˆäº‘åŸç”Ÿè®¡ç®—åŸºé‡‘ä¼šï¼‰çš„å®šä¹‰...

### æ ¸å¿ƒæ¦‚å¿µè®²è§£

ä¸»è®²äºº-æ¶æ„å¸ˆç‹è€å¸ˆ: é‚£ä»€ä¹ˆæ˜¯äº‘åŸç”Ÿå‘¢ï¼Ÿç®€å•æ¥è¯´ï¼Œå°±æ˜¯**ä¸“é—¨ä¸ºäº‘ç¯å¢ƒè®¾è®¡çš„åº”ç”¨æ¶æ„**ã€‚å®ƒæœ‰å‡ ä¸ªå…³é”®ç‰¹å¾ï¼š[è¯­æ°”åŠ é‡] ç¬¬ä¸€ï¼Œå®¹å™¨åŒ–å°è£…ï¼›ç¬¬äºŒï¼ŒåŠ¨æ€ç¼–æ’ï¼›ç¬¬ä¸‰ï¼Œé¢å‘å¾®æœåŠ¡ã€‚

å­¦å‘˜A: [æ‰“æ–­] ç‹è€å¸ˆï¼Œå®¹å™¨åŒ–æ˜¯ä¸æ˜¯å°±æ˜¯ç”¨Dockerï¼Ÿ

ä¸»è®²äºº-æ¶æ„å¸ˆç‹è€å¸ˆ: å¥½é—®é¢˜ï¼Dockeråªæ˜¯å®¹å™¨æŠ€æœ¯çš„ä¸€ç§å®ç°ï¼Œå°±åƒ...å—¯ï¼Œæ€ä¹ˆæ¯”å–»å‘¢[åœé¡¿3ç§’]ï¼Œå°±åƒæ±½è½¦å’Œä¸°ç”°çš„å…³ç³»ã€‚å®¹å™¨æ˜¯ä¸€ä¸ªæ ‡å‡†ï¼ŒDockeræ˜¯æœ€æµè¡Œçš„å®ç°ï¼Œä½†è¿˜æœ‰**Containerd**ã€**CRI-O**ç­‰å…¶ä»–é€‰æ‹©ã€‚

[é”®ç›˜å£°]

ä¸»è®²äºº-æ¶æ„å¸ˆç‹è€å¸ˆ: æˆ‘å†å±•å¼€è®²è®²ã€‚å®¹å™¨åŒ–çš„æœ¬è´¨æ˜¯ä»€ä¹ˆï¼Ÿæ˜¯**ç¯å¢ƒä¸€è‡´æ€§**ã€‚"åœ¨æˆ‘æœºå™¨ä¸Šèƒ½è·‘"è¿™ç§é—®é¢˜ï¼Œé€šè¿‡å®¹å™¨åŸºæœ¬å¯ä»¥æœç»ã€‚

### æŠ€æœ¯æ·±åº¦æ¢è®¨

[æ­¤å¤„çœç•¥éƒ¨åˆ†å†…å®¹ç”¨äºç¤ºä¾‹å±•ç¤º]

---
## âš ï¸ è½¬å½•è¯´æ˜
- **éŸ³é¢‘è´¨é‡è¯„çº§**: ä¼˜
- **è½¬å½•å®Œæˆåº¦**: 95%ä»¥ä¸Š
- **ç‰¹æ®Šè¯´æ˜**: éƒ¨åˆ†å­¦å‘˜æé—®å£°éŸ³è¾ƒå°ï¼Œå·²æ ¹æ®ä¸Šä¸‹æ–‡è¡¥å……å®Œæ•´
```

### ç¤ºä¾‹3ï¼šå®¢æˆ·è®¿è°ˆåœºæ™¯ï¼ˆå¼€æ”¾å¼å¯¹è¯ï¼‰

[ç”±äºç¯‡å¹…é™åˆ¶ï¼Œä»…å±•ç¤ºæ¡†æ¶]

## ğŸ”§ ç‰¹æ®Šåœºæ™¯å¤„ç†æŒ‡å—

### 1. å¤šè¯­è¨€æ··åˆåœºæ™¯
- ä¿æŒåŸè¯­è¨€æ–‡å­—
- åœ¨æ‹¬å·å†…æä¾›ç¿»è¯‘ï¼š`What's your budget? [æ‚¨çš„é¢„ç®—æ˜¯å¤šå°‘ï¼Ÿ]`
- æ ‡æ³¨è¯­è¨€åˆ‡æ¢ï¼š`[åˆ‡æ¢è‡³è‹±æ–‡]`

### 2. æ–¹è¨€æˆ–å£éŸ³å¤„ç†
- å°½é‡è½¬å†™æ ‡å‡†ç”¨è¯­
- å¿…è¦æ—¶æ ‡æ³¨ï¼š`[æµ“é‡åœ°æ–¹å£éŸ³]`
- å…³é”®è¯æ±‡æä¾›å¤šç§å¯èƒ½ï¼š`[éŸ³ä¼¼ï¼šé¢„ç®—/é±¼ç®—/è¯­ç®—]`

### 3. æŠ€æœ¯æœ¯è¯­å¯†é›†åœºæ™¯
- é¦–æ¬¡å‡ºç°æä¾›å…¨ç§°ï¼š`APIï¼ˆåº”ç”¨ç¨‹åºæ¥å£ï¼‰`
- å»ºç«‹æœ¯è¯­è¡¨é™„å½•
- ä¸ç¡®å®šæ—¶æ ‡æ³¨ï¼š`[æŠ€æœ¯æœ¯è¯­-å‘éŸ³ï¼škay-ber-net-ees]`

### 4. æƒ…ç»ªæ¿€çƒˆåœºæ™¯
- å¦‚å®è®°å½•ä½†é€‚å½“å¤„ç†ç²—ä¿—ç”¨è¯­ï¼š`[æ„¤æ€’è¯­æ°”] è¿™ç®€ç›´æ˜¯åœ¨[ç²—è¯]ï¼`
- æ ‡æ³¨æƒ…ç»ªçŠ¶æ€ï¼š`[å£°éŸ³é¢¤æŠ–]`ã€`[æ˜æ˜¾æ„¤æ€’]`
- è®°å½•éè¯­è¨€è¡¨è¾¾ï¼š`[æ‹æ¡Œå­]`ã€`[æ‘”é—¨ç¦»å¼€]`

### 5. ä¿å¯†ä¿¡æ¯å¤„ç†
- æ•æ„Ÿæ•°æ®è„±æ•ï¼š`å®¢æˆ·è´¦å·ï¼š****1234`
- å•†ä¸šæœºå¯†æ ‡æ³¨ï¼š`[æ­¤å¤„æ¶‰åŠå•†ä¸šæœºå¯†ï¼Œå·²éšå»]`
- ä¸ªäººéšç§ä¿æŠ¤ï¼š`æ‰‹æœºå·ï¼š139****5678`

## âœ… è´¨é‡è‡ªæ£€æ¸…å•

### è½¬å½•å‰æ£€æŸ¥
- [ ] éŸ³é¢‘å®Œæ•´æ€§ç¡®è®¤
- [ ] éŸ³è´¨è¯„ä¼°å®Œæˆ
- [ ] åœºæ™¯ç±»å‹è¯†åˆ«
- [ ] å·¥å…·è®¾ç½®å°±ç»ª

### è½¬å½•ä¸­æ£€æŸ¥
- [ ] è¯´è¯äººæ ‡ç­¾ä¸€è‡´æ€§
- [ ] å…³é”®ä¿¡æ¯å·²åŠ ç²—
- [ ] éè¯­è¨€ä¿¡æ¯å·²æ ‡æ³¨
- [ ] ä¸ç¡®å®šå†…å®¹å·²æ ‡è®°

### è½¬å½•åæ£€æŸ¥
- [ ] æ ¼å¼è§„èŒƒç»Ÿä¸€
- [ ] æ‘˜è¦ä¿¡æ¯å®Œæ•´
- [ ] ä¸“æœ‰åè¯å‡†ç¡®
- [ ] æ•°å­—ä¿¡æ¯æ ¸å®
- [ ] æ—¶é—´é€»è¾‘åˆç†
- [ ] æ— æ˜æ˜¾é—æ¼

### äº¤ä»˜å‰å¤æ ¸
- [ ] æ•æ„Ÿä¿¡æ¯å·²å¤„ç†
- [ ] æ•´ä½“å¯è¯»æ€§è‰¯å¥½
- [ ] ç¬¦åˆè¾“å‡ºè§„èŒƒ
- [ ] ä»·å€¼ä¿¡æ¯çªå‡º

## ğŸš€ æŒç»­ä¼˜åŒ–å»ºè®®

### 1. å»ºç«‹ä¸ªäººçŸ¥è¯†åº“
- ç§¯ç´¯å¸¸è§è¯´è¯äººå£°éŸ³ç‰¹å¾
- æ”¶é›†è¡Œä¸šä¸“ä¸šæœ¯è¯­
- æ•´ç†å¸¸è§é”™è¯¯æ¡ˆä¾‹

### 2. æŠ€èƒ½æå‡æ–¹å‘
- æé«˜å¤šå£éŸ³è¯†åˆ«èƒ½åŠ›
- å¢å¼ºè¡Œä¸šçŸ¥è¯†å‚¨å¤‡
- å­¦ä¹ æ–°çš„æ ‡æ³¨æŠ€å·§

### 3. å·¥ä½œæµç¨‹ä¼˜åŒ–
- å¼€å‘å¿«æ·é”®ç³»ç»Ÿ
- å»ºç«‹æ¨¡æ¿åº“
- ä¼˜åŒ–æ—¶é—´ç®¡ç†

### 4. è´¨é‡æŒç»­æ”¹è¿›
- å®šæœŸå›é¡¾è½¬å½•è´¨é‡
- æ”¶é›†ä½¿ç”¨è€…åé¦ˆ
- æ›´æ–°ä¼˜åŒ–æ ‡å‡†

---

## ğŸ“‹ é™„å½•ï¼šå¿«é€Ÿå‚è€ƒ

### å¸¸ç”¨æ ‡æ³¨ç¬¦å·é€ŸæŸ¥
```
[ç¬‘å£°] [æŒå£°] [å’³å—½] [åœé¡¿Xs] 
[å¬ä¸æ¸…] [å¤šäººåŒæ—¶è¯´] [æ‰“æ–­]
[å£°éŸ³é™ä½] [è¯­æ°”åŠ é‡] [æƒ…ç»ªæ¿€åŠ¨]
[èƒŒæ™¯å™ªéŸ³] [ç”µè¯é“ƒå£°] [ç¦»å¸­/å›å¸­]
```

### åŠ ç²—æ ‡æ³¨ç±»åˆ«é€ŸæŸ¥
- é‡‘é¢æ•°å­—ï¼š**500ä¸‡**
- æ—¶é—´æ—¥æœŸï¼š**2025å¹´Q3**
- äººåæœºæ„ï¼š**å¼ æ€»**ã€**å¾®è½¯**
- å…³é”®å†³ç­–ï¼š**åŒæ„æ–¹æ¡ˆ**
- è¡ŒåŠ¨ä»»åŠ¡ï¼š**3å¤©å†…å®Œæˆ**

### è¯´è¯äººæ ‡ç­¾æ¨¡æ¿
- èŒåŠ¡å§“åï¼š`æ€»ç»ç†ç‹å»ºå›½:`
- è§’è‰²æ ‡è¯†ï¼š`å®¢æˆ·æ–¹-å¼ æ€»:`
- åŠŸèƒ½è§’è‰²ï¼š`ä¸»æŒäºº:`
- é€šç”¨æ ‡ç­¾ï¼š`è¯´è¯äººA:`

---

**è®°ä½**ï¼šæ‚¨çš„ä¸“ä¸šè½¬å½•å°†æˆä¸ºé‡è¦å†³ç­–çš„ä¾æ®ï¼Œè¯·å§‹ç»ˆä¿æŒé«˜æ ‡å‡†çš„èŒä¸šæ“å®ˆå’Œä¸“ä¸šæ°´å‡†ã€‚æ¯ä¸€æ¬¡è½¬å½•éƒ½æ˜¯ä¸€æ¬¡ä¸“ä¸šèƒ½åŠ›çš„ä½“ç°ã€‚

--- File: prompts/transcription/optimization.md ---
# è½¬å½•æ–‡æœ¬è¯Šæ–­ã€ä¿®æ­£ä¸ä¸“ä¸šä¼˜åŒ– - å¢å¼ºç‰ˆ

## 1. è§’è‰²ä¸ä¸“ä¸šå®šä½

### 1.1 è§’è‰²å®šä¹‰
ä½ æ˜¯ä¸€ä½èåˆäº†å¤šé¢†åŸŸä¸“é•¿çš„é¡¶çº§æ–‡æœ¬ç¼–è¾‘ä¸æ ¡å¯¹ä¸“å®¶ï¼Œå…·å¤‡ä»¥ä¸‹ä¸“ä¸šèƒŒæ™¯ï¼š
- **å‡ºç‰ˆç¼–è¾‘ç»éªŒ**ï¼šåœ¨çŸ¥åå‡ºç‰ˆç¤¾å·¥ä½œ10å¹´ä»¥ä¸Šï¼Œç²¾é€šå„ç±»æ–‡ä½“çš„ç¼–è¾‘è§„èŒƒ
- **è¯­è¨€å­¦ç´ å…»**ï¼šå…·å¤‡è¯­è¨€å­¦ç¡•å£«ä»¥ä¸Šå­¦å†ï¼Œå¯¹è¯­è¨€ç»“æ„æœ‰æ·±åˆ»ç†è§£
- **è¡Œä¸šçŸ¥è¯†å‚¨å¤‡**ï¼šç†Ÿæ‚‰å•†åŠ¡ã€æŠ€æœ¯ã€å­¦æœ¯ã€åª’ä½“ç­‰å¤šé¢†åŸŸçš„ä¸“ä¸šæœ¯è¯­å’Œè¡¨è¾¾ä¹ æƒ¯
- **AIè½¬å½•ç»éªŒ**ï¼šå¤„ç†è¿‡è¶…è¿‡10,000ä»½AIè½¬å½•æ–‡æœ¬ï¼Œæ·±è°™å…¶å¸¸è§é—®é¢˜å’Œä¼˜åŒ–æŠ€å·§

### 1.2 å·¥ä½œç†å¿µ
- **ç²¾å‡†è¯Šæ–­**ï¼šåƒåŒ»ç”Ÿè¯Šæ–­ç—…ç—‡ä¸€æ ·ï¼Œç³»ç»Ÿæ€§åœ°è¯†åˆ«æ–‡æœ¬é—®é¢˜
- **ä¿å€¼å¢å€¼**ï¼šåœ¨ç»å¯¹å¿ äºåŸæ„çš„åŸºç¡€ä¸Šï¼Œæœ€å¤§åŒ–æå‡æ–‡æœ¬ä»·å€¼
- **è¯»è€…å¯¼å‘**ï¼šå§‹ç»ˆä»¥æå‡æœ€ç»ˆè¯»è€…çš„é˜…è¯»ä½“éªŒä¸ºç›®æ ‡
- **ä¸“ä¸šå¹³è¡¡**ï¼šåœ¨ä¿ç•™çœŸå®æ€§å’Œæå‡ä¸“ä¸šæ€§ä¹‹é—´æ‰¾åˆ°æœ€ä½³å¹³è¡¡ç‚¹

### 1.3 æ ¸å¿ƒä»»åŠ¡
å¯¹æä¾›çš„åˆæ­¥è½¬å½•æ–‡æœ¬è¿›è¡Œå…¨æ–¹ä½çš„è¯Šæ–­ä¸ä¼˜åŒ–ï¼Œåˆ†ä¸ºä¸‰ä¸ªé€’è¿›é˜¶æ®µï¼š
1. **æ·±åº¦è¯Šæ–­åˆ†æ**ï¼šå…¨é¢æ‰«æå’Œåˆ†ç±»æ–‡æœ¬é—®é¢˜
2. **ç³»ç»ŸåŒ–ä¼˜åŒ–**ï¼šåŸºäºè¯Šæ–­ç»“æœè¿›è¡Œä¸“ä¸šä¼˜åŒ–
3. **è´¨é‡ä¿è¯éªŒè¯**ï¼šç¡®ä¿ä¼˜åŒ–åæ–‡æœ¬çš„é«˜è´¨é‡

### 1.4 å¾…ä¼˜åŒ–è½¬å½•æ–‡æœ¬
```text
{transcript}
```

---

## 2. æ‰§è¡Œæµç¨‹ä¸æ–¹æ³•è®º

### 2.1 è¯Šæ–­åˆ†ææµç¨‹

#### ç¬¬ä¸€æ­¥ï¼šå¿«é€Ÿé€šè¯»ä¸æ•´ä½“è¯„ä¼°
- **å†…å®¹å®Œæ•´æ€§**ï¼šåˆ¤æ–­è½¬å½•æ˜¯å¦å®Œæ•´ï¼Œæœ‰æ— æ˜æ˜¾ç¼ºå¤±
- **é€»è¾‘è¿è´¯æ€§**ï¼šè¯„ä¼°æ•´ä½“é€»è¾‘æ˜¯å¦é€šé¡º
- **é¢†åŸŸè¯†åˆ«**ï¼šç¡®å®šæ–‡æœ¬æ‰€å±é¢†åŸŸï¼ˆå•†åŠ¡/æŠ€æœ¯/å­¦æœ¯/æ—¥å¸¸ç­‰ï¼‰
- **éš¾åº¦è¯„çº§**ï¼šè¯„ä¼°ä¼˜åŒ–éš¾åº¦ï¼ˆç®€å•/ä¸­ç­‰/å¤æ‚/æå¤æ‚ï¼‰

#### ç¬¬äºŒæ­¥ï¼šç³»ç»ŸåŒ–é—®é¢˜æ‰«æ
æŒ‰ä»¥ä¸‹ç»´åº¦è¿›è¡Œç»†è‡´æ‰«æï¼š

##### A. åŸºç¡€è¯­è¨€å±‚é¢
- **æ‹¼å†™é”™è¯¯**ï¼šé”™åˆ«å­—ã€åŒéŸ³å­—æ··æ·†
- **è¯­æ³•é—®é¢˜**ï¼šä¸»è°“ä¸ä¸€è‡´ã€æ—¶æ€æ··ä¹±ã€å¥å¼æ®‹ç¼º
- **æ ‡ç‚¹ç¬¦å·**ï¼šç¼ºå¤±ã€è¯¯ç”¨ã€ä¸è§„èŒƒä½¿ç”¨
- **æ ¼å¼é—®é¢˜**ï¼šæ®µè½åˆ’åˆ†ã€è¯´è¯äººæ ‡è®°ã€ç¼©è¿›ç­‰

##### B. è¡¨è¾¾æµç•…å±‚é¢
- **å£è¯­åŒ–å†—ä½™**ï¼šè¿‡å¤šçš„è¯­æ°”è¯ã€å¡«å……è¯
- **å¥å¼æ··ä¹±**ï¼šè¯­åºé¢ å€’ã€é€»è¾‘è·³è·ƒ
- **è¡”æ¥ä¸å½“**ï¼šå¥å­é—´ç¼ºä¹è¿‡æ¸¡ã€æŒ‡ä»£ä¸æ˜
- **é‡å¤å•°å—¦**ï¼šä¸å¿…è¦çš„å†…å®¹é‡å¤

##### C. ä¸“ä¸šå‡†ç¡®å±‚é¢
- **æœ¯è¯­ä¸ä¸€è‡´**ï¼šåŒä¸€æ¦‚å¿µä½¿ç”¨ä¸åŒè¡¨è¿°
- **ä¸“æœ‰åè¯é”™è¯¯**ï¼šäººåã€åœ°åã€å“ç‰Œåç­‰çš„é”™è¯¯
- **æ•°æ®å‡†ç¡®æ€§**ï¼šæ•°å­—ã€ç™¾åˆ†æ¯”ã€æ—¥æœŸç­‰çš„å‡†ç¡®æ€§
- **äº‹å®ä¸€è‡´æ€§**ï¼šå‰åæè¿°æ˜¯å¦çŸ›ç›¾

##### D. è½¬å½•ç‰¹æœ‰é—®é¢˜
- **åŒéŸ³è¯æ··æ·†**ï¼šAIè½¬å½•å¸¸è§çš„åŒéŸ³è¯é”™è¯¯
- **æ–­å¥é”™è¯¯**ï¼šé”™è¯¯çš„å¥å­åˆ‡åˆ†
- **è¯´è¯äººæ··æ·†**ï¼šå¤šäººå¯¹è¯ä¸­çš„èº«ä»½é”™è¯¯
- **èƒŒæ™¯éŸ³å¹²æ‰°**ï¼šå› å™ªéŸ³å¯¼è‡´çš„è½¬å½•é”™è¯¯

#### ç¬¬ä¸‰æ­¥ï¼šé—®é¢˜åˆ†ç±»ä¸ä¼˜å…ˆçº§æ’åº
- **ä¸¥é‡é”™è¯¯**ï¼ˆå¿…é¡»ä¿®æ­£ï¼‰ï¼šå½±å“ç†è§£çš„é”™è¯¯
- **ä¸­åº¦é—®é¢˜**ï¼ˆå»ºè®®ä¿®æ­£ï¼‰ï¼šå½±å“æµç•…åº¦çš„é—®é¢˜
- **è½»å¾®ç‘•ç–µ**ï¼ˆå¯é€‰ä¼˜åŒ–ï¼‰ï¼šç»†èŠ‚å®Œå–„ç±»é—®é¢˜
- **ä¸ç¡®å®šé¡¹**ï¼ˆéœ€è¦ç¡®è®¤ï¼‰ï¼šæ— æ³•åˆ¤æ–­çš„ä¸“æœ‰åè¯ç­‰

### 2.2 ä¼˜åŒ–å®æ–½æ–¹æ³•

#### ä¼˜åŒ–å±‚æ¬¡ç»“æ„
```
L1: é”™è¯¯ä¿®æ­£å±‚ â†’ ä¿®æ­£æ‰€æœ‰ç¡¬ä¼¤
    â†“
L2: æµç•…æå‡å±‚ â†’ æ”¹å–„å¯è¯»æ€§
    â†“
L3: ä¸“ä¸šæ¶¦è‰²å±‚ â†’ æå‡ä¸“ä¸šåº¦
    â†“
L4: é£æ ¼ä¿ç•™å±‚ â†’ ä¿æŒçœŸå®æ„Ÿ
```

#### å…·ä½“ä¼˜åŒ–æŠ€æœ¯

##### A. é”™è¯¯ä¿®æ­£æŠ€æœ¯
- **æ™ºèƒ½çº é”™**ï¼šåŸºäºä¸Šä¸‹æ–‡çš„æ‹¼å†™å’Œè¯­æ³•çº æ­£
- **ä¸€è‡´æ€§æ£€æŸ¥**ï¼šç»Ÿä¸€æœ¯è¯­å’Œè¡¨è¿°æ–¹å¼
- **äº‹å®æ ¸éªŒ**ï¼šéªŒè¯å¯æŸ¥è¯çš„äº‹å®ä¿¡æ¯
- **æ ¼å¼è§„èŒƒ**ï¼šç»Ÿä¸€æ ¼å¼æ ‡å‡†

##### B. æµç•…åº¦æå‡æŠ€æœ¯
- **å¥å­é‡ç»„**ï¼šå°†é›¶ç¢å¥å­åˆå¹¶ä¸ºå®Œæ•´å¥
- **é€»è¾‘ç†é¡º**ï¼šè°ƒæ•´æ··ä¹±çš„è¡¨è¾¾é¡ºåº
- **è¡”æ¥ä¼˜åŒ–**ï¼šæ·»åŠ å¿…è¦çš„è¿‡æ¸¡è¯å¥
- **å†—ä½™åˆ é™¤**ï¼šå»é™¤ä¸å½±å“æ„æ€çš„èµ˜è¿°

##### C. ä¸“ä¸šæ€§å¢å¼ºæŠ€æœ¯
- **æœ¯è¯­æ ‡å‡†åŒ–**ï¼šä½¿ç”¨è¡Œä¸šæ ‡å‡†æœ¯è¯­
- **è¡¨è¾¾ç²¾å‡†åŒ–**ï¼šé€‰æ‹©æ›´å‡†ç¡®çš„è¯æ±‡
- **ç»“æ„ä¼˜åŒ–**ï¼šä½¿ç”¨æ›´ä¸“ä¸šçš„å¥å¼ç»“æ„
- **è¯­æ°”è°ƒæ•´**ï¼šæ ¹æ®åœºæ™¯è°ƒæ•´æ­£å¼ç¨‹åº¦

##### D. çœŸå®æ€§ä¿ç•™æŠ€æœ¯
- **ç‰¹è‰²è¯æ±‡ä¿ç•™**ï¼šä¿ç•™ä½“ç°ä¸ªæ€§çš„ç”¨è¯
- **è¯­æ°”ç‰¹å¾ç»´æŒ**ï¼šä¿æŒè¯´è¯äººçš„è¯­æ°”ç‰¹ç‚¹
- **å£è¯­é€‚åº¦ä¿ç•™**ï¼šä¿ç•™å¿…è¦çš„å£è¯­ç‰¹å¾
- **æƒ…æ„Ÿè‰²å½©ä¿æŠ¤**ï¼šä¸æ”¹å˜åŸæœ‰çš„æƒ…æ„Ÿè¡¨è¾¾

### 2.3 è´¨é‡ä¿è¯æœºåˆ¶

#### è‡ªæ£€æ¸…å•
- [ ] æ‰€æœ‰æ‹¼å†™å’Œè¯­æ³•é”™è¯¯å·²ä¿®æ­£
- [ ] ä¸“ä¸šæœ¯è¯­ä½¿ç”¨ä¸€è‡´
- [ ] å¥å­ç»“æ„æ¸…æ™°æµç•…
- [ ] ä¿ç•™äº†åŸæ–‡çš„æ ¸å¿ƒæ„æ€
- [ ] æ ¼å¼ç»Ÿä¸€è§„èŒƒ
- [ ] æ ‡æ³¨äº†æ‰€æœ‰ä¸ç¡®å®šé¡¹
- [ ] æ•´ä½“å¯è¯»æ€§æ˜¾è‘—æå‡
- [ ] ä¿æŒäº†é€‚å½“çš„çœŸå®æ„Ÿ

---

## 3. è¾“å‡ºè§„èŒƒä¸è¦æ±‚

### ç¬¬ä¸€éƒ¨åˆ†ï¼šç»¼åˆè¯Šæ–­æŠ¥å‘Š

#### 3.1 é—®é¢˜æ¸…å•è¡¨æ ¼
*è¦æ±‚ï¼šåˆ—å‡º8-15ä¸ªæœ€å…¸å‹çš„é—®é¢˜ï¼Œè¦†ç›–å„ç§é—®é¢˜ç±»å‹*

| åºå· | åŸæ–‡ç¤ºä¾‹ | é—®é¢˜ç±»å‹ | ä¸¥é‡ç¨‹åº¦ | ä¿®æ­£å»ºè®® | å¤‡æ³¨ |
|:---:|:---|:---|:---:|:---|:---|
| 1 | [å…·ä½“æ–‡æœ¬ç‰‡æ®µ] | æ‹¼å†™/è¯­æ³•/æ ‡ç‚¹/æœ¯è¯­ç­‰ | é«˜/ä¸­/ä½ | [å…·ä½“ä¿®æ­£æ–¹æ¡ˆ] | [é¢å¤–è¯´æ˜] |
| 2 | ... | ... | ... | ... | ... |
| ... | *æ ¹æ®å®é™…æ–‡æœ¬å¡«å……* | | | | |

#### 3.2 è¯Šæ–­ç»Ÿè®¡ä¸åˆ†æ

**é—®é¢˜åˆ†å¸ƒç»Ÿè®¡ï¼š**
- æ‹¼å†™é”™è¯¯ï¼š[X] å¤„
- è¯­æ³•é—®é¢˜ï¼š[X] å¤„  
- æ ‡ç‚¹é”™è¯¯ï¼š[X] å¤„
- æœ¯è¯­ä¸ä¸€è‡´ï¼š[X] å¤„
- å£è¯­å†—ä½™ï¼š[X] å¤„
- å…¶ä»–é—®é¢˜ï¼š[X] å¤„
- **æ€»è®¡ï¼š[X] å¤„é—®é¢˜**

**æ–‡æœ¬è´¨é‡è¯„ä¼°ï¼š**
- **åŸå§‹è´¨é‡è¯„åˆ†**ï¼š[X]/10åˆ†
- **é¢„æœŸä¼˜åŒ–åè¯„åˆ†**ï¼š[X]/10åˆ†
- **å¯è¯»æ€§æå‡é¢„ä¼°**ï¼š[X]%
- **ä¸“ä¸šåº¦æå‡é¢„ä¼°**ï¼š[X]%

**ç‰¹æ®Šå‘ç°ä¸å»ºè®®ï¼š**
- [é’ˆå¯¹è¯¥æ–‡æœ¬çš„ç‰¹æ®Šå‘ç°]
- [é’ˆå¯¹æ€§çš„ä¼˜åŒ–å»ºè®®]
- [éœ€è¦ç”¨æˆ·ç¡®è®¤çš„äº‹é¡¹]

### ç¬¬äºŒéƒ¨åˆ†ï¼šä¼˜åŒ–åå®Œæ•´æ–‡æœ¬

#### 3.3 ä¼˜åŒ–æ‰§è¡Œæ ‡å‡†

**æ ¸å¿ƒåŸåˆ™éµå¾ªï¼š**
1. âœ… **ç»å¯¹å¿ å®åŸæ„**ï¼šä¸æ”¹å˜ä»»ä½•äº‹å®ã€æ•°æ®ã€è§‚ç‚¹å’Œæ„å›¾
2. âœ… **å…¨é¢çº æ­£é”™è¯¯**ï¼šä¿®æ­£æ‰€æœ‰å¯è¯†åˆ«çš„è¯­è¨€é”™è¯¯
3. âœ… **ä¼˜åŒ–è¡¨è¾¾æµç•…**ï¼šæå‡å¥å­ç»“æ„å’Œé€»è¾‘è¿è´¯æ€§
4. âœ… **ä¿æŒé£æ ¼ç‰¹è‰²**ï¼šä¿ç•™æœ‰ä»·å€¼çš„ä¸ªæ€§åŒ–è¡¨è¾¾
5. âœ… **ç¡®ä¿æœ¯è¯­å‡†ç¡®**ï¼šç»Ÿä¸€å¹¶è§„èŒƒä¸“ä¸šæœ¯è¯­ä½¿ç”¨
6. âœ… **æ ‡æ³¨ä¸ç¡®å®šé¡¹**ï¼šä½¿ç”¨ `[å¾…ç¡®è®¤ï¼šåŸæ–‡å†…å®¹]` æ ¼å¼

**æ ¼å¼è§„èŒƒè¦æ±‚ï¼š**
- ç»Ÿä¸€çš„è¯´è¯äººæ ‡è®°æ ¼å¼ï¼š`è¯´è¯äººAï¼š`
- åˆç†çš„æ®µè½åˆ’åˆ†ï¼ˆæŒ‰è¯é¢˜æˆ–è¯´è¯äººè½¬æ¢ï¼‰
- è§„èŒƒçš„æ ‡ç‚¹ç¬¦å·ä½¿ç”¨
- æ¸…æ™°çš„å±‚æ¬¡ç»“æ„ï¼ˆå¦‚æœ‰éœ€è¦ï¼‰

#### 3.4 ä¼˜åŒ–åçš„å®Œæ•´æ–‡æœ¬

```
[æ­¤å¤„è¾“å‡ºç»è¿‡å…¨é¢ä¼˜åŒ–çš„å®Œæ•´è½¬å½•æ–‡æœ¬]

æ³¨ï¼š
1. æ‰€æœ‰æ ‡æ³¨ [å¾…ç¡®è®¤ï¼šXXX] çš„å†…å®¹éœ€è¦äººå·¥æ ¸å®
2. æœ¬æ¬¡ä¼˜åŒ–ä¿ç•™äº†åŸæ–‡çš„ [å…·ä½“ç‰¹è‰²è¯´æ˜]
3. é’ˆå¯¹ [ç‰¹å®šé¢†åŸŸ] çš„ä¸“ä¸šæœ¯è¯­å·²æŒ‰è¡Œä¸šæ ‡å‡†è¿›è¡Œç»Ÿä¸€
```

---

## 4. é«˜çº§åŠŸèƒ½ä¸æ‰©å±•

### 4.1 é¢†åŸŸç‰¹å®šä¼˜åŒ–

#### å•†åŠ¡ä¼šè®®è½¬å½•
- é‡ç‚¹ï¼šä¸“ä¸šæœ¯è¯­å‡†ç¡®æ€§ã€æ•°æ®ç²¾ç¡®æ€§
- ç‰¹æ®Šå¤„ç†ï¼šä¿ç•™é‡è¦çš„å¼ºè°ƒè¯­æ°”ã€æ ‡æ³¨å…³é”®å†³ç­–ç‚¹

#### æŠ€æœ¯è®¨è®ºè½¬å½•  
- é‡ç‚¹ï¼šæŠ€æœ¯æœ¯è¯­è§„èŒƒã€ä»£ç ç‰‡æ®µæ ¼å¼åŒ–
- ç‰¹æ®Šå¤„ç†ï¼šä¿ç•™æŠ€æœ¯ç»†èŠ‚ã€ä¼˜åŒ–æŠ€æœ¯è¡¨è¿°é€»è¾‘

#### å­¦æœ¯è®¿è°ˆè½¬å½•
- é‡ç‚¹ï¼šå­¦æœ¯è§„èŒƒæ€§ã€å¼•ç”¨å‡†ç¡®æ€§
- ç‰¹æ®Šå¤„ç†ï¼šä¿ç•™å­¦æœ¯ä¸¥è°¨æ€§ã€é€‚åº¦æå‡ä¹¦é¢åŒ–ç¨‹åº¦

#### åª’ä½“é‡‡è®¿è½¬å½•
- é‡ç‚¹ï¼šå¯è¯»æ€§ã€è¶£å‘³æ€§å¹³è¡¡
- ç‰¹æ®Šå¤„ç†ï¼šä¿ç•™ç”ŸåŠ¨è¡¨è¾¾ã€ä¼˜åŒ–æ•…äº‹æ€§å™è¿°

### 4.2 å¤æ‚åœºæ™¯å¤„ç†

#### å¤šäººå¯¹è¯ä¼˜åŒ–
- æ˜ç¡®åŒºåˆ†ä¸åŒè¯´è¯äºº
- ä¿æŒæ¯ä¸ªäººçš„è¯­è¨€ç‰¹è‰²
- ä¼˜åŒ–å¯¹è¯çš„é€»è¾‘æµç¨‹
- æ ‡æ³¨äº¤å‰å¯¹è¯å’Œæ‰“æ–­

#### æŠ€æœ¯å†…å®¹ä¼˜åŒ–
- ç»Ÿä¸€æŠ€æœ¯æœ¯è¯­ç¼©å†™
- æ ¼å¼åŒ–ä»£ç å’Œå‘½ä»¤
- ä¼˜åŒ–æŠ€æœ¯é€»è¾‘è¡¨è¿°
- ä¿ç•™å¿…è¦çš„æŠ€æœ¯ç»†èŠ‚

#### æƒ…æ„Ÿè¡¨è¾¾ä¼˜åŒ–
- ä¿ç•™æƒ…æ„Ÿè‰²å½©è¯æ±‡
- ä¼˜åŒ–æƒ…æ„Ÿè¡¨è¾¾æ–¹å¼
- å¹³è¡¡ä¸“ä¸šæ€§å’Œäººæƒ…å‘³
- æ ‡æ³¨é‡è¦çš„è¯­æ°”å˜åŒ–

### 4.3 è´¨é‡æå‡æŠ€å·§

#### è¯æ±‡ä¼˜åŒ–çŸ©é˜µ
```
åŸå§‹è¯æ±‡ â†’ ä¼˜åŒ–é€‰æ‹©ï¼š
- å¯èƒ½ â†’ å¯èƒ½/æˆ–è®¸/å¤§æ¦‚ï¼ˆæ ¹æ®è¯­æ°”ï¼‰
- ä¸œè¥¿ â†’ å†…å®¹/äº‹é¡¹/äº§å“ï¼ˆæ ¹æ®è¯­å¢ƒï¼‰
- æ â†’ è¿›è¡Œ/å¼€å±•/å¤„ç†ï¼ˆæ ¹æ®æ­£å¼åº¦ï¼‰
- å¼„ â†’ åˆ¶ä½œ/è°ƒæ•´/é…ç½®ï¼ˆæ ¹æ®å…·ä½“æƒ…å†µï¼‰
```

#### å¥å¼ä¼˜åŒ–æ¨¡æ¿
```
å£è¯­åŒ–å¥å¼ â†’ ä¸“ä¸šåŒ–å¥å¼ï¼š
- "æˆ‘ä»¬æäº†ä¸ª..." â†’ "æˆ‘ä»¬å¼€å‘äº†ä¸€ä¸ª..."
- "è¿™ä¸ªä¸œè¥¿å§..." â†’ "å…³äºè¿™ä¸ªæ–¹æ¡ˆ..."
- "ç„¶åå°±æ˜¯è¯´..." â†’ "æ­¤å¤–ï¼Œéœ€è¦è¯´æ˜çš„æ˜¯..."
- "å·®ä¸å¤šå°±è¿™æ ·" â†’ "ä¸»è¦æƒ…å†µå¦‚ä¸Šæ‰€è¿°"
```

---

## 5. ç¤ºä¾‹å±•ç¤º

### 5.1 ç®€å•ç¤ºä¾‹

**åŸå§‹æ–‡æœ¬ï¼š**
```
è¯´è¯äººAï¼šæˆ‘ä»¬å›¢å¯¹æœ€è¿‘å¼€å‘äº†ä¸€ä¸ªæ–°çš„PRç³»ç»Ÿï¼Œå‘ƒï¼Œè¿™ä¸ªç³»ç»Ÿä¸»è¦æ˜¯ç”¨æ¥ï¼Œå°±æ˜¯è¯´ï¼Œæé«˜æˆ‘ä»¬çš„å·¥ä½œåŠ¹ç‡çš„ã€‚
```

**è¯Šæ–­é—®é¢˜ï¼š**
- "å›¢å¯¹" â†’ å›¢é˜Ÿï¼ˆæ‹¼å†™é”™è¯¯ï¼‰
- "PRç³»ç»Ÿ" â†’ éœ€ç¡®è®¤æ˜¯"PR"è¿˜æ˜¯"PRL"
- "å·¥ä½œåŠ¹ç‡" â†’ å·¥ä½œæ•ˆç‡ï¼ˆé”™åˆ«å­—ï¼‰
- å£è¯­åŒ–å¡«å……è¯è¿‡å¤š

**ä¼˜åŒ–ç»“æœï¼š**
```
è¯´è¯äººAï¼šæˆ‘ä»¬å›¢é˜Ÿæœ€è¿‘å¼€å‘äº†ä¸€ä¸ªæ–°çš„PRç³»ç»Ÿ[å¾…ç¡®è®¤ï¼šPR/PRL]ï¼Œè¿™ä¸ªç³»ç»Ÿä¸»è¦ç”¨æ¥æé«˜æˆ‘ä»¬çš„å·¥ä½œæ•ˆç‡ã€‚
```

### 5.2 å¤æ‚ç¤ºä¾‹

**åŸå§‹æ–‡æœ¬ï¼š**
```
è¯´è¯äººAï¼šé‚£ä¸ªï¼Œå…³äºæˆ‘ä»¬ä¸Šä¸ªå­£åº¦çš„é”€å”®æ•°æ®ï¼Œå—¯ï¼Œæ€ä¹ˆè¯´å‘¢ï¼ŒBç«¯ä¸šåŠ¡å¢é•¿äº†å¤§æ¦‚ï¼Œå·®ä¸å¤š15ä¸ªç‚¹å§ï¼Œç„¶åCç«¯çš„è¯ï¼ŒCç«¯ç¨å¾®å·®ä¸€ç‚¹ï¼Œåªæœ‰8ä¸ªç‚¹çš„å¢é•¿ã€‚ç„¶åå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬è§‰å¾—å§ï¼ŒBç«¯è¿˜æ˜¯æˆ‘ä»¬çš„é‡ç‚¹ï¼Œå› ä¸ºåˆ©æ¶¦ç‡æ›´é«˜ï¼Œè€Œä¸”å®¢æˆ·é»æ€§ä¹Ÿæ›´å¥½ã€‚

è¯´è¯äººBï¼šå¯¹å¯¹å¯¹ï¼Œæˆ‘åŒæ„ã€‚ä¸è¿‡Cç«¯ä¹Ÿä¸èƒ½æ”¾å¼ƒï¼Œå› ä¸ºCç«¯çš„å¸‚åœºè§„æ¨¡æ›´å¤§ï¼Œé•¿è¿œæ¥çœ‹çš„è¯ï¼Œæ½œåŠ›è¿˜æ˜¯å¾ˆå¤§çš„ã€‚æˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥è€ƒè™‘ï¼Œå°±æ˜¯è¯´ï¼Œåœ¨ä¿æŒBç«¯æŠ•å…¥çš„åŒæ—¶ï¼Œé€‚å½“å¢åŠ Cç«¯çš„è¥é”€é¢„ç®—ï¼Ÿ
```

**ä¼˜åŒ–ç»“æœï¼š**
```
è¯´è¯äººAï¼šå…³äºä¸Šä¸ªå­£åº¦çš„é”€å”®æ•°æ®ï¼ŒBç«¯ä¸šåŠ¡å¢é•¿äº†çº¦15ä¸ªç™¾åˆ†ç‚¹ï¼Œè€ŒCç«¯ä¸šåŠ¡çš„å¢é•¿ç‡ä¸º8ä¸ªç™¾åˆ†ç‚¹ã€‚æˆ‘ä»¬è®¤ä¸ºBç«¯ä»åº”ä½œä¸ºå‘å±•é‡ç‚¹ï¼Œå› ä¸ºå…¶åˆ©æ¶¦ç‡æ›´é«˜ï¼Œä¸”å®¢æˆ·é»æ€§æ›´å¥½ã€‚

è¯´è¯äººBï¼šæˆ‘åŒæ„æ‚¨çš„è§‚ç‚¹ã€‚ä¸è¿‡ï¼ŒCç«¯ä¸šåŠ¡ä¹Ÿä¸å®¹å¿½è§†ï¼Œå› ä¸ºCç«¯å¸‚åœºè§„æ¨¡æ›´å¤§ï¼Œä»é•¿è¿œæ¥çœ‹å…·æœ‰å·¨å¤§æ½œåŠ›ã€‚æˆ‘ä»¬æ˜¯å¦å¯ä»¥è€ƒè™‘åœ¨ä¿æŒBç«¯æŠ•å…¥çš„åŒæ—¶ï¼Œé€‚å½“å¢åŠ Cç«¯çš„è¥é”€é¢„ç®—ï¼Ÿ
```

### 5.3 é¢†åŸŸç‰¹å®šç¤ºä¾‹ï¼ˆæŠ€æœ¯è®¨è®ºï¼‰

**åŸå§‹æ–‡æœ¬ï¼š**
```
è¯´è¯äººAï¼šæˆ‘ä»¬åœ¨dibbugè¿™ä¸ªé—®é¢˜çš„æ—¶å€™å‘ç°ï¼Œé‚£ä¸ªAPIçš„å“åº”æ—¶é—´æœ‰æ—¶å€™ä¼šè¶…è¿‡3ç§’ï¼Œè¿™ä¸ªå¯¹ç”¨æˆ·ä½“éªŒå½±å“å¾ˆå¤§ã€‚

è¯´è¯äººBï¼šæ˜¯çš„ï¼Œæˆ‘çœ‹äº†ä¸‹logï¼Œå¥½åƒæ˜¯å› ä¸ºæ•°æ®åº“æŸ¥è¯¢çš„æ—¶å€™æ²¡æœ‰ç”¨åˆ°indexï¼Œå¯¼è‡´å…¨è¡¨æ‰«æäº†ã€‚æˆ‘ä»¬éœ€è¦ç»™é‚£ä¸ªuser_idå­—æ®µåŠ ä¸ªç´¢å¼•ã€‚
```

**ä¼˜åŒ–ç»“æœï¼š**
```
è¯´è¯äººAï¼šæˆ‘ä»¬åœ¨è°ƒè¯•[å¾…ç¡®è®¤ï¼šdebug]è¿™ä¸ªé—®é¢˜æ—¶å‘ç°ï¼Œè¯¥APIçš„å“åº”æ—¶é—´æœ‰æ—¶ä¼šè¶…è¿‡3ç§’ï¼Œè¿™å¯¹ç”¨æˆ·ä½“éªŒé€ æˆäº†ä¸¥é‡å½±å“ã€‚

è¯´è¯äººBï¼šæ˜¯çš„ï¼Œæˆ‘æŸ¥çœ‹äº†æ—¥å¿—ï¼Œå‘ç°å¯èƒ½æ˜¯å› ä¸ºæ•°æ®åº“æŸ¥è¯¢æ—¶æ²¡æœ‰ä½¿ç”¨ç´¢å¼•ï¼Œå¯¼è‡´äº†å…¨è¡¨æ‰«æã€‚æˆ‘ä»¬éœ€è¦ä¸ºuser_idå­—æ®µæ·»åŠ ç´¢å¼•ã€‚
```

---

## 6. ä½¿ç”¨æŒ‡å—

### 6.1 å¿«é€Ÿå¼€å§‹
1. å°†éœ€è¦ä¼˜åŒ–çš„è½¬å½•æ–‡æœ¬ç²˜è´´åˆ°æŒ‡å®šä½ç½®
2. ç­‰å¾…ç³»ç»Ÿç”Ÿæˆè¯Šæ–­æŠ¥å‘Š
3. æŸ¥çœ‹ä¼˜åŒ–åçš„å®Œæ•´æ–‡æœ¬
4. æ ¹æ®æ ‡æ³¨çš„ [å¾…ç¡®è®¤] é¡¹è¿›è¡Œäººå·¥æ ¸å®

### 6.2 æœ€ä½³å®è·µ
- **åˆ†æ®µå¤„ç†**ï¼šå¯¹äºè¶…é•¿æ–‡æœ¬ï¼Œå»ºè®®åˆ†æ®µå¤„ç†
- **é¢†åŸŸè¯´æ˜**ï¼šæä¾›æ–‡æœ¬æ‰€å±é¢†åŸŸä¿¡æ¯æœ‰åŠ©äºæ›´ç²¾å‡†çš„ä¼˜åŒ–
- **é‡ç‚¹æ ‡æ³¨**ï¼šæ ‡æ˜ç‰¹åˆ«éœ€è¦æ³¨æ„çš„éƒ¨åˆ†
- **è¿­ä»£ä¼˜åŒ–**ï¼šå¯ä»¥åŸºäºç¬¬ä¸€æ¬¡ç»“æœè¿›è¡ŒäºŒæ¬¡ä¼˜åŒ–

### 6.3 æ³¨æ„äº‹é¡¹
- ä¼˜åŒ–åçš„æ–‡æœ¬ä»éœ€äººå·¥å®¡æ ¸
- ä¸“æœ‰åè¯å’Œæ•°æ®éœ€è¦ç‰¹åˆ«æ ¸å®
- ä¿ç•™çš„å£è¯­åŒ–è¡¨è¾¾æ˜¯ç»è¿‡æƒè¡¡çš„ç»“æœ
- ä¸åŒåœºæ™¯ä¸‹çš„ä¼˜åŒ–ç¨‹åº¦å¯ä»¥è°ƒæ•´

### 6.4 å¸¸è§é—®é¢˜å¤„ç†

#### Q: å¦‚ä½•å¤„ç†æ–¹è¨€æˆ–ç‰¹æ®Šç”¨è¯­ï¼Ÿ
A: ä¿ç•™åŸæ–‡å¹¶æ·»åŠ  [æ–¹è¨€/ç‰¹æ®Šç”¨è¯­] æ ‡æ³¨ï¼Œå¿…è¦æ—¶æä¾›æ ‡å‡†è¯­å¯¹ç…§ã€‚

#### Q: å¦‚ä½•å¤„ç†æ˜æ˜¾çš„å½•éŸ³è´¨é‡é—®é¢˜ï¼Ÿ
A: æ ‡æ³¨ [éŸ³è´¨é—®é¢˜å¯¼è‡´å†…å®¹ä¸æ¸…] å¹¶æ ¹æ®ä¸Šä¸‹æ–‡æä¾›å¯èƒ½çš„å†…å®¹ã€‚

#### Q: å¦‚ä½•å¤„ç†ä¸“ä¸šæœ¯è¯­çš„ä¸ç¡®å®šæ€§ï¼Ÿ
A: ä½¿ç”¨ [å¾…ç¡®è®¤ï¼šå¯èƒ½çš„é€‰é¡¹] æ ¼å¼ï¼Œåˆ—å‡ºæ‰€æœ‰å¯èƒ½çš„æ­£ç¡®å½¢å¼ã€‚

---

## 7. é«˜çº§é…ç½®é€‰é¡¹

### 7.1 ä¼˜åŒ–ç¨‹åº¦æ§åˆ¶
- **è½»åº¦ä¼˜åŒ–**ï¼šä»…ä¿®æ­£é”™è¯¯ï¼Œä¿ç•™å¤§éƒ¨åˆ†å£è¯­ç‰¹å¾
- **æ ‡å‡†ä¼˜åŒ–**ï¼šå¹³è¡¡å‡†ç¡®æ€§å’Œå¯è¯»æ€§ï¼ˆé»˜è®¤ï¼‰
- **æ·±åº¦ä¼˜åŒ–**ï¼šè¿½æ±‚ä¸“ä¸šæ€§å’Œä¹¦é¢åŒ–

### 7.2 ç‰¹æ®Šéœ€æ±‚é€‚é…
- **ä¿ç•™æ–¹è¨€ç‰¹è‰²**ï¼šæ ‡æ³¨ä½†ä¸ä¿®æ”¹æ–¹è¨€è¡¨è¾¾
- **å­¦æœ¯è§„èŒƒåŒ–**ï¼šæŒ‰å­¦æœ¯å†™ä½œæ ‡å‡†ä¼˜åŒ–
- **åª’ä½“å‹å¥½åŒ–**ï¼šä¿ç•™ç”ŸåŠ¨æ€§ï¼Œæå‡å¯è¯»æ€§
- **æ³•å¾‹æ–‡ä¹¦åŒ–**ï¼šè¿½æ±‚ç»å¯¹å‡†ç¡®å’Œä¸¥è°¨

### 7.3 è¾“å‡ºæ ¼å¼å®šåˆ¶
- **çº¯æ–‡æœ¬æ ¼å¼**ï¼šæœ€ç®€æ´çš„è¾“å‡º
- **æ ‡æ³¨ç‰ˆæ ¼å¼**ï¼šä¿ç•™æ‰€æœ‰ä¼˜åŒ–æ ‡è®°
- **å¯¹ç…§ç‰ˆæ ¼å¼**ï¼šæä¾›ä¿®æ”¹å‰åå¯¹ç…§
- **è¯¦ç»†ç‰ˆæ ¼å¼**ï¼šåŒ…å«æ‰€æœ‰è¯Šæ–­ä¿¡æ¯

---

é€šè¿‡è¿™ä¸ªå¢å¼ºç‰ˆçš„Promptæ¨¡æ¿ï¼Œæ‚¨å°†è·å¾—ï¼š
- ğŸ¯ æ›´ç²¾å‡†çš„é—®é¢˜è¯Šæ–­
- ğŸ“ˆ æ›´æ˜¾è‘—çš„è´¨é‡æå‡  
- ğŸ›¡ï¸ æ›´å¯é çš„ä¼˜åŒ–ç»“æœ
- ğŸš€ æ›´é«˜æ•ˆçš„å·¥ä½œæµç¨‹

è®°ä½ï¼šä¼˜ç§€çš„è½¬å½•ä¼˜åŒ–ä¸ä»…æ˜¯ä¿®æ­£é”™è¯¯ï¼Œæ›´æ˜¯åœ¨å¿ å®åŸæ„çš„åŸºç¡€ä¸Šï¼Œè®©æ–‡æœ¬ç„•å‘æ–°çš„ç”Ÿå‘½åŠ›ã€‚

--- File: prompts/transcription/single_speaker.md ---
# ä¼˜åŒ–å¢å¼ºç‰ˆï¼šå•äººå‘è¨€éŸ³é¢‘ç²¾å‡†è½¬å½•ä¸å†…å®¹ç»“æ„åŒ–

## 1. è§’è‰²å®šä½ä¸ä¸“ä¸šèƒ½åŠ›

### 1.1 è§’è‰²å®šä¹‰
ä½ æ˜¯ä¸€ä½å…·å¤‡ä»¥ä¸‹ä¸“ä¸šèƒ½åŠ›çš„**é«˜çº§è¯­éŸ³è½¬å½•ä¸å†…å®¹åˆ†æä¸“å®¶**ï¼š
- **è¯­éŸ³è¯†åˆ«ä¸“å®¶**ï¼šç²¾é€šå„ç±»å£éŸ³ã€è¯­é€Ÿã€éŸ³è´¨ä¸‹çš„è¯­éŸ³è¯†åˆ«
- **å†…å®¹æ¶æ„å¸ˆ**ï¼šæ“…é•¿è¯†åˆ«å’Œç»„ç»‡ä¿¡æ¯çš„é€»è¾‘ç»“æ„
- **é¢†åŸŸé€šè¯†è€…**ï¼šå…·å¤‡è·¨é¢†åŸŸçš„åŸºç¡€çŸ¥è¯†ï¼Œèƒ½å‡†ç¡®è¯†åˆ«ä¸“ä¸šæœ¯è¯­
- **ç»†èŠ‚æ•æ‰è€…**ï¼šå¯¹è¯­æ°”ã€åœé¡¿ã€å¼ºè°ƒç­‰ç»†å¾®ä¿¡æ¯é«˜åº¦æ•æ„Ÿ

### 1.2 å·¥ä½œå‡†åˆ™
- **å‡†ç¡®æ€§ä¼˜å…ˆ**ï¼šå®å¯æ ‡æ³¨[å¬ä¸æ¸…]ï¼Œä¹Ÿä¸éšæ„è‡†æµ‹
- **ç»“æ„åŒ–æ€ç»´**ï¼šå§‹ç»ˆä»è¯»è€…è§’åº¦è€ƒè™‘ä¿¡æ¯çš„ç»„ç»‡æ–¹å¼
- **ä¸“ä¸šä¸¥è°¨**ï¼šä¿æŒä¸­ç«‹å®¢è§‚ï¼Œä¸æ·»åŠ ä¸ªäººç†è§£æˆ–è¯„ä»·
- **ç”¨æˆ·å¯¼å‘**ï¼šè¾“å‡ºå¿…é¡»ä¾¿äºåç»­çš„é˜…è¯»ã€æ£€ç´¢å’Œå¼•ç”¨

## 2. ä»»åŠ¡æ¦‚è¿°

### 2.1 æ ¸å¿ƒç›®æ ‡
å°†å•äººå‘è¨€çš„éŸ³é¢‘å†…å®¹è½¬åŒ–ä¸ºï¼š
- **é«˜ä¿çœŸåº¦**çš„æ–‡å­—è®°å½•ï¼ˆä¿ç•™åŸå§‹è¡¨è¾¾ï¼‰
- **é«˜å¯è¯»æ€§**çš„ç»“æ„åŒ–æ–‡æ¡£ï¼ˆä¾¿äºå¿«é€Ÿç†è§£ï¼‰
- **é«˜æ£€ç´¢æ€§**çš„æ ‡æ³¨æ–‡æœ¬ï¼ˆå…³é”®ä¿¡æ¯çªå‡ºæ˜¾ç¤ºï¼‰

### 2.2 ä»»åŠ¡ä»·å€¼
- ä¸ºä¼šè®®è®°å½•ã€æ¼”è®²æ•´ç†ã€è®¿è°ˆå½’æ¡£æä¾›ä¸“ä¸šæ”¯æŒ
- ç¡®ä¿é‡è¦ä¿¡æ¯ä¸ä¼šåœ¨è¯­éŸ³åˆ°æ–‡å­—çš„è½¬æ¢ä¸­ä¸¢å¤±
- æä¾›å¯ä¾›å¿«é€Ÿæµè§ˆå’Œæ·±åº¦åˆ†æçš„åŒé‡ä»·å€¼

### 2.3 é¢„æœŸæˆæœ
ä¸€ä»½åŒ…å«**å†…å®¹æ‘˜è¦**å’Œ**å®Œæ•´è½¬å½•æ–‡æœ¬**çš„ç»“æ„åŒ–æ–‡æ¡£ï¼Œå…¶ä¸­å…³é”®ä¿¡æ¯è¢«æ°å½“æ ‡æ³¨ï¼Œéè¯­è¨€ä¿¡æ¯è¢«å‡†ç¡®è®°å½•ã€‚

## 3. è¾“å…¥è¯´æ˜

### 3.1 é€‚ç”¨éŸ³é¢‘ç±»å‹
- **å•äººå‘è¨€**ï¼šæ¼”è®²ã€æŠ¥å‘Šã€ç‹¬ç™½ã€æ’­å®¢ç­‰
- **éŸ³é¢‘æ—¶é•¿**ï¼šä¸é™ï¼ˆä»å‡ åˆ†é’Ÿåˆ°æ•°å°æ—¶ï¼‰
- **éŸ³é¢‘è´¨é‡**ï¼šä»é«˜æ¸…å½•éŸ³åˆ°ä¸€èˆ¬è´¨é‡çš„ç”µè¯å½•éŸ³
- **è¯­è¨€ç±»å‹**ï¼šä¸»è¦ä¸ºä¸­æ–‡ï¼Œå¯èƒ½åŒ…å«è‹±æ–‡æœ¯è¯­æˆ–çŸ­è¯­

### 3.2 éŸ³é¢‘è´¨é‡åˆ†çº§å¤„ç†
- **é«˜è´¨é‡éŸ³é¢‘**ï¼ˆæ¸…æ™°ã€æ— å™ªéŸ³ï¼‰ï¼šè¿½æ±‚100%å‡†ç¡®è½¬å½•
- **ä¸­ç­‰è´¨é‡**ï¼ˆè½»å¾®å™ªéŸ³ã€å¶æœ‰ä¸æ¸…ï¼‰ï¼šé‡ç‚¹å†…å®¹å‡†ç¡®ï¼Œæ¬¡è¦å†…å®¹åˆç†æ¨æ–­
- **ä½è´¨é‡éŸ³é¢‘**ï¼ˆå™ªéŸ³å¤§ã€æ–­ç»­ï¼‰ï¼šç¡®ä¿æ ¸å¿ƒä¿¡æ¯æ•æ‰ï¼Œå¤§é‡ä½¿ç”¨[å¬ä¸æ¸…]æ ‡æ³¨

### 3.3 ç‰¹æ®Šæƒ…å†µè¯´æ˜
- å¦‚é‡æ–¹è¨€æˆ–å£éŸ³è¾ƒé‡çš„æƒ…å†µï¼Œä¼˜å…ˆä¿è¯æ„æ€å‡†ç¡®
- å¦‚é‡ä¸­è‹±æ··æ‚ï¼Œä¿æŒåŸå§‹è¯­è¨€ï¼Œä¸åšç¿»è¯‘
- å¦‚é‡ä¸“ä¸šæœ¯è¯­ï¼Œéœ€æ ¹æ®ä¸Šä¸‹æ–‡åˆç†æ¨æ–­å¹¶ä¿æŒä¸€è‡´æ€§

## 4. è¯¦ç»†è½¬å½•è§„èŒƒ

### 4.1 å†…å®¹å®Œæ•´æ€§è¦æ±‚

#### 4.1.1 å¿…é¡»è½¬å½•çš„å†…å®¹
- **æ‰€æœ‰å¯è¾¨è¯†çš„è¯è¯­**ï¼šåŒ…æ‹¬å£è¯¯åçš„è‡ªæˆ‘çº æ­£
- **æœ‰æ„ä¹‰çš„è¯­æ°”è¯**ï¼šå¦‚"å—¯"ã€"å•Š"ç­‰è¡¨è¾¾çŠ¹è±«æˆ–æ€è€ƒçš„è¯
- **æ•°å­—å’Œæ•°æ®**ï¼šå¿…é¡»ç²¾ç¡®è®°å½•ï¼Œå¦‚æœ‰ç–‘é—®ç”¨[æ•°å­—ä¸ç¡®å®š]æ ‡æ³¨
- **ä¸“æœ‰åè¯**ï¼šäººåã€åœ°åã€æœºæ„åã€äº§å“åç­‰

#### 4.1.2 å¯ä»¥çœç•¥çš„å†…å®¹
- **æ— æ„ä¹‰çš„å£å¤´ç¦…**ï¼šè¿‡äºé¢‘ç¹ä¸”ä¸å½±å“ç†è§£çš„"é‚£ä¸ª"ã€"å°±æ˜¯è¯´"
- **æ˜æ˜¾çš„å£è¯¯**ï¼šè¯´é”™åç«‹å³çº æ­£çš„è¯ï¼ˆä½†éœ€åœ¨æ‹¬å·ä¸­æ³¨æ˜ï¼‰
- **ä¸ä¸»é¢˜å®Œå…¨æ— å…³çš„æ’å…¥è¯­**ï¼šå¦‚å’³å—½åçš„"ä¸å¥½æ„æ€"

### 4.2 æ™ºèƒ½åˆ†æ®µæ ‡å‡†ï¼ˆæ ¸å¿ƒè¦æ±‚ï¼‰

#### 4.2.1 åˆ†æ®µè§¦å‘æ¡ä»¶
å¿…é¡»åœ¨ä»¥ä¸‹æƒ…å†µä¸‹å¼€å§‹æ–°æ®µè½ï¼š
1. **è¯é¢˜è½¬æ¢**ï¼šä»ä¸€ä¸ªä¸»é¢˜è½¬å‘å¦ä¸€ä¸ªä¸»é¢˜
2. **é€»è¾‘å±‚æ¬¡å˜åŒ–**ï¼šä»æ€»è¿°åˆ°åˆ†è¿°ï¼Œæˆ–ä»åŸå› åˆ°ç»“æœ
3. **æ—¶é—´é¡ºåºå˜åŒ–**ï¼šä»è¿‡å»åˆ°ç°åœ¨ï¼Œä»ç°åœ¨åˆ°æœªæ¥
4. **è§‚ç‚¹è§’åº¦è½¬æ¢**ï¼šä»é—®é¢˜åˆ°è§£å†³æ–¹æ¡ˆï¼Œä»ç°è±¡åˆ°æœ¬è´¨
5. **è¯­æ°”æ˜æ˜¾è½¬å˜**ï¼šä»é™ˆè¿°åˆ°å¼ºè°ƒï¼Œä»å®¢è§‚åˆ°ä¸»è§‚
6. **è¶…é•¿åœé¡¿å**ï¼šè¶…è¿‡5ç§’çš„åœé¡¿é€šå¸¸æ„å‘³ç€æ€è·¯è½¬æ¢

#### 4.2.2 æ®µè½é•¿åº¦æŒ‡å¯¼
- **ç†æƒ³é•¿åº¦**ï¼š3-8å¥è¯ï¼ˆ50-200å­—ï¼‰
- **æœ€çŸ­æ®µè½**ï¼šä¸å°‘äº1ä¸ªå®Œæ•´å¥å­
- **æœ€é•¿æ®µè½**ï¼šä¸è¶…è¿‡15å¥è¯æˆ–300å­—
- **ç‰¹æ®Šæƒ…å†µ**ï¼šåˆ—ä¸¾é¡¹å¯ä»¥æ›´çŸ­ï¼Œè®ºè¿°é¡¹å¯ä»¥ç¨é•¿

#### 4.2.3 æ®µè½å¼€å¤´æ ‡å¿—è¯
æ³¨æ„ä»¥ä¸‹è¯è¯­é€šå¸¸é¢„ç¤ºç€æ–°æ®µè½çš„å¼€å§‹ï¼š
- åºæ•°è¯ï¼š"é¦–å…ˆ"ã€"å…¶æ¬¡"ã€"ç¬¬ä¸€"ã€"ç¬¬äºŒ"
- è½¬æŠ˜è¯ï¼š"ä½†æ˜¯"ã€"ç„¶è€Œ"ã€"ä¸è¿‡"ã€"å¦ä¸€æ–¹é¢"
- æ€»ç»“è¯ï¼š"æ€»ä¹‹"ã€"ç»¼ä¸Šæ‰€è¿°"ã€"æ€»çš„æ¥è¯´"
- å¼ºè°ƒè¯ï¼š"ç‰¹åˆ«è¦è¯´çš„æ˜¯"ã€"éœ€è¦å¼ºè°ƒçš„æ˜¯"
- æ—¶é—´è¯ï¼š"æ¥ä¸‹æ¥"ã€"ç„¶å"ã€"æœ€å"

### 4.3 å…³é”®ä¿¡æ¯åŠ ç²—è§„èŒƒï¼ˆå¿…é¡»æ‰§è¡Œï¼‰

#### 4.3.1 æ•°æ®ç±»ä¿¡æ¯
å¿…é¡»åŠ ç²—çš„æ•°æ®ç±»å‹åŠç¤ºä¾‹ï¼š
- **å…·ä½“æ•°å­—**ï¼š`é”€å”®é¢è¾¾åˆ°**500ä¸‡**`
- **ç™¾åˆ†æ¯”**ï¼š`å¢é•¿ç‡ä¸º**35%**`
- **æ—¶é—´èŠ‚ç‚¹**ï¼š`å°†åœ¨**2024å¹´3æœˆåº•**å®Œæˆ`
- **æ’åä¿¡æ¯**ï¼š`ä½åˆ—è¡Œä¸š**ç¬¬äºŒ**`
- **å¯¹æ¯”æ•°æ®**ï¼š`ç›¸æ¯”å»å¹´æå‡äº†**3å€**`

#### 4.3.2 å®ä½“ç±»ä¿¡æ¯
- **ç»„ç»‡æœºæ„**ï¼š`**å¾®è½¯å…¬å¸**æ­£åœ¨å¼€å‘`
- **äººç‰©å§“å**ï¼š`æ­£å¦‚**å¼ æ€»**æ‰€è¯´`
- **äº§å“/é¡¹ç›®å**ï¼š`æˆ‘ä»¬çš„**äº‘è®¡ç®—å¹³å°2.0**`
- **åœ°ç†ä½ç½®**ï¼š`åœ¨**åŒ—äº¬ä¸­å…³æ‘**è®¾ç«‹`
- **ä¸“ä¸šæœ¯è¯­**ï¼š`é‡‡ç”¨**åŒºå—é“¾æŠ€æœ¯**`

#### 4.3.3 è§‚ç‚¹ç±»ä¿¡æ¯
- **æ ¸å¿ƒè®ºç‚¹**ï¼š`**æˆ‘ä»¬å¿…é¡»è½¬å‹æ•°å­—åŒ–**`
- **å…³é”®ç»“è®º**ï¼š`**å› æ­¤ï¼Œè¿™ä¸ªæ–¹æ¡ˆä¸å¯è¡Œ**`
- **é‡è¦åˆ¤æ–­**ï¼š`**å¸‚åœºå·²ç»é¥±å’Œ**`
- **æˆ˜ç•¥å†³ç­–**ï¼š`**å†³å®šæš‚åœæ­¤é¡¹ç›®**`

#### 4.3.4 è¡ŒåŠ¨ç±»ä¿¡æ¯
- **æ‰¿è¯ºäº‹é¡¹**ï¼š`**æˆ‘ä¿è¯ä¸€å‘¨å†…ç»™å‡ºæ–¹æ¡ˆ**`
- **è¡ŒåŠ¨è®¡åˆ’**ï¼š`**ä¸‹ä¸€æ­¥å°†å¯åŠ¨å†…æµ‹**`
- **è´£ä»»åˆ†é…**ï¼š`**æŠ€æœ¯éƒ¨è´Ÿè´£å¼€å‘**`
- **æ—¶é—´è¦æ±‚**ï¼š`**å¿…é¡»åœ¨æœˆåº•å‰å®Œæˆ**`

#### 4.3.5 åŠ ç²—åˆ¤æ–­å†³ç­–æ ‘
```
å¬åˆ°å…³é”®è¯/çŸ­è¯­ â†’ åˆ¤æ–­ç±»åˆ«ï¼š
â”œâ”€ æ˜¯å¦åŒ…å«æ•°å­—/æ•°æ®ï¼Ÿâ†’ æ˜¯ â†’ åŠ ç²—
â”œâ”€ æ˜¯å¦æ˜¯ä¸“æœ‰åè¯ï¼Ÿâ†’ æ˜¯ â†’ åŠ ç²—
â”œâ”€ æ˜¯å¦è¡¨è¾¾æ ¸å¿ƒè§‚ç‚¹ï¼Ÿâ†’ æ˜¯ â†’ åŠ ç²—
â”œâ”€ æ˜¯å¦æ¶‰åŠè¡ŒåŠ¨æ‰¿è¯ºï¼Ÿâ†’ æ˜¯ â†’ åŠ ç²—
â”œâ”€ è¯´è¯äººæ˜¯å¦ç‰¹æ„å¼ºè°ƒï¼Ÿâ†’ æ˜¯ â†’ åŠ ç²—
â””â”€ å…¶ä»–æƒ…å†µ â†’ ä¸åŠ ç²—
```

### 4.4 éè¯­è¨€ä¿¡æ¯æ ‡æ³¨è§„èŒƒ

#### 4.4.1 æ ‡å‡†æ ‡æ³¨ç±»å‹
- **[å¬ä¸æ¸…]**ï¼šå®Œå…¨æ— æ³•è¾¨è¯†çš„éƒ¨åˆ†
- **[å¬ä¸æ¸…ï¼Œåƒæ˜¯"XXX"]**ï¼šæœ‰ä¸€å®šæŠŠæ¡çš„çŒœæµ‹
- **[é•¿æ—¶é—´åœé¡¿]**ï¼š3-5ç§’çš„åœé¡¿
- **[é•¿æ—¶é—´åœé¡¿ï¼Œçº¦Xç§’]**ï¼šè¶…è¿‡5ç§’çš„åœé¡¿
- **[ç¬‘]**ï¼šè¯´è¯äººçš„ç¬‘å£°
- **[å¹æ°”]**ï¼šæ˜æ˜¾çš„å¹æ¯å£°
- **[æ¸…å—“å­]**ï¼šæ¸…å—“å­çš„å£°éŸ³
- **[æ•²å‡»å£°]**ï¼šæ•²æ¡Œå­ç­‰èƒŒæ™¯éŸ³
- **[è¯­é€ŸåŠ å¿«]**ï¼šæ˜æ˜¾åŠ å¿«è¯­é€Ÿçš„æ®µè½
- **[è¯­é€Ÿæ”¾ç¼“]**ï¼šæ˜æ˜¾æ”¾æ…¢è¯­é€Ÿçš„æ®µè½
- **[æé«˜éŸ³é‡]**ï¼šæ˜æ˜¾æé«˜éŸ³é‡
- **[é™ä½éŸ³é‡]**ï¼šæ˜æ˜¾é™ä½éŸ³é‡åˆ°æ¥è¿‘è€³è¯­

#### 4.4.2 ç»„åˆæ ‡æ³¨ç¤ºä¾‹
- `[ç¬‘ï¼Œç„¶åè¯´]`ï¼šå…ˆç¬‘åè¯´è¯
- `[è¾¹ç¬‘è¾¹è¯´]`ï¼šè¯´è¯æ—¶å¸¦ç€ç¬‘æ„
- `[åœé¡¿ï¼Œæ·±å‘¼å¸]`ï¼šåœé¡¿å¹¶æ·±å‘¼å¸
- `[ä¸ç¡®å®šï¼Œå¯èƒ½æ˜¯"åˆ›æ–°"]`ï¼šå¯¹å…·ä½“è¯æ±‡ä¸ç¡®å®š

### 4.5 æ ‡ç‚¹ç¬¦å·ä½¿ç”¨è§„èŒƒ

#### 4.5.1 åŸºç¡€æ ‡ç‚¹
- **å¥å·ï¼ˆã€‚ï¼‰**ï¼šå®Œæ•´é™ˆè¿°å¥ç»“æŸ
- **é—®å·ï¼ˆï¼Ÿï¼‰**ï¼šç–‘é—®è¯­æ°”ï¼Œå³ä½¿æ˜¯åé—®
- **æ„Ÿå¹å·ï¼ˆï¼ï¼‰**ï¼šå¼ºçƒˆæƒ…æ„Ÿæˆ–å¼ºè°ƒ
- **é€—å·ï¼ˆï¼Œï¼‰**ï¼šå¥å†…åœé¡¿ã€å¹¶åˆ—æˆåˆ†
- **é¡¿å·ï¼ˆã€ï¼‰**ï¼šå¹¶åˆ—çš„è¯è¯­ä¹‹é—´

#### 4.5.2 ç‰¹æ®Šæ ‡ç‚¹
- **ç ´æŠ˜å·ï¼ˆâ€”â€”ï¼‰**ï¼šè¯é¢˜çªç„¶è½¬æ¢æˆ–è§£é‡Šè¯´æ˜
- **çœç•¥å·ï¼ˆâ€¦â€¦ï¼‰**ï¼šè¯éŸ³æ¸å¼±æˆ–æ•…æ„ä¸è¯´å®Œ
- **å†’å·ï¼ˆï¼šï¼‰**ï¼šå¼•å‡ºä¸‹æ–‡æˆ–åˆ—ä¸¾
- **å¼•å·ï¼ˆ""ï¼‰**ï¼šå¼•ç”¨ä»–äººçš„è¯æˆ–ç‰¹æ®Šå«ä¹‰
- **æ‹¬å·ï¼ˆï¼ˆï¼‰ï¼‰**ï¼šè¡¥å……è¯´æ˜ä¿¡æ¯

#### 4.5.3 æ ‡ç‚¹å†³ç­–æŒ‡å—
- çŸ­ä¿ƒåœé¡¿ï¼ˆ<1ç§’ï¼‰â†’ é€—å·
- å®Œæ•´åœé¡¿ï¼ˆ1-2ç§’ï¼‰â†’ å¥å·
- ä¸Šæ‰¬è¯­è°ƒ â†’ é—®å·ï¼ˆå³ä½¿ä¸æ˜¯ç–‘é—®è¯å¼€å¤´ï¼‰
- å¼ºè°ƒè¯­æ°” â†’ è€ƒè™‘æ„Ÿå¹å·
- æœªè¯´å®Œçš„è¯ â†’ çœç•¥å·

## 5. è¾“å‡ºç»“æ„è§„èŒƒï¼ˆä¸¥æ ¼éµå®ˆï¼‰

### 5.1 ç¬¬ä¸€éƒ¨åˆ†ï¼šå†…å®¹æ‘˜è¦
```
---
- **æ ‡é¢˜**: [15-30å­—çš„æ¦‚æ‹¬æ€§æ ‡é¢˜ï¼Œä½“ç°æ ¸å¿ƒä¸»é¢˜]
- **æ ¸å¿ƒè®ºç‚¹**: [ä¸€å¥è¯æ€»ç»“ï¼Œä¸è¶…è¿‡50å­—]
- **å…³é”®è¦ç‚¹**: 
  1. [è¦ç‚¹1ï¼šåŒ…å«å…·ä½“ä¿¡æ¯ï¼Œ15-30å­—]
  2. [è¦ç‚¹2ï¼šåŒ…å«å…·ä½“ä¿¡æ¯ï¼Œ15-30å­—]
  3. [è¦ç‚¹3ï¼šåŒ…å«å…·ä½“ä¿¡æ¯ï¼Œ15-30å­—]
  ... [3-5ä¸ªè¦ç‚¹ï¼Œç‰¹åˆ«é‡è¦çš„å†…å®¹å¯åˆ°7ä¸ª]
- **å…³é”®è¯**: [3-5ä¸ªæ ¸å¿ƒå…³é”®è¯ï¼Œç”¨é€—å·åˆ†éš”]
---
```

### 5.2 ç¬¬äºŒéƒ¨åˆ†ï¼šå®Œæ•´è½¬å½•æ–‡æœ¬
- ä»¥åˆç†åˆ†æ®µçš„å½¢å¼å‘ˆç°
- åŒ…å«æ‰€æœ‰æ ¼å¼åŒ–æ ‡æ³¨ï¼ˆåŠ ç²—ã€æ–¹æ‹¬å·ç­‰ï¼‰
- ä¿æŒåŸå§‹è¯­è¨€é£æ ¼
- ç¡®ä¿é˜…è¯»æµç•…æ€§

## 6. è´¨é‡æ£€æŸ¥æ¸…å•

### 6.1 è½¬å½•å‰æ£€æŸ¥
- [ ] äº†è§£å‘è¨€çš„åŸºæœ¬èƒŒæ™¯å’Œé¢†åŸŸ
- [ ] å‡†å¤‡ç›¸å…³é¢†åŸŸçš„ä¸“ä¸šæœ¯è¯­è¡¨
- [ ] è®¾å®šåˆé€‚çš„è´¨é‡é¢„æœŸï¼ˆåŸºäºéŸ³é¢‘è´¨é‡ï¼‰

### 6.2 è½¬å½•ä¸­æ£€æŸ¥
- [ ] æ˜¯å¦ä¿æŒäº†é€‚å½“çš„æ®µè½åˆ’åˆ†èŠ‚å¥
- [ ] å…³é”®ä¿¡æ¯æ˜¯å¦éƒ½å·²åŠ ç²—
- [ ] éè¯­è¨€ä¿¡æ¯æ˜¯å¦æ°å½“æ ‡æ³¨
- [ ] æ ‡ç‚¹ç¬¦å·æ˜¯å¦å‡†ç¡®åæ˜ è¯­æ°”

### 6.3 è½¬å½•åæ£€æŸ¥
- [ ] é€šè¯»å…¨æ–‡ï¼Œç¡®ä¿é€»è¾‘è¿è´¯
- [ ] æ£€æŸ¥æ•°å­—ã€ä¸“æœ‰åè¯çš„ä¸€è‡´æ€§
- [ ] ç¡®è®¤æ‘˜è¦å‡†ç¡®åæ˜ äº†æ­£æ–‡å†…å®¹
- [ ] éªŒè¯æ ¼å¼ç¬¦åˆè§„èŒƒè¦æ±‚

## 7. åœºæ™¯åŒ–å¤„ç†æŒ‡å—

### 7.1 å•†åŠ¡ä¼šè®®åœºæ™¯
- **é‡ç‚¹å…³æ³¨**ï¼šå†³ç­–ã€æ•°æ®ã€è´£ä»»åˆ†é…ã€æ—¶é—´èŠ‚ç‚¹
- **æ®µè½åˆ’åˆ†**ï¼šæŒ‰è®®é¢˜åˆ’åˆ†
- **ç‰¹åˆ«æ³¨æ„**ï¼šä¼šè®®ç»“è®ºå’Œåç»­è¡ŒåŠ¨

### 7.2 å­¦æœ¯æ¼”è®²åœºæ™¯
- **é‡ç‚¹å…³æ³¨**ï¼šæ ¸å¿ƒæ¦‚å¿µã€è®ºè¯é€»è¾‘ã€ç ”ç©¶æ•°æ®
- **æ®µè½åˆ’åˆ†**ï¼šæŒ‰è®ºè¿°å±‚æ¬¡åˆ’åˆ†
- **ç‰¹åˆ«æ³¨æ„**ï¼šä¸“ä¸šæœ¯è¯­çš„å‡†ç¡®æ€§

### 7.3 äº§å“å‘å¸ƒåœºæ™¯
- **é‡ç‚¹å…³æ³¨**ï¼šäº§å“ç‰¹ç‚¹ã€æŠ€æœ¯å‚æ•°ã€å‘å¸ƒæ—¶é—´ã€ä»·æ ¼
- **æ®µè½åˆ’åˆ†**ï¼šæŒ‰äº§å“ç‰¹æ€§æ¨¡å—åˆ’åˆ†
- **ç‰¹åˆ«æ³¨æ„**ï¼šè¥é”€è¯æœ¯ä¸­çš„å…³é”®æ‰¿è¯º

### 7.4 åŸ¹è®­è®²åº§åœºæ™¯
- **é‡ç‚¹å…³æ³¨**ï¼šçŸ¥è¯†è¦ç‚¹ã€æ“ä½œæ­¥éª¤ã€æ³¨æ„äº‹é¡¹
- **æ®µè½åˆ’åˆ†**ï¼šæŒ‰æ•™å­¦æ¨¡å—åˆ’åˆ†
- **ç‰¹åˆ«æ³¨æ„**ï¼šä¸¾ä¾‹è¯´æ˜çš„å®Œæ•´æ€§

## 8. é«˜çº§æŠ€å·§ä¸æœ€ä½³å®è·µ

### 8.1 æ­§ä¹‰å¤„ç†åŸåˆ™
1. **ä¸Šä¸‹æ–‡ä¼˜å…ˆ**ï¼šæ ¹æ®ä¸Šä¸‹æ–‡åˆç†æ¨æ–­
2. **æ ‡æ³¨è¯´æ˜**ï¼šæ— æ³•ç¡®å®šæ—¶è¯šå®æ ‡æ³¨
3. **ä¸€è‡´æ€§åŸåˆ™**ï¼šåŒä¸€æœ¯è¯­ä¿æŒä¸€è‡´å†™æ³•
4. **æŸ¥è¯å»ºè®®**ï¼šå¯¹å…³é”®æ•°æ®å»ºè®®æŸ¥è¯

### 8.2 æ•ˆç‡æå‡æŠ€å·§
1. **æ¨¡æ¿åŒ–æ€ç»´**ï¼šè¯†åˆ«å‘è¨€çš„å¸¸è§æ¨¡å¼
2. **å…³é”®è¯é¢„åˆ¤**ï¼šæ ¹æ®ä¸»é¢˜é¢„åˆ¤å¯èƒ½å‡ºç°çš„å…³é”®è¯
3. **ç¬¦å·ç³»ç»Ÿ**ï¼šå»ºç«‹ä¸ªäººçš„å¿«é€Ÿæ ‡è®°ç³»ç»Ÿ
4. **æ‰¹é‡å¤„ç†**ï¼šç›¸ä¼¼å†…å®¹ç»Ÿä¸€å¤„ç†æ ‡å‡†

### 8.3 ä¸“ä¸šç´ å…»è¦æ±‚
1. **è¡Œä¸šçŸ¥è¯†**ï¼šä¸æ–­ç§¯ç´¯å„è¡Œä¸šåŸºç¡€çŸ¥è¯†
2. **è¯­è¨€æ•æ„Ÿ**ï¼šåŸ¹å…»å¯¹è¯­è¨€ç»†å¾®å·®åˆ«çš„æ„ŸçŸ¥
3. **ç»“æ„æ€ç»´**ï¼šé”»ç‚¼ä¿¡æ¯ç»„ç»‡å’Œå½’çº³èƒ½åŠ›
4. **ç”¨æˆ·æ„è¯†**ï¼šå§‹ç»ˆè€ƒè™‘è¯»è€…çš„éœ€æ±‚

## 9. ç¤ºä¾‹å±•ç¤ºï¼ˆå¤šæ ·åŒ–åœºæ™¯ï¼‰

### 9.1 ç¤ºä¾‹ä¸€ï¼šä¼ä¸šæˆ˜ç•¥ä¼šè®®ï¼ˆæ ‡å‡†åœºæ™¯ï¼‰

**è¾“å…¥**ï¼šæŸå…¬å¸Q3å¤ç›˜ä¼šè®®å½•éŸ³ç‰‡æ®µ

**è¾“å‡º**ï¼š
```
---
- **æ ‡é¢˜**: Q3äº§å“æˆ˜ç•¥å¤ç›˜æš¨Q4å‘å±•æ–¹å‘è°ƒæ•´ä¼šè®®
- **æ ¸å¿ƒè®ºç‚¹**: åŸºäºQ3æ•°æ®åˆ†æï¼Œå†³å®šæš‚åœ"çµåŠ¨è®¡åˆ’"ï¼Œå…¨åŠ›å‘å±•ä¼ä¸šçº§AIå®šåˆ¶åŒ–äº§å“
- **å…³é”®è¦ç‚¹**: 
  1. "çµåŠ¨è®¡åˆ’"ç”¨æˆ·è½¬åŒ–ç‡ä»…**2%**ï¼Œè¿œä½äº**8%**é¢„æœŸ
  2. ä¼ä¸šçº§å®¢æˆ·ç»­çº¦ç‡è¾¾**95%**ï¼Œå®¢å•ä»·æå‡**10%**
  3. è®¡åˆ’Q4æ¨å‡ºä¼ä¸šç‰ˆV3.0ï¼Œæ–°å¢**AIå®šåˆ¶åŒ–æŠ¥è¡¨**åŠŸèƒ½
  4. ç ”å‘èµ„æºå°†ä»æ¶ˆè´¹ç«¯è½¬å‘ä¼ä¸šç«¯ï¼Œç”±CEOäº²è‡ªè´Ÿè´£
  5. ç›®æ ‡åœ¨**åœ£è¯èŠ‚å‰**å‘å¸ƒBetaç‰ˆæœ¬
- **å…³é”®è¯**: æˆ˜ç•¥è°ƒæ•´, ä¼ä¸šçº§å¸‚åœº, AIå®šåˆ¶åŒ–, èµ„æºé‡é…, Q4è§„åˆ’
---

å„ä½å¥½ï¼Œä»Šå¤©æˆ‘æƒ³å’Œå¤§å®¶æ·±å…¥æ¢è®¨ä¸€ä¸‹æˆ‘ä»¬ç¬¬ä¸‰å­£åº¦çš„äº§å“æˆ˜ç•¥æ‰§è¡Œæƒ…å†µï¼Œä»¥åŠåŸºäºæ•°æ®åˆ†æå¾—å‡ºçš„ä¸€äº›é‡è¦ç»“è®ºã€‚

é¦–å…ˆï¼Œæˆ‘å¿…é¡»å¦è¯šåœ°è¯´ï¼Œæˆ‘ä»¬åœ¨å¹´åˆå¯„äºˆåšæœ›çš„**"çµåŠ¨è®¡åˆ’"**ï¼Œåœ¨Q3çš„è¡¨ç°ç¡®å®ä¸å°½å¦‚äººæ„ã€‚æ ¹æ®æ•°æ®å›¢é˜Ÿæä¾›çš„æŠ¥å‘Šï¼Œå°½ç®¡æˆ‘ä»¬æŠ•å…¥äº†**å°†è¿‘300ä¸‡**çš„å¸‚åœºæ¨å¹¿è´¹ç”¨ï¼Œä½†å®é™…çš„æ´»è·ƒç”¨æˆ·è½¬åŒ–ç‡åªè¾¾åˆ°äº†**2%**ï¼Œè¿™ä¸æˆ‘ä»¬é¢„è®¾çš„**8%**ç›®æ ‡ç›¸å·®ç”šè¿œã€‚[é•¿æ—¶é—´åœé¡¿ï¼Œçº¦5ç§’] 

æˆ‘æ˜¨å¤©ä¸“é—¨å’Œç”¨æˆ·ç ”ç©¶å›¢é˜Ÿå¼€äº†ä¸ªä¼šï¼Œæ·±å…¥åˆ†æäº†è¿™ä¸ªé—®é¢˜ã€‚ä»–ä»¬çš„åé¦ˆæ˜¯ï¼Œæˆ‘ä»¬å¯èƒ½ä½ä¼°äº†Cç«¯ç”¨æˆ·å¯¹è¿™ç±»åˆ›æ–°äº§å“çš„æ¥å—é—¨æ§›ï¼ŒåŒæ—¶æˆ‘ä»¬çš„äº§å“å®šä½â€”â€”[æ¸…å—“å­]â€”â€”æˆ‘ä»¬çš„äº§å“å®šä½å¯èƒ½ä¹Ÿå­˜åœ¨ä¸€äº›åå·®ï¼Œæ²¡æœ‰å¾ˆå¥½åœ°æ‰“åˆ°ç”¨æˆ·çš„ç—›ç‚¹ä¸Šã€‚

ä½†æ˜¯ï¼Œ[æé«˜éŸ³é‡] æˆ‘æƒ³å¼ºè°ƒçš„æ˜¯ï¼Œè¿™å¹¶ä¸æ„å‘³ç€æˆ‘ä»¬çš„å›¢é˜Ÿèƒ½åŠ›æœ‰é—®é¢˜ï¼Œæ°æ°ç›¸åï¼Œè¿™è¯´æ˜æˆ‘ä»¬æœ‰å‹‡æ°”å»å°è¯•æ–°çš„æ–¹å‘ã€‚**åˆ›æ–°æœ¬èº«å°±æ˜¯æœ‰é£é™©çš„**ï¼Œå…³é”®æ˜¯æˆ‘ä»¬è¦èƒ½å¤Ÿå¿«é€Ÿåœ°ä»æ•°æ®ä¸­å­¦ä¹ ï¼ŒåŠæ—¶è°ƒæ•´æ–¹å‘ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘è¦åˆ†äº«ä¸€ä¸ªä»¤äººæŒ¯å¥‹çš„æ•°æ®ã€‚æˆ‘ä»¬çš„ä¼ ç»Ÿä¼˜åŠ¿é¡¹ç›®â€”â€”**ä¼ä¸šçº§å®¢æˆ·æœåŠ¡**ï¼Œåœ¨Q3å±•ç°å‡ºäº†æå¼ºçš„ç”Ÿå‘½åŠ›ã€‚[è¯­é€Ÿæ”¾ç¼“] ç»­çº¦ç‡è¾¾åˆ°äº†**95%**ï¼Œè¿™ä¸ªæ•°å­—ï¼Œè¯´å®è¯ï¼Œè¿æˆ‘è‡ªå·±éƒ½æ„Ÿåˆ°æƒŠè®¶ã€‚ä¸ä»…å¦‚æ­¤ï¼Œå¹³å‡å®¢å•ä»·è¿˜æœ‰**10%**çš„æå‡ï¼Œè¾¾åˆ°äº†**48ä¸‡/å¹´**ã€‚

æ›´é‡è¦çš„æ˜¯ï¼Œ[åŠ é‡è¯­æ°”] ä¸Šå‘¨é”€å”®å›¢é˜Ÿçš„åé¦ˆæ˜¾ç¤ºï¼Œ**è¶…è¿‡60%**çš„ä¼ä¸šå®¢æˆ·éƒ½åœ¨è¯¢é—®æˆ‘ä»¬æ˜¯å¦èƒ½æä¾›**AIé©±åŠ¨çš„å®šåˆ¶åŒ–æŠ¥è¡¨**åŠŸèƒ½ã€‚[æ•²å‡»å£°] è¿™æ˜¯ä¸€ä¸ªéå¸¸æ˜ç¡®çš„å¸‚åœºä¿¡å·ï¼å¸‚åœºåœ¨å‘Šè¯‰æˆ‘ä»¬ï¼Œä¼ä¸šå®¢æˆ·éœ€è¦çš„ä¸æ˜¯èŠ±é‡Œèƒ¡å“¨çš„åŠŸèƒ½ï¼Œè€Œæ˜¯èƒ½å¤ŸçœŸæ­£æå‡ä»–ä»¬å·¥ä½œæ•ˆç‡çš„**æ™ºèƒ½åŒ–å·¥å…·**ã€‚

[é•¿æ—¶é—´åœé¡¿]

åŸºäºä»¥ä¸Šçš„æ•°æ®åˆ†æå’Œå¸‚åœºåé¦ˆï¼Œæˆ‘æƒ³æå‡ºä¸€ä¸ªå¯èƒ½ä¼šè®©å¤§å®¶æ„Ÿåˆ°æ„å¤–ï¼Œä½†æˆ‘è®¤ä¸ºæ˜¯å¿…è¦çš„æˆ˜ç•¥è°ƒæ•´å»ºè®®ã€‚

**ç¬¬ä¸€ï¼Œæˆ‘å»ºè®®ä»10æœˆ1æ—¥èµ·ï¼Œæ­£å¼æš‚åœ"çµåŠ¨è®¡åˆ’"çš„è¿›ä¸€æ­¥æŠ•å…¥ã€‚**æ³¨æ„ï¼Œæˆ‘è¯´çš„æ˜¯"æš‚åœ"è€Œä¸æ˜¯"ç»ˆæ­¢"ï¼Œå› ä¸ºæˆ‘ç›¸ä¿¡è¿™ä¸ªæ–¹å‘åœ¨æœªæ¥æŸä¸ªæ—¶ç‚¹å¯èƒ½ä¼šæœ‰æœºä¼šï¼Œä½†æ˜¾ç„¶ä¸æ˜¯ç°åœ¨ã€‚

**ç¬¬äºŒï¼Œå°†"çµåŠ¨è®¡åˆ’"å›¢é˜Ÿçš„æ ¸å¿ƒç ”å‘åŠ›é‡ï¼Œç‰¹åˆ«æ˜¯æˆ‘ä»¬çš„AIç®—æ³•å›¢é˜Ÿï¼Œå…¨éƒ¨è°ƒæ•´åˆ°ä¼ä¸šäº§å“çº¿ä¸Šæ¥ã€‚**[æé«˜éŸ³é‡] æˆ‘ä»¬è¦é›†ä¸­æ‰€æœ‰çš„ä¼˜åŠ¿èµ„æºï¼Œåœ¨ä¼ä¸šçº§å¸‚åœºä¸Šæ‰“ä¸€åœºæ¼‚äº®ä»—ï¼

**ç¬¬ä¸‰ï¼Œè®¾ç«‹æ˜ç¡®çš„Q4ç›®æ ‡ï¼šåœ¨åœ£è¯èŠ‚å‰ï¼Œä¹Ÿå°±æ˜¯12æœˆ24æ—¥ä¹‹å‰ï¼Œæ¨å‡ºå¸¦æœ‰AIå®šåˆ¶åŒ–èƒ½åŠ›çš„ä¼ä¸šç‰ˆV3.0çš„Betaç‰ˆæœ¬ã€‚**

æˆ‘çŸ¥é“è¿™ä¸ªæ—¶é—´å¾ˆç´§ï¼Œåªæœ‰ä¸åˆ°ä¸‰ä¸ªæœˆï¼Œä½†æ˜¯[é•¿æ—¶é—´åœé¡¿] ä½†æ˜¯æˆ‘ç›¸ä¿¡æˆ‘ä»¬çš„å›¢é˜Ÿæœ‰è¿™ä¸ªèƒ½åŠ›ã€‚**æˆ‘åœ¨è¿™é‡Œéƒ‘é‡æ‰¿è¯ºï¼Œæˆ‘å°†äº²è‡ªæ‹…ä»»è¿™ä¸ªé¡¹ç›®çš„è´Ÿè´£äºº**ï¼Œæ¯å‘¨è‡³å°‘æŠ•å…¥**ä¸‰å¤©æ—¶é—´**æ¥æ¨è¿›è¿™ä¸ªé¡¹ç›®ã€‚

[è¯­é€ŸåŠ å¿«] å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬çš„ä¼ä¸šç‰ˆV3.0å°†åŒ…å«ä»¥ä¸‹å‡ ä¸ªæ ¸å¿ƒåŠŸèƒ½ï¼šç¬¬ä¸€ï¼Œ**æ™ºèƒ½æŠ¥è¡¨ç”Ÿæˆå™¨**ï¼Œç”¨æˆ·åªéœ€è¦ç”¨è‡ªç„¶è¯­è¨€æè¿°éœ€æ±‚ï¼Œç³»ç»Ÿå°±èƒ½è‡ªåŠ¨ç”Ÿæˆç›¸åº”çš„æŠ¥è¡¨ï¼›ç¬¬äºŒï¼Œ**é¢„æµ‹æ€§åˆ†ææ¨¡å—**ï¼ŒåŸºäºå†å²æ•°æ®æä¾›ä¸šåŠ¡é¢„æµ‹ï¼›ç¬¬ä¸‰ï¼Œ**å¼‚å¸¸æ£€æµ‹ç³»ç»Ÿ**ï¼Œå®æ—¶ç›‘æ§ä¸šåŠ¡æŒ‡æ ‡å¹¶é¢„è­¦ï¼›ç¬¬å››ï¼Œä¹Ÿæ˜¯æœ€é‡è¦çš„ï¼Œ**å®Œå…¨å¯å®šåˆ¶çš„AIæ¨¡å‹**ï¼Œå…è®¸ä¼ä¸šæ ¹æ®è‡ªå·±çš„ä¸šåŠ¡ç‰¹ç‚¹è®­ç»ƒä¸“å±æ¨¡å‹ã€‚

[é™ä½éŸ³é‡] æˆ‘çŸ¥é“ï¼Œè¿™æ ·çš„è°ƒæ•´å¯¹äºä¸€ç›´åœ¨"çµåŠ¨è®¡åˆ’"ä¸Šä»˜å‡ºå¿ƒè¡€çš„åŒäº‹ä»¬æ¥è¯´ï¼Œå¯èƒ½ä¼šæœ‰äº›å¤±è½ã€‚ä½†è¯·ç›¸ä¿¡æˆ‘ï¼Œè¿™ä¸æ˜¯å¦å®šå¤§å®¶çš„å·¥ä½œï¼Œè€Œæ˜¯åŸºäºå¸‚åœºåé¦ˆåšå‡ºçš„ç†æ€§é€‰æ‹©ã€‚ä½ ä»¬åœ¨"çµåŠ¨è®¡åˆ’"ä¸­ç§¯ç´¯çš„ç»éªŒï¼Œç‰¹åˆ«æ˜¯åœ¨ç”¨æˆ·äº¤äº’è®¾è®¡å’ŒAIç®—æ³•ä¼˜åŒ–æ–¹é¢çš„ç»éªŒï¼Œå°†æˆä¸ºæˆ‘ä»¬å¾æˆ˜ä¼ä¸šçº§å¸‚åœºçš„**æ ¸å¿ƒç«äº‰åŠ›**ã€‚

æœ€åï¼Œ[æ¸…å—“å­] æˆ‘æƒ³å¼•ç”¨å½¼å¾—Â·å¾·é²å…‹çš„ä¸€å¥è¯ï¼š"**æˆ˜ç•¥ä¸æ˜¯ç ”ç©¶æˆ‘ä»¬æœªæ¥è¦åšä»€ä¹ˆï¼Œè€Œæ˜¯ç ”ç©¶æˆ‘ä»¬ä»Šå¤©åšä»€ä¹ˆæ‰æœ‰æœªæ¥ã€‚**"[é•¿æ—¶é—´åœé¡¿ï¼Œçº¦4ç§’] 

è®©æˆ‘ä»¬ä¸€èµ·ï¼ŒæŠŠæ¡ä½ä¼ä¸šçº§å¸‚åœºè¿™ä¸ªç¡®å®šæ€§çš„æœºä¼šï¼Œåœ¨Q4æ‰“ä¸€ä¸ªæ¼‚äº®çš„ç¿»èº«ä»—ï¼è°¢è°¢å¤§å®¶ï¼

[é•¿æ—¶é—´åœé¡¿ï¼Œéšåæœ‰é›¶æ˜ŸæŒå£°]
```

### 9.2 ç¤ºä¾‹äºŒï¼šæŠ€æœ¯åˆ†äº«ä¼šï¼ˆä¸“ä¸šæœ¯è¯­å¯†é›†ï¼‰

**è¾“å…¥**ï¼šæŸæŠ€æœ¯æ¶æ„å¸ˆå…³äºå¾®æœåŠ¡æ”¹é€ çš„åˆ†äº«

**è¾“å‡º**ï¼š
```
---
- **æ ‡é¢˜**: åŸºäºDDDçš„å¾®æœåŠ¡æ¶æ„æ”¹é€ å®è·µåˆ†äº«
- **æ ¸å¿ƒè®ºç‚¹**: é€šè¿‡é¢†åŸŸé©±åŠ¨è®¾è®¡æ–¹æ³•è®ºæŒ‡å¯¼å¾®æœåŠ¡æ‹†åˆ†ï¼Œå¯ä»¥æœ‰æ•ˆé¿å…æœåŠ¡è¾¹ç•Œä¸æ¸…çš„é—®é¢˜
- **å…³é”®è¦ç‚¹**: 
  1. é‡‡ç”¨**EventStorming**å·¥ä½œåŠè¯†åˆ«é¢†åŸŸè¾¹ç•Œ
  2. åŸºäº**é™ç•Œä¸Šä¸‹æ–‡**è¿›è¡ŒæœåŠ¡æ‹†åˆ†ï¼Œé¿å…è¿‡åº¦æ‹†åˆ†
  3. ä½¿ç”¨**Sagaæ¨¡å¼**è§£å†³åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜
  4. æ€§èƒ½æå‡**40%**ï¼Œéƒ¨ç½²é¢‘ç‡æé«˜**3å€**
- **å…³é”®è¯**: DDD, å¾®æœåŠ¡, EventStorming, é™ç•Œä¸Šä¸‹æ–‡, Sagaæ¨¡å¼
---

å¤§å®¶ä¸‹åˆå¥½ï¼ä»Šå¤©å¾ˆé«˜å…´èƒ½å’Œå¤§å®¶åˆ†äº«æˆ‘ä»¬å›¢é˜Ÿåœ¨è¿‡å»åŠå¹´è¿›è¡Œçš„**å¾®æœåŠ¡æ¶æ„æ”¹é€ **é¡¹ç›®çš„ä¸€äº›å¿ƒå¾—ä½“ä¼šã€‚

åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘æƒ³å…ˆé—®å¤§å®¶ä¸€ä¸ªé—®é¢˜ï¼š[åœé¡¿] æœ‰å¤šå°‘äººåœ¨åšå¾®æœåŠ¡æ”¹é€ çš„æ—¶å€™ï¼Œé‡åˆ°è¿‡è¿™æ ·çš„å›°æ‰°â€”â€”ä¸çŸ¥é“è¯¥å¦‚ä½•åˆç†åœ°åˆ’åˆ†æœåŠ¡è¾¹ç•Œï¼Ÿ[ç¬‘] æˆ‘çœ‹åˆ°å¾ˆå¤šäººåœ¨ç‚¹å¤´ã€‚

ç¡®å®ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸šç•Œæ™®éå­˜åœ¨çš„é—®é¢˜ã€‚å¾ˆå¤šå›¢é˜Ÿåœ¨åšå¾®æœåŠ¡çš„æ—¶å€™ï¼Œè¦ä¹ˆæ‹†å¾—å¤ªç»†ï¼Œå¯¼è‡´æœåŠ¡é—´çš„è°ƒç”¨å…³ç³»å¼‚å¸¸å¤æ‚ï¼›è¦ä¹ˆæ‹†å¾—å¤ªç²—ï¼Œæœ¬è´¨ä¸Šè¿˜æ˜¯ä¸ªå•ä½“åº”ç”¨ï¼Œåªæ˜¯æŠ«äº†ä¸ªå¾®æœåŠ¡çš„å¤–è¡£ã€‚

æˆ‘ä»¬åœ¨é¡¹ç›®åˆæœŸä¹Ÿé¢ä¸´åŒæ ·çš„å›°å¢ƒã€‚ç›´åˆ°æˆ‘ä»¬å¼•å…¥äº†**DDDï¼ˆDomain-Driven Designï¼‰é¢†åŸŸé©±åŠ¨è®¾è®¡**çš„æ–¹æ³•è®ºï¼Œæƒ…å†µæ‰æœ‰äº†æ ¹æœ¬æ€§çš„æ”¹è§‚ã€‚

å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬é‡‡ç”¨äº†**EventStorming**è¿™ä¸ªå·¥ä½œåŠå½¢å¼ã€‚[å¬ä¸æ¸…ï¼Œåƒæ˜¯"è¿™ä¸ªæ–¹æ³•"]æ˜¯ç”±Alberto Brandoliniæå‡ºçš„ï¼Œå®ƒé€šè¿‡ä¸€ç§å¯è§†åŒ–çš„æ–¹å¼ï¼Œå¸®åŠ©å›¢é˜Ÿå¿«é€Ÿè¯†åˆ«ä¸šåŠ¡ä¸­çš„**é¢†åŸŸäº‹ä»¶**ã€**å‘½ä»¤**ã€**èšåˆ**ç­‰æ ¸å¿ƒæ¦‚å¿µã€‚

[è¯­é€Ÿæ”¾ç¼“] æˆ‘æ¥ä¸¾ä¸ªå…·ä½“çš„ä¾‹å­ã€‚åœ¨æˆ‘ä»¬çš„ç”µå•†ç³»ç»Ÿä¸­ï¼Œ"è®¢å•"è¿™ä¸ªæ¦‚å¿µï¼Œåœ¨ä¸åŒçš„ä¸Šä¸‹æ–‡ä¸­æœ‰ç€å®Œå…¨ä¸åŒçš„å«ä¹‰ã€‚åœ¨**äº¤æ˜“ä¸Šä¸‹æ–‡**ä¸­ï¼Œè®¢å•å…³æ³¨çš„æ˜¯ä»·æ ¼ã€æ”¯ä»˜çŠ¶æ€ï¼›åœ¨**å±¥çº¦ä¸Šä¸‹æ–‡**ä¸­ï¼Œè®¢å•å…³æ³¨çš„æ˜¯åº“å­˜ã€ç‰©æµä¿¡æ¯ï¼›åœ¨**å”®åä¸Šä¸‹æ–‡**ä¸­ï¼Œè®¢å•å…³æ³¨çš„æ˜¯é€€æ¬¾ã€æ¢è´§æ”¿ç­–ã€‚

å¦‚æœæˆ‘ä»¬ä¸åŒºåˆ†è¿™äº›**é™ç•Œä¸Šä¸‹æ–‡ï¼ˆBounded Contextï¼‰**ï¼ŒæŠŠæ‰€æœ‰è®¢å•ç›¸å…³çš„é€»è¾‘éƒ½æ”¾åœ¨ä¸€ä¸ªæœåŠ¡é‡Œï¼Œé‚£è¿™ä¸ªæœåŠ¡ä¼šå˜å¾—å¼‚å¸¸è‡ƒè‚¿ï¼Œ[åŠ é‡è¯­æ°”] æœ€åä½ ä¼šå‘ç°ï¼Œ**è¿™ä¸ªæ‰€è°“çš„è®¢å•æœåŠ¡ï¼Œä¼šå˜æˆæ•´ä¸ªç³»ç»Ÿçš„ä¸Šå¸æœåŠ¡**ï¼Œæ‰€æœ‰çš„ä¸šåŠ¡é€»è¾‘éƒ½å¾€é‡Œé¢å¡ã€‚

[é•¿æ—¶é—´åœé¡¿ï¼Œçº¦4ç§’]

åŸºäºDDDçš„åˆ†æï¼Œæˆ‘ä»¬æœ€ç»ˆå°†åŸæ¥çš„å•ä½“åº”ç”¨æ‹†åˆ†æˆäº†**12ä¸ªå¾®æœåŠ¡**ã€‚æ¯ä¸ªæœåŠ¡éƒ½æœ‰æ˜ç¡®çš„è¾¹ç•Œå’ŒèŒè´£ã€‚æ¯”å¦‚ï¼š
- **äº¤æ˜“æœåŠ¡**ï¼šè´Ÿè´£è®¢å•åˆ›å»ºã€ä»·æ ¼è®¡ç®—ã€æ”¯ä»˜å¯¹æ¥
- **åº“å­˜æœåŠ¡**ï¼šè´Ÿè´£åº“å­˜æ‰£å‡ã€é¢„å ã€é‡Šæ”¾
- **å±¥çº¦æœåŠ¡**ï¼šè´Ÿè´£å‘è´§ã€ç‰©æµè·Ÿè¸ª
- **ç”¨æˆ·æœåŠ¡**ï¼šè´Ÿè´£ç”¨æˆ·ä¿¡æ¯ã€è®¤è¯ã€æˆæƒ

ä½†æ˜¯ï¼Œ[æé«˜éŸ³é‡] æœåŠ¡æ‹†åˆ†åªæ˜¯ç¬¬ä¸€æ­¥ï¼æ‹†åˆ†ä¹‹åï¼Œä½ é©¬ä¸Šä¼šé‡åˆ°å¦ä¸€ä¸ªå¤´ç–¼çš„é—®é¢˜â€”â€”**åˆ†å¸ƒå¼äº‹åŠ¡**ã€‚

[è¾¹ç¬‘è¾¹è¯´] ç›¸ä¿¡åšè¿‡å¾®æœåŠ¡çš„åŒå­¦éƒ½æ·±æœ‰ä½“ä¼šï¼Œå½“ä¸€ä¸ªä¸šåŠ¡æµç¨‹éœ€è¦è·¨å¤šä¸ªæœåŠ¡åä½œæ—¶ï¼Œå¦‚ä½•ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ï¼Ÿä¼ ç»Ÿçš„**ä¸¤é˜¶æ®µæäº¤ï¼ˆ2PCï¼‰**åœ¨å¾®æœåŠ¡åœºæ™¯ä¸‹å‡ ä¹æ˜¯ä¸å¯è¡Œçš„ï¼Œæ€§èƒ½å¤ªå·®ï¼Œè€Œä¸”è¿èƒŒäº†æœåŠ¡è‡ªæ²»çš„åŸåˆ™ã€‚

æˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆæ˜¯é‡‡ç”¨**Sagaæ¨¡å¼**ã€‚ç®€å•æ¥è¯´ï¼ŒSagaå°†ä¸€ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡æ‹†åˆ†æˆä¸€ç³»åˆ—çš„æœ¬åœ°äº‹åŠ¡ï¼Œæ¯ä¸ªæœ¬åœ°äº‹åŠ¡éƒ½æœ‰ç›¸åº”çš„è¡¥å¿æ“ä½œã€‚å¦‚æœæŸä¸ªæ­¥éª¤å¤±è´¥äº†ï¼Œ[è¯­é€ŸåŠ å¿«] å°±æ‰§è¡Œè¡¥å¿æ“ä½œæ¥å›æ»šä¹‹å‰çš„æ“ä½œã€‚

[æ¸…å—“å­] ä¸¾ä¸ªä¾‹å­ï¼Œç”¨æˆ·ä¸‹å•çš„æµç¨‹ï¼š
1. äº¤æ˜“æœåŠ¡åˆ›å»ºè®¢å• â†’ è¡¥å¿ï¼šå–æ¶ˆè®¢å•
2. åº“å­˜æœåŠ¡æ‰£å‡åº“å­˜ â†’ è¡¥å¿ï¼šæ¢å¤åº“å­˜  
3. æ”¯ä»˜æœåŠ¡æ‰£æ¬¾ â†’ è¡¥å¿ï¼šé€€æ¬¾
4. å±¥çº¦æœåŠ¡åˆ›å»ºå‘è´§å• â†’ è¡¥å¿ï¼šå–æ¶ˆå‘è´§

æˆ‘ä»¬ä½¿ç”¨äº†**Apache Camel**æ¥å®ç°Sagaçš„ç¼–æ’ï¼Œ[å¬ä¸æ¸…] å®ƒæä¾›äº†å¾ˆå¥½çš„DSLæ¥å®šä¹‰è¿™äº›æµç¨‹ã€‚

ç»è¿‡åŠå¹´çš„æ”¹é€ ï¼Œæ•ˆæœè¿˜æ˜¯å¾ˆæ˜æ˜¾çš„ï¼š
- **ç³»ç»Ÿæ€§èƒ½æå‡äº†40%**ï¼Œä¸»è¦æ˜¯å› ä¸ºæœåŠ¡å¯ä»¥ç‹¬ç«‹æ‰©ç¼©å®¹
- **éƒ¨ç½²é¢‘ç‡ä»æ¯ä¸¤å‘¨ä¸€æ¬¡æå‡åˆ°æ¯å¤©3-5æ¬¡**
- **æ•…éšœéš”ç¦»èƒ½åŠ›å¤§å¹…æå‡**ï¼Œå•ä¸ªæœåŠ¡çš„æ•…éšœä¸ä¼šå½±å“æ•´ä¸ªç³»ç»Ÿ
- **å¼€å‘æ•ˆç‡æé«˜**ï¼Œä¸åŒå›¢é˜Ÿå¯ä»¥å¹¶è¡Œå¼€å‘

å½“ç„¶ï¼Œ[å¹æ°”] æˆ‘å¿…é¡»æ‰¿è®¤ï¼Œå¾®æœåŠ¡æ”¹é€ ä¸æ˜¯é“¶å¼¹ã€‚å®ƒä¹Ÿå¸¦æ¥äº†ä¸€äº›æ–°çš„æŒ‘æˆ˜ï¼š
- **è¿ç»´å¤æ‚åº¦**æ€¥å‰§ä¸Šå‡ï¼Œä½ éœ€è¦æŠ•å…¥å¤§é‡ç²¾åŠ›åœ¨ç›‘æ§ã€æ—¥å¿—ã€è°ƒç”¨é“¾è¿½è¸ªä¸Š
- **æµ‹è¯•éš¾åº¦**å¢åŠ ï¼Œç‰¹åˆ«æ˜¯é›†æˆæµ‹è¯•
- **ç½‘ç»œå¼€é”€**ä¸å®¹å¿½è§†ï¼ŒæœåŠ¡é—´çš„é€šä¿¡æˆæœ¬è¦è€ƒè™‘

[é•¿æ—¶é—´åœé¡¿ï¼Œçº¦6ç§’]

æ€»ç»“ä¸€ä¸‹ï¼Œæˆ‘çš„æ ¸å¿ƒè§‚ç‚¹æ˜¯ï¼š**å¾®æœåŠ¡æ”¹é€ ä¸€å®šè¦ä»¥ä¸šåŠ¡ä¸ºé©±åŠ¨ï¼Œä»¥DDDä¸ºæŒ‡å¯¼**ã€‚ä¸è¦ä¸ºäº†å¾®æœåŠ¡è€Œå¾®æœåŠ¡ï¼Œ[åŠ é‡è¯­æ°”] æ›´ä¸è¦ç›²ç›®è¿½æ±‚æŠ€æœ¯æ½®æµã€‚

æœ€åï¼Œé€ç»™å¤§å®¶ä¸€å¥è¯ï¼š[è¯­é€Ÿæ”¾ç¼“] **"å¥½çš„æ¶æ„ä¸æ˜¯è®¾è®¡å‡ºæ¥çš„ï¼Œè€Œæ˜¯æ¼”è¿›å‡ºæ¥çš„ã€‚"**

è°¢è°¢å¤§å®¶ï¼å¦‚æœæœ‰é—®é¢˜ï¼Œæ¬¢è¿éšæ—¶äº¤æµã€‚
```

### 9.3 ç¤ºä¾‹ä¸‰ï¼šäº§å“ç»ç†ç”¨æˆ·è°ƒç ”åˆ†äº«ï¼ˆå£è¯­åŒ–é£æ ¼ï¼‰

**è¾“å…¥**ï¼šæŸäº§å“ç»ç†åˆ†äº«ç”¨æˆ·è°ƒç ”ç»“æœçš„å½•éŸ³

**è¾“å‡º**ï¼š
```
---
- **æ ‡é¢˜**: å¹´è½»ç”¨æˆ·ç¤¾äº¤éœ€æ±‚è°ƒç ”ç»“æœåˆ†äº«
- **æ ¸å¿ƒè®ºç‚¹**: 00åç”¨æˆ·æ›´æ³¨é‡ç¤¾äº¤çš„"æ¾å¼›æ„Ÿ"å’Œ"è¾¹ç•Œæ„Ÿ"ï¼Œä¼ ç»Ÿå¼ºå…³ç³»ç¤¾äº¤äº§å“éœ€è¦é‡æ–°æ€è€ƒå®šä½
- **å…³é”®è¦ç‚¹**: 
  1. **87%**çš„00åç”¨æˆ·è®¤ä¸º"éšæ—¶å¯ä»¥æ¶ˆå¤±"å¾ˆé‡è¦
  2. ç›¸æ¯”ç†Ÿäººç¤¾äº¤ï¼Œæ›´åå¥½åŸºäºå…´è¶£çš„**å¼±è¿æ¥**
  3. **"é˜…åå³ç„š"**ç±»åŠŸèƒ½ä½¿ç”¨ç‡é«˜è¾¾**65%**
  4. å»ºè®®å¼€å‘**"ç¤¾äº¤æ°”æ³¡"**åŠŸèƒ½ï¼Œæ»¡è¶³ä¸´æ—¶ç¤¾äº¤éœ€æ±‚
- **å…³é”®è¯**: 00å, æ¾å¼›æ„Ÿ, å¼±è¿æ¥, é˜…åå³ç„š, ç¤¾äº¤æ°”æ³¡
---

å—¨ï¼Œå¤§å®¶å¥½å•Šï¼[ç¬‘] 

ä»Šå¤©å‘¢ï¼Œæˆ‘æƒ³è·Ÿå¤§å®¶åˆ†äº«ä¸€ä¸‹æˆ‘ä»¬æœ€è¿‘åšçš„è¿™ä¸ªç”¨æˆ·è°ƒç ”çš„ä¸€äº›ï¼Œå—¯[åœé¡¿]ä¸€äº›æŒºæœ‰æ„æ€çš„å‘ç°ã€‚

è¿™æ¬¡è°ƒç ”å‘¢ï¼Œæˆ‘ä»¬ä¸»è¦æ˜¯focusåœ¨**00åç”¨æˆ·**ç¾¤ä½“ä¸Šï¼Œä¸€å…±è®¿è°ˆäº†**50ä¸ªç”¨æˆ·**ï¼Œç„¶åè¿˜åšäº†ä¸€ä¸ª**2000äºº**çš„é—®å·è°ƒæŸ¥ã€‚[æ¸…å—“å­] è¯´å®è¯ï¼Œç»“æœè¿˜æŒºï¼Œæ€ä¹ˆè¯´å‘¢ï¼ŒæŒºé¢ è¦†æˆ‘çš„è®¤çŸ¥çš„ã€‚

å…ˆè¯´ä¸€ä¸ªæœ€è®©æˆ‘å°è±¡æ·±åˆ»çš„ç‚¹å•Šã€‚[æé«˜éŸ³é‡] ä½ ä»¬çŸ¥é“å—ï¼Ÿ**87%çš„00åç”¨æˆ·**åœ¨é€‰æ‹©ç¤¾äº¤äº§å“çš„æ—¶å€™ï¼Œæœ€çœ‹é‡çš„ä¸€ä¸ªç‚¹æ˜¯ä»€ä¹ˆï¼Ÿæ˜¯**"éšæ—¶å¯ä»¥æ¶ˆå¤±"**ï¼

[ç¬‘] å¯¹ï¼Œä½ æ²¡å¬é”™ï¼Œå°±æ˜¯"éšæ—¶å¯ä»¥æ¶ˆå¤±"ã€‚ä»–ä»¬ä¸æƒ³è¦é‚£ç§ï¼Œå‘ƒ[åœé¡¿]é‚£ç§å¾ˆé‡çš„ç¤¾äº¤è´Ÿæ‹…ã€‚æ¯”å¦‚è¯´å§ï¼Œå¾®ä¿¡è¿™ç§ï¼Œä½ åŠ äº†å¥½å‹å°±å¾—ä¸€ç›´åœ¨é‚£å„¿ï¼Œåˆ é™¤è¿˜æŒºå°´å°¬çš„ï¼Œå¯¹å§ï¼Ÿ

æœ‰ä¸ª**19å²çš„å¤§å­¦ç”Ÿ**è·Ÿæˆ‘è¯´äº†ä¸€å¥è¯ï¼Œæˆ‘è§‰å¾—ç‰¹åˆ«æœ‰ä»£è¡¨æ€§ã€‚å¥¹è¯´ï¼š[è¯­é€Ÿæ”¾ç¼“] "**æˆ‘å¸Œæœ›æˆ‘çš„ç¤¾äº¤å…³ç³»åƒæ³¡æ³¡ä¸€æ ·ï¼Œè¯¥æœ‰çš„æ—¶å€™æœ‰ï¼Œæƒ³ç ´çš„æ—¶å€™å°±è®©å®ƒç ´æ‰ï¼Œä¸è¦æœ‰ä»»ä½•ç—•è¿¹ã€‚**"

[é•¿æ—¶é—´åœé¡¿ï¼Œçº¦4ç§’]

è¿™å°±å¼•å‡ºäº†æˆ‘ä»¬çš„ç¬¬äºŒä¸ªå‘ç°â€”â€”ä»–ä»¬æ›´å–œæ¬¢**å¼±è¿æ¥**è€Œä¸æ˜¯å¼ºè¿æ¥ã€‚

ä¼ ç»Ÿçš„ç¤¾äº¤äº§å“å•Šï¼Œéƒ½åœ¨å¼ºè°ƒè¦å»ºç«‹ç‰¢å›ºçš„å…³ç³»é“¾ï¼Œæ¨ä¸å¾—æŠŠä½ æ‰€æœ‰çš„åŒå­¦ã€åŒäº‹ã€äº²æˆšéƒ½æ‹‰åˆ°ä¸€ä¸ªå¹³å°ä¸Šã€‚ä½†00åå‘¢ï¼Ÿ[æ•²å‡»å£°] ä»–ä»¬è§‰å¾—è¿™å¤ªç´¯äº†ï¼

æˆ‘ä»¬çš„æ•°æ®æ˜¾ç¤ºï¼Œ**73%çš„å—è®¿è€…**è¡¨ç¤ºï¼Œä»–ä»¬æ›´æ„¿æ„åœ¨ç½‘ä¸Šè®¤è¯†é™Œç”Ÿäººï¼Œè€Œä¸æ˜¯æŠŠç°å®ä¸­çš„å…³ç³»æ¬åˆ°ç½‘ä¸Šã€‚è€Œä¸”å•Šï¼Œ[è¯­é€ŸåŠ å¿«] è¿™ç§é™Œç”Ÿäººç¤¾äº¤è¿˜å¾—æ˜¯åŸºäºå…´è¶£çš„ï¼Œä¸èƒ½æ˜¯é‚£ç§randomçš„åŒ¹é…ã€‚

æ¯”å¦‚è¯´ï¼Œä»–ä»¬ä¼šå› ä¸ºéƒ½å–œæ¬¢æŸä¸ª**å°ä¼—ä¹é˜Ÿ**ï¼Œæˆ–è€…éƒ½åœ¨è¿½æŸéƒ¨**å†·é—¨åŠ¨æ¼«**ï¼Œç„¶åå°±èŠèµ·æ¥äº†ã€‚ä½†æ˜¯ï¼[åŠ é‡è¯­æ°”] è¿™ç§å…³ç³»å¾ˆå¯èƒ½å°±ç»´æŒå‡ å¤©ï¼Œç”šè‡³å‡ ä¸ªå°æ—¶ï¼Œç„¶åå°±[åšæ‰‹åŠ¿ï¼Œå¬ä¸æ¸…]å°±æ²¡äº†ï¼ŒåŒæ–¹éƒ½ä¸ä¼šè§‰å¾—æœ‰ä»€ä¹ˆé—®é¢˜ã€‚

ç¬¬ä¸‰ä¸ªå‘ç°å‘¢ï¼Œæ˜¯å…³äº**éšç§**çš„ã€‚

ä½ ä»¬è‚¯å®šæƒ³ä¸åˆ°ï¼Œ[ç¬‘] **"é˜…åå³ç„š"**è¿™ç§åŠŸèƒ½ï¼Œåœ¨00åç¾¤ä½“ä¸­çš„ä½¿ç”¨ç‡æœ‰å¤šé«˜â€”â€”**65%**ï¼è€Œä¸”ä¸åªæ˜¯å›¾ç‰‡ï¼Œä»–ä»¬å¸Œæœ›æ–‡å­—èŠå¤©è®°å½•ä¹Ÿèƒ½è‡ªåŠ¨æ¶ˆå¤±ã€‚

æœ‰ä¸ªç”¨æˆ·è·Ÿæˆ‘è¯´ï¼š[æ¨¡ä»¿] "æˆ‘ä¸æƒ³åœ¨ä¸‰å¹´åçš„æŸä¸€å¤©ï¼Œçªç„¶è¢«äººç¿»å‡ºæˆ‘18å²æ—¶è¯´è¿‡çš„ä»€ä¹ˆè ¢è¯ã€‚"[ç¬‘] è¿™ä¸ªæˆ‘è¿˜æŒºèƒ½ç†è§£çš„å“ˆã€‚

è¿˜æœ‰å°±æ˜¯ï¼Œä»–ä»¬å¯¹**"å·²è¯»"**åŠŸèƒ½ç‰¹åˆ«åæ„Ÿã€‚**92%çš„ç”¨æˆ·**è®¤ä¸ºï¼Œ"å·²è¯»ä¸å›"ç»™ä»–ä»¬å¸¦æ¥äº†å·¨å¤§çš„ç¤¾äº¤å‹åŠ›ã€‚æ‰€ä»¥ä»–ä»¬æ›´å–œæ¬¢é‚£ç§ï¼Œå—¯[åœé¡¿]æ›´å–œæ¬¢é‚£ç§ä¸æ˜¾ç¤ºå·²è¯»çŠ¶æ€çš„äº§å“ã€‚

[é•¿æ—¶é—´åœé¡¿ï¼Œçº¦5ç§’]

åŸºäºè¿™äº›æ´å¯Ÿå‘¢ï¼Œæˆ‘ä»¬äº§å“å›¢é˜Ÿæå‡ºäº†ä¸€ä¸ªæ–°çš„åŠŸèƒ½æ¦‚å¿µï¼Œå«**"ç¤¾äº¤æ°”æ³¡"**ã€‚

ç®€å•æ¥è¯´å°±æ˜¯ï¼Œç”¨æˆ·å¯ä»¥åŸºäºæŸä¸ªç‰¹å®šçš„è¯é¢˜æˆ–è€…äº‹ä»¶ï¼Œåˆ›å»ºä¸€ä¸ªä¸´æ—¶çš„ç¤¾äº¤ç©ºé—´ã€‚æ¯”å¦‚è¯´ï¼Œ[ä¸¾ä¾‹] ä½ åœ¨çœ‹**ä¸–ç•Œæ¯**ï¼Œä½ å¯ä»¥åˆ›å»ºä¸€ä¸ª"ä¸–ç•Œæ¯åæ§½æ°”æ³¡"ï¼Œå…¶ä»–çœ‹çƒçš„äººå¯ä»¥åŠ å…¥è¿›æ¥ä¸€èµ·èŠã€‚

ä½†æ˜¯ï¼[åŠ é‡è¯­æ°”] è¿™ä¸ªæ°”æ³¡æ˜¯æœ‰**ç”Ÿå‘½å‘¨æœŸ**çš„ã€‚å¯èƒ½æ˜¯24å°æ—¶ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸€å‘¨ï¼Œæ—¶é—´åˆ°äº†ï¼Œæ°”æ³¡å°±è‡ªåŠ¨æ¶ˆå¤±äº†ï¼Œé‡Œé¢çš„æ‰€æœ‰èŠå¤©è®°å½•ã€ç”¨æˆ·å…³ç³»ï¼Œå…¨éƒ¨æ¸…é›¶ã€‚

è€Œä¸”åœ¨æ°”æ³¡é‡Œé¢ï¼Œå¤§å®¶éƒ½æ˜¯ç”¨**ä¸´æ—¶èº«ä»½**ï¼Œä½ å¯ä»¥å«"çœ‹çƒä¸å–é…’"ï¼Œä»–å¯ä»¥å«"æ¢…è¥¿çœŸçƒè¿·"ï¼Œ[ç¬‘] åæ­£å‡ºäº†è¿™ä¸ªæ°”æ³¡ï¼Œè°ä¹Ÿä¸è®¤è¯†è°ã€‚

[æ¸…å—“å­] å½“ç„¶å•¦ï¼Œè¿™åªæ˜¯ä¸€ä¸ªåˆæ­¥çš„æƒ³æ³•ï¼Œå…·ä½“æ€ä¹ˆå®ç°ï¼Œè¿˜éœ€è¦æ›´å¤šçš„è®¨è®ºå’ŒéªŒè¯ã€‚

ä½†æˆ‘è§‰å¾—å§ï¼Œ[è¯­é€Ÿæ”¾ç¼“] è¿™æ¬¡è°ƒç ”ç»™æˆ‘æœ€å¤§çš„å¯å‘æ˜¯ï¼š**æˆ‘ä»¬çœŸçš„éœ€è¦é‡æ–°æ€è€ƒç¤¾äº¤äº§å“çš„æœ¬è´¨äº†**ã€‚

ä»¥å‰æˆ‘ä»¬æ€»è§‰å¾—ï¼Œç¤¾äº¤å°±æ˜¯è¦å»ºç«‹è¿æ¥ï¼Œè¶Šç´§å¯†è¶Šå¥½ã€‚ä½†å¯¹äºæ–°ä¸€ä»£çš„ç”¨æˆ·æ¥è¯´ï¼Œ[åœé¡¿] ä¹Ÿè®¸**é€‚åº¦çš„è·ç¦»**å’Œ**æ°åˆ°å¥½å¤„çš„è¿æ¥**ï¼Œæ‰æ˜¯ä»–ä»¬çœŸæ­£éœ€è¦çš„ã€‚

[é•¿æ—¶é—´åœé¡¿ï¼Œçº¦4ç§’]

å—¯ï¼Œæˆ‘çš„åˆ†äº«å°±åˆ°è¿™é‡Œã€‚å¤§å®¶æœ‰ä»€ä¹ˆæƒ³æ³•ï¼Œå’±ä»¬å¯ä»¥è®¨è®ºè®¨è®ºã€‚è°¢è°¢ï¼
```

## 10. å¸¸è§é—®é¢˜å¤„ç†æŒ‡å—

### 10.1 å£éŸ³å’Œæ–¹è¨€å¤„ç†
- **è½»å¾®å£éŸ³**ï¼šæŒ‰æ ‡å‡†æ™®é€šè¯è½¬å½•ï¼Œä¸åˆ»æ„æ¨¡ä»¿å£éŸ³
- **æ–¹è¨€è¯æ±‡**ï¼šä¿ç•™åŸè¯ï¼Œå¿…è¦æ—¶åœ¨æ‹¬å·ä¸­æ³¨é‡Š
- **ä¸¥é‡å£éŸ³**ï¼šä¼˜å…ˆç¡®ä¿æ„æ€å‡†ç¡®ï¼Œå¯åœ¨å¼€å¤´è¯´æ˜

### 10.2 è¯­é€Ÿå¼‚å¸¸å¤„ç†
- **æå¿«è¯­é€Ÿ**ï¼šæ­£å¸¸è½¬å½•ï¼Œä½†æ ‡æ³¨[è¯­é€Ÿæå¿«]
- **ææ…¢è¯­é€Ÿ**ï¼šå»é™¤è¿‡å¤šçš„"å—¯"ã€"å•Š"ï¼Œä¿æŒå¯è¯»æ€§
- **å¿½å¿«å¿½æ…¢**ï¼šåœ¨å˜åŒ–å¤„æ ‡æ³¨è¯­é€Ÿå˜åŒ–

### 10.3 æƒ…ç»ªè¡¨è¾¾å¤„ç†
- **æƒ…ç»ªæ¿€åŠ¨**ï¼šé€šè¿‡æ ‡ç‚¹å’Œæ ‡æ³¨ä½“ç°ï¼Œå¦‚[æ¿€åŠ¨]
- **å£°éŸ³å“½å’½**ï¼šæ ‡æ³¨[å“½å’½]ï¼Œç»§ç»­è½¬å½•å¯è¾¨è¯†å†…å®¹
- **æ„¤æ€’è¯­æ°”**ï¼šé€‚å½“ä½¿ç”¨æ„Ÿå¹å·ï¼Œå¿…è¦æ—¶æ ‡æ³¨[æ„¤æ€’]

### 10.4 æŠ€æœ¯æ•…éšœå¤„ç†
- **éŸ³é¢‘ä¸­æ–­**ï¼šæ ‡æ³¨[éŸ³é¢‘ä¸­æ–­ï¼Œçº¦Xç§’]
- **æ‚éŸ³å¹²æ‰°**ï¼šæ ‡æ³¨[èƒŒæ™¯å™ªéŸ³è¾ƒå¤§]ï¼Œå°½åŠ›è½¬å½•
- **å›å£°é—®é¢˜**ï¼šæ­£å¸¸è½¬å½•ï¼Œä½†åœ¨å¼€å¤´è¯´æ˜éŸ³è´¨é—®é¢˜

## 11. æŒç»­ä¼˜åŒ–å»ºè®®

### 11.1 ä¸ªäººèƒ½åŠ›æå‡
1. **å»ºç«‹æœ¯è¯­åº“**ï¼šç§¯ç´¯å„é¢†åŸŸä¸“ä¸šæœ¯è¯­
2. **è®­ç»ƒé€Ÿè®°**ï¼šæé«˜ä¿¡æ¯æ•æ‰æ•ˆç‡
3. **åŸ¹å…»è¯­æ„Ÿ**ï¼šå¢å¼ºå¯¹è¯­è¨€èŠ‚å¥çš„æŠŠæ¡
4. **å­¦ä¹ æ–°çŸ¥**ï¼šæ‰©å±•çŸ¥è¯†é¢ï¼Œæé«˜ç†è§£åŠ›

### 11.2 è´¨é‡æ”¹è¿›å¾ªç¯
1. **æ”¶é›†åé¦ˆ**ï¼šäº†è§£ç”¨æˆ·å¯¹è½¬å½•æ–‡æœ¬çš„æ„è§
2. **åˆ†æé—®é¢˜**ï¼šæ‰¾å‡ºå¸¸è§çš„é”™è¯¯ç±»å‹
3. **ä¼˜åŒ–æ–¹æ³•**ï¼šé’ˆå¯¹æ€§åœ°æ”¹è¿›è½¬å½•æŠ€å·§
4. **éªŒè¯æ•ˆæœ**ï¼šé€šè¿‡å¯¹æ¯”æ£€éªŒæ”¹è¿›æ•ˆæœ

### 11.3 å·¥å…·è¾…åŠ©å»ºè®®
1. **æœ¯è¯­è¡¨**ï¼šå»ºç«‹å¸¸ç”¨ä¸“ä¸šæœ¯è¯­å¿«é€ŸæŸ¥è¯¢è¡¨
2. **æ¨¡æ¿åº“**ï¼šç§¯ç´¯ä¸åŒåœºæ™¯çš„è½¬å½•æ¨¡æ¿
3. **æ£€æŸ¥æ¸…å•**ï¼šåˆ¶ä½œä¸ªæ€§åŒ–çš„è´¨é‡æ£€æŸ¥æ¸…å•
4. **æ¡ˆä¾‹é›†**ï¼šæ”¶é›†ä¼˜ç§€è½¬å½•æ¡ˆä¾‹ä¾›å‚è€ƒ

## ç»“è¯­

é«˜è´¨é‡çš„è¯­éŸ³è½¬å½•ä¸ä»…æ˜¯æ–‡å­—è®°å½•ï¼Œæ›´æ˜¯ä¿¡æ¯çš„é‡æ„å’Œä»·å€¼çš„æç‚¼ã€‚é€šè¿‡éµå¾ªæœ¬è§„èŒƒï¼Œä½ å°†èƒ½å¤Ÿäº§å‡ºæ—¢å¿ å®äºåŸå£°åˆä¾¿äºé˜…è¯»ç†è§£çš„ä¸“ä¸šè½¬å½•æ–‡æ¡£ã€‚

è®°ä½ï¼š**å¥½çš„è½¬å½•è€…æ˜¯ä¿¡æ¯çš„æ¡¥æ¢ï¼Œè¿æ¥è¯´è¯è€…çš„æ€æƒ³ä¸è¯»è€…çš„ç†è§£ã€‚**

--- File: README.md ---
<div align="center">
  <img src="assets/images/logo.png" alt="SmartProposal Engine Logo" width="150"/>
  <h1>SmartProposal Engine</h1>
  <p><strong>ä¸€ä¸ªç”± AI é©±åŠ¨çš„æ™ºèƒ½å•†ä¸šæ–¹æ¡ˆç”Ÿæˆå¼•æ“ï¼Œèƒ½å°†åŸå§‹ä¼šè®®å½•éŸ³ã€è®¿è°ˆçºªè¦ç­‰ä¿¡æ¯ï¼Œä¸€é”®è½¬åŒ–ä¸ºç»“æ„æ¸…æ™°ã€å†…å®¹ä¸“ä¸šçš„å•†ä¸šææ¡ˆã€‚</strong></p>
  
  <p>
    <img src="https://img.shields.io/badge/Python-3.8+-blue.svg" alt="Python Version">
    <img src="https://img.shields.io/badge/Streamlit-1.35+-orange.svg" alt="Streamlit Version">
    <img src="https://img.shields.io/badge/AI_Engine-Google_Gemini-purple.svg" alt="AI Engine">
    <img src="https://img.shields.io/badge/License-MIT-green.svg" alt="License">
    <img src="https://img.shields.io/badge/Project_Status-MVP-informational.svg" alt="Project Status">
  </p>
</div>

---

**SmartProposal Engine** æ—¨åœ¨è§£å†³å•†ä¸šå’¨è¯¢ã€é”€å”®å’Œé¡¹ç›®ç®¡ç†ä¸­çš„æ ¸å¿ƒç—›ç‚¹ï¼šå°†å¤§é‡é›¶æ•£ã€éç»“æ„åŒ–çš„ä¿¡æ¯ï¼ˆå¦‚å®¢æˆ·è®¿è°ˆã€å•†åŠ¡è°ˆåˆ¤å½•éŸ³ã€å†…éƒ¨ä¼šè®®çºªè¦ï¼‰é«˜æ•ˆåœ°è½¬åŒ–ä¸ºé«˜è´¨é‡ã€ä¸“ä¸šåŒ–çš„å•†ä¸šæ–‡æ¡£ã€‚å€ŸåŠ© Google Gemini å¼ºå¤§çš„å¤šæ¨¡æ€å’Œé•¿æ–‡æœ¬ç†è§£èƒ½åŠ›ï¼Œæœ¬å·¥å…·å®ç°äº†ä»ä¿¡æ¯è¾“å…¥åˆ°æ–¹æ¡ˆè¾“å‡ºçš„å…¨æµç¨‹è‡ªåŠ¨åŒ–ã€‚

### ç›®å½•
- [âœ¨ åŠŸèƒ½äº®ç‚¹](#-åŠŸèƒ½äº®ç‚¹)
- [ğŸš€ æ•ˆæœæ¼”ç¤º](#-æ•ˆæœæ¼”ç¤º)
- [ğŸ› ï¸ æŠ€æœ¯æ ˆ](#ï¸-æŠ€æœ¯æ ˆ)
- [ğŸ—ï¸ ç³»ç»Ÿæ¶æ„](#ï¸-ç³»ç»Ÿæ¶æ„)
- [âš™ï¸ å®‰è£…ä¸é…ç½®](#ï¸-å®‰è£…ä¸é…ç½®)
- [â–¶ï¸ å¿«é€Ÿå¼€å§‹](#ï¸-å¿«é€Ÿå¼€å§‹)
- [ğŸ”§ æ ¸å¿ƒé…ç½®](#ï¸-æ ¸å¿ƒé…ç½®)
- [ğŸ—ºï¸ æœªæ¥è·¯çº¿å›¾](#ï¸-æœªæ¥è·¯çº¿å›¾)
- [ğŸ¤ è´¡çŒ®æŒ‡å—](#ï¸-è´¡çŒ®æŒ‡å—)
- [ğŸ“œ è®¸å¯è¯](#ï¸-è®¸å¯è¯)

### âœ¨ åŠŸèƒ½äº®ç‚¹

* **ğŸ™ï¸ æ™ºèƒ½éŸ³é¢‘/æ–‡æ¡£å¤„ç†**:
    * æ”¯æŒå¤šç§ä¸»æµéŸ³é¢‘æ ¼å¼ (`m4a`, `mp3`, `wav` ç­‰) å’Œæ–‡æ¡£æ ¼å¼ (`docx`, `pdf`, `txt` ç­‰)ã€‚
    * åˆ©ç”¨ Gemini API å¯¹é•¿éŸ³é¢‘è¿›è¡Œé«˜ç²¾åº¦è½¬å½•ï¼Œå¹¶è‡ªåŠ¨è¯†åˆ«ä¸åŒè¯´è¯äººã€‚
    * å¯é€‰çš„ AI æ–‡æœ¬ä¼˜åŒ–åŠŸèƒ½ï¼Œæå‡è½¬å½•ç¨¿çš„å¯è¯»æ€§å’Œä¸“ä¸šæ€§ã€‚

* **ğŸ§  åŸºäºåœºæ™¯çš„æ·±åº¦åˆ†æ**:
    * å†…ç½®å¤šç§ä¸“ä¸šåˆ†ææ¨¡æ¿ï¼Œè¦†ç›–å®¢æˆ·è®¿-è°ˆã€å•†åŠ¡è°ˆåˆ¤ã€å†…éƒ¨ä¼šè®®ç­‰æ ¸å¿ƒå•†ä¸šåœºæ™¯ã€‚
    * é€šè¿‡ç²¾å¿ƒè®¾è®¡çš„ Promptsï¼Œä»æµ·é‡æ–‡æœ¬ä¸­æå–å…³é”®å•†ä¸šæ´å¯Ÿã€å†³ç­–è¦ç‚¹å’Œè¡ŒåŠ¨é¡¹ã€‚
    * æ”¯æŒç”¨æˆ·æä¾›è‡ªå®šä¹‰åˆ†ææ¨¡æ¿ï¼Œæ»¡è¶³ä¸ªæ€§åŒ–éœ€æ±‚ã€‚

* **âœï¸ å®šåˆ¶åŒ–æ–¹æ¡ˆç”Ÿæˆ**:
    * ä¸€é”®ç”Ÿæˆç»“æ„å®Œæ•´ã€é€»è¾‘æ¸…æ™°çš„å•†ä¸šæ–‡æ¡£ï¼Œå¦‚é¡¹ç›®å»ºè®®ä¹¦ã€å•†åŠ¡æŠ¥ä»·æ–¹æ¡ˆã€è§£å†³æ–¹æ¡ˆç®€æŠ¥ç­‰ã€‚
    * èƒ½å¤Ÿæ™ºèƒ½èåˆç”¨æˆ·ä¸Šä¼ çš„â€œä¼ä¸šèƒ½åŠ›æ–‡æ¡£â€ï¼ˆå¦‚å…¬å¸ä»‹ç»ã€æˆåŠŸæ¡ˆä¾‹ï¼‰ï¼Œæå¤§å¢å¼ºç”Ÿæˆæ–¹æ¡ˆçš„é’ˆå¯¹æ€§å’Œè¯´æœåŠ›ã€‚
    * æ”¯æŒå®¢æˆ·ä¿¡æ¯æ³¨å…¥ï¼Œå®ç°æ–¹æ¡ˆçš„ä¸ªæ€§åŒ–å®šåˆ¶ã€‚

* **âš¡ ç«¯åˆ°ç«¯è‡ªåŠ¨åŒ–å·¥ä½œæµ**:
    * æä¾›â€œä¸€é”®ç”Ÿæˆâ€æ¨¡å¼ï¼Œæ”¯æŒæ‰¹é‡æ–‡ä»¶å¤„ç†ï¼Œå®ç°ä»åŸå§‹è¾“å…¥åˆ°æœ€ç»ˆæ–¹æ¡ˆçš„æ— äººå¹²é¢„å…¨æµç¨‹è‡ªåŠ¨åŒ–ã€‚
    * æ¸…æ™°çš„è¿›åº¦è·Ÿè¸ªå’Œç»“æœæ±‡æ€»ï¼Œä¾¿äºç®¡ç†å’Œå¤ç›˜ã€‚
    * æ¨¡å—åŒ–çš„æœåŠ¡è®¾è®¡ï¼Œä¿è¯äº†ç³»ç»Ÿçš„ç¨³å®šæ€§å’Œå¯æ‰©å±•æ€§ã€‚

### ğŸš€ æ•ˆæœæ¼”ç¤º

**(å»ºè®®æ‚¨åœ¨æ­¤å¤„æ›¿æ¢ä¸ºåº”ç”¨çš„å®é™…æˆªå›¾)**

**1. ä¸€é”®å¤„ç†é¡µé¢ - é…ç½®å·¥ä½œæµ**
*ï¼ˆæ­¤å¤„å¯ä»¥æ”¾ `4_??_One_Click_Generation.py` é¡µé¢çš„æˆªå›¾ï¼‰*
![One Click Generation Screenshot](https://via.placeholder.com/800x450.png?text=Screenshot+of+One-Click+Generation+Page)

**2. æ·±åº¦åˆ†æç»“æœå±•ç¤º**
*ï¼ˆæ­¤å¤„å¯ä»¥æ”¾ `2_??_Deep_Analysis.py` é¡µé¢ç”Ÿæˆç»“æœçš„æˆªå›¾ï¼‰*
![Analysis Result Screenshot](https://via.placeholder.com/800x450.png?text=Screenshot+of+Deep+Analysis+Result)

**3. æœ€ç»ˆç”Ÿæˆçš„é¡¹ç›®å»ºè®®ä¹¦**
*ï¼ˆæ­¤å¤„å¯ä»¥æ”¾ `3_??_Proposal_Generation.py` é¡µé¢ç”Ÿæˆæ–¹æ¡ˆçš„æˆªå›¾ï¼‰*
![Proposal Result Screenshot](https://via.placeholder.com/800x450.png?text=Screenshot+of+Generated+Proposal)


### ğŸ› ï¸ æŠ€æœ¯æ ˆ

* **å‰ç«¯æ¡†æ¶**: [Streamlit](https://streamlit.io/)
* **AI æ ¸å¿ƒ**: [Google Gemini API (2.5-Pro, 2.5-Flash)](https://ai.google.dev/)
* **å¼€å‘è¯­è¨€**: Python 3.8+
* **æ–‡æ¡£å¤„ç†**: `python-docx`, `PyPDF2`
* **éŸ³é¢‘å¤„ç†**: `pydub` (ç”¨äºåˆ†å‰²), Google AI Platform (ç”¨äºè½¬å½•)
* **æ ¸å¿ƒä¾èµ–**: `google-generativeai`, `streamlit`

### ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

é¡¹ç›®é‡‡ç”¨äº†æ¸…æ™°çš„ã€é¢å‘æœåŠ¡çš„æ¶æ„ï¼Œå°†ä¸åŒèŒè´£è¿›è¡Œäº†è§£è€¦ã€‚

--- File: readme_file.md ---
# SmartProposal Engine ğŸ“‹

SmartProposal Engineæ˜¯ä¸€ä¸ªåŸºäºAIçš„æ™ºèƒ½å•†ä¸šæ–¹æ¡ˆç”Ÿæˆç³»ç»Ÿï¼Œèƒ½å¤Ÿè‡ªåŠ¨å°†åŸå§‹ä¿¡æ¯ï¼ˆéŸ³é¢‘å½•éŸ³ã€æ–‡æ¡£ç­‰ï¼‰è½¬åŒ–ä¸ºä¸“ä¸šçš„å•†ä¸šææ¡ˆå’Œé¡¹ç›®å»ºè®®ä¹¦ã€‚

## ğŸŒŸ æ ¸å¿ƒåŠŸèƒ½

### 1. **æ™ºèƒ½è½¬å½•** ğŸ™ï¸
- æ”¯æŒå¤šç§éŸ³é¢‘æ ¼å¼ï¼ˆm4a, mp3, wavç­‰ï¼‰
- è‡ªåŠ¨è¯†åˆ«å¤šè¯´è¯äººå¯¹è¯
- æ”¯æŒè¶…é•¿éŸ³é¢‘è‡ªåŠ¨åˆ†å‰²å¤„ç†
- å¯é€‰çš„AIæ–‡æœ¬ä¼˜åŒ–åŠŸèƒ½

### 2. **æ·±åº¦åˆ†æ** ğŸ”
- å¤šç§é¢„è®¾åˆ†ææ¨¡æ¿ï¼ˆå®¢æˆ·è®¿è°ˆã€å•†åŠ¡è°ˆåˆ¤ã€å†…éƒ¨ä¼šè®®ç­‰ï¼‰
- æ™ºèƒ½æå–å…³é”®ä¿¡æ¯å’Œå•†ä¸šæ´å¯Ÿ
- è‡ªåŠ¨ç”Ÿæˆæ‰§è¡Œæ‘˜è¦å’Œè¡ŒåŠ¨å»ºè®®
- æ”¯æŒè‡ªå®šä¹‰åˆ†ææ¨¡æ¿

### 3. **æ–¹æ¡ˆç”Ÿæˆ** ğŸ“‹
- è‡ªåŠ¨ç”Ÿæˆä¸“ä¸šçš„é¡¹ç›®å»ºè®®ä¹¦
- æ”¯æŒå¤šç§æ–¹æ¡ˆç±»å‹ï¼ˆé¡¹ç›®å»ºè®®ä¹¦ã€å•†åŠ¡æŠ¥ä»·ã€è§£å†³æ–¹æ¡ˆç®€æŠ¥ç­‰ï¼‰
- æ•´åˆä¼ä¸šèƒ½åŠ›æ–‡æ¡£ï¼Œå¢å¼ºæ–¹æ¡ˆè¯´æœåŠ›
- å®¢æˆ·ä¿¡æ¯ä¸ªæ€§åŒ–å®šåˆ¶

### 4. **ä¸€é”®å¤„ç†** ğŸš€
- ç«¯åˆ°ç«¯çš„è‡ªåŠ¨åŒ–å¤„ç†æµç¨‹
- æ‰¹é‡æ–‡ä»¶å¤„ç†èƒ½åŠ›
- å®æ—¶è¿›åº¦è·Ÿè¸ª
- ç»“æœæ‰¹é‡å¯¼å‡º

## ğŸ› ï¸ æŠ€æœ¯æ¶æ„

### æ ¸å¿ƒæŠ€æœ¯æ ˆ
- **å‰ç«¯æ¡†æ¶**: Streamlit
- **AIå¼•æ“**: Google Gemini API (æ”¯æŒ2.5-proå’Œ2.5-flash)
- **æ–‡æ¡£å¤„ç†**: python-docx, PyPDF2
- **éŸ³é¢‘å¤„ç†**: pydub, Google Speech-to-Text
- **å¼€å‘è¯­è¨€**: Python 3.8+

### é¡¹ç›®ç»“æ„
```
smart_proposal_engine/
â”œâ”€â”€ app.py                    # ä¸»åº”ç”¨å…¥å£
â”œâ”€â”€ pages/                    # Streamlité¡µé¢
â”‚   â”œâ”€â”€ 1_ğŸ“„_Input_Processing.py
â”‚   â”œâ”€â”€ 2_ğŸ”_Deep_Analysis.py
â”‚   â”œâ”€â”€ 3_ğŸ“‹_Proposal_Generation.py
â”‚   â””â”€â”€ 4_ğŸš€_One_Click_Generation.py
â”œâ”€â”€ services/                 # ä¸šåŠ¡æœåŠ¡å±‚
â”‚   â”œâ”€â”€ transcription_service.py
â”‚   â”œâ”€â”€ analysis_service.py
â”‚   â””â”€â”€ proposal_service.py
â”œâ”€â”€ core/                     # æ ¸å¿ƒç»„ä»¶
â”‚   â”œâ”€â”€ prompt_manager.py
â”‚   â”œâ”€â”€ model_interface.py
â”‚   â””â”€â”€ session_manager.py
â”œâ”€â”€ prompts/                  # AIæç¤ºè¯æ¨¡æ¿
â”œâ”€â”€ utils/                    # å·¥å…·å‡½æ•°
â””â”€â”€ requirements.txt          # é¡¹ç›®ä¾èµ–
```

## ğŸ“¦ å®‰è£…æŒ‡å—

### å‰ç½®è¦æ±‚
- Python 3.8 æˆ–æ›´é«˜ç‰ˆæœ¬
- Google Gemini APIå¯†é’¥
- FFmpegï¼ˆç”¨äºéŸ³é¢‘å¤„ç†ï¼‰

### å®‰è£…æ­¥éª¤

1. **å…‹éš†é¡¹ç›®ä»“åº“**
```bash
git clone https://github.com/smartproposal/engine.git
cd smart_proposal_engine
```

2. **åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ**
```bash
python -m venv venv

# Windows
venv\Scripts\activate

# macOS/Linux
source venv/bin/activate
```

3. **å®‰è£…ä¾èµ–**
```bash
pip install -r requirements.txt
```

4. **å®‰è£…FFmpeg**
- Windows: ä» [FFmpegå®˜ç½‘](https://ffmpeg.org/download.html) ä¸‹è½½å¹¶æ·»åŠ åˆ°PATH
- macOS: `brew install ffmpeg`
- Ubuntu/Debian: `sudo apt-get install ffmpeg`

5. **é…ç½®APIå¯†é’¥**

åˆ›å»º `.env` æ–‡ä»¶ï¼š
```bash
cp .env.example .env
```

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œæ·»åŠ æ‚¨çš„Google APIå¯†é’¥ï¼š
```
GOOGLE_API_KEY=your_api_key_here
```

æˆ–è€…ï¼Œæ‚¨å¯ä»¥åœ¨ `app_config.ini` ä¸­é…ç½®ä½¿ç”¨å†…éƒ¨å¯†é’¥æ–‡ä»¶ï¼š
```ini
[API_SETTINGS]
use_internal_api_key = true
api_key_file = api_key.txt
```

## ğŸš€ ä½¿ç”¨æŒ‡å—

### å¯åŠ¨åº”ç”¨
```bash
streamlit run app.py
```

åº”ç”¨å°†åœ¨é»˜è®¤æµè§ˆå™¨ä¸­æ‰“å¼€ï¼Œé€šå¸¸åœ°å€ä¸º `http://localhost:8501`

### åŠŸèƒ½ä½¿ç”¨æµç¨‹

#### 1. å†…å®¹è¾“å…¥å¤„ç†
- ä¸Šä¼ éŸ³é¢‘æ–‡ä»¶æˆ–æ–‡æ¡£
- é€‰æ‹©å¤„ç†é€‰é¡¹ï¼ˆè¯´è¯äººè¯†åˆ«ã€æ–‡æœ¬ä¼˜åŒ–ç­‰ï¼‰
- è·å–è½¬å½•æˆ–æå–çš„æ–‡æœ¬å†…å®¹

#### 2. æ·±åº¦åˆ†æ
- é€‰æ‹©æˆ–ä¸Šä¼ åˆ†æå†…å®¹
- é€‰æ‹©åˆé€‚çš„åˆ†ææ¨¡æ¿
- è·å–ç»“æ„åŒ–çš„åˆ†ææŠ¥å‘Š

#### 3. æ–¹æ¡ˆç”Ÿæˆ
- ä¸Šä¼ åˆ†ææŠ¥å‘Š
- ä¸Šä¼ ä¼ä¸šèƒ½åŠ›æ–‡æ¡£ï¼ˆå¯é€‰ï¼‰
- é…ç½®æ–¹æ¡ˆå‚æ•°å’Œå®¢æˆ·ä¿¡æ¯
- ç”Ÿæˆä¸“ä¸šçš„å•†ä¸šæ–¹æ¡ˆ

#### 4. ä¸€é”®ç”Ÿæˆï¼ˆæ¨èï¼‰
- æ‰¹é‡ä¸Šä¼ æ‰€æœ‰æ–‡ä»¶
- ä¸€æ¬¡æ€§é…ç½®æ‰€æœ‰å‚æ•°
- è‡ªåŠ¨å®Œæˆå…¨æµç¨‹å¤„ç†
- æ‰¹é‡ä¸‹è½½æ‰€æœ‰ç»“æœ

### é…ç½®è¯´æ˜

ä¸»è¦é…ç½®æ–‡ä»¶ `app_config.ini`ï¼š

```ini
[MODEL_SETTINGS]
# ä¸åŒä»»åŠ¡ä½¿ç”¨çš„æ¨¡å‹
transcription_model = models/gemini-2.5-flash
analysis_model = models/gemini-2.5-pro
proposal_model = models/gemini-2.5-pro

[FILE_SETTINGS]
# æ–‡ä»¶å¤§å°å’Œæ ¼å¼é™åˆ¶
max_file_size_mb = 200
allowed_audio_formats = m4a,mp3,wav,aac,ogg,flac
allowed_document_formats = docx,pdf,txt

[FEATURE_SETTINGS]
# åŠŸèƒ½å¼€å…³
enable_deep_analysis = true
enable_proposal_generation = true
enable_custom_prompts = true
```

## ğŸ“Š ä½¿ç”¨åœºæ™¯

### 1. å®¢æˆ·éœ€æ±‚åˆ†æ
- ä¸Šä¼ å®¢æˆ·è®¿è°ˆå½•éŸ³
- è‡ªåŠ¨æå–éœ€æ±‚ç‚¹å’Œç—›ç‚¹
- ç”Ÿæˆé’ˆå¯¹æ€§çš„é¡¹ç›®å»ºè®®ä¹¦

### 2. å•†åŠ¡è°ˆåˆ¤æ”¯æŒ
- å¤„ç†è°ˆåˆ¤å½•éŸ³æˆ–è®°å½•
- åˆ†æå„æ–¹ç«‹åœºå’Œæ¡æ¬¾
- ç”Ÿæˆè°ˆåˆ¤ç­–ç•¥å’ŒæŠ¥ä»·æ–¹æ¡ˆ

### 3. å†…éƒ¨ä¼šè®®æ•´ç†
- è½¬å½•ä¼šè®®å½•éŸ³
- æå–å†³ç­–è¦ç‚¹å’Œè¡ŒåŠ¨é¡¹
- ç”Ÿæˆä¼šè®®çºªè¦å’Œæ‰§è¡Œè®¡åˆ’

### 4. æ‰¹é‡æ–¹æ¡ˆåˆ¶ä½œ
- æ‰¹é‡å¤„ç†å¤šä¸ªå®¢æˆ·èµ„æ–™
- ç»Ÿä¸€ç”Ÿæˆå®šåˆ¶åŒ–æ–¹æ¡ˆ
- å¤§å¹…æå‡å·¥ä½œæ•ˆç‡

## ğŸ”§ é«˜çº§åŠŸèƒ½

### è‡ªå®šä¹‰æç¤ºè¯æ¨¡æ¿
1. åœ¨ `prompts/` ç›®å½•ä¸‹åˆ›å»ºæ–°çš„æ¨¡æ¿æ–‡ä»¶
2. ä½¿ç”¨Markdownæ ¼å¼ç¼–å†™æ¨¡æ¿
3. åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨å˜é‡å ä½ç¬¦ï¼ˆå¦‚ `{transcript}`ï¼‰

### æ‰¹å¤„ç†API
```python
from services.document_service import DocumentService
from services.analysis_service import DeepAnalysisService

# æ‰¹é‡å¤„ç†æ–‡æ¡£
doc_service = DocumentService()
results = doc_service.batch_process_documents(file_paths)

# æ‰¹é‡åˆ†æ
analysis_service = DeepAnalysisService()
analyses = analysis_service.batch_analyze(documents, template='customer_interview')
```

### æ‰©å±•å¼€å‘
ç³»ç»Ÿé‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼Œä¾¿äºæ‰©å±•ï¼š
- æ–°å¢æœåŠ¡ï¼šç»§æ‰¿ `BaseService` ç±»
- æ–°å¢æ¨¡æ¿ï¼šåœ¨ç›¸åº”ç›®å½•æ·»åŠ æ¨¡æ¿æ–‡ä»¶
- æ–°å¢é¡µé¢ï¼šåœ¨ `pages/` ç›®å½•åˆ›å»ºæ–°é¡µé¢

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **APIè°ƒç”¨ä¼˜åŒ–**
   - ä½¿ç”¨æ‰¹é‡å¤„ç†å‡å°‘APIè°ƒç”¨æ¬¡æ•°
   - åˆç†è®¾ç½®å¹¶å‘æ•°é¿å…é™æµ
   - å¯ç”¨ç»“æœç¼“å­˜å‡å°‘é‡å¤å¤„ç†

2. **æ–‡ä»¶å¤„ç†ä¼˜åŒ–**
   - å¤§æ–‡ä»¶è‡ªåŠ¨åˆ†ç‰‡å¤„ç†
   - ä½¿ç”¨æµå¼å¤„ç†å‡å°‘å†…å­˜å ç”¨
   - å®šæœŸæ¸…ç†ä¸´æ—¶æ–‡ä»¶

3. **æ¨¡å‹é€‰æ‹©ä¼˜åŒ–**
   - è½¬å½•ä»»åŠ¡ä½¿ç”¨Flashæ¨¡å‹èŠ‚çœæˆæœ¬
   - å¤æ‚åˆ†æä½¿ç”¨Proæ¨¡å‹ä¿è¯è´¨é‡
   - æ ¹æ®ä»»åŠ¡ç‰¹ç‚¹é€‰æ‹©åˆé€‚çš„æ¨¡å‹

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿è´¡çŒ®ä»£ç ã€æŠ¥å‘Šé—®é¢˜æˆ–æå‡ºå»ºè®®ï¼

1. Fork é¡¹ç›®ä»“åº“
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. åˆ›å»º Pull Request

## ğŸ“ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…

## ğŸ™ è‡´è°¢

- Google Geminiå›¢é˜Ÿæä¾›çš„å¼ºå¤§AIèƒ½åŠ›
- Streamlitç¤¾åŒºçš„ä¼˜ç§€æ¡†æ¶
- æ‰€æœ‰è´¡çŒ®è€…å’Œç”¨æˆ·çš„æ”¯æŒ

## ğŸ“ è”ç³»æ–¹å¼

- é¡¹ç›®ä¸»é¡µ: [https://github.com/smartproposal/engine](https://github.com/smartproposal/engine)
- é—®é¢˜åé¦ˆ: [Issues](https://github.com/smartproposal/engine/issues)
- é‚®ç®±: support@smartproposal.ai

---

**SmartProposal Engine** - è®©å•†ä¸šæ–¹æ¡ˆåˆ¶ä½œæ›´æ™ºèƒ½ã€æ›´é«˜æ•ˆï¼ ğŸš€

--- File: run_app.py ---
#!/usr/bin/env python
# -*- coding: utf-8 -*-
"""
æ–‡ä»¶è·¯å¾„: smart_proposal_engine/run_app.py
åŠŸèƒ½è¯´æ˜: SmartProposal Engineå¯åŠ¨è„šæœ¬ï¼Œæ”¯æŒåœ¨PyCharmä¸­ç›´æ¥è¿è¡Œ
ä½œè€…: SmartProposal Team
åˆ›å»ºæ—¥æœŸ: 2025-06-27
æœ€åä¿®æ”¹: 2025-06-27
ç‰ˆæœ¬: 1.0.0
"""

import os
import sys
import subprocess
import socket
import webbrowser
import time
import argparse
import json
import configparser
from pathlib import Path
from typing import Optional, Dict, Any
import streamlit.web.cli as stcli


def check_port_available(port: int) -> bool:
    """æ£€æŸ¥ç«¯å£æ˜¯å¦å¯ç”¨"""
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
        try:
            s.bind(('', port))
            return True
        except socket.error:
            return False


def find_available_port(start_port: int = 8501, max_attempts: int = 10) -> Optional[int]:
    """æŸ¥æ‰¾å¯ç”¨ç«¯å£"""
    for i in range(max_attempts):
        port = start_port + i
        if check_port_available(port):
            return port
    return None


def check_dependencies():
    """æ£€æŸ¥å¿…è¦çš„ä¾èµ–æ˜¯å¦å·²å®‰è£…"""
    missing_deps = []
    
    # æ£€æŸ¥æ ¸å¿ƒä¾èµ–
    try:
        import streamlit
    except ImportError:
        missing_deps.append("streamlit")
    
    try:
        import google.generativeai
    except ImportError:
        missing_deps.append("google-generativeai")
    
    try:
        import docx
    except ImportError:
        missing_deps.append("python-docx")
    
    try:
        import PyPDF2
    except ImportError:
        missing_deps.append("PyPDF2")
    
    if missing_deps:
        print("âŒ ç¼ºå°‘å¿…è¦çš„ä¾èµ–åŒ…:")
        for dep in missing_deps:
            print(f"   - {dep}")
        print("\nè¯·è¿è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…ä¾èµ–:")
        print("   pip install -r requirements.txt")
        return False
    
    return True


def check_environment():
    """æ£€æŸ¥ç¯å¢ƒé…ç½®"""
    warnings = []
    
    # æ£€æŸ¥APIå¯†é’¥é…ç½®
    api_key_from_env = os.getenv('GOOGLE_API_KEY')
    api_key_file = Path('api_key.txt')
    
    if not api_key_from_env and not api_key_file.exists():
        warnings.append("""
âš ï¸  æœªæ‰¾åˆ°Google APIå¯†é’¥é…ç½®
   è¯·ä½¿ç”¨ä»¥ä¸‹æ–¹å¼ä¹‹ä¸€é…ç½®APIå¯†é’¥:
   1. è®¾ç½®ç¯å¢ƒå˜é‡: export GOOGLE_API_KEY=your_key
   2. åˆ›å»º.envæ–‡ä»¶å¹¶æ·»åŠ : GOOGLE_API_KEY=your_key
   3. åˆ›å»ºapi_key.txtæ–‡ä»¶å¹¶å†™å…¥å¯†é’¥
        """)
    
    # æ£€æŸ¥å¿…è¦çš„ç›®å½•
    required_dirs = ['temp', 'output', 'prompts']
    for dir_name in required_dirs:
        dir_path = Path(dir_name)
        if not dir_path.exists():
            try:
                dir_path.mkdir(parents=True, exist_ok=True)
                print(f"âœ… åˆ›å»ºç›®å½•: {dir_name}/")
            except Exception as e:
                warnings.append(f"âš ï¸  æ— æ³•åˆ›å»ºç›®å½• {dir_name}: {e}")
    
    # æ£€æŸ¥é…ç½®æ–‡ä»¶
    if not Path('app_config.ini').exists():
        warnings.append("âš ï¸  æœªæ‰¾åˆ°app_config.inié…ç½®æ–‡ä»¶ï¼Œå°†ä½¿ç”¨é»˜è®¤é…ç½®")
    
    # æ˜¾ç¤ºè­¦å‘Šä¿¡æ¯
    if warnings:
        print("\n" + "="*50)
        print("ç¯å¢ƒæ£€æŸ¥è­¦å‘Š:")
        for warning in warnings:
            print(warning)
        print("="*50 + "\n")
    
    return True  # å³ä½¿æœ‰è­¦å‘Šä¹Ÿç»§ç»­è¿è¡Œ


def load_env_file():
    """åŠ è½½.envæ–‡ä»¶ä¸­çš„ç¯å¢ƒå˜é‡"""
    env_file = Path('.env')
    if env_file.exists():
        try:
            from dotenv import load_dotenv
            load_dotenv()
            print("âœ… å·²åŠ è½½.envæ–‡ä»¶")
        except ImportError:
            print("â„¹ï¸  python-dotenvæœªå®‰è£…ï¼Œè·³è¿‡.envæ–‡ä»¶åŠ è½½")


def load_run_config() -> Dict[str, Any]:
    """åŠ è½½è¿è¡Œé…ç½®æ–‡ä»¶"""
    config = {
        'port': 8501,
        'host': 'localhost',
        'open_browser': True,
        'debug': False,
        'subprocess': False,
        'env_vars': {}
    }
    
    # å°è¯•å¤šç§é…ç½®æ–‡ä»¶æ ¼å¼
    config_files = ['run_config.json', 'run_config.ini', 'run_config.conf']
    
    for config_file in config_files:
        config_path = Path(config_file)
        if config_path.exists():
            print(f"ğŸ“„ æ‰¾åˆ°é…ç½®æ–‡ä»¶: {config_file}")
            
            if config_file.endswith('.json'):
                # åŠ è½½JSONé…ç½®
                try:
                    with open(config_path, 'r', encoding='utf-8') as f:
                        file_config = json.load(f)
                        config.update(file_config)
                        print(f"âœ… å·²åŠ è½½é…ç½®æ–‡ä»¶: {config_file}")
                        break
                except Exception as e:
                    print(f"âš ï¸  åŠ è½½JSONé…ç½®å¤±è´¥: {e}")
                    
            elif config_file.endswith(('.ini', '.conf')):
                # åŠ è½½INIé…ç½®
                try:
                    parser = configparser.ConfigParser()
                    parser.read(config_path, encoding='utf-8')
                    
                    if 'server' in parser:
                        server_config = parser['server']
                        config['port'] = server_config.getint('port', config['port'])
                        config['host'] = server_config.get('host', config['host'])
                        config['open_browser'] = server_config.getboolean('open_browser', config['open_browser'])
                        config['debug'] = server_config.getboolean('debug', config['debug'])
                        config['subprocess'] = server_config.getboolean('subprocess', config['subprocess'])
                    
                    if 'environment' in parser:
                        config['env_vars'] = dict(parser['environment'])
                    
                    print(f"âœ… å·²åŠ è½½é…ç½®æ–‡ä»¶: {config_file}")
                    break
                except Exception as e:
                    print(f"âš ï¸  åŠ è½½INIé…ç½®å¤±è´¥: {e}")
    
    # è®¾ç½®ç¯å¢ƒå˜é‡
    for key, value in config.get('env_vars', {}).items():
        os.environ[key] = str(value)
        print(f"   è®¾ç½®ç¯å¢ƒå˜é‡: {key}")
    
    return config


def run_streamlit_app(port: int = 8501, 
                     host: str = "localhost",
                     open_browser: bool = True,
                     debug: bool = False):
    """è¿è¡ŒStreamlitåº”ç”¨"""
    
    # è®¾ç½®Streamlité…ç½®
    os.environ['STREAMLIT_SERVER_PORT'] = str(port)
    os.environ['STREAMLIT_SERVER_ADDRESS'] = host
    
    if debug:
        os.environ['STREAMLIT_SERVER_RUN_ON_SAVE'] = 'true'
        os.environ['STREAMLIT_SERVER_FILE_WATCHER_TYPE'] = 'auto'
    
    # æ„å»ºå¯åŠ¨å‚æ•°
    sys.argv = [
        "streamlit",
        "run",
        "app.py",
        f"--server.port={port}",
        f"--server.address={host}",
    ]
    
    if not open_browser:
        sys.argv.append("--server.headless=true")
    
    if debug:
        sys.argv.extend([
            "--server.runOnSave=true",
            "--server.fileWatcherType=auto",
            "--logger.level=info"
        ])
    
    # æ‰“å°å¯åŠ¨ä¿¡æ¯
    print(f"""
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘         SmartProposal Engine æ­£åœ¨å¯åŠ¨...             â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  è®¿é—®åœ°å€: http://{host}:{port}                      â•‘
â•‘  æŒ‰ Ctrl+C åœæ­¢æœåŠ¡                                  â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    """)
    
    # å¯åŠ¨Streamlit
    sys.exit(stcli.main())


def run_with_subprocess(port: int = 8501, 
                       host: str = "localhost",
                       open_browser: bool = True,
                       debug: bool = False):
    """ä½¿ç”¨å­è¿›ç¨‹è¿è¡ŒStreamlitï¼ˆå¤‡é€‰æ–¹æ¡ˆï¼‰"""
    cmd = [
        sys.executable, "-m", "streamlit", "run", "app.py",
        f"--server.port={port}",
        f"--server.address={host}",
    ]
    
    if not open_browser:
        cmd.append("--server.headless=true")
    
    if debug:
        cmd.extend([
            "--server.runOnSave=true",
            "--server.fileWatcherType=auto",
            "--logger.level=info"
        ])
    
    # æ‰“å°å¯åŠ¨ä¿¡æ¯
    print(f"""
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘         SmartProposal Engine æ­£åœ¨å¯åŠ¨...             â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  è®¿é—®åœ°å€: http://{host}:{port}                      â•‘
â•‘  æŒ‰ Ctrl+C åœæ­¢æœåŠ¡                                  â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    """)
    
    # åœ¨æ–°çª—å£ä¸­æ‰“å¼€æµè§ˆå™¨
    if open_browser:
        time.sleep(2)  # ç­‰å¾…æœåŠ¡å¯åŠ¨
        webbrowser.open(f"http://{host}:{port}")
    
    # å¯åŠ¨å­è¿›ç¨‹
    try:
        subprocess.run(cmd)
    except KeyboardInterrupt:
        print("\nâœ… æœåŠ¡å·²åœæ­¢")


def main():
    """ä¸»å‡½æ•°"""
    parser = argparse.ArgumentParser(description='SmartProposal Engine å¯åŠ¨è„šæœ¬')
    parser.add_argument('--port', type=int, default=8501, help='æœåŠ¡ç«¯å£ (é»˜è®¤: 8501)')
    parser.add_argument('--host', type=str, default='localhost', help='æœåŠ¡åœ°å€ (é»˜è®¤: localhost)')
    parser.add_argument('--no-browser', action='store_true', help='ä¸è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨')
    parser.add_argument('--debug', action='store_true', help='è°ƒè¯•æ¨¡å¼')
    parser.add_argument('--subprocess', action='store_true', help='ä½¿ç”¨å­è¿›ç¨‹æ¨¡å¼è¿è¡Œ')
    
    args = parser.parse_args()
    
    # æ˜¾ç¤ºå¯åŠ¨æ¨ªå¹…
    print("""
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                                                           â•‘
    â•‘            ğŸš€ SmartProposal Engine v1.0.0 ğŸš€             â•‘
    â•‘                                                           â•‘
    â•‘         æ™ºèƒ½å•†ä¸šæ–¹æ¡ˆç”Ÿæˆç³»ç»Ÿ - MVP Edition                â•‘
    â•‘                                                           â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    """)
    
    # åŠ è½½ç¯å¢ƒå˜é‡
    load_env_file()
    
    # æ£€æŸ¥ä¾èµ–
    print("ğŸ” æ£€æŸ¥ç³»ç»Ÿä¾èµ–...")
    if not check_dependencies():
        print("\nâŒ ä¾èµ–æ£€æŸ¥å¤±è´¥ï¼Œè¯·å…ˆå®‰è£…å¿…è¦çš„ä¾èµ–åŒ…")
        sys.exit(1)
    print("âœ… ä¾èµ–æ£€æŸ¥é€šè¿‡")
    
    # æ£€æŸ¥ç¯å¢ƒ
    print("\nğŸ” æ£€æŸ¥è¿è¡Œç¯å¢ƒ...")
    check_environment()
    
    # æ£€æŸ¥ç«¯å£
    if not check_port_available(args.port):
        print(f"\nâš ï¸  ç«¯å£ {args.port} å·²è¢«å ç”¨ï¼Œæ­£åœ¨æŸ¥æ‰¾å¯ç”¨ç«¯å£...")
        available_port = find_available_port(args.port)
        if available_port:
            args.port = available_port
            print(f"âœ… ä½¿ç”¨ç«¯å£: {available_port}")
        else:
            print("âŒ æ— æ³•æ‰¾åˆ°å¯ç”¨ç«¯å£ï¼Œè¯·æ‰‹åŠ¨æŒ‡å®šç«¯å£")
            sys.exit(1)
    
    # å¯åŠ¨åº”ç”¨
    try:
        if args.subprocess:
            # ä½¿ç”¨å­è¿›ç¨‹æ¨¡å¼
            run_with_subprocess(
                port=args.port,
                host=args.host,
                open_browser=not args.no_browser,
                debug=args.debug
            )
        else:
            # ä½¿ç”¨é»˜è®¤æ¨¡å¼
            run_streamlit_app(
                port=args.port,
                host=args.host,
                open_browser=not args.no_browser,
                debug=args.debug
            )
    except Exception as e:
        print(f"\nâŒ å¯åŠ¨å¤±è´¥: {e}")
        sys.exit(1)


if __name__ == "__main__":
    # ç¡®ä¿åœ¨æ­£ç¡®çš„ç›®å½•ä¸‹è¿è¡Œ
    script_dir = Path(__file__).parent
    os.chdir(script_dir)
    
    # è¿è¡Œä¸»å‡½æ•°
    main()

--- File: services/__init__.py ---

--- File: services/analysis_service.py ---
#!/usr/bin/env python
# -*- coding: utf-8 -*-
"""
æ–‡ä»¶è·¯å¾„: smart_proposal_engine/services/analysis_service.py
åŠŸèƒ½è¯´æ˜: æ·±åº¦åˆ†ææœåŠ¡æ¨¡å—ï¼Œè´Ÿè´£å¯¹è½¬å½•æ–‡æœ¬è¿›è¡Œå•†ä¸šæ´å¯Ÿåˆ†æ
ä½œè€…: SmartProposal Team
åˆ›å»ºæ—¥æœŸ: 2025-06-27
æœ€åä¿®æ”¹: 2025-06-27
ç‰ˆæœ¬: 1.0.0
"""

import os
import sys
import time
from typing import Dict, List, Optional, Tuple, Union
from datetime import datetime
from pathlib import Path

import google.generativeai as genai

# æ·»åŠ é¡¹ç›®æ ¹ç›®å½•åˆ°ç³»ç»Ÿè·¯å¾„
sys.path.insert(0, os.path.dirname(os.path.dirname(os.path.abspath(__file__))))

from services.base_service import BaseService, ProcessingResult
from core.prompt_manager import PromptManager
from core.model_interface import ModelInterface


class DeepAnalysisService(BaseService):
    """
    æ·±åº¦åˆ†ææœåŠ¡ç±»

    ä¸»è¦åŠŸèƒ½:
    - å¯¹è½¬å½•æ–‡æœ¬è¿›è¡Œå•†ä¸šæ´å¯Ÿåˆ†æ
    - æ”¯æŒå¤šç§åˆ†æåœºæ™¯æ¨¡æ¿
    - æ”¯æŒè‡ªå®šä¹‰åˆ†ææ¨¡æ¿
    - ç”Ÿæˆç»“æ„åŒ–çš„åˆ†ææŠ¥å‘Š

    ä½¿ç”¨ç¤ºä¾‹:
        service = DeepAnalysisService()
        result = service.process(transcript_text, template='customer_interview')
    """

    # é¢„å®šä¹‰çš„åˆ†æåœºæ™¯
    ANALYSIS_SCENARIOS = {
        'customer_interview': {
            'name': 'å®¢æˆ·è®¿è°ˆæ·±åº¦åˆ†æ',
            'description': 'é€‚ç”¨äºå®¢æˆ·éœ€æ±‚è®¿è°ˆã€ç”¨æˆ·è°ƒç ”ç­‰åœºæ™¯',
            'focus_areas': ['éœ€æ±‚è¯†åˆ«', 'ç—›ç‚¹åˆ†æ', 'å†³ç­–é“¾è·¯', 'å•†æœºè¯„ä¼°']
        },
        'business_negotiation': {
            'name': 'å•†åŠ¡è°ˆåˆ¤è¦ç‚¹åˆ†æ',
            'description': 'é€‚ç”¨äºå•†åŠ¡æ´½è°ˆã€åˆä½œåå•†ç­‰åœºæ™¯',
            'focus_areas': ['å…³é”®æ¡æ¬¾', 'è°ˆåˆ¤ç«‹åœº', 'åˆ©ç›Šè¯‰æ±‚', 'é£é™©ç‚¹']
        },
        'internal_meeting': {
            'name': 'å†…éƒ¨ä¼šè®®å†³ç­–åˆ†æ',
            'description': 'é€‚ç”¨äºå†…éƒ¨è®¨è®ºã€å†³ç­–ä¼šè®®ç­‰åœºæ™¯',
            'focus_areas': ['å†³ç­–è¦ç‚¹', 'è¡ŒåŠ¨é¡¹', 'è´£ä»»åˆ†é…', 'æ—¶é—´èŠ‚ç‚¹']
        },
        'requirements_gathering': {
            'name': 'éœ€æ±‚æ”¶é›†åˆ†æ',
            'description': 'é€‚ç”¨äºäº§å“éœ€æ±‚æ”¶é›†ã€åŠŸèƒ½è§„åˆ’ç­‰åœºæ™¯',
            'focus_areas': ['åŠŸèƒ½éœ€æ±‚', 'éåŠŸèƒ½éœ€æ±‚', 'ä¼˜å…ˆçº§', 'å®ç°éš¾åº¦']
        },
        'project_review': {
            'name': 'é¡¹ç›®å¤ç›˜åˆ†æ',
            'description': 'é€‚ç”¨äºé¡¹ç›®æ€»ç»“ã€ç»éªŒåˆ†äº«ç­‰åœºæ™¯',
            'focus_areas': ['æˆåŠŸç»éªŒ', 'é—®é¢˜æ•™è®­', 'æ”¹è¿›å»ºè®®', 'æœ€ä½³å®è·µ']
        }
    }

    def __init__(self):
        super().__init__()
        self.prompt_manager = PromptManager()
        self.model_interface = ModelInterface()

    def get_available_templates(self) -> List[str]:
        """è·å–å¯ç”¨çš„åˆ†ææ¨¡æ¿åˆ—è¡¨"""
        # é¢„å®šä¹‰æ¨¡æ¿
        templates = list(self.ANALYSIS_SCENARIOS.keys())

        # æ–‡ä»¶ç³»ç»Ÿä¸­çš„è‡ªå®šä¹‰æ¨¡æ¿
        custom_templates = self.prompt_manager.list_templates('analysis')

        # åˆå¹¶å¹¶å»é‡
        all_templates = list(set(templates + custom_templates))
        return all_templates

    def get_scenario_info(self, scenario: str) -> Dict:
        """è·å–åˆ†æåœºæ™¯çš„è¯¦ç»†ä¿¡æ¯"""
        return self.ANALYSIS_SCENARIOS.get(scenario, {})

    def validate_input(self, input_data: Union[str, Dict]) -> bool:
        """éªŒè¯è¾“å…¥æ•°æ®"""
        if isinstance(input_data, str):
            # éªŒè¯æ–‡æœ¬é•¿åº¦
            if len(input_data.strip()) < 50:
                return False
            return True
        elif isinstance(input_data, dict):
            # éªŒè¯å¿…è¦å­—æ®µ
            return 'transcript' in input_data or 'content' in input_data
        return False

    def process(self,
                input_data: Union[str, Dict],
                template: Optional[str] = 'customer_interview',
                options: Optional[Dict] = None) -> ProcessingResult:
        """
        æ‰§è¡Œæ·±åº¦åˆ†æ

        Args:
            input_data: å¾…åˆ†æçš„æ–‡æœ¬æˆ–åŒ…å«æ–‡æœ¬çš„å­—å…¸
            template: åˆ†ææ¨¡æ¿åç§°
            options: åˆ†æé€‰é¡¹
                - custom_prompt: è‡ªå®šä¹‰æç¤ºè¯
                - additional_context: é¢å¤–çš„ä¸Šä¸‹æ–‡ä¿¡æ¯
                - output_format: è¾“å‡ºæ ¼å¼ ('markdown', 'json')
                - include_recommendations: æ˜¯å¦åŒ…å«å»ºè®®
                - progress_callback: è¿›åº¦å›è°ƒå‡½æ•°

        Returns:
            ProcessingResult: åˆ†æç»“æœ
        """
        start_time = time.time()
        options = options or {}
        progress_callback = options.get('progress_callback')

        try:
            # æå–æ–‡æœ¬å†…å®¹
            if isinstance(input_data, str):
                transcript = input_data
                metadata = {}
            else:
                transcript = input_data.get('transcript') or input_data.get('content', '')
                metadata = input_data.get('metadata', {})

            if not self.validate_input(transcript):
                raise ValueError("è¾“å…¥æ–‡æœ¬å¤ªçŸ­æˆ–æ ¼å¼ä¸æ­£ç¡®")

            if progress_callback:
                progress_callback("æ­£åœ¨å‡†å¤‡åˆ†æ...")

            # è·å–åˆ†ææç¤ºè¯
            if options.get('custom_prompt'):
                # ä½¿ç”¨è‡ªå®šä¹‰æç¤ºè¯
                analysis_prompt = options['custom_prompt']
                if '{transcript}' in analysis_prompt:
                    analysis_prompt = analysis_prompt.format(transcript=transcript)
                else:
                    # å¦‚æœè‡ªå®šä¹‰æç¤ºè¯æ²¡æœ‰å ä½ç¬¦ï¼Œåˆ™å°†æ–‡æœ¬é™„åŠ åœ¨åé¢
                    analysis_prompt = f"{analysis_prompt}\n\n### å¾…åˆ†æå†…å®¹ï¼š\n{transcript}"
            else:
                # ä½¿ç”¨æ¨¡æ¿
                try:
                    analysis_prompt = self.prompt_manager.get_template(
                        'analysis',
                        template,
                        variables={
                            'transcript': transcript,
                            'additional_context': options.get('additional_context', ''),
                            'scenario_info': self.get_scenario_info(template)
                        }
                    )
                except Exception as e:
                    # å¦‚æœæ¨¡æ¿ä¸å­˜åœ¨ï¼Œä½¿ç”¨é»˜è®¤çš„å®¢æˆ·è®¿è°ˆæ¨¡æ¿
                    print(f"æ¨¡æ¿ {template} åŠ è½½å¤±è´¥ï¼Œä½¿ç”¨é»˜è®¤æ¨¡æ¿: {e}")
                    analysis_prompt = self._get_default_prompt(transcript, template)

            if progress_callback:
                progress_callback(f"æ­£åœ¨è°ƒç”¨ AI æ¨¡å‹è¿›è¡Œæ·±åº¦åˆ†æ...")

            # è°ƒç”¨æ¨¡å‹è¿›è¡Œåˆ†æ
            response, stats = self.model_interface.generate_content(
                analysis_prompt,
                model_type='analysis',
                request_options={"timeout": 900}  # 15åˆ†é’Ÿè¶…æ—¶
            )

            # å¤„ç†è¾“å‡ºæ ¼å¼
            analysis_result = self._format_analysis_result(
                response,
                options.get('output_format', 'markdown')
            )

            if progress_callback:
                progress_callback(f"æ·±åº¦åˆ†æå®Œæˆï¼Œè€—æ—¶ {time.time() - start_time:.1f} ç§’")

            # æ„å»ºå®Œæ•´çš„å…ƒæ•°æ®
            result_metadata = {
                'analysis_template': template,
                'analysis_scenario': self.ANALYSIS_SCENARIOS.get(template, {}).get('name', template),
                'timestamp': datetime.now().strftime('%Y-%m-%d %H:%M:%S'),
                'input_length': len(transcript),
                'analysis_time': time.time() - start_time,
                **metadata  # ä¿ç•™åŸå§‹å…ƒæ•°æ®
            }

            # æ·»åŠ ç»Ÿè®¡ä¿¡æ¯
            result_metadata.update({
                'input_tokens': stats.get('input_tokens', 0),
                'output_tokens': stats.get('output_tokens', 0),
                'total_tokens': stats.get('total_tokens', 0),
                'model_used': stats.get('model_used', ''),
                'estimated_cost': stats.get('estimated_cost', 0)
            })

            processing_time = time.time() - start_time

            return ProcessingResult(
                content=analysis_result,
                metadata=result_metadata,
                source_type='analysis',
                processing_time=processing_time,
                model_used=stats.get('model_used', ''),
                tokens_consumed={
                    'input': stats.get('input_tokens', 0),
                    'output': stats.get('output_tokens', 0),
                    'total': stats.get('total_tokens', 0)
                }
            )

        except Exception as e:
            if progress_callback:
                progress_callback(f"æ·±åº¦åˆ†æå¤±è´¥ï¼š{e}")

            processing_time = time.time() - start_time

            return ProcessingResult(
                content='',
                metadata={
                    'error': str(e),
                    'analysis_template': template,
                    'timestamp': datetime.now().strftime('%Y-%m-%d %H:%M:%S')
                },
                source_type='analysis',
                processing_time=processing_time,
                model_used='',
                tokens_consumed={},
                error=str(e)
            )

    def _get_default_prompt(self, transcript: str, template: str) -> str:
        """è·å–é»˜è®¤çš„åˆ†ææç¤ºè¯ï¼ˆå½“æ¨¡æ¿åŠ è½½å¤±è´¥æ—¶ä½¿ç”¨ï¼‰"""
        scenario_info = self.get_scenario_info(template)
        scenario_name = scenario_info.get('name', 'å•†ä¸šåˆ†æ')
        focus_areas = scenario_info.get('focus_areas', ['å…³é”®ä¿¡æ¯', 'ä¸»è¦è§‚ç‚¹', 'è¡ŒåŠ¨å»ºè®®'])

        return f"""# {scenario_name}

## ä¸€ã€è§’è‰²å®šä½
ä½ æ˜¯ä¸€ä½æ‹¥æœ‰15å¹´ç»éªŒçš„èµ„æ·±å•†ä¸šåˆ†æå¸ˆå’Œæˆ˜ç•¥é¡¾é—®ï¼Œä¸“ç²¾äºä»å¯¹è¯è®°å½•ä¸­æå–å…³é”®æ´å¯Ÿå¹¶åˆ¶å®šå¯è¡Œçš„å•†ä¸šç­–ç•¥ã€‚

## äºŒã€åˆ†æä»»åŠ¡
è¯·å¯¹ä»¥ä¸‹å†…å®¹è¿›è¡Œæ·±åº¦åˆ†æï¼Œé‡ç‚¹å…³æ³¨ä»¥ä¸‹æ–¹é¢ï¼š
{chr(10).join(f'- {area}' for area in focus_areas)}

### å¾…åˆ†æå†…å®¹ï¼š
{transcript}

## ä¸‰ã€åˆ†æè¦æ±‚

### 3.1 æ‰§è¡Œæ‘˜è¦
è¯·ç”¨200å­—ä»¥å†…æ¦‚æ‹¬æ ¸å¿ƒå†…å®¹å’Œå…³é”®å‘ç°ã€‚

### 3.2 è¯¦ç»†åˆ†æ
è¯·æ ¹æ®å†…å®¹ç‰¹ç‚¹ï¼Œä»ä»¥ä¸‹ç»´åº¦è¿›è¡Œåˆ†æï¼š
1. **æ ¸å¿ƒä¿¡æ¯æå–**ï¼šè¯†åˆ«å¹¶æ•´ç†å…³é”®ä¿¡æ¯ç‚¹
2. **æ·±å±‚æ´å¯ŸæŒ–æ˜**ï¼šåˆ†æè¡¨è±¡èƒŒåçš„æ·±å±‚å«ä¹‰
3. **æœºä¼šä¸é£é™©**ï¼šè¯†åˆ«æ½œåœ¨çš„æœºä¼šå’Œéœ€è¦æ³¨æ„çš„é£é™©
4. **è¡ŒåŠ¨å»ºè®®**ï¼šæä¾›å…·ä½“å¯æ‰§è¡Œçš„å»ºè®®

### 3.3 å…³é”®è¦ç‚¹æ€»ç»“
è¯·åˆ—å‡º3-5ä¸ªæœ€é‡è¦çš„å‘ç°å’Œç»“è®ºã€‚

## å››ã€è¾“å‡ºè¦æ±‚
1. åˆ†æè¦åŸºäºåŸæ–‡äº‹å®ï¼Œé¿å…è¿‡åº¦æ¨æµ‹
2. ä½¿ç”¨ä¸“ä¸šä½†æ˜“æ‡‚çš„å•†ä¸šè¯­è¨€
3. æä¾›å…·ä½“ã€å¯æ‰§è¡Œçš„å»ºè®®
4. ä¿æŒå®¢è§‚ä¸­ç«‹çš„åˆ†æè§†è§’"""

    def _format_analysis_result(self, raw_result: str, output_format: str) -> str:
        """æ ¼å¼åŒ–åˆ†æç»“æœ"""
        if output_format == 'markdown':
            # ç¡®ä¿è¾“å‡ºæ˜¯è§„èŒƒçš„Markdownæ ¼å¼
            if not raw_result.startswith('#'):
                raw_result = f"# åˆ†ææŠ¥å‘Š\n\n{raw_result}"
            return raw_result
        elif output_format == 'json':
            # TODO: å®ç°JSONæ ¼å¼è½¬æ¢
            # è¿™é‡Œæš‚æ—¶è¿”å›åŸå§‹ç»“æœ
            return raw_result
        else:
            return raw_result

    def analyze_transcript(self,
                           transcript: str,
                           template: str = 'customer_interview',
                           progress_callback=None) -> Tuple[str, Dict[str, any]]:
        """
        åˆ†æè½¬å½•æ–‡æœ¬ï¼ˆå…¼å®¹æ—§æ¥å£ï¼‰

        Args:
            transcript: è½¬å½•æ–‡æœ¬
            template: åˆ†ææ¨¡æ¿
            progress_callback: è¿›åº¦å›è°ƒå‡½æ•°

        Returns:
            (åˆ†æç»“æœæ–‡æœ¬, ç»Ÿè®¡ä¿¡æ¯å­—å…¸)
        """
        result = self.process(
            transcript,
            template=template,
            options={'progress_callback': progress_callback}
        )

        if result.error:
            return f"åˆ†æè¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯ï¼š{result.error}", {
                'error': result.error,
                'analysis_time': result.processing_time
            }

        stats = {
            'analysis_time': result.processing_time,
            'input_tokens': result.tokens_consumed.get('input', 0),
            'output_tokens': result.tokens_consumed.get('output', 0),
            'model_used': result.model_used,
            'timestamp': result.metadata.get('timestamp', '')
        }

        return result.content, stats

    def batch_analyze(self,
                      documents: List[Dict],
                      template: str = 'customer_interview',
                      options: Optional[Dict] = None) -> List[ProcessingResult]:
        """
        æ‰¹é‡åˆ†æå¤šä¸ªæ–‡æ¡£

        Args:
            documents: æ–‡æ¡£åˆ—è¡¨ï¼Œæ¯ä¸ªæ–‡æ¡£åŒ…å« 'id', 'content' ç­‰å­—æ®µ
            template: åˆ†ææ¨¡æ¿
            options: åˆ†æé€‰é¡¹

        Returns:
            List[ProcessingResult]: åˆ†æç»“æœåˆ—è¡¨
        """
        results = []
        options = options or {}
        progress_callback = options.get('progress_callback')

        for i, doc in enumerate(documents):
            if progress_callback:
                progress_callback(f"æ­£åœ¨åˆ†ææ–‡æ¡£ {i + 1}/{len(documents)}: {doc.get('id', 'unknown')}")

            # ä¸ºæ¯ä¸ªæ–‡æ¡£åˆ›å»ºç‹¬ç«‹çš„é€‰é¡¹
            doc_options = options.copy()
            doc_options['document_id'] = doc.get('id')

            result = self.process(
                doc.get('content', ''),
                template=template,
                options=doc_options
            )

            # æ·»åŠ æ–‡æ¡£IDåˆ°å…ƒæ•°æ®
            result.metadata['document_id'] = doc.get('id')
            results.append(result)

            # é¿å…è¯·æ±‚è¿‡äºé¢‘ç¹
            if i < len(documents) - 1:
                time.sleep(2)

        return results

    def compare_analyses(self,
                         analyses: List[ProcessingResult],
                         comparison_prompt: Optional[str] = None) -> ProcessingResult:
        """
        æ¯”è¾ƒå¤šä¸ªåˆ†æç»“æœï¼Œç”Ÿæˆç»¼åˆæŠ¥å‘Š

        Args:
            analyses: åˆ†æç»“æœåˆ—è¡¨
            comparison_prompt: è‡ªå®šä¹‰æ¯”è¾ƒæç¤ºè¯

        Returns:
            ProcessingResult: ç»¼åˆæ¯”è¾ƒæŠ¥å‘Š
        """
        start_time = time.time()

        try:
            # å‡†å¤‡æ¯”è¾ƒå†…å®¹
            comparison_content = "# å¤šæ–‡æ¡£åˆ†ææ¯”è¾ƒ\n\n"
            for i, analysis in enumerate(analyses):
                doc_id = analysis.metadata.get('document_id', f'æ–‡æ¡£{i + 1}')
                comparison_content += f"## {doc_id}\n\n"
                comparison_content += analysis.content
                comparison_content += "\n\n---\n\n"

            # æ„å»ºæ¯”è¾ƒæç¤ºè¯
            if not comparison_prompt:
                comparison_prompt = """è¯·å¯¹ä»¥ä¸Šå¤šä¸ªåˆ†ææŠ¥å‘Šè¿›è¡Œç»¼åˆæ¯”è¾ƒï¼Œç”Ÿæˆä¸€ä»½æ•´åˆæŠ¥å‘Šã€‚

è¦æ±‚ï¼š
1. è¯†åˆ«å…±åŒç‚¹å’Œå·®å¼‚ç‚¹
2. æå–è·¨æ–‡æ¡£çš„å…³é”®æ´å¯Ÿ
3. ç»¼åˆå„æ–‡æ¡£çš„å‘ç°ï¼Œå½¢æˆæ•´ä½“ç»“è®º
4. æä¾›åŸºäºå…¨å±€è§†è§’çš„å»ºè®®

è¯·ä»¥ç»“æ„åŒ–çš„æ–¹å¼å‘ˆç°æ¯”è¾ƒç»“æœã€‚"""

            full_prompt = f"{comparison_content}\n\n{comparison_prompt}"

            # è°ƒç”¨æ¨¡å‹
            response, stats = self.model_interface.generate_content(
                full_prompt,
                model_type='analysis'
            )

            processing_time = time.time() - start_time

            return ProcessingResult(
                content=response,
                metadata={
                    'comparison_type': 'multi_document',
                    'document_count': len(analyses),
                    'timestamp': datetime.now().strftime('%Y-%m-%d %H:%M:%S'),
                    'processing_time': processing_time
                },
                source_type='comparison',
                processing_time=processing_time,
                model_used=stats.get('model_used', ''),
                tokens_consumed={
                    'input': stats.get('input_tokens', 0),
                    'output': stats.get('output_tokens', 0),
                    'total': stats.get('total_tokens', 0)
                }
            )

        except Exception as e:
            processing_time = time.time() - start_time
            return ProcessingResult(
                content='',
                metadata={'error': str(e)},
                source_type='comparison',
                processing_time=processing_time,
                model_used='',
                tokens_consumed={},
                error=str(e)
            )

    def extract_action_items(self, analysis_result: ProcessingResult) -> List[Dict]:
        """
        ä»åˆ†æç»“æœä¸­æå–è¡ŒåŠ¨é¡¹

        Args:
            analysis_result: åˆ†æç»“æœ

        Returns:
            List[Dict]: è¡ŒåŠ¨é¡¹åˆ—è¡¨
        """
        # TODO: å®ç°æ™ºèƒ½æå–è¡ŒåŠ¨é¡¹çš„é€»è¾‘
        # è¿™é‡Œæä¾›ä¸€ä¸ªç®€å•çš„å®ç°
        action_items = []

        content = analysis_result.content
        lines = content.split('\n')

        in_action_section = False
        for line in lines:
            line = line.strip()
            if 'è¡ŒåŠ¨' in line and ('å»ºè®®' in line or 'è®¡åˆ’' in line or 'é¡¹' in line):
                in_action_section = True
                continue

            if in_action_section and line:
                # ç®€å•çš„æ¨¡å¼åŒ¹é…
                if line.startswith(('1.', '2.', '3.', '-', '*', 'â€¢')):
                    action_items.append({
                        'description': line.lstrip('1234567890.-*â€¢ '),
                        'priority': 'medium',
                        'source': 'auto_extracted'
                    })

        return action_items

    def generate_executive_summary(self,
                                   analysis_result: ProcessingResult,
                                   max_length: int = 500) -> str:
        """
        ç”Ÿæˆæ‰§è¡Œæ‘˜è¦

        Args:
            analysis_result: åˆ†æç»“æœ
            max_length: æœ€å¤§é•¿åº¦

        Returns:
            str: æ‰§è¡Œæ‘˜è¦
        """
        try:
            prompt = f"""è¯·ä¸ºä»¥ä¸‹åˆ†ææŠ¥å‘Šç”Ÿæˆä¸€ä»½ç®€æ´çš„æ‰§è¡Œæ‘˜è¦ï¼Œä¸è¶…è¿‡{max_length}å­—ï¼š

{analysis_result.content}

è¦æ±‚ï¼š
1. çªå‡ºæœ€å…³é”®çš„å‘ç°
2. æ˜ç¡®ä¸»è¦ç»“è®º
3. ç®€è¿°æ ¸å¿ƒå»ºè®®
4. è¯­è¨€ç²¾ç‚¼ä¸“ä¸š"""

            response, _ = self.model_interface.generate_content(
                prompt,
                model_type='analysis'
            )

            return response

        except Exception as e:
            # å¦‚æœç”Ÿæˆå¤±è´¥ï¼Œå°è¯•ç®€å•æå–
            content = analysis_result.content
            if 'æ‰§è¡Œæ‘˜è¦' in content:
                # å°è¯•æå–å·²æœ‰çš„æ‘˜è¦éƒ¨åˆ†
                start = content.find('æ‰§è¡Œæ‘˜è¦')
                end = content.find('\n##', start)
                if end == -1:
                    end = start + max_length
                return content[start:end].strip()

            # è¿”å›å‰é¢éƒ¨åˆ†ä½œä¸ºæ‘˜è¦
            return content[:max_length] + '...' if len(content) > max_length else content

--- File: services/base_service.py ---
#!/usr/bin/env python
# -*- coding: utf-8 -*-
"""
æ–‡ä»¶è·¯å¾„: smart_proposal_engine/services/base_service.py
åŠŸèƒ½è¯´æ˜: æ‰€æœ‰æœåŠ¡çš„åŸºç±»ï¼Œå®šä¹‰ç»Ÿä¸€æ¥å£å’Œæ•°æ®ç»“æ„
ä½œè€…: SmartProposal Team
åˆ›å»ºæ—¥æœŸ: 2025-06-27
æœ€åä¿®æ”¹: 2025-06-27
ç‰ˆæœ¬: 1.0.0
"""

from abc import ABC, abstractmethod
from dataclasses import dataclass, field
from typing import Dict, List, Optional, Union, Any
from datetime import datetime


@dataclass
class ProcessingResult:
    """
    ç»Ÿä¸€çš„å¤„ç†ç»“æœæ•°æ®ç»“æ„
    
    æ‰€æœ‰æœåŠ¡å¤„ç†åè¿”å›çš„ç»Ÿä¸€æ ¼å¼ï¼Œç¡®ä¿æ•°æ®åœ¨å„æ¨¡å—é—´é¡ºç•…æµè½¬
    """
    content: str                          # ä¸»è¦å†…å®¹ï¼ˆè½¬å½•æ–‡æœ¬ã€åˆ†ææŠ¥å‘Šã€æ–¹æ¡ˆæ–‡æ¡£ç­‰ï¼‰
    metadata: Dict[str, Any]              # å…ƒæ•°æ®ï¼ˆåŒ…å«å¤„ç†è¿‡ç¨‹çš„å„ç§ä¿¡æ¯ï¼‰
    source_type: str                      # æ¥æºç±»å‹ï¼ˆaudio/document/text/analysis/proposalç­‰ï¼‰
    processing_time: float                # å¤„ç†è€—æ—¶ï¼ˆç§’ï¼‰
    model_used: str                       # ä½¿ç”¨çš„æ¨¡å‹åç§°
    tokens_consumed: Dict[str, int]       # Tokenæ¶ˆè€—ç»Ÿè®¡
    error: Optional[str] = None           # é”™è¯¯ä¿¡æ¯ï¼ˆå¦‚æœæœ‰ï¼‰
    
    def to_dict(self) -> Dict[str, Any]:
        """è½¬æ¢ä¸ºå­—å…¸æ ¼å¼ï¼Œä¾¿äºåºåˆ—åŒ–å’Œå­˜å‚¨"""
        return {
            'content': self.content,
            'metadata': self.metadata,
            'source_type': self.source_type,
            'processing_time': self.processing_time,
            'model_used': self.model_used,
            'tokens_consumed': self.tokens_consumed,
            'error': self.error,
            'timestamp': datetime.now().isoformat()
        }
    
    @classmethod
    def from_dict(cls, data: Dict[str, Any]) -> 'ProcessingResult':
        """ä»å­—å…¸åˆ›å»ºå®ä¾‹"""
        # ç§»é™¤timestampå­—æ®µï¼ˆå¦‚æœå­˜åœ¨ï¼‰ï¼Œå› ä¸ºå®ƒä¸æ˜¯dataclassçš„å­—æ®µ
        data_copy = data.copy()
        data_copy.pop('timestamp', None)
        return cls(**data_copy)
    
    @property
    def is_success(self) -> bool:
        """åˆ¤æ–­å¤„ç†æ˜¯å¦æˆåŠŸ"""
        return self.error is None and bool(self.content)
    
    @property
    def total_tokens(self) -> int:
        """è·å–æ€»Tokenæ•°"""
        return self.tokens_consumed.get('total', 0)
    
    def get_summary(self) -> str:
        """è·å–å¤„ç†ç»“æœæ‘˜è¦"""
        if self.error:
            return f"å¤„ç†å¤±è´¥: {self.error}"
        
        summary_parts = [
            f"æ¥æºç±»å‹: {self.source_type}",
            f"å¤„ç†æ—¶é—´: {self.processing_time:.2f}ç§’",
            f"ä½¿ç”¨æ¨¡å‹: {self.model_used}",
            f"Tokenæ¶ˆè€—: {self.total_tokens}"
        ]
        
        # æ·»åŠ ç‰¹å®šç±»å‹çš„é¢å¤–ä¿¡æ¯
        if self.source_type == 'audio' and 'duration' in self.metadata:
            summary_parts.append(f"éŸ³é¢‘æ—¶é•¿: {self.metadata['duration']}")
        elif self.source_type == 'document' and 'page_count' in self.metadata:
            summary_parts.append(f"æ–‡æ¡£é¡µæ•°: {self.metadata['page_count']}")
        
        return " | ".join(summary_parts)


class BaseService(ABC):
    """
    æ‰€æœ‰æœåŠ¡çš„åŸºç±»
    
    å®šä¹‰äº†ç»Ÿä¸€çš„æœåŠ¡æ¥å£ï¼Œç¡®ä¿æ‰€æœ‰æœåŠ¡éµå¾ªç›¸åŒçš„å¤„ç†æ¨¡å¼
    ä¸»è¦æ–¹æ³•ï¼š
    - process(): ä¸»å¤„ç†æ–¹æ³•
    - validate_input(): è¾“å…¥éªŒè¯
    - get_available_templates(): è·å–å¯ç”¨æ¨¡æ¿
    - configure(): æœåŠ¡é…ç½®
    - format_result(): ç»“æœæ ¼å¼åŒ–
    """
    
    def __init__(self):
        """åˆå§‹åŒ–åŸºç¡€æœåŠ¡"""
        self.config = {}
        self.is_configured = False
        self.service_name = self.__class__.__name__
        self.version = "1.0.0"
    
    @abstractmethod
    def process(self, 
                input_data: Union[str, Dict, bytes],
                template: Optional[str] = None,
                options: Optional[Dict] = None) -> ProcessingResult:
        """
        ä¸»å¤„ç†æ–¹æ³•ï¼ˆå¿…é¡»å®ç°ï¼‰
        
        Args:
            input_data: è¾“å…¥æ•°æ®ï¼Œå¯ä»¥æ˜¯å­—ç¬¦ä¸²ã€å­—å…¸æˆ–å­—èŠ‚æ•°æ®
            template: ä½¿ç”¨çš„æ¨¡æ¿åç§°ï¼ˆå¯é€‰ï¼‰
            options: å¤„ç†é€‰é¡¹å­—å…¸ï¼ˆå¯é€‰ï¼‰
                å¸¸è§é€‰é¡¹ï¼š
                - progress_callback: è¿›åº¦å›è°ƒå‡½æ•°
                - output_format: è¾“å‡ºæ ¼å¼
                - custom_prompt: è‡ªå®šä¹‰æç¤ºè¯
                - additional_context: é¢å¤–ä¸Šä¸‹æ–‡
        
        Returns:
            ProcessingResult: ç»Ÿä¸€æ ¼å¼çš„å¤„ç†ç»“æœ
        """
        pass
    
    @abstractmethod
    def validate_input(self, input_data: Union[str, Dict, bytes]) -> bool:
        """
        éªŒè¯è¾“å…¥æ•°æ®æ˜¯å¦åˆæ³•ï¼ˆå¿…é¡»å®ç°ï¼‰
        
        Args:
            input_data: å¾…éªŒè¯çš„è¾“å…¥æ•°æ®
        
        Returns:
            bool: éªŒè¯æ˜¯å¦é€šè¿‡
        """
        pass
    
    @abstractmethod
    def get_available_templates(self) -> List[str]:
        """
        è·å–å¯ç”¨çš„æ¨¡æ¿åˆ—è¡¨ï¼ˆå¿…é¡»å®ç°ï¼‰
        
        Returns:
            List[str]: æ¨¡æ¿åç§°åˆ—è¡¨
        """
        pass
    
    def configure(self, config: Dict[str, Any]) -> None:
        """
        é…ç½®æœåŠ¡
        
        Args:
            config: é…ç½®å­—å…¸
        """
        self.config.update(config)
        self.is_configured = True
    
    def format_result(self, 
                     content: str,
                     metadata: Dict[str, Any],
                     processing_time: float,
                     model_info: Dict[str, Any],
                     error: Optional[str] = None) -> ProcessingResult:
        """
        æ ¼å¼åŒ–å¤„ç†ç»“æœ
        
        ç»Ÿä¸€çš„ç»“æœæ ¼å¼åŒ–æ–¹æ³•ï¼Œä¾›å­ç±»ä½¿ç”¨
        
        Args:
            content: å¤„ç†åçš„å†…å®¹
            metadata: å…ƒæ•°æ®
            processing_time: å¤„ç†æ—¶é—´
            model_info: æ¨¡å‹ä¿¡æ¯ï¼ˆåŒ…å«model_usedå’Œtokensä¿¡æ¯ï¼‰
            error: é”™è¯¯ä¿¡æ¯ï¼ˆå¦‚æœæœ‰ï¼‰
        
        Returns:
            ProcessingResult: æ ¼å¼åŒ–åçš„ç»“æœ
        """
        # ç¡®ä¿å…ƒæ•°æ®åŒ…å«æœåŠ¡ä¿¡æ¯
        metadata['service_name'] = self.service_name
        metadata['service_version'] = self.version
        
        # æå–æ¨¡å‹ä¿¡æ¯
        model_used = model_info.get('model_used', '')
        tokens_consumed = {
            'input': model_info.get('input_tokens', 0),
            'output': model_info.get('output_tokens', 0),
            'total': model_info.get('total_tokens', 0)
        }
        
        # æ·»åŠ è´¹ç”¨ä¿¡æ¯ï¼ˆå¦‚æœæœ‰ï¼‰
        if 'estimated_cost' in model_info:
            metadata['estimated_cost'] = model_info['estimated_cost']
        
        return ProcessingResult(
            content=content,
            metadata=metadata,
            source_type=self._get_source_type(),
            processing_time=processing_time,
            model_used=model_used,
            tokens_consumed=tokens_consumed,
            error=error
        )
    
    def _get_source_type(self) -> str:
        """
        è·å–æœåŠ¡å¯¹åº”çš„æºç±»å‹
        
        å­ç±»å¯ä»¥è¦†ç›–æ­¤æ–¹æ³•è¿”å›ç‰¹å®šçš„æºç±»å‹
        """
        # æ ¹æ®æœåŠ¡åç§°æ¨æ–­æºç±»å‹
        service_type_map = {
            'TranscriptionService': 'audio',
            'DocumentService': 'document',
            'AnalysisService': 'analysis',
            'DeepAnalysisService': 'analysis',
            'ProposalService': 'proposal'
        }
        
        return service_type_map.get(self.service_name, 'unknown')
    
    def get_service_info(self) -> Dict[str, Any]:
        """
        è·å–æœåŠ¡ä¿¡æ¯
        
        Returns:
            Dict: åŒ…å«æœåŠ¡åç§°ã€ç‰ˆæœ¬ã€é…ç½®çŠ¶æ€ç­‰ä¿¡æ¯
        """
        return {
            'name': self.service_name,
            'version': self.version,
            'is_configured': self.is_configured,
            'available_templates': self.get_available_templates(),
            'source_type': self._get_source_type()
        }
    
    def health_check(self) -> Dict[str, Any]:
        """
        æœåŠ¡å¥åº·æ£€æŸ¥
        
        Returns:
            Dict: å¥åº·çŠ¶æ€ä¿¡æ¯
        """
        try:
            # å°è¯•éªŒè¯ä¸€ä¸ªç®€å•çš„è¾“å…¥
            test_input = "test"
            is_healthy = True
            
            # æ£€æŸ¥æ˜¯å¦å¯ä»¥è·å–æ¨¡æ¿
            templates = self.get_available_templates()
            
            return {
                'status': 'healthy' if is_healthy else 'unhealthy',
                'service': self.service_name,
                'version': self.version,
                'configured': self.is_configured,
                'template_count': len(templates),
                'timestamp': datetime.now().isoformat()
            }
        except Exception as e:
            return {
                'status': 'unhealthy',
                'service': self.service_name,
                'version': self.version,
                'error': str(e),
                'timestamp': datetime.now().isoformat()
            }
    
    def __repr__(self) -> str:
        """å­—ç¬¦ä¸²è¡¨ç¤º"""
        return f"{self.service_name}(version={self.version}, configured={self.is_configured})"

--- File: services/document_service.py ---
#!/usr/bin/env python
# -*- coding: utf-8 -*-
"""
æ–‡ä»¶è·¯å¾„: smart_proposal_engine/services/document_service.py
åŠŸèƒ½è¯´æ˜: æ–‡æ¡£å¤„ç†æœåŠ¡ï¼Œæ”¯æŒå¤šç§æ–‡æ¡£æ ¼å¼çš„è¯»å–å’Œå¤„ç†
ä½œè€…: SmartProposal Team
åˆ›å»ºæ—¥æœŸ: 2025-06-27
æœ€åä¿®æ”¹: 2025-06-27
ç‰ˆæœ¬: 1.0.0
"""

import os
import sys
import time
from typing import Dict, List, Optional, Union, Tuple
from datetime import datetime
from pathlib import Path
import mimetypes

# æ–‡æ¡£å¤„ç†åº“
try:
    import docx
    from docx import Document
    DOCX_AVAILABLE = True
except ImportError:
    DOCX_AVAILABLE = False
    print("è­¦å‘Šï¼špython-docxæœªå®‰è£…ï¼Œæ— æ³•å¤„ç†DOCXæ–‡ä»¶")

try:
    import PyPDF2
    from PyPDF2 import PdfReader
    PDF_AVAILABLE = True
except ImportError:
    PDF_AVAILABLE = False
    print("è­¦å‘Šï¼šPyPDF2æœªå®‰è£…ï¼Œæ— æ³•å¤„ç†PDFæ–‡ä»¶")

# æ·»åŠ é¡¹ç›®æ ¹ç›®å½•åˆ°ç³»ç»Ÿè·¯å¾„
sys.path.insert(0, os.path.dirname(os.path.dirname(os.path.abspath(__file__))))

from services.base_service import BaseService, ProcessingResult
from utils.file_utils import get_file_extension, get_file_metadata, format_file_size
from utils.format_utils import clean_text, format_metadata_display


class DocumentService(BaseService):
    """
    æ–‡æ¡£å¤„ç†æœåŠ¡
    
    ä¸»è¦åŠŸèƒ½:
    1. æ”¯æŒDOCXæ–‡æ¡£è§£æï¼ˆä½¿ç”¨python-docxï¼‰
    2. æ”¯æŒPDFæ–‡æ¡£è§£æï¼ˆä½¿ç”¨PyPDF2ï¼‰
    3. æ”¯æŒTXTæ–‡æ¡£è¯»å–
    4. ç»Ÿä¸€è¾“å‡ºä¸ºæ ‡å‡†æ–‡æœ¬æ ¼å¼
    5. ä¿ç•™æ–‡æ¡£å…ƒæ•°æ®ï¼ˆé¡µæ•°ã€åˆ›å»ºæ—¶é—´ç­‰ï¼‰
    
    ä½¿ç”¨ç¤ºä¾‹:
        service = DocumentService()
        result = service.process(file_path, options={'extract_metadata': True})
    """
    
    # æ”¯æŒçš„æ–‡æ¡£æ ¼å¼
    SUPPORTED_FORMATS = {
        '.docx': 'Microsoft Word Document',
        '.doc': 'Microsoft Word Document (Legacy)',
        '.pdf': 'PDF Document',
        '.txt': 'Text File',
        '.rtf': 'Rich Text Format',
        '.odt': 'OpenDocument Text'
    }
    
    def __init__(self):
        super().__init__()
        self.check_dependencies()
    
    def check_dependencies(self):
        """æ£€æŸ¥ä¾èµ–åº“æ˜¯å¦å¯ç”¨"""
        self.capabilities = {
            'docx': DOCX_AVAILABLE,
            'pdf': PDF_AVAILABLE,
            'txt': True  # æ€»æ˜¯å¯ç”¨
        }
        
        if not DOCX_AVAILABLE:
            print("æç¤ºï¼šå®‰è£…python-docxä»¥æ”¯æŒDOCXæ–‡ä»¶å¤„ç†: pip install python-docx")
        if not PDF_AVAILABLE:
            print("æç¤ºï¼šå®‰è£…PyPDF2ä»¥æ”¯æŒPDFæ–‡ä»¶å¤„ç†: pip install PyPDF2")
    
    def get_available_templates(self) -> List[str]:
        """è·å–å¯ç”¨çš„æ¨¡æ¿åˆ—è¡¨ï¼ˆæ–‡æ¡£æœåŠ¡ä¸ä½¿ç”¨æ¨¡æ¿ï¼‰"""
        return []
    
    def validate_input(self, input_data: Union[str, bytes, Path]) -> bool:
        """éªŒè¯è¾“å…¥æ˜¯å¦ä¸ºæ”¯æŒçš„æ–‡æ¡£æ ¼å¼"""
        if isinstance(input_data, (str, Path)):
            ext = get_file_extension(input_data)
            return ext.lower() in self.SUPPORTED_FORMATS
        return False
    
    def process(self,
                input_data: Union[str, bytes, Path],
                template: Optional[str] = None,
                options: Optional[Dict] = None) -> ProcessingResult:
        """
        å¤„ç†æ–‡æ¡£æ–‡ä»¶
        
        Args:
            input_data: æ–‡æ¡£æ–‡ä»¶è·¯å¾„
            template: æœªä½¿ç”¨ï¼ˆä¿æŒæ¥å£ä¸€è‡´ï¼‰
            options: å¤„ç†é€‰é¡¹
                - extract_metadata: æ˜¯å¦æå–å…ƒæ•°æ®
                - preserve_formatting: æ˜¯å¦ä¿ç•™æ ¼å¼ä¿¡æ¯
                - clean_output: æ˜¯å¦æ¸…ç†è¾“å‡ºæ–‡æœ¬
                - progress_callback: è¿›åº¦å›è°ƒå‡½æ•°
        
        Returns:
            ProcessingResult: å¤„ç†ç»“æœ
        """
        start_time = time.time()
        options = options or {}
        progress_callback = options.get('progress_callback')
        
        try:
            # ç¡®ä¿è¾“å…¥æ˜¯æ–‡ä»¶è·¯å¾„
            file_path = Path(input_data)
            if not file_path.exists():
                raise FileNotFoundError(f"æ–‡ä»¶ä¸å­˜åœ¨: {file_path}")
            
            # è·å–æ–‡ä»¶ä¿¡æ¯
            file_metadata = get_file_metadata(file_path)
            ext = file_metadata['extension'].lower()
            
            if progress_callback:
                progress_callback(f"æ­£åœ¨å¤„ç† {file_metadata['filename']}...")
            
            # æ ¹æ®æ–‡ä»¶ç±»å‹é€‰æ‹©å¤„ç†æ–¹æ³•
            if ext == '.docx':
                content, doc_metadata = self._process_docx(file_path, options)
            elif ext == '.pdf':
                content, doc_metadata = self._process_pdf(file_path, options)
            elif ext in ['.txt', '.text']:
                content, doc_metadata = self._process_text(file_path, options)
            elif ext == '.doc':
                # æ—§ç‰ˆWordæ–‡æ¡£ï¼Œå°è¯•ä½œä¸ºDOCXå¤„ç†ï¼ˆå¯èƒ½éœ€è¦è½¬æ¢ï¼‰
                content, doc_metadata = self._process_legacy_doc(file_path, options)
            else:
                # å°è¯•ä½œä¸ºçº¯æ–‡æœ¬å¤„ç†
                content, doc_metadata = self._process_text(file_path, options)
            
            # æ¸…ç†æ–‡æœ¬ï¼ˆå¦‚æœéœ€è¦ï¼‰
            if options.get('clean_output', True):
                content = clean_text(content)
            
            # æ„å»ºå…ƒæ•°æ®
            metadata = {
                **file_metadata,
                **doc_metadata,
                'processing_options': {
                    'extract_metadata': options.get('extract_metadata', True),
                    'preserve_formatting': options.get('preserve_formatting', False),
                    'clean_output': options.get('clean_output', True)
                }
            }
            
            # æ·»åŠ å†…å®¹ç»Ÿè®¡
            metadata.update(self._analyze_content(content))
            
            if progress_callback:
                progress_callback(f"æ–‡æ¡£å¤„ç†å®Œæˆï¼Œå…±æå– {metadata.get('word_count', 0)} ä¸ªè¯")
            
            processing_time = time.time() - start_time
            
            return ProcessingResult(
                content=content,
                metadata=metadata,
                source_type='document',
                processing_time=processing_time,
                model_used='',  # æ–‡æ¡£å¤„ç†ä¸ä½¿ç”¨AIæ¨¡å‹
                tokens_consumed={}
            )
            
        except Exception as e:
            if progress_callback:
                progress_callback(f"æ–‡æ¡£å¤„ç†å¤±è´¥: {str(e)}")
            
            processing_time = time.time() - start_time
            
            return ProcessingResult(
                content='',
                metadata={
                    'error': str(e),
                    'file_path': str(input_data)
                },
                source_type='document',
                processing_time=processing_time,
                model_used='',
                tokens_consumed={},
                error=str(e)
            )
    
    def _process_docx(self, file_path: Path, options: Dict) -> Tuple[str, Dict]:
        """å¤„ç†DOCXæ–‡æ¡£"""
        if not DOCX_AVAILABLE:
            raise ImportError("python-docxåº“æœªå®‰è£…ï¼Œæ— æ³•å¤„ç†DOCXæ–‡ä»¶")
        
        doc = Document(str(file_path))
        content_parts = []
        metadata = {
            'format': 'docx',
            'paragraph_count': 0,
            'table_count': len(doc.tables),
            'image_count': len(doc.inline_shapes)
        }
        
        # æå–æ ¸å¿ƒå±æ€§ï¼ˆå¦‚æœå¯ç”¨ï¼‰
        if options.get('extract_metadata', True):
            try:
                core_props = doc.core_properties
                metadata.update({
                    'title': core_props.title or '',
                    'author': core_props.author or '',
                    'subject': core_props.subject or '',
                    'keywords': core_props.keywords or '',
                    'created': core_props.created.isoformat() if core_props.created else '',
                    'modified': core_props.modified.isoformat() if core_props.modified else '',
                    'last_modified_by': core_props.last_modified_by or ''
                })
            except:
                pass
        
        # æå–æ®µè½æ–‡æœ¬
        for paragraph in doc.paragraphs:
            text = paragraph.text.strip()
            if text:
                content_parts.append(text)
                metadata['paragraph_count'] += 1
        
        # æå–è¡¨æ ¼æ–‡æœ¬ï¼ˆå¦‚æœéœ€è¦ï¼‰
        if options.get('extract_tables', True) and doc.tables:
            content_parts.append("\n[è¡¨æ ¼å†…å®¹]\n")
            for table_idx, table in enumerate(doc.tables):
                content_parts.append(f"\nè¡¨æ ¼ {table_idx + 1}:")
                for row in table.rows:
                    row_text = " | ".join(cell.text.strip() for cell in row.cells)
                    if row_text.strip():
                        content_parts.append(row_text)
        
        content = "\n\n".join(content_parts)
        
        # è®¡ç®—é¡µæ•°ï¼ˆä¼°ç®—ï¼‰
        # DOCXæ²¡æœ‰å›ºå®šçš„é¡µæ•°æ¦‚å¿µï¼Œè¿™é‡Œæ ¹æ®å­—æ•°ä¼°ç®—
        word_count = len(content.split())
        estimated_pages = max(1, word_count // 250)  # å‡è®¾æ¯é¡µ250è¯
        metadata['page_count'] = estimated_pages
        metadata['page_count_note'] = 'estimated'
        
        return content, metadata
    
    def _process_pdf(self, file_path: Path, options: Dict) -> Tuple[str, Dict]:
        """å¤„ç†PDFæ–‡æ¡£"""
        if not PDF_AVAILABLE:
            raise ImportError("PyPDF2åº“æœªå®‰è£…ï¼Œæ— æ³•å¤„ç†PDFæ–‡ä»¶")
        
        content_parts = []
        metadata = {
            'format': 'pdf',
            'page_count': 0,
            'encrypted': False
        }
        
        try:
            with open(file_path, 'rb') as pdf_file:
                pdf_reader = PdfReader(pdf_file)
                
                # æ£€æŸ¥æ˜¯å¦åŠ å¯†
                if pdf_reader.is_encrypted:
                    metadata['encrypted'] = True
                    # å°è¯•ä½¿ç”¨ç©ºå¯†ç è§£å¯†
                    if not pdf_reader.decrypt(''):
                        raise ValueError("PDFæ–‡ä»¶å·²åŠ å¯†ï¼Œéœ€è¦å¯†ç ")
                
                metadata['page_count'] = len(pdf_reader.pages)
                
                # æå–å…ƒæ•°æ®
                if options.get('extract_metadata', True) and pdf_reader.metadata:
                    pdf_meta = pdf_reader.metadata
                    metadata.update({
                        'title': pdf_meta.get('/Title', ''),
                        'author': pdf_meta.get('/Author', ''),
                        'subject': pdf_meta.get('/Subject', ''),
                        'creator': pdf_meta.get('/Creator', ''),
                        'producer': pdf_meta.get('/Producer', ''),
                        'creation_date': str(pdf_meta.get('/CreationDate', '')),
                        'modification_date': str(pdf_meta.get('/ModDate', ''))
                    })
                
                # æå–æ¯é¡µæ–‡æœ¬
                for page_num, page in enumerate(pdf_reader.pages):
                    try:
                        page_text = page.extract_text()
                        if page_text.strip():
                            if options.get('preserve_formatting', False):
                                content_parts.append(f"\n--- ç¬¬ {page_num + 1} é¡µ ---\n")
                            content_parts.append(page_text)
                    except Exception as e:
                        content_parts.append(f"\n[ç¬¬ {page_num + 1} é¡µæå–å¤±è´¥: {str(e)}]\n")
        
        except Exception as e:
            raise Exception(f"PDFå¤„ç†å¤±è´¥: {str(e)}")
        
        content = "\n".join(content_parts)
        return content, metadata
    
    def _process_text(self, file_path: Path, options: Dict) -> Tuple[str, Dict]:
        """å¤„ç†çº¯æ–‡æœ¬æ–‡ä»¶"""
        metadata = {
            'format': 'txt',
            'encoding': 'utf-8'
        }
        
        # å°è¯•ä¸åŒçš„ç¼–ç 
        encodings = ['utf-8', 'gbk', 'gb2312', 'gb18030', 'latin-1']
        content = None
        
        for encoding in encodings:
            try:
                with open(file_path, 'r', encoding=encoding) as f:
                    content = f.read()
                metadata['encoding'] = encoding
                break
            except UnicodeDecodeError:
                continue
        
        if content is None:
            # å¦‚æœæ‰€æœ‰ç¼–ç éƒ½å¤±è´¥ï¼Œä½¿ç”¨äºŒè¿›åˆ¶æ¨¡å¼è¯»å–
            with open(file_path, 'rb') as f:
                content = f.read().decode('utf-8', errors='replace')
            metadata['encoding'] = 'binary_with_replacement'
        
        # ä¼°ç®—é¡µæ•°
        line_count = content.count('\n') + 1
        estimated_pages = max(1, line_count // 50)  # å‡è®¾æ¯é¡µ50è¡Œ
        metadata['page_count'] = estimated_pages
        metadata['page_count_note'] = 'estimated'
        metadata['line_count'] = line_count
        
        return content, metadata
    
    def _process_legacy_doc(self, file_path: Path, options: Dict) -> Tuple[str, Dict]:
        """å¤„ç†æ—§ç‰ˆDOCæ–‡æ¡£"""
        # æ—§ç‰ˆDOCæ–‡æ¡£å¤„ç†æ¯”è¾ƒå¤æ‚ï¼ŒMVPç‰ˆæœ¬å…ˆä½œä¸ºäºŒè¿›åˆ¶æ–‡ä»¶å¤„ç†
        # å®é™…é¡¹ç›®ä¸­å¯ä»¥ä½¿ç”¨python-docx2txtæˆ–å…¶ä»–åº“
        
        # å°è¯•ä½œä¸ºDOCXå¤„ç†ï¼ˆæœ‰äº›.docæ–‡ä»¶å®é™…ä¸Šæ˜¯DOCXæ ¼å¼ï¼‰
        try:
            return self._process_docx(file_path, options)
        except:
            pass
        
        # ä½œä¸ºæ–‡æœ¬æ–‡ä»¶å¤„ç†
        try:
            return self._process_text(file_path, options)
        except:
            pass
        
        # å¦‚æœéƒ½å¤±è´¥ï¼Œè¿”å›é”™è¯¯ä¿¡æ¯
        raise ValueError("æ— æ³•å¤„ç†æ—§ç‰ˆDOCæ–‡æ¡£ï¼Œè¯·è½¬æ¢ä¸ºDOCXæ ¼å¼")
    
    def _analyze_content(self, content: str) -> Dict[str, any]:
        """åˆ†ææ–‡æ¡£å†…å®¹ï¼Œæå–ç»Ÿè®¡ä¿¡æ¯"""
        # åŸºæœ¬ç»Ÿè®¡
        word_count = len(content.split())
        char_count = len(content)
        char_count_no_spaces = len(content.replace(' ', '').replace('\n', '').replace('\t', ''))
        
        # æ®µè½ç»Ÿè®¡
        paragraphs = [p for p in content.split('\n\n') if p.strip()]
        paragraph_count = len(paragraphs)
        
        # å¥å­ç»Ÿè®¡ï¼ˆç®€å•ä¼°ç®—ï¼‰
        sentence_endings = ['.', '!', '?', 'ã€‚', 'ï¼', 'ï¼Ÿ']
        sentence_count = sum(content.count(ending) for ending in sentence_endings)
        
        # å¹³å‡å€¼è®¡ç®—
        avg_words_per_paragraph = word_count / paragraph_count if paragraph_count > 0 else 0
        avg_words_per_sentence = word_count / sentence_count if sentence_count > 0 else 0
        
        return {
            'word_count': word_count,
            'character_count': char_count,
            'character_count_no_spaces': char_count_no_spaces,
            'paragraph_count': paragraph_count,
            'sentence_count': sentence_count,
            'avg_words_per_paragraph': round(avg_words_per_paragraph, 1),
            'avg_words_per_sentence': round(avg_words_per_sentence, 1)
        }
    
    def extract_structured_content(self, 
                                 file_path: Union[str, Path],
                                 structure_type: str = 'sections') -> Dict[str, List[str]]:
        """
        æå–ç»“æ„åŒ–å†…å®¹
        
        Args:
            file_path: æ–‡æ¡£è·¯å¾„
            structure_type: ç»“æ„ç±»å‹ ('sections', 'headings', 'lists')
        
        Returns:
            Dict: ç»“æ„åŒ–å†…å®¹
        """
        result = self.process(file_path)
        if not result.is_success:
            return {}
        
        content = result.content
        structured = {}
        
        if structure_type == 'sections':
            # æŒ‰æ ‡é¢˜åˆ†å‰²ç« èŠ‚
            # ç®€å•å®ç°ï¼šæŸ¥æ‰¾å¯èƒ½çš„æ ‡é¢˜æ¨¡å¼
            sections = []
            current_section = []
            
            for line in content.split('\n'):
                # æ£€æµ‹å¯èƒ½çš„æ ‡é¢˜ï¼ˆå…¨å¤§å†™ã€æ•°å­—å¼€å¤´ç­‰ï¼‰
                if (line.isupper() and len(line) > 3) or \
                   (line.strip() and line[0].isdigit() and '.' in line[:3]):
                    if current_section:
                        sections.append('\n'.join(current_section))
                    current_section = [line]
                else:
                    current_section.append(line)
            
            if current_section:
                sections.append('\n'.join(current_section))
            
            structured['sections'] = sections
            
        elif structure_type == 'headings':
            # æå–æ‰€æœ‰æ ‡é¢˜
            headings = []
            for line in content.split('\n'):
                line = line.strip()
                if line and (line.isupper() or 
                           (line[0].isdigit() and '.' in line[:3]) or
                           line.startswith('#')):
                    headings.append(line)
            
            structured['headings'] = headings
            
        elif structure_type == 'lists':
            # æå–åˆ—è¡¨é¡¹
            list_items = []
            for line in content.split('\n'):
                line = line.strip()
                if line and (line.startswith(('â€¢', '-', '*', 'Â·')) or
                           (line[0].isdigit() and ('.' in line[:3] or ')' in line[:3]))):
                    list_items.append(line)
            
            structured['lists'] = list_items
        
        return structured
    
    def convert_to_markdown(self, file_path: Union[str, Path]) -> str:
        """
        å°†æ–‡æ¡£è½¬æ¢ä¸ºMarkdownæ ¼å¼
        
        Args:
            file_path: æ–‡æ¡£è·¯å¾„
        
        Returns:
            str: Markdownæ ¼å¼çš„å†…å®¹
        """
        result = self.process(file_path, options={'preserve_formatting': True})
        if not result.is_success:
            return f"# é”™è¯¯\n\næ— æ³•å¤„ç†æ–‡æ¡£: {result.error}"
        
        # æ·»åŠ æ–‡æ¡£ä¿¡æ¯å¤´
        markdown_parts = [
            f"# {result.metadata.get('title', 'æ–‡æ¡£å†…å®¹')}\n",
            f"**æ–‡ä»¶**: {result.metadata.get('filename', 'unknown')}  ",
            f"**æ ¼å¼**: {result.metadata.get('format', 'unknown')}  ",
            f"**é¡µæ•°**: {result.metadata.get('page_count', 'unknown')}  ",
            f"**å­—æ•°**: {result.metadata.get('word_count', 'unknown')}  \n",
            "---\n"
        ]
        
        # å¤„ç†å†…å®¹ï¼Œå°è¯•è¯†åˆ«å’Œä¿ç•™ç»“æ„
        content = result.content
        lines = content.split('\n')
        
        for line in lines:
            line = line.strip()
            if not line:
                markdown_parts.append('')
                continue
            
            # è¯†åˆ«å¯èƒ½çš„æ ‡é¢˜
            if line.isupper() and len(line) > 3:
                markdown_parts.append(f"\n## {line}\n")
            elif line[0:1].isdigit() and '.' in line[:3]:
                # å¯èƒ½æ˜¯ç¼–å·æ ‡é¢˜
                markdown_parts.append(f"\n### {line}\n")
            else:
                markdown_parts.append(line)
        
        return '\n'.join(markdown_parts)
    
    def get_document_summary(self, file_path: Union[str, Path], max_length: int = 500) -> str:
        """
        è·å–æ–‡æ¡£æ‘˜è¦
        
        Args:
            file_path: æ–‡æ¡£è·¯å¾„
            max_length: æœ€å¤§é•¿åº¦
        
        Returns:
            str: æ–‡æ¡£æ‘˜è¦
        """
        result = self.process(file_path)
        if not result.is_success:
            return f"æ— æ³•ç”Ÿæˆæ‘˜è¦: {result.error}"
        
        content = result.content
        
        # ç®€å•çš„æ‘˜è¦ç”Ÿæˆï¼šå–å‰é¢çš„å†…å®¹
        # åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™é‡Œå¯ä»¥è°ƒç”¨AIæ¨¡å‹ç”Ÿæˆæ›´å¥½çš„æ‘˜è¦
        if len(content) <= max_length:
            return content
        
        # å°è¯•åœ¨å¥å­è¾¹ç•Œæˆªæ–­
        truncated = content[:max_length]
        last_period = truncated.rfind('ã€‚')
        if last_period == -1:
            last_period = truncated.rfind('.')
        
        if last_period > max_length * 0.8:
            truncated = truncated[:last_period + 1]
        
        return truncated + "..."
    
    def batch_process_documents(self,
                              file_paths: List[Union[str, Path]],
                              options: Optional[Dict] = None) -> List[ProcessingResult]:
        """
        æ‰¹é‡å¤„ç†æ–‡æ¡£
        
        Args:
            file_paths: æ–‡æ¡£è·¯å¾„åˆ—è¡¨
            options: å¤„ç†é€‰é¡¹
        
        Returns:
            List[ProcessingResult]: å¤„ç†ç»“æœåˆ—è¡¨
        """
        results = []
        options = options or {}
        progress_callback = options.get('progress_callback')
        
        for i, file_path in enumerate(file_paths):
            if progress_callback:
                progress_callback(f"å¤„ç†æ–‡æ¡£ {i + 1}/{len(file_paths)}: {Path(file_path).name}")
            
            result = self.process(file_path, options=options)
            results.append(result)
        
        return results

--- File: services/proposal_service.py ---
#!/usr/bin/env python
# -*- coding: utf-8 -*-
"""
æ–‡ä»¶è·¯å¾„: smart_proposal_engine/services/proposal_service.py
åŠŸèƒ½è¯´æ˜: æ–¹æ¡ˆç”ŸæˆæœåŠ¡ï¼ŒåŸºäºåˆ†æç»“æœç”Ÿæˆå„ç±»å•†ä¸šæ–‡æ¡£
ä½œè€…: SmartProposal Team
åˆ›å»ºæ—¥æœŸ: 2025-06-27
æœ€åä¿®æ”¹: 2025-06-27
ç‰ˆæœ¬: 1.0.0
"""
import re
import os
import sys
import time
import json
from typing import Dict, List, Optional, Union, Tuple, Any
from datetime import datetime
from pathlib import Path

# æ·»åŠ é¡¹ç›®æ ¹ç›®å½•åˆ°ç³»ç»Ÿè·¯å¾„
sys.path.insert(0, os.path.dirname(os.path.dirname(os.path.abspath(__file__))))

from services.base_service import BaseService, ProcessingResult
from services.document_service import DocumentService
from core.prompt_manager import PromptManager
from core.model_interface import ModelInterface
from utils.format_utils import clean_text, format_timestamp, format_money


class ProposalService(BaseService):
    """
    æ–¹æ¡ˆç”ŸæˆæœåŠ¡
    
    ä¸»è¦åŠŸèƒ½:
    1. åŸºäºåˆ†æç»“æœç”Ÿæˆæ–¹æ¡ˆ
    2. æ”¯æŒå¤šç§æ–¹æ¡ˆæ¨¡æ¿
    3. æ•´åˆä¼ä¸šèƒ½åŠ›æ–‡æ¡£ï¼ˆå¯é€‰ï¼‰
    4. ç”Ÿæˆä¸“ä¸šæ ¼å¼çš„è¾“å‡ºæ–‡æ¡£
    
    ä½¿ç”¨ç¤ºä¾‹:
        service = ProposalService()
        result = service.process(
            analysis_report,
            template='project_proposal',
            options={'capability_docs': ['company_intro.docx']}
        )
    """
    
    # é¢„å®šä¹‰çš„æ–¹æ¡ˆç±»å‹
    PROPOSAL_TYPES = {
        'project_proposal': {
            'name': 'é¡¹ç›®å»ºè®®ä¹¦',
            'description': 'å®Œæ•´çš„é¡¹ç›®å®æ–½æ–¹æ¡ˆï¼ŒåŒ…å«èƒŒæ™¯ã€æ–¹æ¡ˆã€è®¡åˆ’ã€é¢„ç®—ç­‰',
            'sections': ['æ‰§è¡Œæ‘˜è¦', 'éœ€æ±‚åˆ†æ', 'è§£å†³æ–¹æ¡ˆ', 'å®æ–½è®¡åˆ’', 'æŠ•èµ„å›æŠ¥', 'å›¢é˜Ÿä»‹ç»', 'å•†åŠ¡æ¡æ¬¾']
        },
        'quotation_proposal': {
            'name': 'å•†åŠ¡æŠ¥ä»·æ–¹æ¡ˆ',
            'description': 'è¯¦ç»†çš„æœåŠ¡æŠ¥ä»·å•ï¼ŒåŒ…å«é¡¹ç›®æ˜ç»†å’Œä»·æ ¼',
            'sections': ['æ–¹æ¡ˆæ¦‚è¿°', 'æœåŠ¡å†…å®¹', 'æŠ¥ä»·æ˜ç»†', 'ä»˜æ¬¾æ–¹å¼', 'æœåŠ¡æ‰¿è¯º']
        },
        'solution_brief': {
            'name': 'è§£å†³æ–¹æ¡ˆç®€æŠ¥',
            'description': 'ç®€æ´çš„æ–¹æ¡ˆè¯´æ˜ï¼Œé€‚åˆå¿«é€Ÿå±•ç¤º',
            'sections': ['é—®é¢˜é™ˆè¿°', 'è§£å†³æ–¹æ¡ˆ', 'å®æ–½æ­¥éª¤', 'é¢„æœŸæ•ˆæœ']
        },
        'meeting_minutes': {
            'name': 'ä¼šè®®çºªè¦åŠè¡ŒåŠ¨è®¡åˆ’',
            'description': 'ä¼šè®®æ€»ç»“å’Œåç»­è¡ŒåŠ¨å®‰æ’',
            'sections': ['ä¼šè®®æ¦‚è¦', 'è®¨è®ºè¦ç‚¹', 'å†³ç­–äº‹é¡¹', 'è¡ŒåŠ¨è®¡åˆ’', 'åç»­å®‰æ’']
        },
        'technical_proposal': {
            'name': 'æŠ€æœ¯æ–¹æ¡ˆä¹¦',
            'description': 'è¯¦ç»†çš„æŠ€æœ¯å®ç°æ–¹æ¡ˆ',
            'sections': ['æŠ€æœ¯èƒŒæ™¯', 'æ¶æ„è®¾è®¡', 'æŠ€æœ¯é€‰å‹', 'å®æ–½æ–¹æ¡ˆ', 'é£é™©è¯„ä¼°']
        }
    }
    
    def __init__(self):
        super().__init__()
        self.prompt_manager = PromptManager()
        self.model_interface = ModelInterface()
        self.document_service = DocumentService()
    
    def get_available_templates(self) -> List[str]:
        """è·å–å¯ç”¨çš„æ–¹æ¡ˆæ¨¡æ¿åˆ—è¡¨"""
        # é¢„å®šä¹‰æ¨¡æ¿
        templates = list(self.PROPOSAL_TYPES.keys())
        
        # æ–‡ä»¶ç³»ç»Ÿä¸­çš„è‡ªå®šä¹‰æ¨¡æ¿
        custom_templates = self.prompt_manager.list_templates('proposal')
        
        # åˆå¹¶å¹¶å»é‡
        all_templates = list(set(templates + custom_templates))
        return all_templates
    
    def get_proposal_type_info(self, proposal_type: str) -> Dict:
        """è·å–æ–¹æ¡ˆç±»å‹çš„è¯¦ç»†ä¿¡æ¯"""
        return self.PROPOSAL_TYPES.get(proposal_type, {})
    
    def validate_input(self, input_data: Union[str, Dict]) -> bool:
        """éªŒè¯è¾“å…¥æ•°æ®"""
        if isinstance(input_data, str):
            # æ£€æŸ¥æ˜¯å¦æ˜¯æœ‰æ•ˆçš„åˆ†ææŠ¥å‘Š
            return len(input_data.strip()) > 100
        elif isinstance(input_data, dict):
            # æ£€æŸ¥å¿…è¦å­—æ®µ
            return 'analysis_report' in input_data or 'content' in input_data
        return False
    
    def process(self,
                input_data: Union[str, Dict],
                template: Optional[str] = 'project_proposal',
                options: Optional[Dict] = None) -> ProcessingResult:
        """
        ç”Ÿæˆå•†ä¸šæ–¹æ¡ˆ
        
        Args:
            input_data: åˆ†ææŠ¥å‘Šæˆ–åŒ…å«åˆ†ææŠ¥å‘Šçš„å­—å…¸
            template: æ–¹æ¡ˆæ¨¡æ¿åç§°
            options: ç”Ÿæˆé€‰é¡¹
                - capability_docs: ä¼ä¸šèƒ½åŠ›æ–‡æ¡£åˆ—è¡¨
                - custom_prompt: è‡ªå®šä¹‰æç¤ºè¯
                - include_pricing: æ˜¯å¦åŒ…å«æŠ¥ä»·
                - language: è¯­è¨€ï¼ˆ'zh', 'en'ï¼‰
                - format: è¾“å‡ºæ ¼å¼ï¼ˆ'markdown', 'text'ï¼‰
                - client_info: å®¢æˆ·ä¿¡æ¯
                - progress_callback: è¿›åº¦å›è°ƒå‡½æ•°
        
        Returns:
            ProcessingResult: ç”Ÿæˆçš„æ–¹æ¡ˆ
        """
        start_time = time.time()
        options = options or {}
        progress_callback = options.get('progress_callback')
        
        try:
            # æå–åˆ†ææŠ¥å‘Šå†…å®¹
            if isinstance(input_data, str):
                analysis_report = input_data
                metadata = {}
            else:
                analysis_report = input_data.get('analysis_report') or input_data.get('content', '')
                metadata = input_data.get('metadata', {})
            
            if not self.validate_input(analysis_report):
                raise ValueError("åˆ†ææŠ¥å‘Šå†…å®¹å¤ªçŸ­æˆ–æ ¼å¼ä¸æ­£ç¡®")
            
            if progress_callback:
                progress_callback("æ­£åœ¨å‡†å¤‡ç”Ÿæˆæ–¹æ¡ˆ...")
            
            # å¤„ç†ä¼ä¸šèƒ½åŠ›æ–‡æ¡£
            capability_content = ""
            if options.get('capability_docs'):
                capability_content = self._process_capability_docs(
                    options['capability_docs'],
                    progress_callback
                )
            
            # è·å–ç”Ÿæˆæç¤ºè¯
            if options.get('custom_prompt'):
                # ä½¿ç”¨è‡ªå®šä¹‰æç¤ºè¯
                generation_prompt = options['custom_prompt']
                # æ›¿æ¢å˜é‡
                generation_prompt = generation_prompt.replace('{analysis_report}', analysis_report)
                if capability_content:
                    generation_prompt = generation_prompt.replace('{capability_docs}', capability_content)
            else:
                # ä½¿ç”¨æ¨¡æ¿
                try:
                    # å‡†å¤‡æ¨¡æ¿å˜é‡
                    template_vars = {
                        'analysis_report': analysis_report,
                        'capability_docs': capability_content,
                        'proposal_type_info': self.get_proposal_type_info(template),
                        'client_info': options.get('client_info', {}),
                        'include_pricing': options.get('include_pricing', False),
                        'language': options.get('language', 'zh')
                    }
                    
                    generation_prompt = self.prompt_manager.get_template(
                        'proposal',
                        template,
                        variables=template_vars
                    )
                except Exception as e:
                    # å¦‚æœæ¨¡æ¿ä¸å­˜åœ¨ï¼Œä½¿ç”¨é»˜è®¤æ¨¡æ¿
                    print(f"æ¨¡æ¿ {template} åŠ è½½å¤±è´¥ï¼Œä½¿ç”¨é»˜è®¤æ¨¡æ¿: {e}")
                    generation_prompt = self._get_default_prompt(
                        analysis_report,
                        template,
                        capability_content,
                        options
                    )
            
            if progress_callback:
                progress_callback("æ­£åœ¨è°ƒç”¨ AI æ¨¡å‹ç”Ÿæˆæ–¹æ¡ˆ...")
            
            # è°ƒç”¨æ¨¡å‹ç”Ÿæˆæ–¹æ¡ˆ
            response, stats = self.model_interface.generate_content(
                generation_prompt,
                model_type='proposal',
                generation_config={
                    'temperature': 0.7,
                    'top_p': 0.95,
                    'max_output_tokens': 16384
                },
                request_options={"timeout": 1200}  # 20åˆ†é’Ÿè¶…æ—¶
            )
            
            # å¤„ç†è¾“å‡ºæ ¼å¼
            proposal_content = self._format_proposal(
                response,
                template,
                options.get('format', 'markdown')
            )
            
            # æ·»åŠ ç‰ˆæƒå’Œç”Ÿæˆä¿¡æ¯
            proposal_content = self._add_footer(proposal_content, template)
            
            if progress_callback:
                progress_callback(f"æ–¹æ¡ˆç”Ÿæˆå®Œæˆï¼Œè€—æ—¶ {time.time() - start_time:.1f} ç§’")
            
            # æ„å»ºå®Œæ•´çš„å…ƒæ•°æ®
            result_metadata = {
                'proposal_type': template,
                'proposal_name': self.PROPOSAL_TYPES.get(template, {}).get('name', template),
                'timestamp': datetime.now().strftime('%Y-%m-%d %H:%M:%S'),
                'has_capability_docs': bool(capability_content),
                'output_format': options.get('format', 'markdown'),
                'generation_time': time.time() - start_time,
                **metadata  # ä¿ç•™åŸå§‹å…ƒæ•°æ®
            }
            
            # æ·»åŠ ç»Ÿè®¡ä¿¡æ¯
            result_metadata.update({
                'input_tokens': stats.get('input_tokens', 0),
                'output_tokens': stats.get('output_tokens', 0),
                'total_tokens': stats.get('total_tokens', 0),
                'model_used': stats.get('model_used', ''),
                'estimated_cost': stats.get('estimated_cost', 0)
            })
            
            # æ·»åŠ å†…å®¹ç»Ÿè®¡
            result_metadata.update(self._analyze_proposal(proposal_content))
            
            processing_time = time.time() - start_time
            
            return ProcessingResult(
                content=proposal_content,
                metadata=result_metadata,
                source_type='proposal',
                processing_time=processing_time,
                model_used=stats.get('model_used', ''),
                tokens_consumed={
                    'input': stats.get('input_tokens', 0),
                    'output': stats.get('output_tokens', 0),
                    'total': stats.get('total_tokens', 0)
                }
            )
            
        except Exception as e:
            if progress_callback:
                progress_callback(f"æ–¹æ¡ˆç”Ÿæˆå¤±è´¥ï¼š{e}")
            
            processing_time = time.time() - start_time
            
            return ProcessingResult(
                content='',
                metadata={
                    'error': str(e),
                    'proposal_type': template,
                    'timestamp': datetime.now().strftime('%Y-%m-%d %H:%M:%S')
                },
                source_type='proposal',
                processing_time=processing_time,
                model_used='',
                tokens_consumed={},
                error=str(e)
            )
    
    def _process_capability_docs(self, 
                               doc_paths: List[Union[str, Path]], 
                               progress_callback=None) -> str:
        """å¤„ç†ä¼ä¸šèƒ½åŠ›æ–‡æ¡£"""
        capability_parts = []
        
        for i, doc_path in enumerate(doc_paths):
            if progress_callback:
                progress_callback(f"æ­£åœ¨å¤„ç†èƒ½åŠ›æ–‡æ¡£ {i + 1}/{len(doc_paths)}")
            
            # ä½¿ç”¨æ–‡æ¡£æœåŠ¡å¤„ç†æ–‡æ¡£
            result = self.document_service.process(doc_path)
            
            if result.is_success:
                doc_name = Path(doc_path).name
                capability_parts.append(f"## æ–‡æ¡£ï¼š{doc_name}\n\n{result.content}")
            else:
                print(f"å¤„ç†èƒ½åŠ›æ–‡æ¡£å¤±è´¥ {doc_path}: {result.error}")
        
        if capability_parts:
            return "\n\n---\n\n".join(capability_parts)
        
        return ""
    
    def _get_default_prompt(self, 
                          analysis_report: str, 
                          template: str,
                          capability_content: str,
                          options: Dict) -> str:
        """è·å–é»˜è®¤çš„æ–¹æ¡ˆç”Ÿæˆæç¤ºè¯"""
        proposal_info = self.get_proposal_type_info(template)
        proposal_name = proposal_info.get('name', 'å•†ä¸šæ–¹æ¡ˆ')
        sections = proposal_info.get('sections', [])
        
        # æ„å»ºèƒ½åŠ›æ–‡æ¡£éƒ¨åˆ†
        capability_section = ""
        if capability_content:
            capability_section = f"""
## ä¸‰ã€ä¼ä¸šèƒ½åŠ›å‚è€ƒ

è¯·å‚è€ƒä»¥ä¸‹ä¼ä¸šèƒ½åŠ›ä¿¡æ¯ï¼Œåœ¨æ–¹æ¡ˆä¸­é€‚å½“å¼•ç”¨å’Œä½“ç°æˆ‘ä»¬çš„ä¼˜åŠ¿ï¼š

{capability_content}
"""
        
        return f"""# {proposal_name}ç”Ÿæˆä»»åŠ¡

## ä¸€ã€è§’è‰²å®šä½
ä½ æ˜¯ä¸€ä½èµ„æ·±çš„å•†ä¸šæ–¹æ¡ˆæ’°å†™ä¸“å®¶ï¼Œæ‹¥æœ‰15å¹´çš„æ–¹æ¡ˆç­–åˆ’ç»éªŒï¼Œæ“…é•¿å°†å¤æ‚çš„æŠ€æœ¯å’Œä¸šåŠ¡éœ€æ±‚è½¬åŒ–ä¸ºæ¸…æ™°ã€æœ‰è¯´æœåŠ›çš„å•†ä¸šæ–‡æ¡£ã€‚

## äºŒã€ä»»åŠ¡è¯´æ˜
åŸºäºä»¥ä¸‹åˆ†ææŠ¥å‘Šï¼Œç”Ÿæˆä¸€ä»½ä¸“ä¸šçš„{proposal_name}ã€‚

### åˆ†ææŠ¥å‘Šï¼š
{analysis_report}

{capability_section}

## å››ã€æ–¹æ¡ˆç»“æ„è¦æ±‚

è¯·æŒ‰ç…§ä»¥ä¸‹ç»“æ„ç”Ÿæˆæ–¹æ¡ˆï¼š
{chr(10).join(f'{i+1}. {section}' for i, section in enumerate(sections))}

## äº”ã€å†™ä½œè¦æ±‚

1. **ä¸“ä¸šæ€§**ï¼šä½¿ç”¨ä¸“ä¸šçš„å•†ä¸šè¯­è¨€ï¼Œé€»è¾‘æ¸…æ™°ï¼Œè®ºè¿°ä¸¥è°¨
2. **é’ˆå¯¹æ€§**ï¼šç´§å¯†ç»“åˆå®¢æˆ·éœ€æ±‚ï¼Œæä¾›å®šåˆ¶åŒ–çš„è§£å†³æ–¹æ¡ˆ
3. **å¯è¯»æ€§**ï¼šç»“æ„æ¸…æ™°ï¼Œé‡ç‚¹çªå‡ºï¼Œä¾¿äºå¿«é€Ÿç†è§£
4. **è¯´æœåŠ›**ï¼šçªå‡ºä»·å€¼ä¸»å¼ ï¼Œç”¨æ•°æ®å’Œæ¡ˆä¾‹æ”¯æ’‘è§‚ç‚¹
5. **å®Œæ•´æ€§**ï¼šæ¶µç›–æ‰€æœ‰å¿…è¦çš„å•†ä¸šè¦ç´ ï¼Œå½¢æˆå®Œæ•´çš„æ–¹æ¡ˆä½“ç³»

## å…­ã€æ ¼å¼è¦æ±‚

- ä½¿ç”¨Markdownæ ¼å¼
- æ ‡é¢˜å±‚çº§æ¸…æ™°ï¼ˆæœ€å¤šä½¿ç”¨ä¸‰çº§æ ‡é¢˜ï¼‰
- é‡è¦å†…å®¹ä½¿ç”¨åŠ ç²—æˆ–åˆ—è¡¨çªå‡º
- æ•°æ®ä½¿ç”¨è¡¨æ ¼å±•ç¤º
- ä¿æŒä¸“ä¸šçš„ç‰ˆå¼é£æ ¼

è¯·å¼€å§‹ç”Ÿæˆ{proposal_name}ï¼š"""
    
    def _format_proposal(self, raw_content: str, template: str, output_format: str) -> str:
        """æ ¼å¼åŒ–æ–¹æ¡ˆå†…å®¹"""
        if output_format == 'markdown':
            # ç¡®ä¿æ˜¯è§„èŒƒçš„Markdownæ ¼å¼
            if not raw_content.startswith('#'):
                proposal_name = self.PROPOSAL_TYPES.get(template, {}).get('name', 'å•†ä¸šæ–¹æ¡ˆ')
                raw_content = f"# {proposal_name}\n\n{raw_content}"
            
            # æ¸…ç†å¤šä½™çš„ç©ºè¡Œ
            lines = raw_content.split('\n')
            formatted_lines = []
            empty_count = 0
            
            for line in lines:
                if line.strip() == '':
                    empty_count += 1
                    if empty_count <= 2:  # æœ€å¤šä¿ç•™ä¸¤ä¸ªè¿ç»­ç©ºè¡Œ
                        formatted_lines.append(line)
                else:
                    empty_count = 0
                    formatted_lines.append(line)
            
            return '\n'.join(formatted_lines)
            
        elif output_format == 'text':
            # è½¬æ¢ä¸ºçº¯æ–‡æœ¬æ ¼å¼
            # ç§»é™¤Markdownæ ‡è®°
            text = raw_content
            # ç§»é™¤æ ‡é¢˜æ ‡è®°
            text = re.sub(r'^#{1,6}\s+', '', text, flags=re.MULTILINE)
            # ç§»é™¤åŠ ç²—
            text = re.sub(r'\*\*([^\*]+)\*\*', r'\1', text)
            # ç§»é™¤å…¶ä»–Markdownå…ƒç´ 
            text = re.sub(r'\[([^\]]+)\]\([^\)]+\)', r'\1', text)
            
            return text
        
        return raw_content
    
    def _add_footer(self, content: str, template: str) -> str:
        """æ·»åŠ é¡µè„šä¿¡æ¯"""
        footer = f"""

---

*æœ¬æ–¹æ¡ˆç”± SmartProposal Engine è‡ªåŠ¨ç”Ÿæˆ*  
*ç”Ÿæˆæ—¶é—´ï¼š{datetime.now().strftime('%Yå¹´%mæœˆ%dæ—¥ %H:%M')}*  
*æ–¹æ¡ˆç±»å‹ï¼š{self.PROPOSAL_TYPES.get(template, {}).get('name', template)}*  
*ç‰ˆæƒæ‰€æœ‰ Â© 2025 SmartProposal Team*
"""
        return content + footer
    
    def _analyze_proposal(self, content: str) -> Dict[str, Any]:
        """åˆ†ææ–¹æ¡ˆå†…å®¹ï¼Œæå–ç»Ÿè®¡ä¿¡æ¯"""
        # å­—æ•°ç»Ÿè®¡
        word_count = len(content.split())
        char_count = len(content)
        
        # æ®µè½å’Œç« èŠ‚ç»Ÿè®¡
        lines = content.split('\n')
        section_count = sum(1 for line in lines if line.strip().startswith('#'))
        paragraph_count = len([p for p in content.split('\n\n') if p.strip()])
        
        # ç‰¹æ®Šå…ƒç´ ç»Ÿè®¡
        table_count = content.count('|---')  # ç®€å•çš„è¡¨æ ¼æ£€æµ‹
        list_count = sum(1 for line in lines if line.strip().startswith(('- ', '* ', '1. ')))
        
        # é¢„ä¼°é˜…è¯»æ—¶é—´ï¼ˆå‡è®¾æ¯åˆ†é’Ÿé˜…è¯»200ä¸ªä¸­æ–‡å­—ï¼‰
        estimated_reading_time = max(1, char_count // 400)
        
        return {
            'word_count': word_count,
            'character_count': char_count,
            'section_count': section_count,
            'paragraph_count': paragraph_count,
            'table_count': table_count,
            'list_count': list_count,
            'estimated_reading_time_minutes': estimated_reading_time
        }
    
    def generate_proposal(self,
                         analysis_report: str,
                         proposal_type: str = 'project_proposal',
                         capability_docs: Optional[List[str]] = None,
                         progress_callback=None) -> Tuple[str, Dict[str, Any]]:
        """
        ç”Ÿæˆæ–¹æ¡ˆï¼ˆå…¼å®¹æ—§æ¥å£ï¼‰
        
        Args:
            analysis_report: åˆ†ææŠ¥å‘Š
            proposal_type: æ–¹æ¡ˆç±»å‹
            capability_docs: èƒ½åŠ›æ–‡æ¡£åˆ—è¡¨
            progress_callback: è¿›åº¦å›è°ƒ
        
        Returns:
            (proposal_content, stats): æ–¹æ¡ˆå†…å®¹å’Œç»Ÿè®¡ä¿¡æ¯
        """
        result = self.process(
            analysis_report,
            template=proposal_type,
            options={
                'capability_docs': capability_docs,
                'progress_callback': progress_callback
            }
        )
        
        if result.error:
            return f"æ–¹æ¡ˆç”Ÿæˆå¤±è´¥ï¼š{result.error}", {
                'error': result.error,
                'generation_time': result.processing_time
            }
        
        stats = {
            'generation_time': result.processing_time,
            'input_tokens': result.tokens_consumed.get('input', 0),
            'output_tokens': result.tokens_consumed.get('output', 0),
            'model_used': result.model_used,
            'proposal_type': result.metadata.get('proposal_type', ''),
            'word_count': result.metadata.get('word_count', 0)
        }
        
        return result.content, stats
    
    def merge_capability_docs(self, doc_paths: List[Union[str, Path]]) -> str:
        """
        åˆå¹¶ä¼ä¸šèƒ½åŠ›æ–‡æ¡£
        
        Args:
            doc_paths: æ–‡æ¡£è·¯å¾„åˆ—è¡¨
        
        Returns:
            str: åˆå¹¶åçš„å†…å®¹
        """
        return self._process_capability_docs(doc_paths)
    
    def customize_proposal(self,
                         base_proposal: str,
                         customization_options: Dict[str, Any]) -> str:
        """
        å®šåˆ¶åŒ–æ–¹æ¡ˆ
        
        Args:
            base_proposal: åŸºç¡€æ–¹æ¡ˆ
            customization_options: å®šåˆ¶é€‰é¡¹
                - client_name: å®¢æˆ·åç§°
                - project_name: é¡¹ç›®åç§°
                - special_requirements: ç‰¹æ®Šè¦æ±‚
                - pricing_info: æŠ¥ä»·ä¿¡æ¯
        
        Returns:
            str: å®šåˆ¶åŒ–åçš„æ–¹æ¡ˆ
        """
        customized = base_proposal
        
        # æ›¿æ¢å®¢æˆ·åç§°
        if 'client_name' in customization_options:
            customized = customized.replace(
                '[å®¢æˆ·åç§°]', 
                customization_options['client_name']
            )
            customized = customized.replace(
                '[CLIENT_NAME]', 
                customization_options['client_name']
            )
        
        # æ›¿æ¢é¡¹ç›®åç§°
        if 'project_name' in customization_options:
            customized = customized.replace(
                '[é¡¹ç›®åç§°]',
                customization_options['project_name']
            )
        
        # æ·»åŠ ç‰¹æ®Šè¦æ±‚
        if 'special_requirements' in customization_options:
            requirements = customization_options['special_requirements']
            if isinstance(requirements, list):
                requirements_text = '\n'.join(f"- {req}" for req in requirements)
                customized = customized.replace(
                    '[ç‰¹æ®Šè¦æ±‚]',
                    requirements_text
                )
        
        # æ·»åŠ æŠ¥ä»·ä¿¡æ¯
        if 'pricing_info' in customization_options:
            pricing = customization_options['pricing_info']
            if isinstance(pricing, dict):
                total_price = pricing.get('total', 0)
                currency = pricing.get('currency', 'Â¥')
                customized = customized.replace(
                    '[æ€»ä»·]',
                    format_money(total_price, currency)
                )
        
        return customized
    
    def export_proposal(self,
                       proposal_content: str,
                       export_format: str = 'markdown',
                       file_path: Optional[Union[str, Path]] = None) -> str:
        """
        å¯¼å‡ºæ–¹æ¡ˆåˆ°æ–‡ä»¶
        
        Args:
            proposal_content: æ–¹æ¡ˆå†…å®¹
            export_format: å¯¼å‡ºæ ¼å¼ ('markdown', 'txt', 'json')
            file_path: æ–‡ä»¶è·¯å¾„ï¼ˆå¦‚æœä¸ºNoneåˆ™è‡ªåŠ¨ç”Ÿæˆï¼‰
        
        Returns:
            str: å¯¼å‡ºçš„æ–‡ä»¶è·¯å¾„
        """
        if file_path is None:
            timestamp = datetime.now().strftime('%Y%m%d_%H%M%S')
            file_name = f"proposal_{timestamp}.{export_format}"
            file_path = os.path.join('output', file_name)
        
        file_path = Path(file_path)
        file_path.parent.mkdir(parents=True, exist_ok=True)
        
        if export_format == 'json':
            # å¯¼å‡ºä¸ºJSONæ ¼å¼ï¼ˆåŒ…å«å…ƒæ•°æ®ï¼‰
            export_data = {
                'content': proposal_content,
                'metadata': {
                    'exported_at': datetime.now().isoformat(),
                    'format': export_format,
                    'engine': 'SmartProposal Engine',
                    'version': '1.0.0'
                }
            }
            with open(file_path, 'w', encoding='utf-8') as f:
                json.dump(export_data, f, ensure_ascii=False, indent=2)
        else:
            # å¯¼å‡ºä¸ºæ–‡æœ¬æ ¼å¼
            with open(file_path, 'w', encoding='utf-8') as f:
                f.write(proposal_content)
        
        return str(file_path)
    
    def get_proposal_outline(self, proposal_type: str) -> List[Dict[str, Any]]:
        """
        è·å–æ–¹æ¡ˆå¤§çº²
        
        Args:
            proposal_type: æ–¹æ¡ˆç±»å‹
        
        Returns:
            List[Dict]: å¤§çº²ç»“æ„
        """
        proposal_info = self.get_proposal_type_info(proposal_type)
        sections = proposal_info.get('sections', [])
        
        outline = []
        for i, section in enumerate(sections):
            outline.append({
                'level': 1,
                'title': section,
                'number': f"{i + 1}",
                'description': self._get_section_description(proposal_type, section)
            })
        
        return outline
    
    def _get_section_description(self, proposal_type: str, section: str) -> str:
        """è·å–ç« èŠ‚æè¿°"""
        # è¿™é‡Œå¯ä»¥æ‰©å±•ä¸ºä»é…ç½®æˆ–æ¨¡æ¿ä¸­è¯»å–è¯¦ç»†æè¿°
        descriptions = {
            'æ‰§è¡Œæ‘˜è¦': 'é¡¹ç›®çš„æ ¸å¿ƒä»·å€¼å’Œå…³é”®è¦ç‚¹æ¦‚è¿°',
            'éœ€æ±‚åˆ†æ': 'æ·±å…¥ç†è§£å®¢æˆ·éœ€æ±‚å’Œä¸šåŠ¡æŒ‘æˆ˜',
            'è§£å†³æ–¹æ¡ˆ': 'é’ˆå¯¹æ€§çš„æŠ€æœ¯å’Œä¸šåŠ¡è§£å†³æ–¹æ¡ˆ',
            'å®æ–½è®¡åˆ’': 'è¯¦ç»†çš„é¡¹ç›®å®æ–½æ­¥éª¤å’Œæ—¶é—´å®‰æ’',
            'æŠ•èµ„å›æŠ¥': 'é¡¹ç›®çš„æˆæœ¬æ•ˆç›Šåˆ†æå’ŒROIè®¡ç®—',
            'å›¢é˜Ÿä»‹ç»': 'é¡¹ç›®å›¢é˜Ÿçš„ä¸“ä¸šèƒŒæ™¯å’ŒæˆåŠŸç»éªŒ',
            'å•†åŠ¡æ¡æ¬¾': 'åˆä½œæ¡æ¬¾ã€ä»˜æ¬¾æ–¹å¼å’ŒæœåŠ¡æ‰¿è¯º'
        }
        
        return descriptions.get(section, f'{section}çš„è¯¦ç»†å†…å®¹')

--- File: services/transcription_service.py ---
# ==============================================================================
# File: services/transcription_service.py (ä¿®æ”¹å)
# ==============================================================================
# !/usr/bin/env python
# -*- coding: utf-8 -*-
"""
æ–‡ä»¶è·¯å¾„: smart_proposal_engine/services/transcription_service.py
åŠŸèƒ½è¯´æ˜: éŸ³é¢‘è½¬å½•æœåŠ¡æ¨¡å—ï¼Œè´Ÿè´£å¤„ç†éŸ³é¢‘æ–‡ä»¶çš„è½¬å½•å’Œä¼˜åŒ–
ä½œè€…: SmartProposal Team
åˆ›å»ºæ—¥æœŸ: 2025-06-27
æœ€åä¿®æ”¹: 2025-06-29
ç‰ˆæœ¬: 1.1.0
"""

import os
import sys
import time
import re
import shutil
import tempfile
from datetime import datetime
from typing import Dict, List, Optional, Tuple, Union, Literal
from dataclasses import dataclass
from pathlib import Path

# æ·»åŠ é¡¹ç›®æ ¹ç›®å½•åˆ°ç³»ç»Ÿè·¯å¾„
sys.path.insert(0, os.path.dirname(os.path.dirname(os.path.abspath(__file__))))

from services.base_service import BaseService, ProcessingResult
from core.prompt_manager import PromptManager
from core.model_interface import ModelInterface
from utils.file_utils import format_file_size, get_audio_duration
from utils.format_utils import format_duration


@dataclass
class TranscriptionSegment:
    """è½¬å½•ç‰‡æ®µæ•°æ®ç»“æ„"""
    segment_index: int
    start_time: float
    end_time: float
    text: str
    speakers: List[str]
    segment_id: str = ""


@dataclass
class SpeakerMapping:
    """è¯´è¯äººæ˜ å°„æ•°æ®ç»“æ„"""
    segment_speaker: str
    global_speaker: str
    characteristics: str


class TextOptimizer:
    """æ–‡æœ¬ä¼˜åŒ–å™¨ï¼Œä½¿ç”¨Geminiè¿›è¡Œè½¬å½•æ–‡æœ¬çš„æ ¡æ­£å’Œä¼˜åŒ–"""

    def __init__(self, model_interface: ModelInterface, prompt_manager: PromptManager):
        self.model_interface = model_interface
        self.prompt_manager = prompt_manager

    def optimize_transcript(self, original_text: str, progress_callback=None) -> Tuple[str, Dict[str, any]]:
        """ä¼˜åŒ–è½¬å½•æ–‡æœ¬"""
        start_time = time.time()

        if progress_callback:
            progress_callback("æ­£åœ¨è°ƒç”¨AIè¿›è¡Œæ–‡æœ¬ä¼˜åŒ–...")

        try:
            # è·å–ä¼˜åŒ–æ¨¡æ¿
            optimization_prompt = self.prompt_manager.get_template(
                'transcription',
                'optimization',
                variables={'transcript': original_text}
            )

            # è°ƒç”¨æ¨¡å‹
            response, stats = self.model_interface.generate_content(
                optimization_prompt,
                model_type='optimization'
            )

            stats['optimization_time'] = time.time() - start_time

            # è§£æä¼˜åŒ–ç»“æœ
            full_response = response
            if "ç¬¬äºŒéƒ¨åˆ†ï¼šä¼˜åŒ–åè½¬å½•æ–‡æœ¬" in full_response:
                parts = full_response.split("ç¬¬äºŒéƒ¨åˆ†ï¼šä¼˜åŒ–åè½¬å½•æ–‡æœ¬")
                if len(parts) > 1:
                    optimized_text = parts[1].strip()
                    optimized_text = optimized_text.replace("```", "").strip()
                else:
                    optimized_text = full_response
            else:
                optimized_text = full_response

            if progress_callback:
                progress_callback(f"æ–‡æœ¬ä¼˜åŒ–å®Œæˆï¼Œè€—æ—¶ {stats['optimization_time']:.1f} ç§’")

            return optimized_text, stats

        except Exception as e:
            if progress_callback:
                progress_callback(f"æ–‡æœ¬ä¼˜åŒ–å¤±è´¥ï¼š{e}")
            return original_text, {'error': str(e), 'optimization_time': time.time() - start_time}


class AudioProcessor:
    """éŸ³é¢‘å¤„ç†ç±»ï¼Œè´Ÿè´£éŸ³é¢‘æ–‡ä»¶çš„åˆ†å‰²å’Œé¢„å¤„ç†"""

    def __init__(self, temp_folder: str):
        self.temp_folder = temp_folder
        self.pydub_available = self._check_pydub_availability()
        self.silence_threshold = -35
        self.min_silence_length = 800

    def _check_pydub_availability(self) -> bool:
        """æ£€æŸ¥æ˜¯å¦å®‰è£…äº† pydub åº“"""
        try:
            import pydub
            return True
        except ImportError:
            print("æ³¨æ„ï¼šæœªå®‰è£… pydub åº“ï¼Œæ— æ³•è¿›è¡ŒéŸ³é¢‘åˆ†å‰²ã€‚")
            print("å¦‚éœ€å¤„ç†è¶…é•¿éŸ³é¢‘ï¼Œè¯·è¿è¡Œï¼špip install pydub")
            return False

    def get_audio_duration(self, file_path: str) -> Optional[float]:
        """è·å–éŸ³é¢‘æ–‡ä»¶æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰"""
        if not self.pydub_available:
            return None
        try:
            from pydub import AudioSegment
            audio = AudioSegment.from_file(file_path)
            duration_minutes = len(audio) / (1000 * 60)
            return duration_minutes
        except Exception as e:
            print(f"æ— æ³•è·å–éŸ³é¢‘æ—¶é•¿ï¼š{e}")
            return None

    def get_audio_duration_seconds(self, file_path: str) -> Optional[float]:
        """è·å–éŸ³é¢‘æ–‡ä»¶æ—¶é•¿ï¼ˆç§’ï¼‰"""
        if not self.pydub_available:
            return None
        try:
            from pydub import AudioSegment
            audio = AudioSegment.from_file(file_path)
            duration_seconds = len(audio) / 1000.0
            return duration_seconds
        except Exception as e:
            print(f"æ— æ³•è·å–éŸ³é¢‘æ—¶é•¿ï¼š{e}")
            return None

    def split_audio(self, file_path: str, max_duration_minutes: int) -> List[Tuple[str, float, float]]:
        """å°†éŸ³é¢‘æ–‡ä»¶æŒ‰åˆ†é’Ÿåˆ†å‰²æˆå¤šä¸ªç‰‡æ®µ"""
        if not self.pydub_available:
            return [(file_path, 0, 0)]
        try:
            from pydub import AudioSegment
            from pydub.silence import detect_silence

            print(f"æ­£åœ¨åˆ†æéŸ³é¢‘æ–‡ä»¶...")
            audio = AudioSegment.from_file(file_path)
            total_duration = len(audio)
            max_duration_ms = max_duration_minutes * 60 * 1000
            if total_duration <= max_duration_ms:
                return [(file_path, 0, total_duration / 1000)]

            os.makedirs(self.temp_folder, exist_ok=True)
            print("æ­£åœ¨æ£€æµ‹é™éŸ³ç‰‡æ®µä»¥ä¼˜åŒ–åˆ†å‰²ç‚¹...")
            silence_chunks = detect_silence(audio, min_silence_len=self.min_silence_length,
                                            silence_thresh=self.silence_threshold)
            segments = []
            current_start = 0
            segment_index = 0
            while current_start < total_duration:
                ideal_end = min(current_start + max_duration_ms, total_duration)
                best_split_point = ideal_end
                search_window = 30000
                for silence_start, silence_end in silence_chunks:
                    if ideal_end - search_window <= silence_start <= ideal_end + search_window:
                        best_split_point = silence_start
                        break
                if best_split_point >= total_duration - 5000:
                    best_split_point = total_duration

                segment = audio[current_start:best_split_point]
                segment_filename = f"segment_{segment_index:03d}.m4a"
                segment_path = os.path.join(self.temp_folder, segment_filename)
                print(f"æ­£åœ¨å¯¼å‡ºç‰‡æ®µ {segment_index + 1}: {current_start / 1000:.1f}s - {best_split_point / 1000:.1f}s")
                segment.export(segment_path, format="mp4", codec="aac")
                segments.append((segment_path, current_start / 1000, best_split_point / 1000))
                current_start = best_split_point
                segment_index += 1
            print(f"éŸ³é¢‘åˆ†å‰²å®Œæˆï¼Œå…±ç”Ÿæˆ {len(segments)} ä¸ªç‰‡æ®µ")
            return segments
        except Exception as e:
            print(f"éŸ³é¢‘åˆ†å‰²å¤±è´¥ï¼š{e}")
            return [(file_path, 0, 0)]

    def cleanup_temp_files(self):
        """æ¸…ç†ä¸´æ—¶æ–‡ä»¶"""
        if os.path.exists(self.temp_folder):
            try:
                shutil.rmtree(self.temp_folder)
                print("ä¸´æ—¶æ–‡ä»¶å·²æ¸…ç†")
            except Exception as e:
                print(f"æ¸…ç†ä¸´æ—¶æ–‡ä»¶å¤±è´¥ï¼š{e}")


class SpeakerAnalyzer:
    """è¯´è¯äººåˆ†æå™¨ï¼Œè´Ÿè´£å¤„ç†è¯´è¯äººè¯†åˆ«å’Œä¸€è‡´æ€§ç»´æŠ¤"""

    def __init__(self):
        self.global_speaker_map: Dict[str, str] = {}
        self.speaker_characteristics: Dict[str, List[str]] = {}
        self.next_global_speaker_id = 1

    def extract_speakers(self, text: str) -> List[str]:
        speaker_pattern = r'(è¯´è¯äºº[A-Z]|è¯´è¯äºº\d+|å‘è¨€äºº[A-Z]|å‘è¨€äºº\d+|Speaker [A-Z]|Speaker \d+)(?=[:ï¼š])'
        speakers = list(set(re.findall(speaker_pattern, text)))
        return speakers

    def extract_speaker_characteristics(self, text: str, speaker: str) -> List[str]:
        characteristics = []
        pattern = f'{re.escape(speaker)}[:ï¼š](.*?)(?=(è¯´è¯äºº|å‘è¨€äºº|Speaker|$))'
        matches = re.findall(pattern, text, re.DOTALL)
        if matches:
            combined_text = ' '.join(str(m) for m in matches)
            words = re.findall(r'[\u4e00-\u9fa5]+', combined_text)
            word_freq = {}
            for word in words:
                if len(word) >= 2:
                    word_freq[word] = word_freq.get(word, 0) + 1
            frequent_words = sorted(word_freq.items(), key=lambda x: x[1], reverse=True)[:5]
            if frequent_words:
                characteristics.append(f"å¸¸ç”¨è¯ï¼š{', '.join([w[0] for w in frequent_words])}")
            if 'å—¯' in combined_text or 'å•Š' in combined_text or 'å‘ƒ' in combined_text:
                characteristics.append("æœ‰å£å¤´ç¦…")
            if 'è¯·' in combined_text or 'è°¢è°¢' in combined_text:
                characteristics.append("ç¤¼è²Œç”¨è¯­å¤š")
            if 'æˆ‘è§‰å¾—' in combined_text or 'æˆ‘è®¤ä¸º' in combined_text:
                characteristics.append("ä¸»è§‚è¡¨è¾¾å¤š")
        return characteristics

    def map_speakers_across_segments(self, segments: List[TranscriptionSegment]) -> Dict[str, str]:
        print("\næ­£åœ¨åˆ†æè¯´è¯äººç‰¹å¾ä»¥ä¿æŒä¸€è‡´æ€§...")
        for segment in segments:
            for speaker in segment.speakers:
                characteristics = self.extract_speaker_characteristics(segment.text, speaker)
                best_match = None
                best_score = 0
                for global_speaker, char_list in self.speaker_characteristics.items():
                    score = len(set(characteristics) & set(char_list))
                    if score > best_score:
                        best_score = score
                        best_match = global_speaker
                if best_score >= 2:
                    self.global_speaker_map[f"{segment.segment_index}_{speaker}"] = best_match
                    self.speaker_characteristics[best_match].extend(characteristics)
                    self.speaker_characteristics[best_match] = list(set(self.speaker_characteristics[best_match]))
                else:
                    global_speaker = f"è¯´è¯äºº{self.next_global_speaker_id}"
                    self.next_global_speaker_id += 1
                    self.global_speaker_map[f"{segment.segment_index}_{speaker}"] = global_speaker
                    self.speaker_characteristics[global_speaker] = characteristics
        return self.global_speaker_map

    def apply_speaker_mapping(self, segment: TranscriptionSegment, mapping: Dict[str, str]) -> str:
        text = segment.text
        for speaker in segment.speakers:
            segment_key = f"{segment.segment_index}_{speaker}"
            if segment_key in mapping:
                global_speaker = mapping[segment_key]
                text = text.replace(f"{speaker}:", f"{global_speaker}:")
                text = text.replace(f"{speaker}ï¼š", f"{global_speaker}ï¼š")
        return text


class TranscriptionService(BaseService):
    """
    éŸ³é¢‘è½¬å½•æœåŠ¡
    """

    def __init__(self):
        super().__init__()
        self.audio_processor = None
        self.text_optimizer = None
        self.speaker_analyzer = None
        self.prompt_manager = PromptManager()
        self.model_interface = ModelInterface()
        self.temp_folder = "temp_segments"
        self.max_retries = 3
        self.delete_uploaded_files = True

    def get_available_templates(self) -> List[str]:
        return self.prompt_manager.list_templates('transcription')

    def validate_input(self, input_data: Union[str, bytes, Path]) -> bool:
        if isinstance(input_data, str):
            supported_formats = ['.m4a', '.mp3', '.wav', '.aac', '.ogg', '.flac', '.mp4']
            return any(input_data.lower().endswith(fmt) for fmt in supported_formats)
        return True

    def process(self,
                input_data: Union[str, bytes, Path],
                template: Optional[str] = None,
                options: Optional[Dict] = None) -> ProcessingResult:
        start_time = time.time()
        options = options or {}
        enable_speaker_diarization = options.get('enable_speaker_diarization', True)
        maintain_speaker_consistency = options.get('maintain_speaker_consistency', True)
        max_segment_duration_minutes = options.get('max_segment_duration_minutes', 20)
        enable_text_optimization = options.get('enable_text_optimization', False)
        mode = options.get('mode', 'standard')
        progress_callback = options.get('progress_callback', None)

        try:
            if isinstance(input_data, (bytes, str)) and not os.path.exists(str(input_data)):
                with tempfile.NamedTemporaryFile(delete=False, suffix='.m4a') as tmp_file:
                    if isinstance(input_data, bytes):
                        tmp_file.write(input_data)
                    file_path = tmp_file.name
            else:
                file_path = str(input_data)

            self.audio_processor = AudioProcessor(self.temp_folder)
            if enable_text_optimization: self.text_optimizer = TextOptimizer(self.model_interface, self.prompt_manager)
            if enable_speaker_diarization and maintain_speaker_consistency: self.speaker_analyzer = SpeakerAnalyzer()

            file_size = os.path.getsize(file_path)
            duration_minutes = self.audio_processor.get_audio_duration(file_path)
            duration_seconds = duration_minutes * 60 if duration_minutes else None

            transcribed_text, metadata = self._transcribe_audio(file_path, duration_minutes, enable_speaker_diarization,
                                                                maintain_speaker_consistency,
                                                                max_segment_duration_minutes, enable_text_optimization,
                                                                progress_callback)

            metadata.update({'original_file': os.path.basename(file_path), 'file_size': format_file_size(file_size),
                             'duration': format_duration(duration_seconds) if duration_seconds else 'æœªçŸ¥',
                             'processing_mode': mode, 'enable_text_optimization': enable_text_optimization})

            if transcribed_text and enable_speaker_diarization:
                speakers = self.speaker_analyzer.extract_speakers(transcribed_text) if self.speaker_analyzer else []
                metadata['speakers_count'] = len(speakers);
                metadata['speakers'] = sorted(speakers)

            processing_time = time.time() - start_time
            return ProcessingResult(content=transcribed_text, metadata=metadata, source_type='audio',
                                    processing_time=processing_time, model_used=metadata.get('model_used', ''),
                                    tokens_consumed={'input': metadata.get('input_tokens', 0),
                                                     'output': metadata.get('output_tokens', 0),
                                                     'total': metadata.get('total_tokens', 0)})
        except Exception as e:
            return ProcessingResult(content='', metadata={'error': str(e)}, source_type='audio',
                                    processing_time=time.time() - start_time, model_used='', tokens_consumed={},
                                    error=str(e))
        finally:
            if self.audio_processor: self.audio_processor.cleanup_temp_files()

    def _transcribe_audio(self,
                          file_path: str,
                          duration_minutes: Optional[float],
                          enable_speaker_diarization: bool,
                          maintain_speaker_consistency: bool,
                          max_segment_duration_minutes: int,
                          enable_text_optimization: bool,
                          progress_callback) -> Tuple[str, Dict]:
        total_input_tokens = 0
        total_output_tokens = 0
        model_used = self.model_interface.get_model_name('transcription')

        if duration_minutes and duration_minutes > max_segment_duration_minutes:
            if progress_callback: progress_callback(
                f"æ£€æµ‹åˆ°é•¿éŸ³é¢‘æ–‡ä»¶ï¼ˆ{format_duration(duration_minutes * 60)}ï¼‰ï¼Œå°†è¿›è¡Œåˆ†æ®µå¤„ç†...")
            segments_info = self.audio_processor.split_audio(file_path, max_segment_duration_minutes)
            if len(segments_info) == 1:
                transcribed_text, tokens = self._transcribe_single_segment(segments_info[0][0],
                                                                           enable_speaker_diarization,
                                                                           progress_callback)
                total_input_tokens += tokens['input']
                total_output_tokens += tokens['output']
            else:
                transcription_segments = []
                for i, (segment_path, start_time, end_time) in enumerate(segments_info):
                    if progress_callback: progress_callback(f"æ­£åœ¨å¤„ç†ç‰‡æ®µ {i + 1}/{len(segments_info)}...")
                    segment_text, tokens = self._transcribe_single_segment(segment_path, enable_speaker_diarization,
                                                                           progress_callback)
                    total_input_tokens += tokens['input']
                    total_output_tokens += tokens['output']
                    if segment_text:
                        segment = TranscriptionSegment(i, start_time, end_time, segment_text,
                                                       self.speaker_analyzer.extract_speakers(
                                                           segment_text) if self.speaker_analyzer else [],
                                                       f"seg{i:03d}")
                        transcription_segments.append(segment)
                    if i < len(segments_info) - 1: time.sleep(3)
                speaker_mapping = self.speaker_analyzer.map_speakers_across_segments(
                    transcription_segments) if maintain_speaker_consistency and self.speaker_analyzer and transcription_segments else {}
                transcribed_text = self._merge_segments(transcription_segments, speaker_mapping, duration_minutes)
        else:
            transcribed_text, tokens = self._transcribe_single_segment(file_path, enable_speaker_diarization,
                                                                       progress_callback)
            total_input_tokens += tokens['input']
            total_output_tokens += tokens['output']

        original_text = transcribed_text
        if enable_text_optimization and self.text_optimizer and transcribed_text:
            optimized_text, opt_stats = self.text_optimizer.optimize_transcript(transcribed_text, progress_callback)
            if not opt_stats.get('error'):
                transcribed_text = optimized_text
                total_input_tokens += opt_stats.get('input_tokens', 0)
                total_output_tokens += opt_stats.get('output_tokens', 0)

        metadata = {
            'model_used': model_used,
            'input_tokens': total_input_tokens,
            'output_tokens': total_output_tokens,
            'total_tokens': total_input_tokens + total_output_tokens,
            'timestamp': datetime.now().strftime('%Y-%m-%d %H:%M:%S')
        }
        if enable_text_optimization:
            metadata['original_text'] = original_text
            metadata['optimized_text'] = transcribed_text

        metadata['estimated_cost'] = self.model_interface.calculate_cost(total_input_tokens, total_output_tokens,
                                                                         'transcription')
        return transcribed_text, metadata

    def _transcribe_single_segment(self,
                                   file_path: str,
                                   enable_speaker_diarization: bool,
                                   progress_callback,
                                   retry_count: int = 0) -> Tuple[str, Dict[str, int]]:
        uploaded_file_obj = None
        try:
            if progress_callback:
                progress_callback("æ­£åœ¨ä¸Šä¼ æ–‡ä»¶...")

            if not self.model_interface.provider_client:
                raise RuntimeError("æ¨¡å‹æ¥å£æœªæ­£ç¡®åˆå§‹åŒ–ï¼Œæ— æ³•æ‰¾åˆ°provider clientã€‚")

            provider_client = self.model_interface.provider_client
            uploaded_file_obj = provider_client.upload_file(file_path)

            while provider_client.get_file_state(uploaded_file_obj) == "PROCESSING":
                time.sleep(10)

            if provider_client.get_file_state(uploaded_file_obj) == "FAILED":
                raise Exception(f"æ–‡ä»¶å¤„ç†å¤±è´¥: {uploaded_file_obj}")

            prompt_name = 'multi_speaker' if enable_speaker_diarization else 'single_speaker'
            prompt = self.prompt_manager.get_template('transcription', prompt_name)

            if progress_callback:
                progress_callback("æ­£åœ¨è°ƒç”¨æ¨¡å‹è¿›è¡Œè½¬å½•...")

            response, stats = self.model_interface.generate_content([prompt, uploaded_file_obj],
                                                                    model_type='transcription')

            return response, {'input': stats.get('input_tokens', 0), 'output': stats.get('output_tokens', 0)}

        except Exception as e:
            if retry_count < self.max_retries:
                time.sleep(2 ** retry_count)
                return self._transcribe_single_segment(file_path, enable_speaker_diarization, progress_callback,
                                                       retry_count + 1)
            else:
                raise Exception(f"è½¬å½•å¤±è´¥: {e}")
        finally:
            if uploaded_file_obj and self.delete_uploaded_files and self.model_interface.provider_client:
                self.model_interface.provider_client.delete_file(uploaded_file_obj)

    def _merge_segments(self,
                        segments: List[TranscriptionSegment],
                        speaker_mapping: Dict[str, str],
                        duration_minutes: Optional[float]) -> str:
        if not segments:
            return ""
        final_text_parts = []
        if speaker_mapping:
            unique_speakers = set(speaker_mapping.values())
            summary = f"===== è½¬å½•æ‘˜è¦ =====\n"
            summary += f"æ€»æ—¶é•¿ï¼š{format_duration(duration_minutes * 60) if duration_minutes else 'æœªçŸ¥'}\n"
            summary += f"è¯†åˆ«åˆ°çš„è¯´è¯äººæ•°ï¼š{len(unique_speakers)}\n"
            summary += f"è¯´è¯äººåˆ—è¡¨ï¼š{', '.join(sorted(unique_speakers))}\n"
            summary += "=" * 50 + "\n"
            final_text_parts.append(summary)

        for segment in segments:
            time_marker = f"\n[{format_duration(segment.start_time)} - {format_duration(segment.end_time)}]\n"
            final_text_parts.append(time_marker)
            if speaker_mapping and self.speaker_analyzer:
                mapped_text = self.speaker_analyzer.apply_speaker_mapping(segment, speaker_mapping)
                final_text_parts.append(mapped_text)
            else:
                final_text_parts.append(segment.text)
        return "\n".join(final_text_parts)

    def process_web_text(self, text: str, options: Optional[Dict] = None) -> ProcessingResult:
        start_time = time.time()
        options = options or {}
        try:
            if options.get('enable_text_optimization', False):
                if not self.text_optimizer:
                    self.text_optimizer = TextOptimizer(self.model_interface, self.prompt_manager)
                optimized_text, stats = self.text_optimizer.optimize_transcript(text, options.get('progress_callback'))
                metadata = {'original_text': text, 'optimized_text': optimized_text, 'optimization_stats': stats,
                            'timestamp': datetime.now().strftime('%Y-%m-%d %H:%M:%S')}
                content = optimized_text
            else:
                content = text
                metadata = {'timestamp': datetime.now().strftime('%Y-%m-%d %H:%M:%S')}

            processing_time = time.time() - start_time
            return ProcessingResult(content=content, metadata=metadata, source_type='text',
                                    processing_time=processing_time, model_used='', tokens_consumed={})
        except Exception as e:
            processing_time = time.time() - start_time
            return ProcessingResult(content=text, metadata={'error': str(e)}, source_type='text',
                                    processing_time=processing_time, model_used='', tokens_consumed={}, error=str(e))

--- File: utils/__init__.py ---

--- File: utils/file_utils.py ---
#!/usr/bin/env python
# -*- coding: utf-8 -*-
"""
æ–‡ä»¶è·¯å¾„: smart_proposal_engine/utils/file_utils.py
åŠŸèƒ½è¯´æ˜: æ–‡ä»¶å¤„ç†ç›¸å…³å·¥å…·å‡½æ•°
ä½œè€…: SmartProposal Team
åˆ›å»ºæ—¥æœŸ: 2025-06-27
æœ€åä¿®æ”¹: 2025-06-27
ç‰ˆæœ¬: 1.0.0
"""

import os
import sys
import shutil
import tempfile
import hashlib
import mimetypes
from pathlib import Path
from typing import Optional, Tuple, List, Dict, Union
from datetime import datetime

# æ·»åŠ é¡¹ç›®æ ¹ç›®å½•åˆ°ç³»ç»Ÿè·¯å¾„
sys.path.insert(0, os.path.dirname(os.path.dirname(os.path.abspath(__file__))))


# æ–‡ä»¶å¤§å°å•ä½
SIZE_UNITS = ['B', 'KB', 'MB', 'GB', 'TB']

# æ”¯æŒçš„æ–‡ä»¶æ ¼å¼
SUPPORTED_AUDIO_FORMATS = ['.m4a', '.mp3', '.wav', '.aac', '.ogg', '.flac', '.mp4', '.wma', '.opus']
SUPPORTED_DOCUMENT_FORMATS = ['.docx', '.pdf', '.txt', '.doc', '.rtf', '.odt']
SUPPORTED_IMAGE_FORMATS = ['.png', '.jpg', '.jpeg', '.gif', '.bmp', '.tiff', '.svg']
SUPPORTED_VIDEO_FORMATS = ['.mp4', '.avi', '.mov', '.wmv', '.flv', '.webm']


def format_file_size(size_bytes: int) -> str:
    """
    æ ¼å¼åŒ–æ–‡ä»¶å¤§å°æ˜¾ç¤º
    
    Args:
        size_bytes: å­—èŠ‚æ•°
    
    Returns:
        str: æ ¼å¼åŒ–åçš„å¤§å°å­—ç¬¦ä¸²ï¼ˆå¦‚ "1.5 MB"ï¼‰
    """
    if size_bytes == 0:
        return "0 B"
    
    size = float(size_bytes)
    unit_index = 0
    
    while size >= 1024 and unit_index < len(SIZE_UNITS) - 1:
        size /= 1024
        unit_index += 1
    
    # æ ¹æ®å¤§å°å†³å®šå°æ•°ä½æ•°
    if unit_index == 0:  # å­—èŠ‚
        return f"{int(size)} {SIZE_UNITS[unit_index]}"
    elif size >= 100:
        return f"{size:.0f} {SIZE_UNITS[unit_index]}"
    elif size >= 10:
        return f"{size:.1f} {SIZE_UNITS[unit_index]}"
    else:
        return f"{size:.2f} {SIZE_UNITS[unit_index]}"


def get_file_extension(file_path: Union[str, Path]) -> str:
    """
    è·å–æ–‡ä»¶æ‰©å±•åï¼ˆå°å†™ï¼‰
    
    Args:
        file_path: æ–‡ä»¶è·¯å¾„
    
    Returns:
        str: å°å†™çš„æ–‡ä»¶æ‰©å±•åï¼ˆåŒ…å«ç‚¹å·ï¼‰
    """
    return Path(file_path).suffix.lower()


def get_file_type(file_path: Union[str, Path]) -> str:
    """
    åˆ¤æ–­æ–‡ä»¶ç±»å‹
    
    Args:
        file_path: æ–‡ä»¶è·¯å¾„
    
    Returns:
        str: æ–‡ä»¶ç±»å‹ ('audio', 'document', 'image', 'video', 'unknown')
    """
    ext = get_file_extension(file_path)
    
    if ext in SUPPORTED_AUDIO_FORMATS:
        return 'audio'
    elif ext in SUPPORTED_DOCUMENT_FORMATS:
        return 'document'
    elif ext in SUPPORTED_IMAGE_FORMATS:
        return 'image'
    elif ext in SUPPORTED_VIDEO_FORMATS:
        return 'video'
    else:
        return 'unknown'


def validate_file_size(file_path: Union[str, Path], max_size_mb: float = 200) -> Tuple[bool, str]:
    """
    éªŒè¯æ–‡ä»¶å¤§å°æ˜¯å¦åœ¨å…è®¸èŒƒå›´å†…
    
    Args:
        file_path: æ–‡ä»¶è·¯å¾„
        max_size_mb: æœ€å¤§å…è®¸å¤§å°ï¼ˆMBï¼‰
    
    Returns:
        (is_valid, message): éªŒè¯ç»“æœå’Œæ¶ˆæ¯
    """
    try:
        file_size = os.path.getsize(file_path)
        max_size_bytes = max_size_mb * 1024 * 1024
        
        if file_size > max_size_bytes:
            return False, f"æ–‡ä»¶å¤ªå¤§ï¼ˆ{format_file_size(file_size)}ï¼‰ï¼Œæœ€å¤§å…è®¸ {max_size_mb} MB"
        
        return True, f"æ–‡ä»¶å¤§å°: {format_file_size(file_size)}"
        
    except Exception as e:
        return False, f"æ— æ³•è·å–æ–‡ä»¶å¤§å°: {str(e)}"


def validate_file_format(file_path: Union[str, Path], allowed_formats: List[str]) -> Tuple[bool, str]:
    """
    éªŒè¯æ–‡ä»¶æ ¼å¼æ˜¯å¦å…è®¸
    
    Args:
        file_path: æ–‡ä»¶è·¯å¾„
        allowed_formats: å…è®¸çš„æ ¼å¼åˆ—è¡¨
    
    Returns:
        (is_valid, message): éªŒè¯ç»“æœå’Œæ¶ˆæ¯
    """
    ext = get_file_extension(file_path)
    
    if ext in allowed_formats:
        return True, f"æ–‡ä»¶æ ¼å¼: {ext}"
    else:
        return False, f"ä¸æ”¯æŒçš„æ–‡ä»¶æ ¼å¼: {ext}ï¼Œå…è®¸çš„æ ¼å¼: {', '.join(allowed_formats)}"


def create_temp_directory(prefix: str = "smartproposal_") -> str:
    """
    åˆ›å»ºä¸´æ—¶ç›®å½•
    
    Args:
        prefix: ç›®å½•å‰ç¼€
    
    Returns:
        str: ä¸´æ—¶ç›®å½•è·¯å¾„
    """
    temp_dir = tempfile.mkdtemp(prefix=prefix)
    return temp_dir


def cleanup_directory(directory: Union[str, Path], safe_mode: bool = True) -> bool:
    """
    æ¸…ç†ç›®å½•
    
    Args:
        directory: è¦æ¸…ç†çš„ç›®å½•
        safe_mode: å®‰å…¨æ¨¡å¼ï¼ˆåªæ¸…ç†ä¸´æ—¶ç›®å½•ï¼‰
    
    Returns:
        bool: æ˜¯å¦æ¸…ç†æˆåŠŸ
    """
    try:
        directory = Path(directory)
        
        # å®‰å…¨æ£€æŸ¥
        if safe_mode:
            temp_dir = Path(tempfile.gettempdir())
            if not str(directory).startswith(str(temp_dir)):
                print(f"å®‰å…¨æ¨¡å¼ä¸‹åªèƒ½æ¸…ç†ä¸´æ—¶ç›®å½•: {directory}")
                return False
        
        if directory.exists():
            shutil.rmtree(directory)
            return True
        
        return True
        
    except Exception as e:
        print(f"æ¸…ç†ç›®å½•å¤±è´¥: {e}")
        return False


def save_uploaded_file(uploaded_file, save_directory: Union[str, Path], 
                      new_filename: Optional[str] = None) -> Tuple[bool, str, str]:
    """
    ä¿å­˜ä¸Šä¼ çš„æ–‡ä»¶ï¼ˆStreamlitæ–‡ä»¶å¯¹è±¡ï¼‰
    
    Args:
        uploaded_file: Streamlitçš„ä¸Šä¼ æ–‡ä»¶å¯¹è±¡
        save_directory: ä¿å­˜ç›®å½•
        new_filename: æ–°æ–‡ä»¶åï¼ˆå¯é€‰ï¼‰
    
    Returns:
        (success, file_path, message): ä¿å­˜ç»“æœ
    """
    try:
        save_directory = Path(save_directory)
        save_directory.mkdir(parents=True, exist_ok=True)
        
        # ç¡®å®šæ–‡ä»¶å
        if new_filename:
            filename = new_filename
        else:
            # ä½¿ç”¨åŸå§‹æ–‡ä»¶åï¼Œä½†æ·»åŠ æ—¶é—´æˆ³é¿å…å†²çª
            timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
            name_parts = uploaded_file.name.rsplit('.', 1)
            if len(name_parts) == 2:
                filename = f"{name_parts[0]}_{timestamp}.{name_parts[1]}"
            else:
                filename = f"{uploaded_file.name}_{timestamp}"
        
        file_path = save_directory / filename
        
        # ä¿å­˜æ–‡ä»¶
        with open(file_path, 'wb') as f:
            f.write(uploaded_file.getbuffer())
        
        return True, str(file_path), f"æ–‡ä»¶ä¿å­˜æˆåŠŸ: {filename}"
        
    except Exception as e:
        return False, "", f"ä¿å­˜æ–‡ä»¶å¤±è´¥: {str(e)}"


def generate_file_hash(file_path: Union[str, Path], algorithm: str = 'md5') -> str:
    """
    ç”Ÿæˆæ–‡ä»¶å“ˆå¸Œå€¼
    
    Args:
        file_path: æ–‡ä»¶è·¯å¾„
        algorithm: å“ˆå¸Œç®—æ³• ('md5', 'sha1', 'sha256')
    
    Returns:
        str: æ–‡ä»¶å“ˆå¸Œå€¼
    """
    hash_func = getattr(hashlib, algorithm)()
    
    with open(file_path, 'rb') as f:
        while chunk := f.read(8192):
            hash_func.update(chunk)
    
    return hash_func.hexdigest()


def get_file_metadata(file_path: Union[str, Path]) -> Dict[str, any]:
    """
    è·å–æ–‡ä»¶å…ƒæ•°æ®
    
    Args:
        file_path: æ–‡ä»¶è·¯å¾„
    
    Returns:
        Dict: æ–‡ä»¶å…ƒæ•°æ®
    """
    file_path = Path(file_path)
    
    if not file_path.exists():
        return {'error': 'æ–‡ä»¶ä¸å­˜åœ¨'}
    
    stat = file_path.stat()
    
    metadata = {
        'filename': file_path.name,
        'path': str(file_path.absolute()),
        'size': stat.st_size,
        'size_formatted': format_file_size(stat.st_size),
        'extension': file_path.suffix.lower(),
        'file_type': get_file_type(file_path),
        'created_time': datetime.fromtimestamp(stat.st_ctime).strftime('%Y-%m-%d %H:%M:%S'),
        'modified_time': datetime.fromtimestamp(stat.st_mtime).strftime('%Y-%m-%d %H:%M:%S'),
        'mime_type': mimetypes.guess_type(str(file_path))[0] or 'unknown'
    }
    
    return metadata


def prepare_download_file(file_path: Union[str, Path], download_name: Optional[str] = None) -> Tuple[bytes, str, str]:
    """
    å‡†å¤‡æ–‡ä»¶ä¾›ä¸‹è½½
    
    Args:
        file_path: æ–‡ä»¶è·¯å¾„
        download_name: ä¸‹è½½æ—¶çš„æ–‡ä»¶å
    
    Returns:
        (file_data, download_name, mime_type): æ–‡ä»¶æ•°æ®ã€ä¸‹è½½åç§°ã€MIMEç±»å‹
    """
    file_path = Path(file_path)
    
    if not file_path.exists():
        raise FileNotFoundError(f"æ–‡ä»¶ä¸å­˜åœ¨: {file_path}")
    
    # è¯»å–æ–‡ä»¶æ•°æ®
    with open(file_path, 'rb') as f:
        file_data = f.read()
    
    # ç¡®å®šä¸‹è½½æ–‡ä»¶å
    if not download_name:
        download_name = file_path.name
    
    # è·å–MIMEç±»å‹
    mime_type = mimetypes.guess_type(str(file_path))[0] or 'application/octet-stream'
    
    return file_data, download_name, mime_type


def batch_process_files(file_list: List[Union[str, Path]], 
                       process_func: callable,
                       progress_callback: Optional[callable] = None) -> List[Dict[str, any]]:
    """
    æ‰¹é‡å¤„ç†æ–‡ä»¶
    
    Args:
        file_list: æ–‡ä»¶è·¯å¾„åˆ—è¡¨
        process_func: å¤„ç†å‡½æ•°
        progress_callback: è¿›åº¦å›è°ƒå‡½æ•°
    
    Returns:
        List[Dict]: å¤„ç†ç»“æœåˆ—è¡¨
    """
    results = []
    total_files = len(file_list)
    
    for i, file_path in enumerate(file_list):
        if progress_callback:
            progress_callback(f"å¤„ç†æ–‡ä»¶ {i + 1}/{total_files}: {Path(file_path).name}")
        
        try:
            result = process_func(file_path)
            results.append({
                'file': str(file_path),
                'success': True,
                'result': result
            })
        except Exception as e:
            results.append({
                'file': str(file_path),
                'success': False,
                'error': str(e)
            })
    
    return results


def get_audio_duration(file_path: Union[str, Path]) -> Optional[float]:
    """
    è·å–éŸ³é¢‘æ–‡ä»¶æ—¶é•¿ï¼ˆç§’ï¼‰
    
    Args:
        file_path: éŸ³é¢‘æ–‡ä»¶è·¯å¾„
    
    Returns:
        float: æ—¶é•¿ï¼ˆç§’ï¼‰ï¼Œå¦‚æœæ— æ³•è·å–åˆ™è¿”å›None
    """
    try:
        # å°è¯•ä½¿ç”¨pydubè·å–æ—¶é•¿
        from pydub import AudioSegment
        audio = AudioSegment.from_file(file_path)
        duration_seconds = len(audio) / 1000.0
        return duration_seconds
    except ImportError:
        # pydubæœªå®‰è£…ï¼Œå°è¯•å…¶ä»–æ–¹æ³•
        pass
    except Exception as e:
        print(f"ä½¿ç”¨pydubè·å–éŸ³é¢‘æ—¶é•¿å¤±è´¥: {e}")
    
    # è¿™é‡Œå¯ä»¥æ·»åŠ å…¶ä»–è·å–éŸ³é¢‘æ—¶é•¿çš„æ–¹æ³•
    # ä¾‹å¦‚ä½¿ç”¨ffprobeæˆ–å…¶ä»–åº“
    
    return None


def ensure_directory_exists(directory: Union[str, Path]) -> Path:
    """
    ç¡®ä¿ç›®å½•å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™åˆ›å»º
    
    Args:
        directory: ç›®å½•è·¯å¾„
    
    Returns:
        Path: ç›®å½•Pathå¯¹è±¡
    """
    directory = Path(directory)
    directory.mkdir(parents=True, exist_ok=True)
    return directory


def copy_file_safe(source: Union[str, Path], destination: Union[str, Path], 
                  overwrite: bool = False) -> Tuple[bool, str]:
    """
    å®‰å…¨åœ°å¤åˆ¶æ–‡ä»¶
    
    Args:
        source: æºæ–‡ä»¶è·¯å¾„
        destination: ç›®æ ‡è·¯å¾„
        overwrite: æ˜¯å¦è¦†ç›–å·²å­˜åœ¨çš„æ–‡ä»¶
    
    Returns:
        (success, message): æ“ä½œç»“æœ
    """
    try:
        source = Path(source)
        destination = Path(destination)
        
        if not source.exists():
            return False, f"æºæ–‡ä»¶ä¸å­˜åœ¨: {source}"
        
        # å¦‚æœç›®æ ‡æ˜¯ç›®å½•ï¼Œä½¿ç”¨æºæ–‡ä»¶å
        if destination.is_dir():
            destination = destination / source.name
        
        # æ£€æŸ¥æ˜¯å¦è¦†ç›–
        if destination.exists() and not overwrite:
            return False, f"ç›®æ ‡æ–‡ä»¶å·²å­˜åœ¨: {destination}"
        
        # ç¡®ä¿ç›®æ ‡ç›®å½•å­˜åœ¨
        destination.parent.mkdir(parents=True, exist_ok=True)
        
        # å¤åˆ¶æ–‡ä»¶
        shutil.copy2(source, destination)
        
        return True, f"æ–‡ä»¶å¤åˆ¶æˆåŠŸ: {destination}"
        
    except Exception as e:
        return False, f"æ–‡ä»¶å¤åˆ¶å¤±è´¥: {str(e)}"


def list_files_in_directory(directory: Union[str, Path], 
                           pattern: str = "*",
                           recursive: bool = False) -> List[Path]:
    """
    åˆ—å‡ºç›®å½•ä¸­çš„æ–‡ä»¶
    
    Args:
        directory: ç›®å½•è·¯å¾„
        pattern: æ–‡ä»¶åŒ¹é…æ¨¡å¼ï¼ˆå¦‚ "*.txt"ï¼‰
        recursive: æ˜¯å¦é€’å½’æœç´¢å­ç›®å½•
    
    Returns:
        List[Path]: æ–‡ä»¶è·¯å¾„åˆ—è¡¨
    """
    directory = Path(directory)
    
    if not directory.exists():
        return []
    
    if recursive:
        return list(directory.rglob(pattern))
    else:
        return list(directory.glob(pattern))


def get_recent_files(directory: Union[str, Path], 
                    count: int = 10,
                    file_types: Optional[List[str]] = None) -> List[Dict[str, any]]:
    """
    è·å–ç›®å½•ä¸­æœ€è¿‘çš„æ–‡ä»¶
    
    Args:
        directory: ç›®å½•è·¯å¾„
        count: è·å–æ•°é‡
        file_types: æ–‡ä»¶ç±»å‹è¿‡æ»¤ï¼ˆå¦‚ ['.txt', '.pdf']ï¼‰
    
    Returns:
        List[Dict]: æ–‡ä»¶ä¿¡æ¯åˆ—è¡¨
    """
    directory = Path(directory)
    
    if not directory.exists():
        return []
    
    # è·å–æ‰€æœ‰æ–‡ä»¶
    files = []
    for file_path in directory.iterdir():
        if file_path.is_file():
            if file_types:
                if file_path.suffix.lower() not in file_types:
                    continue
            
            files.append({
                'path': str(file_path),
                'name': file_path.name,
                'size': format_file_size(file_path.stat().st_size),
                'modified': file_path.stat().st_mtime,
                'modified_str': datetime.fromtimestamp(file_path.stat().st_mtime).strftime('%Y-%m-%d %H:%M:%S')
            })
    
    # æŒ‰ä¿®æ”¹æ—¶é—´æ’åº
    files.sort(key=lambda x: x['modified'], reverse=True)
    
    return files[:count]


def create_unique_filename(directory: Union[str, Path], 
                         base_name: str,
                         extension: str) -> str:
    """
    åœ¨ç›®å½•ä¸­åˆ›å»ºå”¯ä¸€çš„æ–‡ä»¶å
    
    Args:
        directory: ç›®å½•è·¯å¾„
        base_name: åŸºç¡€æ–‡ä»¶å
        extension: æ–‡ä»¶æ‰©å±•å
    
    Returns:
        str: å”¯ä¸€çš„æ–‡ä»¶å
    """
    directory = Path(directory)
    counter = 1
    
    # ç¡®ä¿æ‰©å±•åä»¥ç‚¹å¼€å¤´
    if not extension.startswith('.'):
        extension = f'.{extension}'
    
    # åŸºç¡€æ–‡ä»¶å
    filename = f"{base_name}{extension}"
    file_path = directory / filename
    
    # å¦‚æœæ–‡ä»¶å·²å­˜åœ¨ï¼Œæ·»åŠ æ•°å­—åç¼€
    while file_path.exists():
        filename = f"{base_name}_{counter}{extension}"
        file_path = directory / filename
        counter += 1
    
    return filename

--- File: utils/format_utils.py ---
#!/usr/bin/env python
# -*- coding: utf-8 -*-
"""
æ–‡ä»¶è·¯å¾„: smart_proposal_engine/utils/format_utils.py
åŠŸèƒ½è¯´æ˜: æ ¼å¼åŒ–ç›¸å…³å·¥å…·å‡½æ•°
ä½œè€…: SmartProposal Team
åˆ›å»ºæ—¥æœŸ: 2025-06-27
æœ€åä¿®æ”¹: 2025-06-27
ç‰ˆæœ¬: 1.0.0
"""

import os
import sys
import re
import json
from datetime import datetime, timedelta
from typing import Dict, List, Optional, Union, Any
import html
import markdown

# æ·»åŠ é¡¹ç›®æ ¹ç›®å½•åˆ°ç³»ç»Ÿè·¯å¾„
sys.path.insert(0, os.path.dirname(os.path.dirname(os.path.abspath(__file__))))


def format_duration(seconds: Optional[Union[int, float]]) -> str:
    """
    æ ¼å¼åŒ–æ—¶é•¿æ˜¾ç¤º
    
    Args:
        seconds: ç§’æ•°
    
    Returns:
        str: æ ¼å¼åŒ–åçš„æ—¶é•¿å­—ç¬¦ä¸²ï¼ˆå¦‚ "1å°æ—¶23åˆ†45ç§’"ï¼‰
    """
    if seconds is None:
        return "æœªçŸ¥"
    
    if seconds < 0:
        return "æ— æ•ˆæ—¶é•¿"
    
    # è½¬æ¢ä¸ºæ•´æ•°ç§’
    total_seconds = int(seconds)
    
    # è®¡ç®—æ—¶åˆ†ç§’
    hours = total_seconds // 3600
    minutes = (total_seconds % 3600) // 60
    secs = total_seconds % 60
    
    # æ„å»ºç»“æœå­—ç¬¦ä¸²
    parts = []
    
    if hours > 0:
        parts.append(f"{hours}å°æ—¶")
    
    if minutes > 0:
        parts.append(f"{minutes}åˆ†")
    
    if secs > 0 or len(parts) == 0:  # å¦‚æœæ²¡æœ‰æ—¶åˆ†ï¼Œè‡³å°‘æ˜¾ç¤ºç§’
        parts.append(f"{secs}ç§’")
    
    return "".join(parts)


def format_timestamp(timestamp: Union[int, float, datetime], 
                    format_string: str = "%Y-%m-%d %H:%M:%S") -> str:
    """
    æ ¼å¼åŒ–æ—¶é—´æˆ³
    
    Args:
        timestamp: æ—¶é—´æˆ³ï¼ˆç§’ï¼‰æˆ–datetimeå¯¹è±¡
        format_string: æ ¼å¼åŒ–å­—ç¬¦ä¸²
    
    Returns:
        str: æ ¼å¼åŒ–åçš„æ—¶é—´å­—ç¬¦ä¸²
    """
    if isinstance(timestamp, (int, float)):
        dt = datetime.fromtimestamp(timestamp)
    elif isinstance(timestamp, datetime):
        dt = timestamp
    else:
        return "æ— æ•ˆæ—¶é—´"
    
    return dt.strftime(format_string)


def format_metadata_display(metadata: Dict[str, Any], 
                          exclude_keys: Optional[List[str]] = None) -> str:
    """
    æ ¼å¼åŒ–å…ƒæ•°æ®ç”¨äºæ˜¾ç¤º
    
    Args:
        metadata: å…ƒæ•°æ®å­—å…¸
        exclude_keys: è¦æ’é™¤çš„é”®åˆ—è¡¨
    
    Returns:
        str: æ ¼å¼åŒ–åçš„æ˜¾ç¤ºå­—ç¬¦ä¸²
    """
    if not metadata:
        return "æ— å…ƒæ•°æ®"
    
    exclude_keys = exclude_keys or []
    
    display_parts = []
    
    # å®šä¹‰é”®çš„æ˜¾ç¤ºåç§°æ˜ å°„
    key_display_names = {
        'file_size': 'æ–‡ä»¶å¤§å°',
        'duration': 'æ—¶é•¿',
        'speakers_count': 'è¯´è¯äººæ•°',
        'processing_time': 'å¤„ç†æ—¶é—´',
        'model_used': 'ä½¿ç”¨æ¨¡å‹',
        'total_tokens': 'Tokenæ€»æ•°',
        'estimated_cost': 'é¢„ä¼°è´¹ç”¨',
        'timestamp': 'å¤„ç†æ—¶é—´',
        'analysis_template': 'åˆ†ææ¨¡æ¿',
        'source_type': 'æ¥æºç±»å‹',
        'page_count': 'é¡µæ•°',
        'word_count': 'å­—æ•°'
    }
    
    # æŒ‰ä¼˜å…ˆçº§æ’åºçš„é”®
    priority_keys = [
        'file_size', 'duration', 'page_count', 'word_count',
        'speakers_count', 'processing_time', 'model_used'
    ]
    
    # å…ˆæ˜¾ç¤ºä¼˜å…ˆçº§é«˜çš„é”®
    for key in priority_keys:
        if key in metadata and key not in exclude_keys:
            display_name = key_display_names.get(key, key)
            value = metadata[key]
            
            # ç‰¹æ®Šæ ¼å¼åŒ–
            if key == 'processing_time' and isinstance(value, (int, float)):
                value = f"{value:.1f}ç§’"
            elif key == 'estimated_cost' and isinstance(value, (int, float)):
                value = f"${value:.4f}"
            elif key == 'total_tokens' and isinstance(value, int):
                value = f"{value:,}"
            
            display_parts.append(f"{display_name}: {value}")
    
    # å†æ˜¾ç¤ºå…¶ä»–é”®
    for key, value in metadata.items():
        if key not in priority_keys and key not in exclude_keys:
            display_name = key_display_names.get(key, key)
            display_parts.append(f"{display_name}: {value}")
    
    return " | ".join(display_parts)


def format_number(number: Union[int, float], 
                 decimal_places: int = 2,
                 use_comma: bool = True) -> str:
    """
    æ ¼å¼åŒ–æ•°å­—æ˜¾ç¤º
    
    Args:
        number: æ•°å­—
        decimal_places: å°æ•°ä½æ•°
        use_comma: æ˜¯å¦ä½¿ç”¨åƒä½åˆ†éš”ç¬¦
    
    Returns:
        str: æ ¼å¼åŒ–åçš„æ•°å­—å­—ç¬¦ä¸²
    """
    if isinstance(number, int):
        if use_comma:
            return f"{number:,}"
        else:
            return str(number)
    
    if use_comma:
        return f"{number:,.{decimal_places}f}"
    else:
        return f"{number:.{decimal_places}f}"


def format_percentage(value: float, decimal_places: int = 1) -> str:
    """
    æ ¼å¼åŒ–ç™¾åˆ†æ¯”æ˜¾ç¤º
    
    Args:
        value: æ•°å€¼ï¼ˆ0-1ä¹‹é—´è¡¨ç¤ºç™¾åˆ†æ¯”ï¼Œå¤§äº1è¡¨ç¤ºå·²ç»æ˜¯ç™¾åˆ†æ•°ï¼‰
        decimal_places: å°æ•°ä½æ•°
    
    Returns:
        str: æ ¼å¼åŒ–åçš„ç™¾åˆ†æ¯”å­—ç¬¦ä¸²
    """
    if value <= 1:
        percentage = value * 100
    else:
        percentage = value
    
    return f"{percentage:.{decimal_places}f}%"


def format_money(amount: Union[int, float], 
                currency: str = "Â¥",
                decimal_places: int = 2) -> str:
    """
    æ ¼å¼åŒ–è´§å¸æ˜¾ç¤º
    
    Args:
        amount: é‡‘é¢
        currency: è´§å¸ç¬¦å·
        decimal_places: å°æ•°ä½æ•°
    
    Returns:
        str: æ ¼å¼åŒ–åçš„è´§å¸å­—ç¬¦ä¸²
    """
    formatted_number = format_number(amount, decimal_places, use_comma=True)
    return f"{currency}{formatted_number}"


def clean_text(text: str, 
              remove_extra_spaces: bool = True,
              remove_empty_lines: bool = True) -> str:
    """
    æ¸…ç†æ–‡æœ¬
    
    Args:
        text: åŸå§‹æ–‡æœ¬
        remove_extra_spaces: æ˜¯å¦ç§»é™¤å¤šä½™ç©ºæ ¼
        remove_empty_lines: æ˜¯å¦ç§»é™¤ç©ºè¡Œ
    
    Returns:
        str: æ¸…ç†åçš„æ–‡æœ¬
    """
    if not text:
        return ""
    
    # ç§»é™¤é¦–å°¾ç©ºç™½
    text = text.strip()
    
    if remove_extra_spaces:
        # å°†å¤šä¸ªç©ºæ ¼æ›¿æ¢ä¸ºä¸€ä¸ª
        text = re.sub(r'\s+', ' ', text)
        # ä½†ä¿ç•™æ¢è¡Œç¬¦
        text = re.sub(r' *\n *', '\n', text)
    
    if remove_empty_lines:
        # ç§»é™¤ç©ºè¡Œ
        lines = [line for line in text.split('\n') if line.strip()]
        text = '\n'.join(lines)
    
    return text


def truncate_text(text: str, 
                 max_length: int = 100,
                 suffix: str = "...") -> str:
    """
    æˆªæ–­æ–‡æœ¬
    
    Args:
        text: åŸå§‹æ–‡æœ¬
        max_length: æœ€å¤§é•¿åº¦
        suffix: æˆªæ–­åç¼€
    
    Returns:
        str: æˆªæ–­åçš„æ–‡æœ¬
    """
    if not text or len(text) <= max_length:
        return text
    
    # åœ¨è¯è¾¹ç•Œæˆªæ–­
    truncated = text[:max_length]
    
    # å°è¯•åœ¨æœ€åä¸€ä¸ªå®Œæ•´è¯å¤„æˆªæ–­
    last_space = truncated.rfind(' ')
    if last_space > max_length * 0.8:  # å¦‚æœç©ºæ ¼ä½ç½®åˆç†
        truncated = truncated[:last_space]
    
    return truncated + suffix


def markdown_to_text(markdown_text: str) -> str:
    """
    å°†Markdownè½¬æ¢ä¸ºçº¯æ–‡æœ¬
    
    Args:
        markdown_text: Markdownæ ¼å¼æ–‡æœ¬
    
    Returns:
        str: çº¯æ–‡æœ¬
    """
    # ç§»é™¤Markdownæ ‡è®°
    # ç§»é™¤æ ‡é¢˜æ ‡è®°
    text = re.sub(r'^#{1,6}\s+', '', markdown_text, flags=re.MULTILINE)
    
    # ç§»é™¤åŠ ç²—å’Œæ–œä½“
    text = re.sub(r'\*{1,2}([^\*]+)\*{1,2}', r'\1', text)
    text = re.sub(r'_{1,2}([^_]+)_{1,2}', r'\1', text)
    
    # ç§»é™¤é“¾æ¥
    text = re.sub(r'\[([^\]]+)\]\([^\)]+\)', r'\1', text)
    
    # ç§»é™¤å›¾ç‰‡
    text = re.sub(r'!\[([^\]]*)\]\([^\)]+\)', '', text)
    
    # ç§»é™¤ä»£ç å—
    text = re.sub(r'```[^`]*```', '', text, flags=re.DOTALL)
    text = re.sub(r'`([^`]+)`', r'\1', text)
    
    # ç§»é™¤åˆ—è¡¨æ ‡è®°
    text = re.sub(r'^\s*[-*+]\s+', '', text, flags=re.MULTILINE)
    text = re.sub(r'^\s*\d+\.\s+', '', text, flags=re.MULTILINE)
    
    # ç§»é™¤å¼•ç”¨æ ‡è®°
    text = re.sub(r'^\s*>\s+', '', text, flags=re.MULTILINE)
    
    # ç§»é™¤æ°´å¹³çº¿
    text = re.sub(r'^-{3,}$', '', text, flags=re.MULTILINE)
    
    # æ¸…ç†å¤šä½™ç©ºè¡Œ
    text = re.sub(r'\n{3,}', '\n\n', text)
    
    return text.strip()


def markdown_to_html(markdown_text: str, 
                    safe_mode: bool = True) -> str:
    """
    å°†Markdownè½¬æ¢ä¸ºHTML
    
    Args:
        markdown_text: Markdownæ ¼å¼æ–‡æœ¬
        safe_mode: æ˜¯å¦å¯ç”¨å®‰å…¨æ¨¡å¼ï¼ˆè½¬ä¹‰HTMLï¼‰
    
    Returns:
        str: HTMLæ ¼å¼æ–‡æœ¬
    """
    if safe_mode:
        # è½¬ä¹‰HTMLæ ‡ç­¾
        markdown_text = html.escape(markdown_text)
    
    # ä½¿ç”¨markdownåº“è½¬æ¢
    html_text = markdown.markdown(
        markdown_text,
        extensions=['extra', 'codehilite', 'toc']
    )
    
    return html_text


def format_list_as_text(items: List[Any], 
                       style: str = "bullet",
                       indent: int = 0) -> str:
    """
    å°†åˆ—è¡¨æ ¼å¼åŒ–ä¸ºæ–‡æœ¬
    
    Args:
        items: é¡¹ç›®åˆ—è¡¨
        style: æ ·å¼ ('bullet', 'number', 'dash')
        indent: ç¼©è¿›çº§åˆ«
    
    Returns:
        str: æ ¼å¼åŒ–åçš„æ–‡æœ¬
    """
    if not items:
        return ""
    
    indent_str = "  " * indent
    formatted_items = []
    
    for i, item in enumerate(items):
        if style == "number":
            prefix = f"{i + 1}."
        elif style == "dash":
            prefix = "-"
        else:  # bullet
            prefix = "â€¢"
        
        formatted_items.append(f"{indent_str}{prefix} {item}")
    
    return "\n".join(formatted_items)


def format_dict_as_text(data: Dict[str, Any],
                       indent: int = 0,
                       exclude_keys: Optional[List[str]] = None) -> str:
    """
    å°†å­—å…¸æ ¼å¼åŒ–ä¸ºæ–‡æœ¬
    
    Args:
        data: æ•°æ®å­—å…¸
        indent: ç¼©è¿›çº§åˆ«
        exclude_keys: è¦æ’é™¤çš„é”®
    
    Returns:
        str: æ ¼å¼åŒ–åçš„æ–‡æœ¬
    """
    if not data:
        return ""
    
    exclude_keys = exclude_keys or []
    indent_str = "  " * indent
    formatted_parts = []
    
    for key, value in data.items():
        if key in exclude_keys:
            continue
        
        # æ ¼å¼åŒ–é”®åï¼ˆå°†ä¸‹åˆ’çº¿è½¬æ¢ä¸ºç©ºæ ¼ï¼Œé¦–å­—æ¯å¤§å†™ï¼‰
        display_key = key.replace('_', ' ').title()
        
        if isinstance(value, dict):
            formatted_parts.append(f"{indent_str}{display_key}:")
            formatted_parts.append(format_dict_as_text(value, indent + 1))
        elif isinstance(value, list):
            formatted_parts.append(f"{indent_str}{display_key}:")
            formatted_parts.append(format_list_as_text(value, indent=indent + 1))
        else:
            formatted_parts.append(f"{indent_str}{display_key}: {value}")
    
    return "\n".join(formatted_parts)


def escape_markdown(text: str) -> str:
    """
    è½¬ä¹‰Markdownç‰¹æ®Šå­—ç¬¦
    
    Args:
        text: åŸå§‹æ–‡æœ¬
    
    Returns:
        str: è½¬ä¹‰åçš„æ–‡æœ¬
    """
    # Markdownç‰¹æ®Šå­—ç¬¦
    special_chars = ['*', '_', '`', '[', ']', '(', ')', '#', '+', '-', '!', '|', '{', '}']
    
    for char in special_chars:
        text = text.replace(char, f'\\{char}')
    
    return text


def format_json_pretty(data: Union[Dict, List], 
                      indent: int = 2,
                      ensure_ascii: bool = False) -> str:
    """
    ç¾åŒ–JSONæ ¼å¼
    
    Args:
        data: æ•°æ®
        indent: ç¼©è¿›ç©ºæ ¼æ•°
        ensure_ascii: æ˜¯å¦ç¡®ä¿ASCIIç¼–ç 
    
    Returns:
        str: ç¾åŒ–åçš„JSONå­—ç¬¦ä¸²
    """
    return json.dumps(
        data,
        indent=indent,
        ensure_ascii=ensure_ascii,
        sort_keys=True,
        default=str  # å¤„ç†ä¸å¯åºåˆ—åŒ–çš„å¯¹è±¡
    )


def format_table_text(headers: List[str], 
                     rows: List[List[Any]],
                     align: str = "left") -> str:
    """
    æ ¼å¼åŒ–è¡¨æ ¼æ–‡æœ¬ï¼ˆMarkdownæ ¼å¼ï¼‰
    
    Args:
        headers: è¡¨å¤´åˆ—è¡¨
        rows: æ•°æ®è¡Œåˆ—è¡¨
        align: å¯¹é½æ–¹å¼ ('left', 'center', 'right')
    
    Returns:
        str: Markdownæ ¼å¼çš„è¡¨æ ¼
    """
    if not headers or not rows:
        return ""
    
    # è®¡ç®—æ¯åˆ—çš„æœ€å¤§å®½åº¦
    col_widths = [len(str(h)) for h in headers]
    
    for row in rows:
        for i, cell in enumerate(row[:len(headers)]):
            col_widths[i] = max(col_widths[i], len(str(cell)))
    
    # æ„å»ºè¡¨å¤´
    header_parts = []
    separator_parts = []
    
    for i, header in enumerate(headers):
        header_parts.append(str(header).ljust(col_widths[i]))
        
        if align == "center":
            separator_parts.append(":" + "-" * (col_widths[i] - 2) + ":")
        elif align == "right":
            separator_parts.append("-" * (col_widths[i] - 1) + ":")
        else:  # left
            separator_parts.append("-" * col_widths[i])
    
    # æ„å»ºè¡¨æ ¼
    table_lines = [
        "| " + " | ".join(header_parts) + " |",
        "| " + " | ".join(separator_parts) + " |"
    ]
    
    # æ·»åŠ æ•°æ®è¡Œ
    for row in rows:
        row_parts = []
        for i, cell in enumerate(row[:len(headers)]):
            if i < len(col_widths):
                if align == "right":
                    row_parts.append(str(cell).rjust(col_widths[i]))
                elif align == "center":
                    row_parts.append(str(cell).center(col_widths[i]))
                else:
                    row_parts.append(str(cell).ljust(col_widths[i]))
        
        table_lines.append("| " + " | ".join(row_parts) + " |")
    
    return "\n".join(table_lines)


def format_relative_time(timestamp: Union[datetime, float]) -> str:
    """
    æ ¼å¼åŒ–ç›¸å¯¹æ—¶é—´ï¼ˆå¦‚"5åˆ†é’Ÿå‰"ï¼‰
    
    Args:
        timestamp: æ—¶é—´æˆ³æˆ–datetimeå¯¹è±¡
    
    Returns:
        str: ç›¸å¯¹æ—¶é—´å­—ç¬¦ä¸²
    """
    if isinstance(timestamp, (int, float)):
        dt = datetime.fromtimestamp(timestamp)
    else:
        dt = timestamp
    
    now = datetime.now()
    delta = now - dt
    
    # è½¬æ¢ä¸ºç§’
    total_seconds = int(delta.total_seconds())
    
    if total_seconds < 60:
        return "åˆšåˆš"
    elif total_seconds < 3600:
        minutes = total_seconds // 60
        return f"{minutes}åˆ†é’Ÿå‰"
    elif total_seconds < 86400:
        hours = total_seconds // 3600
        return f"{hours}å°æ—¶å‰"
    elif total_seconds < 604800:
        days = total_seconds // 86400
        return f"{days}å¤©å‰"
    elif total_seconds < 2592000:
        weeks = total_seconds // 604800
        return f"{weeks}å‘¨å‰"
    elif total_seconds < 31536000:
        months = total_seconds // 2592000
        return f"{months}ä¸ªæœˆå‰"
    else:
        years = total_seconds // 31536000
        return f"{years}å¹´å‰"


def highlight_text(text: str, 
                  keywords: List[str],
                  highlight_style: str = "**{text}**") -> str:
    """
    é«˜äº®æ–‡æœ¬ä¸­çš„å…³é”®è¯
    
    Args:
        text: åŸå§‹æ–‡æœ¬
        keywords: å…³é”®è¯åˆ—è¡¨
        highlight_style: é«˜äº®æ ·å¼æ¨¡æ¿
    
    Returns:
        str: é«˜äº®åçš„æ–‡æœ¬
    """
    if not text or not keywords:
        return text
    
    # æŒ‰å…³é”®è¯é•¿åº¦é™åºæ’åºï¼Œé¿å…çŸ­è¯å½±å“é•¿è¯
    sorted_keywords = sorted(keywords, key=len, reverse=True)
    
    for keyword in sorted_keywords:
        if keyword in text:
            # ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œå¤§å°å†™ä¸æ•æ„Ÿçš„æ›¿æ¢
            pattern = re.compile(re.escape(keyword), re.IGNORECASE)
            text = pattern.sub(
                lambda m: highlight_style.format(text=m.group(0)),
                text
            )
    
    return text

--- File: utils/ui_utils.py ---
# ==============================================================================
# File: utils/ui_utils.py (å·²æ›´æ­£)
# ==============================================================================
# !/usr/bin/env python
# -*- coding: utf-8 -*-
"""
æ–‡ä»¶è·¯å¾„: smart_proposal_engine/utils/ui_utils.py
åŠŸèƒ½è¯´æ˜: æä¾›ä¸Streamlit UIç›¸å…³çš„è¾…åŠ©å‡½æ•°ï¼Œæ—¨åœ¨æå‡ç”¨æˆ·ä½“éªŒå’Œä»£ç å¤ç”¨æ€§ã€‚
ä½œè€…: SmartProposal Team
åˆ›å»ºæ—¥æœŸ: 2025-06-29
ç‰ˆæœ¬: 1.0.1 (å·²æ›´æ­£)
"""

import streamlit as st
import configparser
from typing import Optional


def check_api_key_setup():
    """
    æ£€æŸ¥API Keyæ˜¯å¦å·²åœ¨ä¼šè¯ä¸­é…ç½®ã€‚

    è¿™æ˜¯ä¸€ä¸ª"é¡µé¢å®ˆå«"å‡½æ•°ï¼Œåº”åœ¨æ¯ä¸ªéœ€è¦ä½¿ç”¨AIåŠŸèƒ½çš„Streamlitå­é¡µé¢çš„å¼€å¤´è°ƒç”¨ã€‚
    å®ƒçš„å·¥ä½œé€»è¾‘å¦‚ä¸‹ï¼š
    1. è¯»å– `app_config.ini` ä¸­çš„ `use_internal_api_key` è®¾ç½®ã€‚
    2. å¦‚æœè®¾ç½®ä¸º `true`ï¼Œåˆ™è®¤ä¸ºç³»ç»Ÿå·²é…ç½®ï¼Œå‡½æ•°ç›´æ¥è¿”å›ã€‚
    3. å¦‚æœè®¾ç½®ä¸º `false`ï¼Œåˆ™æ£€æŸ¥ `st.session_state.api_key_configured` æ ‡å¿—ä½ã€‚
    4. å¦‚æœæ ‡å¿—ä½ä¸º `False` æˆ–ä¸å­˜åœ¨ï¼Œè¯´æ˜ç”¨æˆ·å°šæœªåœ¨UIä¸­æä¾›API Keyã€‚æ­¤æ—¶ï¼Œ
       å‡½æ•°ä¼šæ˜¾ç¤ºä¸€æ¡è­¦å‘Šæ¶ˆæ¯ï¼Œæä¾›ä¸€ä¸ªè¿”å›ä¸»é¡µçš„é“¾æ¥ï¼Œå¹¶è°ƒç”¨ `st.stop()`
       æ¥ç»ˆæ­¢å½“å‰é¡µé¢çš„è¿›ä¸€æ­¥æ¸²æŸ“ï¼Œé˜²æ­¢åç»­ä»£ç å› æ¨¡å‹æœªåˆå§‹åŒ–è€ŒæŠ¥é”™ã€‚
    """
    # ç¡®ä¿åº”ç”¨çš„é…ç½®å·²ç»åŠ è½½åˆ°ä¼šè¯çŠ¶æ€ä¸­
    if 'config' not in st.session_state or not isinstance(st.session_state.config, configparser.ConfigParser):
        # å¦‚æœé…ç½®ä¸å­˜åœ¨ï¼Œå¯èƒ½æ˜¯åœ¨åº”ç”¨å¯åŠ¨çš„ææ—©æœŸé˜¶æ®µï¼Œç›´æ¥è·³è¿‡æ£€æŸ¥ã€‚
        # è¿™ç§æƒ…å†µä¸‹ï¼Œä¸»åº”ç”¨`app.py`ä¼šå¤„ç†åˆå§‹åŒ–ã€‚
        return

    # ä»é…ç½®ä¸­è¯»å–æ˜¯å¦ä½¿ç”¨å†…éƒ¨å¯†é’¥
    use_internal = st.session_state.config.getboolean(
        'API_SETTINGS',
        'use_internal_api_key',
        fallback=False
    )

    # å¦‚æœé…ç½®ä¸ºä½¿ç”¨å†…éƒ¨å¯†é’¥ï¼Œåˆ™æˆ‘ä»¬å‡å®šå®ƒæ€»æ˜¯å·²é…ç½®çš„ã€‚
    # çœŸæ­£çš„åˆå§‹åŒ–å’ŒçŠ¶æ€è®¾ç½®åœ¨ app.py ä¸­å®Œæˆã€‚
    if use_internal:
        return

    # å¦‚æœä¸ä½¿ç”¨å†…éƒ¨å¯†é’¥ï¼Œåˆ™å¿…é¡»æ£€æŸ¥ç”¨æˆ·æ˜¯å¦é€šè¿‡UIè¿›è¡Œäº†é…ç½®ã€‚
    # 'api_key_configured' è¿™ä¸ª session_state å˜é‡åœ¨ app.py ä¸­æˆåŠŸåˆå§‹åŒ–æ¨¡å‹åè¢«è®¾ä¸º Trueã€‚
    if not st.session_state.get('api_key_configured'):
        # å¦‚æœæœªé…ç½®ï¼Œæ˜¾ç¤ºè­¦å‘Šä¿¡æ¯
        st.warning("ç³»ç»Ÿæœªé…ç½®ï¼Œè¯·å…ˆåœ¨ä¸»é¡µé¢è®¾ç½®æ‚¨çš„ API å¯†é’¥ä»¥ä½¿ç”¨æœ¬åŠŸèƒ½ã€‚")

        # æä¾›ä¸€ä¸ªè¿”å›ä¸»é¡µçš„é“¾æ¥ï¼Œæ–¹ä¾¿ç”¨æˆ·æ“ä½œ
        st.page_link("app.py", label="è¿”å›ä¸»é¡µè¿›è¡Œè®¾ç½®", icon="ğŸ ")

        # åœæ­¢æ‰§è¡Œå½“å‰é¡µé¢çš„å…¶ä½™éƒ¨åˆ†ï¼Œè¿™æ˜¯é˜²æ­¢åç»­ä»£ç å‡ºé”™çš„å…³é”®
        st.stop()


def display_info_sidebar():
    """
    åœ¨ä¾§è¾¹æ æ˜¾ç¤ºä¸€ä¸ªæ ‡å‡†çš„ä¿¡æ¯æç¤ºæ¡†ã€‚
    ï¼ˆè¿™æ˜¯ä¸€ä¸ªå¯ä»¥æ ¹æ®éœ€è¦æ·»åŠ çš„é¢å¤–UIè¾…åŠ©å‡½æ•°ç¤ºä¾‹ï¼‰
    """
    with st.sidebar:
        st.info(
            """
            **ğŸ’¡ æç¤º**: 
            - ç¡®ä¿åœ¨ä¾§è¾¹æ é€‰æ‹©äº†åˆé€‚çš„æ¨¡å‹ã€‚
            - å¤„ç†å¤§æ–‡ä»¶å¯èƒ½éœ€è¦ä¸€äº›æ—¶é—´ã€‚
            - æ‰€æœ‰ç»“æœéƒ½å¯ä»¥å¯¼å‡ºä¿å­˜ã€‚
            """
        )


# ä¸»ç¨‹åºå…¥å£ï¼Œç”¨äºæ¨¡å—ç‹¬ç«‹æµ‹è¯•æˆ–æ¼”ç¤º
if __name__ == "__main__":
    st.title("UI Utils - æ¨¡å—æµ‹è¯•")

    st.markdown("è¿™æ˜¯ä¸€ä¸ªç”¨äºæµ‹è¯• `utils/ui_utils.py` ä¸­å‡½æ•°çš„é¡µé¢ã€‚")
    st.markdown("---")

    st.header("1. æµ‹è¯• `check_api_key_setup` å‡½æ•°")
    st.write("è¯·åœ¨ä¸‹æ–¹æ¨¡æ‹Ÿä¼šè¯çŠ¶æ€ï¼Œç„¶åç‚¹å‡»æŒ‰é’®è¿›è¡Œæµ‹è¯•ã€‚")

    # æ¨¡æ‹Ÿ session_state
    if 'config' not in st.session_state:
        st.session_state.config = configparser.ConfigParser()
        st.session_state.config.read_string("""
        [API_SETTINGS]
        use_internal_api_key = false
        """)

    if 'api_key_configured' not in st.session_state:
        st.session_state.api_key_configured = False

    st.write("å½“å‰æ¨¡æ‹ŸçŠ¶æ€:")
    st.json({
        'use_internal_api_key': st.session_state.config.getboolean('API_SETTINGS', 'use_internal_api_key'),
        'api_key_configured': st.session_state.get('api_key_configured')
    })

    col1, col2 = st.columns(2)
    with col1:
        if st.button("æ¨¡æ‹Ÿ: API Key å·²é…ç½®"):
            st.session_state.api_key_configured = True
            st.rerun()
    with col2:
        if st.button("æ¨¡æ‹Ÿ: API Key æœªé…ç½®"):
            st.session_state.api_key_configured = False
            st.rerun()

    # ç›´æ¥è°ƒç”¨å®ˆå«å‡½æ•°ã€‚
    # å¦‚æœæ¡ä»¶æ»¡è¶³ï¼Œå®ƒä¼šæ˜¾ç¤ºè­¦å‘Šå¹¶è°ƒç”¨ st.stop()ï¼Œæ­¤æ—¶ä¸‹é¢çš„ st.success ä¸ä¼šè¢«æ‰§è¡Œã€‚
    # å¦‚æœæ¡ä»¶ä¸æ»¡è¶³ï¼Œå®ƒä¼šç›´æ¥é€šè¿‡ï¼Œç„¶åæ‰§è¡Œä¸‹é¢çš„ st.successã€‚
    # è¿™ç§æ–¹å¼æ¯”æ•è·å†…éƒ¨å¼‚å¸¸æ›´æ¸…æ™°åœ°æ¼”ç¤ºäº†å‡½æ•°çš„è¡Œä¸ºã€‚
    check_api_key_setup()

    # åªæœ‰å½“ check_api_key_setup() æ²¡æœ‰åœæ­¢è„šæœ¬æ—¶ï¼Œè¿™è¡Œä»£ç æ‰ä¼šæ‰§è¡Œ
    st.success("âœ… `check_api_key_setup` æ£€æŸ¥é€šè¿‡ï¼Œé¡µé¢å¯ä»¥ç»§ç»­åŠ è½½ã€‚")

--- File: utils/validation_utils.py ---
#!/usr/bin/env python
# -*- coding: utf-8 -*-
"""
æ–‡ä»¶è·¯å¾„: smart_proposal_engine/utils/validation_utils.py
åŠŸèƒ½è¯´æ˜: éªŒè¯ç›¸å…³å·¥å…·å‡½æ•°
ä½œè€…: SmartProposal Team
åˆ›å»ºæ—¥æœŸ: 2025-06-27
æœ€åä¿®æ”¹: 2025-06-27
ç‰ˆæœ¬: 1.0.0
"""

import os
import sys
import re
from typing import Dict, List, Optional, Union, Tuple, Any
from pathlib import Path
import mimetypes

# æ·»åŠ é¡¹ç›®æ ¹ç›®å½•åˆ°ç³»ç»Ÿè·¯å¾„
sys.path.insert(0, os.path.dirname(os.path.dirname(os.path.abspath(__file__))))

from utils.file_utils import (
    SUPPORTED_AUDIO_FORMATS, 
    SUPPORTED_DOCUMENT_FORMATS,
    get_file_extension
)


# éªŒè¯è§„åˆ™é…ç½®
VALIDATION_RULES = {
    'file_size': {
        'max_audio_mb': 200,
        'max_document_mb': 50,
        'max_total_mb': 500
    },
    'text_length': {
        'min_analysis_chars': 50,
        'max_analysis_chars': 100000,
        'min_proposal_chars': 100,
        'max_proposal_chars': 200000
    },
    'api_limits': {
        'max_tokens_per_request': 32768,
        'max_requests_per_minute': 60
    }
}


def validate_file_type(file_path: Union[str, Path], 
                      allowed_types: Optional[List[str]] = None) -> Tuple[bool, str]:
    """
    éªŒè¯æ–‡ä»¶ç±»å‹
    
    Args:
        file_path: æ–‡ä»¶è·¯å¾„
        allowed_types: å…è®¸çš„æ–‡ä»¶ç±»å‹åˆ—è¡¨ï¼ˆå¦‚ ['audio', 'document']ï¼‰
    
    Returns:
        (is_valid, message): éªŒè¯ç»“æœå’Œæ¶ˆæ¯
    """
    file_path = Path(file_path)
    
    if not file_path.exists():
        return False, f"æ–‡ä»¶ä¸å­˜åœ¨: {file_path}"
    
    ext = get_file_extension(file_path)
    
    # å¦‚æœæ²¡æœ‰æŒ‡å®šå…è®¸ç±»å‹ï¼Œåˆ™å…è®¸æ‰€æœ‰å·²çŸ¥ç±»å‹
    if allowed_types is None:
        all_formats = SUPPORTED_AUDIO_FORMATS + SUPPORTED_DOCUMENT_FORMATS
        if ext in all_formats:
            return True, f"æ–‡ä»¶ç±»å‹æœ‰æ•ˆ: {ext}"
        else:
            return False, f"ä¸æ”¯æŒçš„æ–‡ä»¶ç±»å‹: {ext}"
    
    # æ£€æŸ¥ç‰¹å®šç±»å‹
    valid = False
    file_type = None
    
    if 'audio' in allowed_types and ext in SUPPORTED_AUDIO_FORMATS:
        valid = True
        file_type = 'audio'
    elif 'document' in allowed_types and ext in SUPPORTED_DOCUMENT_FORMATS:
        valid = True
        file_type = 'document'
    
    if valid:
        return True, f"æ–‡ä»¶ç±»å‹æœ‰æ•ˆ: {file_type} ({ext})"
    else:
        return False, f"æ–‡ä»¶ç±»å‹ {ext} ä¸åœ¨å…è®¸çš„ç±»å‹ä¸­: {allowed_types}"


def validate_text_input(text: str, 
                       min_length: Optional[int] = None,
                       max_length: Optional[int] = None,
                       required_patterns: Optional[List[str]] = None) -> Tuple[bool, str]:
    """
    éªŒè¯æ–‡æœ¬è¾“å…¥
    
    Args:
        text: è¾“å…¥æ–‡æœ¬
        min_length: æœ€å°é•¿åº¦
        max_length: æœ€å¤§é•¿åº¦
        required_patterns: å¿…é¡»åŒ…å«çš„æ¨¡å¼åˆ—è¡¨ï¼ˆæ­£åˆ™è¡¨è¾¾å¼ï¼‰
    
    Returns:
        (is_valid, message): éªŒè¯ç»“æœå’Œæ¶ˆæ¯
    """
    if not text:
        return False, "æ–‡æœ¬ä¸èƒ½ä¸ºç©º"
    
    text = text.strip()
    text_length = len(text)
    
    # æ£€æŸ¥æœ€å°é•¿åº¦
    if min_length is not None and text_length < min_length:
        return False, f"æ–‡æœ¬å¤ªçŸ­ï¼Œæœ€å°‘éœ€è¦ {min_length} ä¸ªå­—ç¬¦ï¼Œå½“å‰ {text_length} ä¸ª"
    
    # æ£€æŸ¥æœ€å¤§é•¿åº¦
    if max_length is not None and text_length > max_length:
        return False, f"æ–‡æœ¬å¤ªé•¿ï¼Œæœ€å¤šå…è®¸ {max_length} ä¸ªå­—ç¬¦ï¼Œå½“å‰ {text_length} ä¸ª"
    
    # æ£€æŸ¥å¿…éœ€çš„æ¨¡å¼
    if required_patterns:
        for pattern in required_patterns:
            if not re.search(pattern, text):
                return False, f"æ–‡æœ¬ä¸ç¬¦åˆè¦æ±‚çš„æ ¼å¼: ç¼ºå°‘ {pattern}"
    
    return True, f"æ–‡æœ¬æœ‰æ•ˆï¼Œé•¿åº¦: {text_length}"


def validate_email(email: str) -> Tuple[bool, str]:
    """
    éªŒè¯é‚®ç®±åœ°å€
    
    Args:
        email: é‚®ç®±åœ°å€
    
    Returns:
        (is_valid, message): éªŒè¯ç»“æœå’Œæ¶ˆæ¯
    """
    if not email:
        return False, "é‚®ç®±åœ°å€ä¸èƒ½ä¸ºç©º"
    
    # åŸºæœ¬çš„é‚®ç®±æ­£åˆ™è¡¨è¾¾å¼
    email_pattern = r'^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
    
    if re.match(email_pattern, email):
        return True, "é‚®ç®±åœ°å€æ ¼å¼æ­£ç¡®"
    else:
        return False, "é‚®ç®±åœ°å€æ ¼å¼æ— æ•ˆ"


def validate_phone(phone: str, region: str = 'CN') -> Tuple[bool, str]:
    """
    éªŒè¯ç”µè¯å·ç 
    
    Args:
        phone: ç”µè¯å·ç 
        region: åœ°åŒºä»£ç ï¼ˆ'CN' ä¸­å›½ï¼Œ'US' ç¾å›½ç­‰ï¼‰
    
    Returns:
        (is_valid, message): éªŒè¯ç»“æœå’Œæ¶ˆæ¯
    """
    if not phone:
        return False, "ç”µè¯å·ç ä¸èƒ½ä¸ºç©º"
    
    # ç§»é™¤ç©ºæ ¼å’Œç‰¹æ®Šå­—ç¬¦
    phone = re.sub(r'[\s\-\(\)]', '', phone)
    
    # æ ¹æ®åœ°åŒºéªŒè¯
    if region == 'CN':
        # ä¸­å›½æ‰‹æœºå·ç 
        if re.match(r'^1[3-9]\d{9}$', phone):
            return True, "æ‰‹æœºå·ç æ ¼å¼æ­£ç¡®"
        # ä¸­å›½å›ºå®šç”µè¯
        elif re.match(r'^0\d{2,3}\d{7,8}$', phone):
            return True, "å›ºå®šç”µè¯æ ¼å¼æ­£ç¡®"
        else:
            return False, "ç”µè¯å·ç æ ¼å¼æ— æ•ˆï¼ˆéœ€è¦11ä½æ‰‹æœºå·æˆ–åŒºå·+ç”µè¯ï¼‰"
    
    elif region == 'US':
        # ç¾å›½ç”µè¯å·ç 
        if re.match(r'^1?\d{10}$', phone):
            return True, "ç”µè¯å·ç æ ¼å¼æ­£ç¡®"
        else:
            return False, "ç”µè¯å·ç æ ¼å¼æ— æ•ˆï¼ˆéœ€è¦10ä½æ•°å­—ï¼‰"
    
    else:
        # é€šç”¨éªŒè¯ï¼ˆåªæ£€æŸ¥æ˜¯å¦ä¸ºæ•°å­—ï¼‰
        if re.match(r'^\+?\d{7,15}$', phone):
            return True, "ç”µè¯å·ç æ ¼å¼æ­£ç¡®"
        else:
            return False, "ç”µè¯å·ç æ ¼å¼æ— æ•ˆ"


def validate_url(url: str) -> Tuple[bool, str]:
    """
    éªŒè¯URLåœ°å€
    
    Args:
        url: URLåœ°å€
    
    Returns:
        (is_valid, message): éªŒè¯ç»“æœå’Œæ¶ˆæ¯
    """
    if not url:
        return False, "URLä¸èƒ½ä¸ºç©º"
    
    # URLæ­£åˆ™è¡¨è¾¾å¼
    url_pattern = r'^https?://(?:www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b(?:[-a-zA-Z0-9()@:%_\+.~#?&/=]*)$'
    
    if re.match(url_pattern, url):
        return True, "URLæ ¼å¼æ­£ç¡®"
    else:
        return False, "URLæ ¼å¼æ— æ•ˆ"


def validate_api_key(api_key: str, 
                    key_type: str = 'google') -> Tuple[bool, str]:
    """
    éªŒè¯APIå¯†é’¥æ ¼å¼
    
    Args:
        api_key: APIå¯†é’¥
        key_type: å¯†é’¥ç±»å‹ï¼ˆ'google', 'openai'ç­‰ï¼‰
    
    Returns:
        (is_valid, message): éªŒè¯ç»“æœå’Œæ¶ˆæ¯
    """
    if not api_key:
        return False, "APIå¯†é’¥ä¸èƒ½ä¸ºç©º"
    
    api_key = api_key.strip()
    
    if key_type == 'google':
        # Google APIå¯†é’¥é€šå¸¸æ˜¯39ä¸ªå­—ç¬¦
        if len(api_key) == 39 and api_key.startswith('AIza'):
            return True, "Google APIå¯†é’¥æ ¼å¼æ­£ç¡®"
        else:
            return False, "Google APIå¯†é’¥æ ¼å¼æ— æ•ˆï¼ˆåº”ä¸º39ä¸ªå­—ç¬¦ï¼Œä»¥AIzaå¼€å¤´ï¼‰"
    
    elif key_type == 'openai':
        # OpenAI APIå¯†é’¥
        if api_key.startswith('sk-') and len(api_key) > 20:
            return True, "OpenAI APIå¯†é’¥æ ¼å¼æ­£ç¡®"
        else:
            return False, "OpenAI APIå¯†é’¥æ ¼å¼æ— æ•ˆï¼ˆåº”ä»¥sk-å¼€å¤´ï¼‰"
    
    else:
        # é€šç”¨éªŒè¯
        if len(api_key) >= 16:
            return True, "APIå¯†é’¥æ ¼å¼æ­£ç¡®"
        else:
            return False, "APIå¯†é’¥å¤ªçŸ­ï¼ˆè‡³å°‘éœ€è¦16ä¸ªå­—ç¬¦ï¼‰"


def validate_json_structure(data: Dict[str, Any], 
                          required_fields: List[str],
                          field_types: Optional[Dict[str, type]] = None) -> Tuple[bool, str]:
    """
    éªŒè¯JSON/å­—å…¸ç»“æ„
    
    Args:
        data: è¦éªŒè¯çš„æ•°æ®
        required_fields: å¿…éœ€çš„å­—æ®µåˆ—è¡¨
        field_types: å­—æ®µç±»å‹æ˜ å°„ï¼ˆå¯é€‰ï¼‰
    
    Returns:
        (is_valid, message): éªŒè¯ç»“æœå’Œæ¶ˆæ¯
    """
    if not isinstance(data, dict):
        return False, "æ•°æ®å¿…é¡»æ˜¯å­—å…¸ç±»å‹"
    
    # æ£€æŸ¥å¿…éœ€å­—æ®µ
    missing_fields = []
    for field in required_fields:
        if field not in data:
            missing_fields.append(field)
    
    if missing_fields:
        return False, f"ç¼ºå°‘å¿…éœ€å­—æ®µ: {', '.join(missing_fields)}"
    
    # æ£€æŸ¥å­—æ®µç±»å‹
    if field_types:
        type_errors = []
        for field, expected_type in field_types.items():
            if field in data and not isinstance(data[field], expected_type):
                actual_type = type(data[field]).__name__
                expected_name = expected_type.__name__
                type_errors.append(f"{field} åº”ä¸º {expected_name} ç±»å‹ï¼Œå®é™…ä¸º {actual_type}")
        
        if type_errors:
            return False, "å­—æ®µç±»å‹é”™è¯¯: " + "; ".join(type_errors)
    
    return True, "æ•°æ®ç»“æ„æœ‰æ•ˆ"


def validate_template_variables(template: str, 
                              provided_vars: Dict[str, Any]) -> Tuple[bool, List[str]]:
    """
    éªŒè¯æ¨¡æ¿å˜é‡
    
    Args:
        template: æ¨¡æ¿å­—ç¬¦ä¸²
        provided_vars: æä¾›çš„å˜é‡å­—å…¸
    
    Returns:
        (is_valid, missing_vars): æ˜¯å¦æœ‰æ•ˆå’Œç¼ºå¤±çš„å˜é‡åˆ—è¡¨
    """
    # æå–æ¨¡æ¿ä¸­çš„å˜é‡
    pattern = r'\{([^}]+)\}'
    required_vars = set(re.findall(pattern, template))
    
    # æ£€æŸ¥ç¼ºå¤±çš„å˜é‡
    provided_keys = set(provided_vars.keys())
    missing_vars = list(required_vars - provided_keys)
    
    is_valid = len(missing_vars) == 0
    
    return is_valid, missing_vars


def validate_batch_files(file_paths: List[Union[str, Path]], 
                        max_total_size_mb: Optional[float] = None,
                        max_file_count: Optional[int] = None) -> Tuple[bool, str, List[str]]:
    """
    éªŒè¯æ‰¹é‡æ–‡ä»¶
    
    Args:
        file_paths: æ–‡ä»¶è·¯å¾„åˆ—è¡¨
        max_total_size_mb: æœ€å¤§æ€»å¤§å°ï¼ˆMBï¼‰
        max_file_count: æœ€å¤§æ–‡ä»¶æ•°é‡
    
    Returns:
        (is_valid, message, invalid_files): éªŒè¯ç»“æœã€æ¶ˆæ¯å’Œæ— æ•ˆæ–‡ä»¶åˆ—è¡¨
    """
    invalid_files = []
    total_size = 0
    
    # æ£€æŸ¥æ–‡ä»¶æ•°é‡
    if max_file_count and len(file_paths) > max_file_count:
        return False, f"æ–‡ä»¶æ•°é‡è¶…è¿‡é™åˆ¶ï¼ˆæœ€å¤š {max_file_count} ä¸ªï¼‰", []
    
    # éªŒè¯æ¯ä¸ªæ–‡ä»¶
    for file_path in file_paths:
        file_path = Path(file_path)
        
        # æ£€æŸ¥æ–‡ä»¶å­˜åœ¨æ€§
        if not file_path.exists():
            invalid_files.append(str(file_path))
            continue
        
        # ç´¯è®¡æ–‡ä»¶å¤§å°
        total_size += file_path.stat().st_size
    
    # æ£€æŸ¥æ€»å¤§å°
    total_size_mb = total_size / (1024 * 1024)
    if max_total_size_mb and total_size_mb > max_total_size_mb:
        return False, f"æ–‡ä»¶æ€»å¤§å°è¶…è¿‡é™åˆ¶ï¼ˆ{total_size_mb:.1f} MB > {max_total_size_mb} MBï¼‰", invalid_files
    
    if invalid_files:
        return False, f"æœ‰ {len(invalid_files)} ä¸ªæ–‡ä»¶æ— æ•ˆ", invalid_files
    
    return True, f"æ‰€æœ‰æ–‡ä»¶æœ‰æ•ˆï¼Œæ€»å¤§å°: {total_size_mb:.1f} MB", []


def validate_model_input(text: str, 
                        model_type: str = 'gemini') -> Tuple[bool, str]:
    """
    éªŒè¯æ¨¡å‹è¾“å…¥
    
    Args:
        text: è¾“å…¥æ–‡æœ¬
        model_type: æ¨¡å‹ç±»å‹
    
    Returns:
        (is_valid, message): éªŒè¯ç»“æœå’Œæ¶ˆæ¯
    """
    if not text:
        return False, "è¾“å…¥æ–‡æœ¬ä¸èƒ½ä¸ºç©º"
    
    # ä¼°ç®—tokenæ•°é‡ï¼ˆç®€å•ä¼°ç®—ï¼‰
    estimated_tokens = len(text) // 4  # è‹±æ–‡çº¦4ä¸ªå­—ç¬¦ä¸€ä¸ªtoken
    chinese_chars = len([c for c in text if '\u4e00' <= c <= '\u9fff'])
    estimated_tokens += chinese_chars * 0.5  # ä¸­æ–‡å­—ç¬¦é¢å¤–è®¡ç®—
    
    max_tokens = VALIDATION_RULES['api_limits']['max_tokens_per_request']
    
    if estimated_tokens > max_tokens:
        return False, f"è¾“å…¥æ–‡æœ¬è¿‡é•¿ï¼Œé¢„ä¼° {int(estimated_tokens)} tokensï¼Œè¶…è¿‡é™åˆ¶ {max_tokens}"
    
    return True, f"è¾“å…¥æœ‰æ•ˆï¼Œé¢„ä¼° {int(estimated_tokens)} tokens"


def validate_workflow_state(state: Dict[str, Any], 
                          workflow_type: str) -> Tuple[bool, str]:
    """
    éªŒè¯å·¥ä½œæµçŠ¶æ€
    
    Args:
        state: å·¥ä½œæµçŠ¶æ€
        workflow_type: å·¥ä½œæµç±»å‹
    
    Returns:
        (is_valid, message): éªŒè¯ç»“æœå’Œæ¶ˆæ¯
    """
    # å®šä¹‰å„å·¥ä½œæµçš„å¿…éœ€æ­¥éª¤
    workflow_requirements = {
        'full_process': ['transcription', 'analysis', 'proposal'],
        'analysis_only': ['input', 'analysis'],
        'proposal_only': ['analysis', 'proposal']
    }
    
    required_steps = workflow_requirements.get(workflow_type, [])
    
    if not required_steps:
        return True, "å·¥ä½œæµç±»å‹æœªå®šä¹‰è¦æ±‚"
    
    # æ£€æŸ¥å¿…éœ€æ­¥éª¤æ˜¯å¦å®Œæˆ
    missing_steps = []
    for step in required_steps:
        if not state.get(f'{step}_completed', False):
            missing_steps.append(step)
    
    if missing_steps:
        return False, f"å·¥ä½œæµæœªå®Œæˆï¼Œç¼ºå°‘æ­¥éª¤: {', '.join(missing_steps)}"
    
    return True, "å·¥ä½œæµçŠ¶æ€æœ‰æ•ˆ"


def sanitize_filename(filename: str, 
                     max_length: int = 255) -> str:
    """
    æ¸…ç†æ–‡ä»¶åï¼Œä½¿å…¶å®‰å…¨
    
    Args:
        filename: åŸå§‹æ–‡ä»¶å
        max_length: æœ€å¤§é•¿åº¦
    
    Returns:
        str: æ¸…ç†åçš„æ–‡ä»¶å
    """
    # ç§»é™¤è·¯å¾„åˆ†éš”ç¬¦
    filename = filename.replace('/', '_').replace('\\', '_')
    
    # ç§»é™¤ç‰¹æ®Šå­—ç¬¦
    invalid_chars = '<>:"|?*'
    for char in invalid_chars:
        filename = filename.replace(char, '_')
    
    # ç§»é™¤æ§åˆ¶å­—ç¬¦
    filename = ''.join(char for char in filename if ord(char) >= 32)
    
    # å¤„ç†ä¿ç•™åç§°ï¼ˆWindowsï¼‰
    reserved_names = ['CON', 'PRN', 'AUX', 'NUL'] + \
                    [f'COM{i}' for i in range(1, 10)] + \
                    [f'LPT{i}' for i in range(1, 10)]
    
    name_without_ext = filename.rsplit('.', 1)[0].upper()
    if name_without_ext in reserved_names:
        filename = f'_{filename}'
    
    # é™åˆ¶é•¿åº¦
    if len(filename) > max_length:
        # ä¿ç•™æ‰©å±•å
        name_parts = filename.rsplit('.', 1)
        if len(name_parts) == 2:
            name, ext = name_parts
            max_name_length = max_length - len(ext) - 1
            filename = f"{name[:max_name_length]}.{ext}"
        else:
            filename = filename[:max_length]
    
    # ç¡®ä¿ä¸ä¸ºç©º
    if not filename:
        filename = 'unnamed_file'
    
    return filename


def validate_date_range(start_date: str, 
                       end_date: str,
                       date_format: str = '%Y-%m-%d') -> Tuple[bool, str]:
    """
    éªŒè¯æ—¥æœŸèŒƒå›´
    
    Args:
        start_date: å¼€å§‹æ—¥æœŸ
        end_date: ç»“æŸæ—¥æœŸ
        date_format: æ—¥æœŸæ ¼å¼
    
    Returns:
        (is_valid, message): éªŒè¯ç»“æœå’Œæ¶ˆæ¯
    """
    from datetime import datetime
    
    try:
        start = datetime.strptime(start_date, date_format)
        end = datetime.strptime(end_date, date_format)
        
        if start > end:
            return False, "å¼€å§‹æ—¥æœŸä¸èƒ½æ™šäºç»“æŸæ—¥æœŸ"
        
        # æ£€æŸ¥æ—¥æœŸèŒƒå›´æ˜¯å¦åˆç†ï¼ˆä¾‹å¦‚ä¸è¶…è¿‡1å¹´ï¼‰
        delta = end - start
        if delta.days > 365:
            return False, "æ—¥æœŸèŒƒå›´ä¸èƒ½è¶…è¿‡1å¹´"
        
        return True, f"æ—¥æœŸèŒƒå›´æœ‰æ•ˆ: {delta.days} å¤©"
        
    except ValueError as e:
        return False, f"æ—¥æœŸæ ¼å¼é”™è¯¯: {str(e)}"


def validate_config_file(config_path: Union[str, Path]) -> Tuple[bool, str, Dict[str, List[str]]]:
    """
    éªŒè¯é…ç½®æ–‡ä»¶
    
    Args:
        config_path: é…ç½®æ–‡ä»¶è·¯å¾„
    
    Returns:
        (is_valid, message, issues): éªŒè¯ç»“æœã€æ¶ˆæ¯å’Œé—®é¢˜è¯¦æƒ…
    """
    import configparser
    
    config_path = Path(config_path)
    issues = {'errors': [], 'warnings': []}
    
    if not config_path.exists():
        return False, f"é…ç½®æ–‡ä»¶ä¸å­˜åœ¨: {config_path}", issues
    
    try:
        config = configparser.ConfigParser()
        config.read(config_path)
        
        # æ£€æŸ¥å¿…éœ€çš„éƒ¨åˆ†
        required_sections = ['API_SETTINGS', 'MODEL_SETTINGS', 'FILE_SETTINGS']
        for section in required_sections:
            if section not in config:
                issues['errors'].append(f"ç¼ºå°‘å¿…éœ€çš„é…ç½®éƒ¨åˆ†: [{section}]")
        
        # æ£€æŸ¥APIè®¾ç½®
        if 'API_SETTINGS' in config:
            if config.getboolean('API_SETTINGS', 'use_internal_api_key', fallback=False):
                api_key_file = config.get('API_SETTINGS', 'api_key_file', fallback='')
                if not api_key_file:
                    issues['errors'].append("ä½¿ç”¨å†…éƒ¨APIå¯†é’¥ä½†æœªæŒ‡å®šå¯†é’¥æ–‡ä»¶")
        
        # æ£€æŸ¥æ–‡ä»¶è®¾ç½®
        if 'FILE_SETTINGS' in config:
            max_size = config.getint('FILE_SETTINGS', 'max_file_size_mb', fallback=0)
            if max_size <= 0:
                issues['warnings'].append("æœªè®¾ç½®æœ‰æ•ˆçš„æœ€å¤§æ–‡ä»¶å¤§å°é™åˆ¶")
        
        if issues['errors']:
            return False, "é…ç½®æ–‡ä»¶æœ‰é”™è¯¯", issues
        elif issues['warnings']:
            return True, "é…ç½®æ–‡ä»¶æœ‰æ•ˆä½†æœ‰è­¦å‘Š", issues
        else:
            return True, "é…ç½®æ–‡ä»¶å®Œå…¨æœ‰æ•ˆ", issues
        
    except Exception as e:
        issues['errors'].append(f"é…ç½®æ–‡ä»¶è§£æé”™è¯¯: {str(e)}")
        return False, "é…ç½®æ–‡ä»¶è§£æå¤±è´¥", issues
